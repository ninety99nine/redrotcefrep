import{I as g}from"./Input-l_fu_pN6.js";import{B as b}from"./Button-D7saANb7.js";import{S as _}from"./StoreLogo-D34TjnQk.js";import{W as x}from"./WhatsappIcon-EtQqnzYS.js";import{S as w}from"./SelectCountry-Bi88VSpx.js";import{a as C,i as E}from"./stringUtils-Bvzw0-oW.js";import{S as V}from"./SelectCurrency-BriyL9dm.js";import{c as F,b as s,a,r as n,g as u,o as T}from"./app-DF0QnPU4.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as v}from"./earth-78_1Tq43.js";import"./Copy-DudZ5Uvs.js";import"./ShineEffect-BVNWGq73.js";import"./createLucideIcon-eN94IJz_.js";import"./Popover-DmuV9HMk.js";import"./x-DdzUJel4.js";import"./Skeleton-DAfv9Rr0.js";import"./refresh-ccw-BWvWNHcU.js";import"./circle-check-B1WpMwJ7.js";import"./circle-alert-ByShgotJ.js";import"./parsePhoneNumber-DR0S47Bc.js";import"./Loader-CNeQD6e9.js";import"./plus-DYnannGu.js";import"./Select-dH13kFO1.js";const B={inject:["authState","storeState","formState","notificationState"],components:{Earth:v,Input:g,Button:b,StoreLogo:_,WhatsappIcon:x,SelectCountry:w,SelectCurrency:V},data(){return{form:{name:"",alias:"",country:"BW",currency:"BWP",whatsapp_mobile_number:""},logo:null,aliasModified:!1,isCreatingStore:!1}},methods:{isEmpty:E,isNotEmpty:C,syncWithAlias(){this.aliasModified==!1&&(this.form.alias=this.form.name,this.formatAlias())},formatAlias(i=!1){this.form.alias.length?(this.form.alias=this.form.alias.replace(/[^a-zA-Z0-9\s-]/g,"").replace(/\s+/g,"-").trim().toLowerCase(),this.aliasModified=i):this.aliasModified=!1},handleSelectedFile(i){this.logo=i},async createStore(){var i,e;try{if(this.isCreatingStore||(this.formState.hideFormErrors(),this.isEmpty(this.form.name)&&this.formState.setFormError("name","Enter store name"),this.formState.hasErrors))return;this.isCreatingStore=!0;let t=new FormData;t.append("return",1),t.append("name",this.form.name),t.append("country",this.form.country),t.append("currency",this.form.currency),this.isNotEmpty(this.form.alias)&&t.append("alias",this.form.alias.trim()),this.isNotEmpty(this.form.whatsapp_mobile_number)&&t.append("whatsapp_mobile_number",this.form.whatsapp_mobile_number.trim()),this.logo&&t.append("logo",this.logo);const m={headers:{"Content-Type":"multipart/form-data"}},o=await axios.post("/api/stores",t,m);this.notificationState.showSuccessNotification("Store created!"),this.$router.push({name:"add-products",params:{store_id:o.data.store.id}})}catch(t){const m=((e=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while creating store";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(t),console.error("Failed to create store:",t)}finally{this.isCreatingStore=!1}}},created(){this.storeState.setStore(null),this.authState.user.mobile_number&&(this.form.whatsapp_mobile_number=this.authState.user.mobile_number.international)}},N={class:"min-h-screen flex flex-col items-center justify-center py-20"},I={class:"w-full max-w-lg bg-white p-8 rounded-2xl shadow-lg"},A={class:"space-y-4 mb-4"},k={class:"flex items-center space-x-1 pl-2 rounded-l-md bg-gray-50 text-gray-500 whitespace-nowrap"};function L(i,e,t,m,o,l){const f=n("StoreLogo"),p=n("Input"),c=n("WhatsappIcon"),d=n("Earth"),h=n("SelectCountry"),y=n("SelectCurrency"),S=n("Button");return T(),F("div",N,[e[9]||(e[9]=s("div",{class:"w-full max-w-lg"},[s("h2",{class:"text-2xl font-semibold text-center"},"Start Your Store"),s("p",{class:"text-gray-500 text-center mb-6"},"Tell us a little about your store to get started")],-1)),s("div",I,[a(f,{onSelectedFile:l.handleSelectedFile,uploading:o.logo&&o.isCreatingStore,class:"flex justify-center mb-4"},null,8,["onSelectedFile","uploading"]),s("div",A,[a(p,{type:"text",label:"Name",modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.form.name=r),showAsterisk:!0,onKeyup:l.syncWithAlias,placeholder:"Baby Cakes ðŸ§",autocomplete:"organization",errorText:l.formState.getFormError("name")},null,8,["modelValue","onKeyup","errorText"]),a(p,{type:"text",label:"WhatsApp Number",placeholder:"+26772000001",modelValue:o.form.whatsapp_mobile_number,"onUpdate:modelValue":e[1]||(e[1]=r=>o.form.whatsapp_mobile_number=r),errorText:l.formState.getFormError("whatsapp_mobile_number"),description:"Customers can send orders to this number after shopping"},{prefix:u(()=>[a(c,{class:"mx-2"})]),_:1},8,["modelValue","errorText"]),a(p,{type:"text",label:"Store Link",modelValue:o.form.alias,"onUpdate:modelValue":e[2]||(e[2]=r=>o.form.alias=r),placeholder:"baby-cakes",onKeyup:e[3]||(e[3]=()=>l.formatAlias(!0)),errorText:l.formState.getFormError("alias"),description:"Your storeâ€™s shopping link. Custom domains can be set later."},{prefix:u(()=>[s("div",k,[a(d,{size:"18",class:"mt-0.5"}),e[6]||(e[6]=s("span",{class:"text-sm"},"perfectorder.shop",-1)),e[7]||(e[7]=s("span",{class:"text-gray-400 text-sm"},"/",-1))])]),_:1},8,["modelValue","errorText"]),a(h,{class:"w-full",label:"Country",modelValue:o.form.country,"onUpdate:modelValue":e[4]||(e[4]=r=>o.form.country=r),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your storeâ€™s country of operation"},null,8,["modelValue"]),a(y,{class:"w-full",label:"Currency",modelValue:o.form.currency,"onUpdate:modelValue":e[5]||(e[5]=r=>o.form.currency=r),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your storeâ€™s currency"},null,8,["modelValue"])]),a(S,{size:"lg",type:"primary",buttonClass:"w-full",action:l.createStore,loading:o.isCreatingStore,disabled:o.isCreatingStore},{default:u(()=>e[8]||(e[8]=[s("span",null,"Create Store",-1)])),_:1,__:[8]},8,["action","loading","disabled"])])])}const ae=W(B,[["render",L]]);export{ae as default};
