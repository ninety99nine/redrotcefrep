import{I as S}from"./Input-pc2fltgk.js";import{B as x}from"./Button-pzNXv-1Y.js";import{i as f}from"./stringUtils-Bvzw0-oW.js";import{c as l,b as s,a as d,t as g,e as p,F as y,g as h,r as w,o as c}from"./app-BdtY1GmG.js";import{_}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as b}from"./createLucideIcon-0MdAfLNi.js";import{P as k}from"./plus-CFRUzLa5.js";import"./Copy-Bf47GF8y.js";import"./ShineEffect-3X5J5V6N.js";import"./Popover-bKPSdKQk.js";import"./Tooltip-Hig8fsp-.js";import"./Skeleton-CB7Ij9bY.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-D9yatk9r.js";import"./circle-check-BBZmw5-4.js";import"./circle-alert-BJ7_6iqo.js";import"./x-C6hQ11hV.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-C1t9Dbrf.js";/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=b("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),v={inject:["authState","storeState","formState","changeHistoryState","notificationState"],components:{Input:S,Button:x},data(){return{Plus:k,Minus:F,connectingGoogle:!1,connectingFacebook:!1,connectingLinkedin:!1,connecting:{google:!1,facebook:!1,linkedin:!1}}},computed:{userForm(){return this.authState.userForm},user(){return this.authState.user},store(){return this.storeState.store},socialLoginCount(){return this.user.social_login_count},hasPassword(){return this.user.has_password===!0}},methods:{isEmpty:f,setup(){this.authState.setUserForm()},setActionButtons(){this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(),this.changeHistoryState.addActionButton("Save Changes",this.updateUser,"primary",null)},async updateUser(){var n,t;try{if(this.authState.isUpdatingUser)return;this.authState.isUpdatingUser=!0,this.changeHistoryState.actionButtons[1].loading=!0;const a={...this.userForm};f(a.password)&&(delete a.password,delete a.password_confirmation,delete a.current_password),await axios.put("/api/auth/user",a),await this.authState.fetchUser(),this.userForm.password=null,this.userForm.current_password=null,this.userForm.password_confirmation=null,this.notificationState.showSuccessNotification("Account updated successfully"),this.authState.saveOriginalState("Original account")}catch(a){const m=((t=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to update account";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(a)}finally{this.authState.isUpdatingUser=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async handleSocialAction(n,t){var a,m,r;this.connecting[n]=!0;try{if(t){if(this.socialLoginCount===1&&!this.hasPassword){this.notificationState.showWarningNotification(`You cannot disconnect ${n}. This is your only login method. Please set a password first.`);return}if(!confirm(`Are you sure you want to disconnect ${n}?`))return;const i=`${n}_id`;await axios.put("/api/auth/user",{[i]:null}),await this.authState.fetchUser(),this.notificationState.showSuccessNotification(`${n} disconnected successfully`),this.connecting[n]=!1}else{const e=this.authState.token,i=(a=this.store)==null?void 0:a.id,u=new URLSearchParams;u.append("store_id",i),u.append("token",e),window.location.href=`/auth/${n}${u.toString()?"?"+u.toString():""}`}}catch(e){const i=((r=(m=e==null?void 0:e.response)==null?void 0:m.data)==null?void 0:r.message)||`Failed to ${t?"disconnect":"connect"} ${n}`;this.notificationState.showWarningNotification(i)}}},created(){this.setup(),this.setActionButtons(),["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"].forEach(t=>{this.changeHistoryState.listeners[t]=()=>this.authState.setUserForm()})}},C={class:"max-w-2xl mx-auto pt-24 pb-40"},V={class:"bg-white p-8 shadow-sm rounded-xl"},P={class:"space-y-6"},U={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},I={class:"pt-6 border-t border-gray-200"},N={class:"text-md font-semibold mb-2"},T={class:"text-xs text-gray-500 mb-4"},L={class:"space-y-4"},B={key:0},A={class:"pt-6 border-t border-gray-200"},E={class:"space-y-4"},D={class:"flex items-center justify-between"},H={class:"flex items-center space-x-4"},M={key:0,class:"text-xs font-semibold text-green-600"},z={key:1,class:"text-sm text-gray-500"},j={class:""},G={class:"flex items-center justify-between"},O={class:"flex items-center space-x-4"},W={key:0,class:"text-xs font-semibold text-green-600"},R={key:1,class:"text-sm text-gray-500"},q={class:""},Y={class:"flex items-center justify-between"},J={class:"flex items-center space-x-4"},K={key:0,class:"text-xs font-semibold text-green-600"},Q={key:1,class:"text-sm text-gray-500"},X={class:""};function Z(n,t,a,m,r,e){const i=w("Input"),u=w("Button");return c(),l("div",C,[s("div",V,[t[20]||(t[20]=s("h1",{class:"text-lg font-bold mb-4"},"Account Settings",-1)),t[21]||(t[21]=s("p",{class:"text-xs text-gray-500 mb-8"}," Update your personal information and password. ",-1)),s("div",P,[s("div",U,[d(i,{type:"text",label:"First Name",modelValue:e.userForm.first_name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.userForm.first_name=o),onChange:t[1]||(t[1]=o=>e.authState.saveStateDebounced("First name changed")),errorText:e.formState.getFormError("first_name")},null,8,["modelValue","errorText"]),d(i,{type:"text",label:"Last Name",modelValue:e.userForm.last_name,"onUpdate:modelValue":t[2]||(t[2]=o=>e.userForm.last_name=o),onChange:t[3]||(t[3]=o=>e.authState.saveStateDebounced("Last name changed")),errorText:e.formState.getFormError("last_name")},null,8,["modelValue","errorText"])]),d(i,{type:"text",label:"Email Address",modelValue:e.userForm.email,"onUpdate:modelValue":t[4]||(t[4]=o=>e.userForm.email=o),onChange:t[5]||(t[5]=o=>e.authState.saveStateDebounced("Email changed")),errorText:e.formState.getFormError("email")},null,8,["modelValue","errorText"]),s("div",I,[s("h2",N,g(e.hasPassword?"Change Password":"Set a Password"),1),s("p",T,g(e.hasPassword?"Leave blank if you don't want to change your password.":"Set a password to sign in with email in the future."),1),s("div",L,[e.hasPassword?(c(),l("div",B,[d(i,{type:"password",label:"Current Password",placeholder:"Required to set a new password",modelValue:e.userForm.current_password,"onUpdate:modelValue":t[6]||(t[6]=o=>e.userForm.current_password=o),errorText:e.formState.getFormError("current_password"),onChange:t[7]||(t[7]=o=>e.authState.saveStateDebounced("Current password entered"))},null,8,["modelValue","errorText"])])):p("",!0),!e.hasPassword||e.hasPassword&&(e.userForm.current_password??"").length!=0?(c(),l(y,{key:1},[d(i,{type:"password",label:"New Password",modelValue:e.userForm.password,"onUpdate:modelValue":t[8]||(t[8]=o=>e.userForm.password=o),errorText:e.formState.getFormError("password"),onChange:t[9]||(t[9]=o=>e.authState.saveStateDebounced("New password changed"))},null,8,["modelValue","errorText"]),d(i,{type:"password",label:"Confirm New Password",modelValue:e.userForm.password_confirmation,"onUpdate:modelValue":t[10]||(t[10]=o=>e.userForm.password_confirmation=o),errorText:e.formState.getFormError("password_confirmation"),onChange:t[11]||(t[11]=o=>e.authState.saveStateDebounced("Password confirmation changed"))},null,8,["modelValue","errorText"])],64)):p("",!0)])]),s("div",A,[t[18]||(t[18]=s("h2",{class:"text-md font-semibold mb-2"},"Connected Accounts",-1)),t[19]||(t[19]=s("p",{class:"text-xs text-gray-500 mb-6"}," Link your social accounts to sign in faster. ",-1)),s("div",E,[s("div",D,[s("div",H,[t[13]||(t[13]=s("img",{src:"/images/social-login-icons/google.png",alt:"Google",class:"w-8 h-8"},null,-1)),s("div",null,[t[12]||(t[12]=s("p",{class:"font-medium"},"Google",-1)),e.user.has_google?(c(),l("p",M,"Connected")):(c(),l("p",z,"Not connected"))])]),d(u,{size:"xs",leftIconSize:"14",loading:r.connecting.google,leftIcon:e.user.has_google?r.Minus:r.Plus,type:e.user.has_google?"danger":"success",action:()=>e.handleSocialAction("google",e.user.has_google)},{default:h(()=>[s("span",j,g(e.user.has_google?"Disconnect":"Connect"),1)]),_:1},8,["loading","leftIcon","type","action"])]),s("div",G,[s("div",O,[t[15]||(t[15]=s("img",{src:"/images/social-login-icons/facebook.png",alt:"Facebook",class:"w-8 h-8"},null,-1)),s("div",null,[t[14]||(t[14]=s("p",{class:"font-medium"},"Facebook",-1)),e.user.has_facebook?(c(),l("p",W,"Connected")):(c(),l("p",R,"Not connected"))])]),d(u,{size:"xs",leftIconSize:"14",loading:r.connecting.facebook,leftIcon:e.user.has_facebook?r.Minus:r.Plus,type:e.user.has_facebook?"danger":"success",action:()=>e.handleSocialAction("facebook",e.user.has_facebook)},{default:h(()=>[s("span",q,g(e.user.has_facebook?"Disconnect":"Connect"),1)]),_:1},8,["loading","leftIcon","type","action"])]),s("div",Y,[s("div",J,[t[17]||(t[17]=s("img",{src:"/images/social-login-icons/linkedin.png",alt:"LinkedIn",class:"w-8 h-8"},null,-1)),s("div",null,[t[16]||(t[16]=s("p",{class:"font-medium"},"LinkedIn",-1)),e.user.has_linkedin?(c(),l("p",K,"Connected")):(c(),l("p",Q,"Not connected"))])]),d(u,{size:"xs",leftIconSize:"14",loading:r.connecting.linkedin,leftIcon:e.user.has_linkedin?r.Minus:r.Plus,type:e.user.has_linkedin?"danger":"success",action:()=>e.handleSocialAction("linkedin",e.user.has_linkedin)},{default:h(()=>[s("span",X,g(e.user.has_linkedin?"Disconnect":"Connect"),1)]),_:1},8,["loading","leftIcon","type","action"])])])])])])])}const Se=_(v,[["render",Z]]);export{Se as default};
