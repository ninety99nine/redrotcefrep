import{d,r as i,o as c,g as _,b as l,a as h,c as g,e as w,n as x,t as v,k as y,l as C}from"./app-9D_Cw4s4.js";import{B as S}from"./Button-enl4NEGy.js";import{_ as p}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{H as b}from"./house-Dc5rO9nA.js";import{S as B}from"./shopping-cart-BRSmbnSA.js";import{D}from"./Drawer-Dzx_WJvx.js";import{D as I}from"./DesignCardManager-WbQ76Phf.js";import{M}from"./menu-uNaVAIDT.js";import{U as z}from"./user-CjuVjUxA.js";import{S as k}from"./Input-CaqG3UNa.js";import{T as O}from"./toastify-ChEGw9op.js";import{S as j}from"./StoreLogo-BlTZERCk.js";import"./Loader-BJ_yFh5a.js";import"./ShineEffect-CCEGWZwA.js";import"./createLucideIcon-BjPl0ua2.js";import"./x-ByYxaui0.js";import"./store-pMI7L-M5.js";import"./MyCartButton-D-GmFwpz.js";import"./Skeleton-ChnWfFmK.js";import"./Pill-BFJX92pa.js";import"./Popover-BYwxVx0y.js";import"./Tooltip-DBg9S1F5.js";import"./image-CekI2fYH.js";import"./stringUtils-Bvzw0-oW.js";import"./AddressInput-C7JpUQiS.js";import"./index-B6OgRaxB.js";import"./Modal-BQzBOKi-.js";import"./GoogleMaps-Dc7f_r0d.js";import"./SelectCountry-AcneJGDj.js";import"./Select-DmaDYR2i.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-sY-Ia2Cp.js";import"./move-left-DwJIasRB.js";import"./trash-2-BO5hz549.js";import"./plus-BPwoMIzT.js";import"./link-Ceb0b8zq.js";import"./video-sqH5enGD.js";import"./at-sign-Cuu9decL.js";import"./chevron-right-CoCZnxpS.js";import"./arrow-right-CP2uaHBL.js";import"./chevron-down-DgK8UlFM.js";import"./chevron-up-CpFDy9fL.js";import"./Datepicker-OztGanCN.js";import"./Alert-cipDnSO8.js";import"./circle-check-gsRbbAn8.js";import"./info-B7NJElNr.js";import"./arrow-left-D4fa9TJE.js";import"./Switch-B-8TeSQT.js";import"./DeliveryTimePicker-CQz7gcc5.js";import"./circle-alert-BncYZhnp.js";import"./circle-check-big-BriKmtq6.js";import"./Copy-TLmCwI7a.js";import"./parsePhoneNumber-xMTQFMCS.js";const F={inject:["storeState","notificationState"],components:{Button:S},data(){return{House:b}},computed:{store(){return this.storeState.store},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)}},methods:{async navigateToStorefront(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-storefront",params:{alias:this.store.alias}})}}};function T(s,e,t,r,n,o){const a=i("Button");return c(),d(a,{size:"sm",type:"bare",leftIcon:n.House,leftIconSize:"18",action:o.navigateToStorefront},null,8,["leftIcon","action"])}const L=p(F,[["render",T]]),N={inject:["storeState"],components:{Button:S},data(){return{ShoppingCart:B}},computed:{store(){return this.storeState.store}},methods:{async navigateToStorefront(){await this.$router.push({name:"show-storefront",params:{alias:this.store.alias}})}}};function H(s,e,t,r,n,o){const a=i("Button");return c(),d(a,{size:"xs",type:"bare",leftIconSize:"18",leftIcon:n.ShoppingCart,action:o.navigateToStorefront},null,8,["leftIcon","action"])}const A=p(N,[["render",H]]),P={inject:["notificationState"],components:{Button:S,Drawer:D,DesignCardManager:I},data(){return{Menu:M}},watch:{isDesigningMenu(s){s?this.$refs.menuDrawer.showDrawer():this.$refs.menuDrawer.hideDrawer()}},computed:{isDesigningMenu(){return this.$route.name=="edit-menu"}},methods:{closeOnX(){this.isDesigningMenu?this.notificationState.showSuccessNotification("Only closes on the actual store"):this.$refs.menuDrawer.hideDrawer()}},mounted(){this.isDesigningMenu&&this.$refs.menuDrawer.showDrawer()}};function E(s,e,t,r,n,o){const a=i("Button"),m=i("DesignCardManager"),f=i("Drawer");return c(),d(f,{position:"left",contentClass:"",ref:"menuDrawer",showFooter:!1,closeOnX:o.closeOnX,scrollOnContent:!1,targetClass:"mockup-phone"},{trigger:_(u=>[h(a,{size:"xs",type:"bare",leftIcon:n.Menu,leftIconSize:"18",action:u.showDrawer},null,8,["leftIcon","action"])]),content:_(()=>[e[0]||(e[0]=l("h3",{class:"font-semibold text-gray-900 border-b border-gray-200 p-4"},"Menu",-1)),h(m,{placement:"menu"})]),_:1},8,["closeOnX"])}const U=p(P,[["render",E]]),X={inject:["storeState","notificationState"],components:{Button:S},data(){return{User:z}},computed:{store(){return this.storeState.store},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)}},methods:{async navigateToStoreLogin(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-login"})}}};function V(s,e,t,r,n,o){const a=i("Button");return c(),d(a,{size:"sm",type:"primary",leftIcon:n.User,leftIconSize:"18",action:o.navigateToStoreLogin},{default:_(()=>[...e[0]||(e[0]=[l("span",{class:"ml-1"},"Login",-1)])]),_:1},8,["leftIcon","action"])}const W=p(X,[["render",V]]),q={inject:["storeState","notificationState"],components:{Button:S},data(){return{Search:k}},computed:{store(){return this.storeState.store},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)}},methods:{async navigateToSearch(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-search",params:{alias:this.store.alias}})}}};function G(s,e,t,r,n,o){const a=i("Button");return c(),d(a,{size:"xs",type:"bare",leftIconSize:"18",leftIcon:n.Search,action:o.navigateToSearch},null,8,["leftIcon","action"])}const J=p(q,[["render",G]]),K={components:{HomeButton:L,CartButton:A,MenuButton:U,LoginButton:W,SearchButton:J},data(){return{}},computed:{onStorefront(){return["show-storefront","edit-storefront"].includes(this.$route.name)},onSearchPage(){return this.$route.name==="show-search"}},methods:{},created(){}},Q={style:{height:"52px"},class:"relative"},R={class:"fixed top-0 left-0 right-0 z-10 boder-b flex items-center justify-between space-x-2 bg-white shadow px-6 py-2.5 mx-auto"},Y={class:"flex items-center justify-between space-x-4"};function Z(s,e,t,r,n,o){const a=i("MenuButton"),m=i("LoginButton"),f=i("HomeButton"),u=i("SearchButton"),$=i("CartButton");return c(),g("div",Q,[l("div",R,[h(a),l("div",Y,[h(m),!o.onStorefront&&!o.onSearchPage?(c(),d(f,{key:0})):w("",!0),!o.onStorefront&&!o.onSearchPage?(c(),d(u,{key:1})):w("",!0),h($)])])])}const tt=p(K,[["render",Z]]),et={inject:["notificationState"],watch:{"notifications.length"(s,e){if(s>e){const t=this.notifications[this.notifications.length-1];let r,n;t.type=="success"?(r=`
                            <div class="flex space-x-2 p-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mt-0.5 lucide shrink-0 lucide-circle-check-icon lucide-circle-check"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                                <p>${t.message}</p>
                                <div class="ms-auto">
                                    <button onclick="tostifyCustomClose(this)" type="button" class="inline-flex shrink-0 justify-center items-center size-5 rounded-lg text-green-800 opacity-50 hover:opacity-100 focus:outline-hidden focus:opacity-100 dark:text-white" aria-label="Close">
                                        <span class="sr-only">Close</span>
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                                    </button>
                                </div>
                            </div>
                            `,n="hs-toastify-on:opacity-100 opacity-0 fixed -top-37.5 right-5 z-90 transition-all duration-300 w-80 bg-green-200 text-sm text-green-900 border border-green-900 rounded-lg shadow-lg [&>.toast-close]:hidden dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-400"):t.type=="warning"?(r=`
                            <div class="flex space-x-2 p-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mt-0.5 lucide shrink-0 lucide-triangle-alert-icon lucide-triangle-alert"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>
                                <p>${t.message}</p>
                                <div class="ms-auto">
                                    <button onclick="tostifyCustomClose(this)" type="button" class="inline-flex shrink-0 justify-center items-center size-5 rounded-lg text-yellow-800 opacity-50 hover:opacity-100 focus:outline-hidden focus:opacity-100 dark:text-white" aria-label="Close">
                                        <span class="sr-only">Close</span>
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                                    </button>
                                </div>
                            </div>
                            `,n="hs-toastify-on:opacity-100 opacity-0 fixed -top-37.5 right-5 z-90 transition-all duration-300 w-80 bg-yellow-200 text-sm text-yellow-900 border border-yellow-900 rounded-lg shadow-lg [&>.toast-close]:hidden dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-400"):(r=`
                            <div class="flex space-x-2 p-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mt-0.5 lucide shrink-0 lucide-info-icon lucide-info"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                                <p>${t.message}</p>
                                <div class="ms-auto">
                                    <button onclick="tostifyCustomClose(this)" type="button" class="inline-flex shrink-0 justify-center items-center size-5 rounded-lg text-gray-800 opacity-50 hover:opacity-100 focus:outline-hidden focus:opacity-100 dark:text-white" aria-label="Close">
                                        <span class="sr-only">Close</span>
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                                    </button>
                                </div>
                            </div>
                            `,n="hs-toastify-on:opacity-100 opacity-0 fixed -top-37.5 right-5 z-90 transition-all duration-300 w-80 bg-gray-200 text-sm text-gray-900 border border-gray-900 rounded-lg shadow-lg [&>.toast-close]:hidden dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-400"),O({text:r,close:!0,escapeMarkup:!1,className:n,duration:t.duration}).showToast()}}},computed:{notifications(){return this.notificationState.notifications}},mounted(){window.tostifyCustomClose=function(s){const e=s.closest(".toastify");e&&(e.classList.remove("hs-toastify-on:opacity-100"),e.classList.add("opacity-0","scale-95"),setTimeout(()=>{const t=e.querySelector(".toast-close");t&&t.click()},300))}}};function ot(s,e,t,r,n,o){return null}const rt=p(et,[["render",ot]]),st={inject:["storeState"],components:{Home:b,Search:k,StoreLogo:j},computed:{store(){return this.storeState.store},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)},homeMenuActive(){return this.$route.name=="show-storefront"},searchMenuActive(){return this.$route.name=="show-search"}},methods:{async navigateToStorefront(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-storefront",params:{alias:this.store.alias}})},async navigateToSearch(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-search",params:{alias:this.store.alias}})}}},nt={key:0},it={class:"flex flex-col items-center mb-8 space-y-4"},at={class:"absolute -bottom-10 border-4 border-white rounded-full"},ct={class:"absolute -bottom-10 border-4 border-white rounded-full"},lt={class:"text-xl font-bold"},ht={class:"flex justify-center mb-4"};function dt(s,e,t,r,n,o){const a=i("StoreLogo"),m=i("Home"),f=i("Search");return o.store?(c(),g("div",nt,[l("div",it,[o.store.show_background&&o.store.background_photo?(c(),g("div",{key:0,style:x({backgroundImage:`url(${o.store.background_photo.path})`}),class:"relative w-full flex justify-center min-h-48 mb-16 bg-no-repeat bg-cover bg-center"},[l("div",at,[h(a,{size:"w-24 h-24",editable:!1,showButton:!1})])],4)):o.store.show_background?(c(),g("div",{key:1,style:x({background:`#${o.store.bg_color}`}),class:"relative w-full flex justify-center min-h-48 mb-16"},[l("div",ct,[h(a,{size:"w-24 h-24",editable:!1,showButton:!1})])],4)):(c(),d(a,{key:2,size:"w-24 h-24",class:"mt-8",editable:!1,showButton:!1})),l("h1",lt,v(o.store.name),1),o.store.description?(c(),g("p",{key:3,class:y(["text-center max-w-xl",o.isDesigning?"px-4":"px-4 lg:px-0"])},v(o.store.description),3)):w("",!0)]),l("div",ht,[l("div",{onClick:e[0]||(e[0]=(...u)=>o.navigateToStorefront&&o.navigateToStorefront(...u)),class:y(["flex items-center space-x-2 py-2 px-4 border-b-4 hover:border-gray-300 transition-all duration-300 cursor-pointer",o.homeMenuActive?"border-gray-300":"border-transparent"])},[h(m,{size:"20"}),e[2]||(e[2]=l("span",null,"Home",-1))],2),l("div",{onClick:e[1]||(e[1]=(...u)=>o.navigateToSearch&&o.navigateToSearch(...u)),class:y(["flex items-center space-x-2 py-2 px-4 border-b-4 hover:border-gray-300 transition-all duration-300 cursor-pointer",o.searchMenuActive?"border-gray-300":"border-transparent"])},[h(f,{size:"20"}),e[3]||(e[3]=l("span",null,"Search",-1))],2)])])):w("",!0)}const ut=p(st,[["render",dt]]),pt={inject:["formState","orderState","storeState","notificationState"],components:{Menu:tt,Header:ut,Notifications:rt},data(){return{orderAgain:!1}},watch:{$route(s,e){this.orderAgain=e.name==="show-shop-order"&&s.name==="show-checkout",this.showStore()},orderId(s){const e=this.orderAgain?this.order:null;this.orderState.resetOrderForm(),s?this.showOrder():this.prepareStoreForShopping(e)},orderForm:{handler(){this.canInspectShoppingCart&&(this.orderState.setIsInspectingShoppingCart(!0),this.inspectShoppingCartDelayed())},deep:!0}},computed:{store(){return this.storeState.store},alias(){return this.$route.params.alias||null},orderId(){return this.$route.params.order_id||null},order(){return this.orderState.order},hasOrder(){return this.order!=null},orderForm(){return this.orderState.orderForm},canInspectShoppingCart(){return this.orderState.canInspectShoppingCart},showHeader(){return["show-storefront","show-search","show-shop-category"].includes(this.$route.name)},showMenu(){return!["show-checkout","show-shop-payment-methods","show-shop-payment-method","show-shop-confirming-payment","show-shop-pending-payment"].includes(this.$route.name)}},methods:{async prepareStoreForShopping(s=null){await this.orderState.hasStateFromLocalStorage()?(await this.orderState.setStateFromLocalStorage(),await this.inspectShoppingCart()):s?(this.orderState.setOrderForm(s,!1),this.orderState.canInspectShoppingCart=!0):(this.orderState.setOrderForm(null,!1),setTimeout(()=>{this.orderState.canInspectShoppingCart=!0},1e3))},async showStore(){var s,e;try{this.store||(this.storeState.isLoadingStore=!0);let t={params:{_relationships:["logo","backgroundPhoto","categories","myMembership"].join(",")}},r;if(window.storeId&&!this.alias)r=await axios.get(`/api/stores/${window.storeId}`,t);else if(this.alias)r=await axios.get(`/api/stores/alias/${this.alias}`,t);else return;this.storeState.setStore(r.data),document.body.style.backgroundColor=this.store.bg_color,this.orderId?await this.showOrder():await this.prepareStoreForShopping()}catch(t){const r=((e=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while fetching store";this.notificationState.showWarningNotification(r),this.formState.setServerFormErrors(t),console.error("Failed to fetch store:",t),this.$router.replace({name:"notFound"})}finally{this.storeState.isLoadingStore=!1}},async showOrder(){var s,e,t;try{this.orderState.isLoadingOrder=!0;let r={params:{store_id:this.store.id,_relationships:["orderProducts.photo","orderPromotions","orderFees","orderDiscounts","orderComments","customer","courier","deliveryMethod","deliveryAddress"].join(",")}};const o=(await axios.get(`/api/orders/${this.orderId||this.duplicateOrderId}`,r)).data;this.orderState.setOrder(o)}catch(r){const n=((e=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:e.message)||(r==null?void 0:r.message)||"Something went wrong while fetching order";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(r),console.error("Failed to fetch order:",r),((t=r.response)==null?void 0:t.status)===404&&await this.$router.replace({name:"show-storefront",params:{alias:window.storeId?null:this.store.alias}})}finally{this.orderState.isLoadingOrder=!1}},inspectShoppingCartDelayed:C(function(){this.inspectShoppingCart()},1e3),async inspectShoppingCart(){var s,e;try{this.orderState.setIsInspectingShoppingCart(!0);const t={inspect:!0,...this.orderForm,association:"shopper",store_id:this.store.id},r=await axios.post("/api/orders",t);this.orderState.setShoppingCart(r.data)}catch(t){const r=((e=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while inspecting shopping cart";this.notificationState.showWarningNotification(r),this.formState.setServerFormErrors(t),console.error("Failed to inspect shopping cart:",t)}finally{this.orderState.setIsInspectingShoppingCart(!1),this.orderState.setStateOnLocalStorage()}}},beforeUnmount(){this.orderState.resetOrderForm()},unmounted(){document.body.style.backgroundColor=null},created(){this.store?this.orderId?this.showOrder():this.prepareStoreForShopping():this.showStore()}};function mt(s,e,t,r,n,o){const a=i("Notifications"),m=i("Menu"),f=i("Header"),u=i("router-view");return c(),g("div",null,[h(a),o.showMenu?(c(),d(m,{key:0})):w("",!0),o.showHeader?(c(),d(f,{key:1})):w("",!0),h(u)])}const me=p(pt,[["render",mt]]);export{me as default};
