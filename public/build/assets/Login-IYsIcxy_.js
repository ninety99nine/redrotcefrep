import{c,b as o,a as m,w as k,d as g,e as y,F as v,f as E,t as u,g as p,h as F,r as l,o as n,i as h}from"./app-CfcRgAtV.js";import{P as V}from"./Pill-26NEKJFK.js";import{L}from"./Logo-D4rVQRSS.js";import{I as T}from"./Input-5etQ1obE.js";import{B}from"./Button-C-mSVtjr.js";import{i as N}from"./stringUtils-Bvzw0-oW.js";import{S as C}from"./SocialLinks-C1jVlwBf.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Popover-CErryWiK.js";import"./Tooltip-DXGv3bv0.js";import"./Copy-DthcHkWW.js";import"./ShineEffect-DuM8M3bS.js";import"./createLucideIcon-6Wi-O4Lc.js";import"./Skeleton-dcrsQT38.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-BfzP-qh6.js";import"./circle-check-DJt4jgY5.js";import"./circle-alert-DtAPlORr.js";import"./x-0E_1Yt9j.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-DC71jh3F.js";const j={name:"Login",components:{Pill:V,Logo:L,Input:T,Button:B,SocialLinks:C},inject:["authState","formState","notificationState"],data(){return{form:{email:"",password:"",type:"email",mobile_number:""},loginTypes:[{label:"Email",value:"email"},{label:"Mobile Number",value:"mobile_number"}],loading:!1,currentYear:new Date().getFullYear(),appName:"Perfect Order"}},methods:{isEmpty:N,async submit(){var d,e;if(!this.loading&&(this.formState.hideFormErrors(),this.form.type=="email"&&this.isEmpty(this.form.email)?this.formState.setFormError("email","Enter your email"):this.form.type=="mobile_number"&&this.isEmpty(this.form.mobile_number)?this.formState.setFormError("mobile_number","Enter your mobile number"):this.isEmpty(this.form.password)&&this.formState.setFormError("password","Enter your password"),!this.formState.hasErrors)){this.loading=!0;try{const a=(await F.post("/api/auth/login",this.form)).data.token;this.authState.setTokenOnRequest(a),this.authState.setTokenOnLocalStorage(a);const t=this.$route.query.redirect;t?this.$router.push(t):this.$router.push({name:"show-stores"})}catch(s){const a=((e=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while signing in";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(s),console.error("Failed to sign in:",s)}finally{this.loading=!1}}}}},I={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},O={class:"flex items-center justify-center p-6 bg-linear-to-b from-blue-100 to-white-100"},U={class:"w-full max-w-md"},Y={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},q={class:"flex space-x-2"},D={key:2,class:"text-red-500 text-sm mb-3"},M={class:"ml-1"},z={class:"text-sm text-center mb-4"},A={class:"text-sm text-center text-gray-500"};function R(d,e,s,a,t,i){const x=l("Logo"),_=l("Pill"),f=l("Input"),w=l("Button"),b=l("router-link"),S=l("SocialLinks");return n(),c("div",I,[o("div",O,[o("div",U,[m(x,{height:"h-20 mx-auto mb-4"}),o("div",Y,[e[7]||(e[7]=o("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Sign in",-1)),e[8]||(e[8]=o("h1",{class:"text-sm text-gray-500 mb-4"},"Pick how you would like to sign in",-1)),o("form",{onSubmit:e[3]||(e[3]=k((...r)=>i.submit&&i.submit(...r),["prevent"])),class:"space-y-4 mb-4"},[o("div",q,[(n(!0),c(v,null,E(t.loginTypes,r=>(n(),g(_,{type:t.form.type===r.value?"primary":"light",action:()=>t.form.type=r.value,key:r.value},{default:p(()=>[h(u(r.label),1)]),_:2},1032,["type","action"]))),128))]),t.form.type=="email"?(n(),g(f,{key:0,type:"email",modelValue:t.form.email,"onUpdate:modelValue":e[0]||(e[0]=r=>t.form.email=r),placeholder:"john@gmail.com",errorText:i.formState.getFormError("email")},null,8,["modelValue","errorText"])):t.form.type=="mobile_number"?(n(),g(f,{key:1,type:"text",placeholder:"+26772000001",modelValue:t.form.mobile_number,"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.mobile_number=r),errorText:i.formState.getFormError("mobile_number")},null,8,["modelValue","errorText"])):y("",!0),m(f,{type:"password",modelValue:t.form.password,"onUpdate:modelValue":e[2]||(e[2]=r=>t.form.password=r),placeholder:"******",errorText:i.formState.getFormError("password")},null,8,["modelValue","errorText"]),i.formState.generalErrorText?(n(),c("div",D,u(i.formState.generalErrorText),1)):y("",!0),m(w,{size:"md",type:"primary",action:i.submit,buttonClass:"w-full"},{default:p(()=>[o("span",M,u(t.loading?"Signing in...":"Continue"),1)]),_:1},8,["action"]),o("div",z,[m(b,{to:{name:"register"},class:"text-blue-600 hover:underline"},{default:p(()=>[...e[4]||(e[4]=[h("Create account",-1)])]),_:1}),e[6]||(e[6]=o("span",{class:"text-gray-300 mx-4"},"|",-1)),m(b,{to:{name:"forgot-password"},class:"text-blue-600 hover:underline"},{default:p(()=>[...e[5]||(e[5]=[h("Forgot password?",-1)])]),_:1})])],32),m(S)]),o("p",A,"Â© "+u(t.currentYear)+" "+u(t.appName)+". All rights reserved.",1)])]),e[9]||(e[9]=o("div",{class:"hidden lg:block"},[o("img",{src:"/images/lady-holding-boxes.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const de=P(j,[["render",R]]);export{de as default};
