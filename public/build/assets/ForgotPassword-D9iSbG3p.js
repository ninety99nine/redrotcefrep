import{c as n,b as e,a as m,F as c,i as s,w as k,f as S,e as v,t as u,g as d,h as E,r as p,o as a,d as F}from"./app-BFRszLDY.js";import{P as L}from"./Pill-Tc8R0SoQ.js";import{L as N}from"./Logo-DYfLnSeb.js";import{I as P}from"./Input-D2CpQCT5.js";import{A as B}from"./Alert-CAFHaSk0.js";import{B as V}from"./Button-DCQzWhi0.js";import{i as A}from"./stringUtils-Bvzw0-oW.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Popover-7t3v7uU0.js";import"./Tooltip-BCcWuuCA.js";import"./Copy-BnPm0WTY.js";import"./ShineEffect-jVKnL5S-.js";import"./createLucideIcon-CSc6mW6X.js";import"./Skeleton-Cb_5uZP7.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-DHHZfB71.js";import"./circle-check--aSqogot.js";import"./circle-alert-C2w03bbG.js";import"./x-t57Ey7ol.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./info-BmAppJiG.js";import"./Loader-CVwI2N_w.js";const j={name:"ForgotPassword",components:{Pill:L,Logo:N,Input:P,Alert:B,Button:V},inject:["formState","notificationState"],data(){return{form:{email:""},type:"email",loginTypes:[{label:"Email",value:"email"},{label:"Mobile Number",value:"mobile_number"}],loading:!1,currentYear:new Date().getFullYear(),appName:"Perfect Order"}},methods:{isEmpty:A,goToLogin(){this.$router.push({name:"login"})},async submit(){var f,t;if(!this.loading&&(this.formState.hideFormErrors(),this.isEmpty(this.form.email)&&this.formState.setFormError("email","Email is required"),!this.formState.hasErrors)){this.loading=!0;try{await E.post("/api/auth/forgot-password",this.form),this.notificationState.showSuccessNotification("A password reset link has been sent to your email."),this.$router.push({name:"login"})}catch(r){const g=((t=(f=r==null?void 0:r.response)==null?void 0:f.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while requesting a password reset link";this.notificationState.showWarningNotification(g),this.formState.setServerFormErrors(r),console.error("Failed to request password reset link:",r)}finally{this.loading=!1}}}},mounted(){this.form.email=this.$route.query.email||""}},C={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},q={class:"flex items-center justify-center p-6 bg-linear-to-b from-blue-100 to-white-100"},I={class:"w-full max-w-md"},D={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},Y={class:"text-sm text-gray-500 mb-4"},z={class:"flex space-x-2"},M={key:0,class:"text-red-500 text-sm mb-3"},O={class:"ml-1"},R={class:"flex justify-center mt-4"},U={class:"text-sm text-center text-gray-500"};function W(f,t,r,g,o,l){const y=p("Logo"),w=p("Pill"),_=p("Input"),b=p("Button"),x=p("router-link"),h=p("Alert");return a(),n("div",C,[e("div",q,[e("div",I,[m(y,{height:"h-20 mx-auto mb-4"}),e("div",D,[t[6]||(t[6]=e("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Forgot Password",-1)),e("h1",Y,[o.type=="email"?(a(),n(c,{key:0},[s("Enter your email address to receive a password reset link.")],64)):(a(),n(c,{key:1},[s("Follow instructions to reset your password")],64))]),e("form",{onSubmit:t[1]||(t[1]=k((...i)=>l.submit&&l.submit(...i),["prevent"])),class:"space-y-4"},[e("div",z,[(a(!0),n(c,null,S(o.loginTypes,i=>(a(),F(w,{type:o.type===i.value?"primary":"light",action:()=>o.type=i.value,key:i.value},{default:d(()=>[s(u(i.label),1)]),_:2},1032,["type","action"]))),128))]),o.type=="email"?(a(),n(c,{key:0},[m(_,{type:"email",label:"Email",modelValue:o.form.email,"onUpdate:modelValue":t[0]||(t[0]=i=>o.form.email=i),errorText:l.formState.getFormError("email")},null,8,["modelValue","errorText"]),l.formState.generalErrorText?(a(),n("div",M,u(l.formState.generalErrorText),1)):v("",!0),m(b,{size:"md",type:"primary",action:l.submit,disabled:o.loading,buttonClass:"w-full"},{default:d(()=>[e("span",O,u(o.loading?"Sending...":"Send Reset Link"),1)]),_:1},8,["action","disabled"]),e("div",R,[m(x,{to:{name:"login"},class:"text-sm text-blue-600 hover:underline"},{default:d(()=>[...t[2]||(t[2]=[s("Back to Login",-1)])]),_:1})])],64)):(a(),n(c,{key:1},[m(h,{dismissable:!1},{description:d(()=>[...t[3]||(t[3]=[e("p",{class:"font-semibold mb-4"},"Supported Networks",-1),e("img",{src:"/images/mobile-network-icons/orange.png",class:"w-10 rounded-sm"},null,-1)])]),_:1}),m(h,{dismissable:!1},{description:d(()=>[...t[4]||(t[4]=[e("p",{class:"mb-4"},[s("Dial "),e("span",{class:"font-bold"},"*250#"),s(" on your mobile phone. Select "),e("span",{class:"font-bold"},"Profile"),s(", then select "),e("span",{class:"font-bold"},"Set Password"),s(" and enter your new password.")],-1),e("p",null,[s("Now click the login button below and login using your "),e("span",{class:"font-bold"},"mobile number"),s(" and "),e("span",{class:"font-bold"},"new password")],-1)])]),_:1}),m(b,{size:"md",type:"primary",action:l.goToLogin,disabled:o.loading,buttonClass:"w-full"},{default:d(()=>[...t[5]||(t[5]=[e("span",{class:"ml-1"},"Login",-1)])]),_:1},8,["action","disabled"])],64))],32)]),e("p",U,"Â© "+u(o.currentYear)+" "+u(o.appName)+". All rights reserved.",1)])]),t[7]||(t[7]=e("div",{class:"hidden lg:block"},[e("img",{src:"/images/lady-with-laptop.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const fe=T(j,[["render",W]]);export{fe as default};
