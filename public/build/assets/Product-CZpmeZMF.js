import{i as j}from"./index-DP0-bHZg.js";import{P as Q}from"./Pill-BNjRcmXt.js";import{A as ae}from"./Alert-CQid1sw2.js";import{I as K}from"./Input-B2ak7xuW.js";import{M as X}from"./Modal-COpD3FzR.js";import{H as A,s as le,c as g,b as s,a as d,e as i,w as E,g as V,k as U,d as u,u as G,r as v,o as a,F as M,f as N,t as k,i as D}from"./app-qohHnai2.js";import{B as Y}from"./Button-CPqWnTAQ.js";import{L as se}from"./Loader-BkdSj3Qz.js";import{S as ie}from"./Switch-DC-AVpIl.js";import{S as Z}from"./Select-C8qxM4tY.js";import{P as de}from"./Popover-BLOHpHVX.js";import{i as ne}from"./stringUtils-Bvzw0-oW.js";import{S as ue}from"./Skeleton-TldU7eME.js";import{S as ce}from"./SelectTags-DSUvUu4V.js";import{V as J}from"./vue-draggable-next.esm-bundler-BEyD8LHn.js";import{B as me}from"./BackdropLoader-Cjr5pj-F.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as pe,H as ge,T as he,a as fe,L as ye}from"./tally-2-UiWCnCHY.js";import{C as ve}from"./cloud-upload-DXX6SWrv.js";import{C as be}from"./calendar-BBEw5pOK.js";import{M as _e}from"./map-pin-BkUMvTU4.js";import{C as Se}from"./clock-ELFxRK-k.js";import{M as ee}from"./move-CHoShjWz.js";import{P as te}from"./plus-Dn-tsknJ.js";import{c as re}from"./createLucideIcon-DFF6csNE.js";import{I as Fe}from"./image-CZedVLAN.js";import{C as we,a as Ve}from"./chevron-up-C4ADKmmn.js";import{M as xe}from"./move-left-RxSrJ1xh.js";import{T as ke}from"./trash-2-C_1A6Ztu.js";import{X as Te}from"./x-D2eEjOWs.js";import"./Tooltip-DNCrFSbg.js";import"./circle-check-CkMv-4m2.js";import"./info-DK73QrUb.js";import"./Copy-BivnTeSq.js";import"./ShineEffect-bdFyZnCD.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-gHkE3gSp.js";import"./circle-alert-y8k_vQsc.js";import"./parsePhoneNumber-xMTQFMCS.js";/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=re("arrow-down-up",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=re("split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]),Ue={inject:["formState","storeState","productState"],components:{Move:ee,List:ye,Clock:Se,Tally1:fe,Tally2:he,MapPin:_e,Hash:ge,Calendar:be,CloudUpload:ve,SquareCheck:pe,Pill:Q,Input:K,Modal:X,Button:Y,Select:Z,draggable:J},data(){return{Plus:te,originalFields:[],deletableDataCollectionField:null,typeOptions:[{label:"Short answer",value:"short answer"},{label:"Long answer",value:"long answer"},{label:"Number",value:"number"},{label:"Date",value:"date"},{label:"Time",value:"time"},{label:"Checkbox",value:"checkbox"},{label:"Selection",value:"selection"},{label:"Location",value:"location"},{label:"Media",value:"media"}],validationOptions:[{label:"Not applicable",value:"not applicable"},{label:"Select at least",value:"select at least"},{label:"Select at most",value:"select at most"},{label:"Select between",value:"select between"}]}},computed:{store(){return this.storeState.store},productForm(){return this.productState.productForm},hasFields(){return this.productForm.data_collection_fields.length>0},hasOriginalFields(){return this.originalFields.length>0},hasCollapsedAll(){return this.productForm.data_collection_fields.every(l=>l.is_editable===!1)},hasExpandedAll(){return this.productForm.data_collection_fields.every(l=>l.is_editable===!0)},fieldsHaveChanged(){var l=A(this.productForm.data_collection_fields),t=A(this.originalFields);return l.forEach(n=>delete n.is_editable),t.forEach(n=>delete n.is_editable),!j(l,t)}},methods:{onAddField(){this.productForm.data_collection_fields.push({validation:"not applicable",temporary_id:le(),type:"short answer",is_editable:!0,required:!1,description:"",options:[],title:"",min:"1",max:"2"}),this.productState.saveStateDebounced("Option added")},onRemoveField(l){const t=this.productForm.data_collection_fields.findIndex(n=>n.temporary_id==this.deletableDataCollectionField.temporary_id);this.productForm.data_collection_fields.splice(t,1),l(),this.productState.saveStateDebounced("Option removed")},onResetFields(){this.productForm.data_collection_fields=A(this.originalFields),this.productState.saveStateDebounced("Options restored")},onAddOption(l){this.productForm.data_collection_fields[l].options.push({title:`Option ${this.productForm.data_collection_fields[l].options.length+1}`,fee:"0.00"}),this.productState.saveStateDebounced("Sub option added")},onRemoveOption(l,t){this.productForm.data_collection_fields[l].options.splice(t,1),this.productState.saveStateDebounced("Sub option removed")},collapseAll(){this.productForm.data_collection_fields.forEach(l=>{l.is_editable=!1})},expandAll(){this.productForm.data_collection_fields.forEach(l=>{l.is_editable=!0})},showDeleteConfirmationModal(l){this.deletableDataCollectionField=l,this.$refs.confirmDeleteModal.showModal()},supportsOptions(l){return l.type=="checkbox"||l.type=="selection"},hasOptions(l){return this.productForm.data_collection_fields[l].options.length>0}}},Pe={key:0,class:"flex justify-end items-center space-x-2 px-2"},Ee=["onClick"],Me={class:"absolute top-2 right-2 flex items-center space-x-2 opacity-20 group-hover:opacity-100"},Le=["onClick"],Ae=["onClick"],Ie={key:0,"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"},qe={key:1,"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"},ze=["onClick"],Oe={key:0,class:"space-y-4"},Be={class:"flex items-center space-x-2"},He={class:"flex items-start justify-between space-x-8"},je={class:"w-full space-y-4"},Ne={class:"w-full flex items-center space-x-4"},Re={class:"flex items-center space-x-4"},We=["onClick"],Qe={key:0,class:"flex items-end space-x-2"},Ke={class:"relative"},Xe={class:"absolute -bottom-12 left-1/2 transform -translate-x-1/2"},Ge={key:0,class:"animate-bounce text-4xl"},Ye=["onClick"],Ze={class:"flex items-center space-x-2 text-sm text-gray-500"},Je={key:9},$e={key:10,class:"font-medium text-red-500 text-xs ml-1"},et={key:0,class:"text-sm text-gray-700"},tt={class:"flex justify-end space-x-2"},rt={key:0,class:"flex items-start space-x-2 border border-gray-300 rounded-lg p-2 mb-4"},ot={class:"text-sm"},at={class:"mb-8"};function lt(l,t,n,c,o,e){const b=v("Move"),F=v("Clock"),_=v("List"),w=v("Hash"),f=v("Calendar"),x=v("MapPin"),T=v("CloudUpload"),I=v("SquareCheck"),P=v("Tally2"),q=v("Tally1"),O=v("Select"),C=v("Input"),B=v("draggable"),z=v("Button"),L=v("Pill"),H=v("Modal");return a(),g("div",null,[s("div",{class:U(["space-y-4",{"mt-4":e.productForm.data_collection_fields.length<2}])},[e.productForm.data_collection_fields.length>=2?(a(),g("div",Pe,[e.hasCollapsedAll?i("",!0):(a(),g("span",{key:0,class:"text-sm text-gray-500 underline hover:text-black cursor-pointer",onClick:t[0]||(t[0]=(...h)=>e.collapseAll&&e.collapseAll(...h))}," collapse all ")),e.hasExpandedAll?i("",!0):(a(),g("span",{key:1,class:"text-sm text-gray-500 underline hover:text-black cursor-pointer",onClick:t[1]||(t[1]=E((...h)=>e.expandAll&&e.expandAll(...h),["stop"]))}," expand all "))])):i("",!0),d(B,{class:"space-y-2",handle:".draggable-handle","ghost-class":"bg-yellow-50",modelValue:e.productForm.data_collection_fields,"onUpdate:modelValue":t[13]||(t[13]=h=>e.productForm.data_collection_fields=h)},{default:V(()=>[(a(!0),g(M,null,N(e.productForm.data_collection_fields,(h,m)=>(a(),g("div",{key:h.temporary_id,onClick:y=>e.productForm.data_collection_fields[m].is_editable?null:e.productForm.data_collection_fields[m].is_editable=!0,class:U(["w-full relative bg-gray-50 p-4 border border-gray-300 rounded-lg hover:bg-gray-100 group",{"cursor-pointer":!e.productForm.data_collection_fields[m].is_editable}])},[s("div",Me,[e.productForm.data_collection_fields[m].is_editable?(a(),g("span",{key:0,class:"text-sm text-gray-500 underline hover:text-black cursor-pointer",onClick:E(y=>e.productForm.data_collection_fields[m].is_editable=!1,["stop"])}," collapse ",8,Le)):(a(),g("svg",{key:1,class:"w-4 h-4 cursor-pointer hover:opacity-50",onClick:E(y=>e.productForm.data_collection_fields[m].is_editable=!0,["stop"]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e.productForm.data_collection_fields[m].is_editable?(a(),g("path",Ie)):(a(),g("path",qe))],8,Ae)),(a(),g("svg",{onClick:E(y=>e.showDeleteConfirmationModal(h),["stop"]),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[...t[14]||(t[14]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)])],8,ze)),d(b,{onClick:t[2]||(t[2]=E(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})]),e.productForm.data_collection_fields[m].is_editable?(a(),g("div",Oe,[s("div",Be,[h.type=="time"?(a(),u(F,{key:0,size:"20"})):i("",!0),h.type=="selection"?(a(),u(_,{key:1,size:"20"})):i("",!0),h.type=="number"?(a(),u(w,{key:2,size:"20"})):i("",!0),h.type=="date"?(a(),u(f,{key:3,size:"20"})):i("",!0),h.type=="location"?(a(),u(x,{key:4,size:"20"})):i("",!0),h.type=="media"?(a(),u(T,{key:5,size:"20"})):i("",!0),h.type=="checkbox"?(a(),u(I,{key:6,size:"20"})):i("",!0),h.type=="long answer"?(a(),u(P,{key:7,size:"20",class:"rotate-90"})):i("",!0),h.type=="short answer"?(a(),u(q,{key:8,size:"20",class:"rotate-90"})):i("",!0),d(O,{class:"w-60",search:!1,options:o.typeOptions,modelValue:e.productForm.data_collection_fields[m].type,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].type=y,onChange:t[3]||(t[3]=y=>e.productState.saveStateDebounced("Option type changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"type")},null,8,["options","modelValue","onUpdate:modelValue","errorText"])]),s("div",He,[s("div",je,[d(C,{class:"w-full",placeholder:"Title",modelValue:e.productForm.data_collection_fields[m].title,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].title=y,onInput:t[4]||(t[4]=y=>e.productState.saveStateDebounced("Option title changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"title")},null,8,["modelValue","onUpdate:modelValue","errorText"]),d(C,{rows:"2",class:"w-full",type:"textarea",placeholder:"Short description (optional)",modelValue:e.productForm.data_collection_fields[m].description,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].description=y,onInput:t[5]||(t[5]=y=>e.productState.saveStateDebounced("Option description changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"description")},null,8,["modelValue","onUpdate:modelValue","errorText"])]),d(C,{type:"checkbox",inputLabel:"Required",modelValue:e.productForm.data_collection_fields[m].required,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].required=y,onChange:t[6]||(t[6]=y=>e.productState.saveStateDebounced("Required status changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"required")},null,8,["modelValue","onUpdate:modelValue","errorText"])]),e.supportsOptions(h)?(a(),u(B,{key:0,class:"space-y-0",handle:".draggable-handle-2","ghost-class":"bg-yellow-50",modelValue:e.productForm.data_collection_fields[m].options,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].options=y},{default:V(()=>[(a(!0),g(M,null,N(e.productForm.data_collection_fields[m].options,(y,r)=>(a(),g("div",{key:r,class:"flex items-center justify-between space-x-4 rounded-lg py-2 px-2 hover:border-blue-200 hover:bg-gray-50 group"},[s("div",Ne,[d(C,{class:"w-full",placeholder:`Option ${r+1}`,onInput:t[7]||(t[7]=p=>e.productState.saveStateDebounced("Sub option name changed")),modelValue:e.productForm.data_collection_fields[m].options[r].name,"onUpdate:modelValue":p=>e.productForm.data_collection_fields[m].options[r].name=p,errorText:e.formState.getFormError("data_collection_fields"+m+"options"+r+"name")},null,8,["placeholder","modelValue","onUpdate:modelValue","errorText"]),d(C,{type:"money",currency:e.store.currency,modelValue:e.productForm.data_collection_fields[m].options[r].fee,"onUpdate:modelValue":p=>e.productForm.data_collection_fields[m].options[r].fee=p,onInput:t[8]||(t[8]=p=>e.productState.saveStateDebounced("Sub option amount changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"options"+r+"fee")},null,8,["currency","modelValue","onUpdate:modelValue","errorText"])]),s("div",Re,[(a(),g("svg",{onClick:p=>e.onRemoveOption(m,r),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[...t[15]||(t[15]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)])],8,We)),d(b,{onClick:t[9]||(t[9]=E(()=>{},["stop"])),size:"16",class:"draggable-handle-2 cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})])]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):i("",!0),e.supportsOptions(h)?(a(),g("div",{key:1,class:U(["flex",h.type=="checkbox"?"justify-between items-start":"justify-end"])},[h.type=="checkbox"?(a(),g("div",Qe,[d(O,{class:"w-60",search:!1,label:"Validation",options:o.validationOptions,modelValue:e.productForm.data_collection_fields[m].validation,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].validation=y,onChange:t[10]||(t[10]=y=>e.productState.saveStateDebounced("Validation changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"validation")},null,8,["options","modelValue","onUpdate:modelValue","errorText"]),e.productForm.data_collection_fields[m].validation=="select at least"||e.productForm.data_collection_fields[m].validation=="select between"?(a(),u(C,{key:0,min:"0",class:"w-24",type:"number",modelValue:e.productForm.data_collection_fields[m].min,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].min=y,onChange:t[11]||(t[11]=y=>e.productState.saveStateDebounced("Validation changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"min"),label:e.productForm.data_collection_fields[m].validation=="select at least"?null:"Min"},null,8,["modelValue","onUpdate:modelValue","errorText","label"])):i("",!0),e.productForm.data_collection_fields[m].validation=="select at most"||e.productForm.data_collection_fields[m].validation=="select between"?(a(),u(C,{key:1,min:"0",class:"w-24",type:"number",modelValue:e.productForm.data_collection_fields[m].max,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[m].max=y,onChange:t[12]||(t[12]=y=>e.productState.saveStateDebounced("Validation changed")),errorText:e.formState.getFormError("data_collection_fields"+m+"max"),label:e.productForm.data_collection_fields[m].validation=="select at most"?null:"Max"},null,8,["modelValue","onUpdate:modelValue","errorText","label"])):i("",!0)])):i("",!0),s("div",Ke,[s("div",Xe,[e.hasOptions(m)?i("",!0):(a(),g("div",Ge,"👆"))]),d(z,{size:"xs",type:"primary",leftIcon:o.Plus,action:()=>e.onAddOption(m)},{default:V(()=>[...t[16]||(t[16]=[s("span",null,"Add Choice",-1)])]),_:1},8,["leftIcon","action"])])],2)):i("",!0)])):(a(),g("div",{key:1,class:"space-y-2",onClick:y=>e.productForm.data_collection_fields[m].is_editable=!0},[s("div",Ze,[h.type=="time"?(a(),u(F,{key:0,size:"20"})):i("",!0),h.type=="selection"?(a(),u(_,{key:1,size:"20"})):i("",!0),h.type=="number"?(a(),u(w,{key:2,size:"20"})):i("",!0),h.type=="date"?(a(),u(f,{key:3,size:"20"})):i("",!0),h.type=="location"?(a(),u(x,{key:4,size:"20"})):i("",!0),h.type=="media"?(a(),u(T,{key:5,size:"20"})):i("",!0),h.type=="checkbox"?(a(),u(I,{key:6,size:"20"})):i("",!0),h.type=="long answer"?(a(),u(P,{key:7,size:"20",class:"rotate-90"})):i("",!0),h.type=="short answer"?(a(),u(q,{key:8,size:"20",class:"rotate-90"})):i("",!0),h.title?(a(),g("span",Je,k(h.title),1)):(a(),g("span",$e," No title ")),h.required?(a(),u(L,{key:11,type:"primary",size:"xs",showDot:!1},{default:V(()=>[...t[17]||(t[17]=[D("required",-1)])]),_:1})):i("",!0)])],8,Ye))],10,Ee))),128))]),_:1},8,["modelValue"]),s("div",{class:U([{"flex space-x-2 justify-between":!e.hasFields}])},[e.hasFields?i("",!0):(a(),g("p",et,"Add questions if your product must capture additional information from the customer")),s("div",tt,[e.fieldsHaveChanged&&e.hasOriginalFields?(a(),u(z,{key:0,size:"xs",type:"primary",action:e.onResetFields},{default:V(()=>[...t[18]||(t[18]=[s("span",null,"Undo",-1)])]),_:1},8,["action"])):i("",!0),d(z,{size:"xs",type:"light",leftIcon:o.Plus,action:e.onAddField},{default:V(()=>[...t[19]||(t[19]=[s("span",null,"Add Question",-1)])]),_:1},8,["leftIcon","action"])])],2)],2),d(H,{approveType:"danger",approveText:"Delete",ref:"confirmDeleteModal",approveAction:h=>e.onRemoveField(h)},G({_:2},[o.deletableDataCollectionField?{name:"content",fn:V(()=>[t[22]||(t[22]=s("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),o.deletableDataCollectionField.title?(a(),g("div",rt,[o.deletableDataCollectionField.type=="time"?(a(),u(F,{key:0,size:"20"})):i("",!0),o.deletableDataCollectionField.type=="selection"?(a(),u(_,{key:1,size:"20"})):i("",!0),o.deletableDataCollectionField.type=="number"?(a(),u(w,{key:2,size:"20"})):i("",!0),o.deletableDataCollectionField.type=="date"?(a(),u(f,{key:3,size:"20"})):i("",!0),o.deletableDataCollectionField.type=="location"?(a(),u(x,{key:4,size:"20"})):i("",!0),o.deletableDataCollectionField.type=="media"?(a(),u(T,{key:5,size:"20"})):i("",!0),o.deletableDataCollectionField.type=="checkbox"?(a(),u(I,{key:6,size:"20"})):i("",!0),o.deletableDataCollectionField.type=="long answer"?(a(),u(P,{key:7,size:"20",class:"rotate-90"})):i("",!0),o.deletableDataCollectionField.type=="short answer"?(a(),u(q,{key:8,size:"20",class:"rotate-90"})):i("",!0),s("span",ot,k(o.deletableDataCollectionField.title),1)])):i("",!0),s("p",at,[t[20]||(t[20]=D("Are you sure you want to delete this ",-1)),d(L,{type:"primary",size:"xs",showDot:!1},{default:V(()=>[D(k(o.deletableDataCollectionField.type),1)]),_:1}),t[21]||(t[21]=D(" field?",-1))])]),key:"0"}:void 0]),1032,["approveAction"])])}const st=$(Ue,[["render",lt]]),it={inject:["formState","storeState","productState","changeHistoryState","notificationState"],components:{Move:ee,Image:Fe,Split:Ce,Pill:Q,Alert:ae,Input:K,Modal:X,Button:Y,Loader:se,Switch:ie,Select:Z,Popover:de,Skeleton:ue,SelectTags:ce,draggable:J,BackdropLoader:me,DataCollectionFields:st},data(){return{X:Te,Plus:te,Trash2:ke,MoveLeft:xe,tags:[],ChevronUp:Ve,ArrowDownUp:De,ChevronDown:we,categories:[],deliveryMethods:[],selectedVariants:[],deletableVariant:null,isDeletingVariantIds:[],variantsForArrangement:[],isLoadingDeliveryMethods:!1,hasLoadedInitialDeliveryMethods:!1,pricePerUnitTypes:[{label:"G",value:"g"},{label:"KG",value:"kg"},{label:"L",value:"l"},{label:"ML",value:"ml"},{label:"PSC",value:"psc"},{label:"PAX",value:"pax"},{label:"PERSON",value:"person"},{label:"ROOM",value:"room"},{label:"PACK",value:"pack"},{label:"QTY",value:"qty"},{label:"LBS",value:"lbs"},{label:"HOUR",value:"hour"},{label:"BOX",value:"box"}],productTypes:[{label:"Physical",value:"physical"},{label:"Digital",value:"digital"},{label:"Booking",value:"booking"},{label:"Subscription",value:"subscription"},{label:"Other",value:"other"}],visibilityTypes:[{label:"Visible",value:!0},{label:"Hidden",value:!1}],stockQuantityTypes:[{label:"Unlimited",value:"unlimited"},{label:"Limited",value:"limited"}],allowedQuantityPerOrder:[{label:"Unlimited",value:"unlimited"},{label:"Limited",value:"limited"}]}},watch:{store(l,t){!t&&l&&this.setup()},productId(l){l&&(this.setup(),this.setActionButtons())}},computed:{store(){return this.storeState.store},product(){return this.productState.product},hasProduct(){return this.productState.hasProduct},productId(){return this.$route.params.product_id},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingProduct(){return this.productState.isLoadingProduct},isEditing(){return this.$route.name==="edit-product"},isCreating(){return this.$route.name==="create-product"},productForm(){return this.productState.productForm},isSubmitting(){return this.changeHistoryState.actionButtons.length==0?!1:this.changeHistoryState.actionButtons[1].loading},hasVariants(){return this.productState.hasVariants},isDeletingProduct(){return this.productState.isDeletingProduct},isCreatingVariants(){return this.productState.isCreatingVariants},isChangingVariantArrangement(){return this.productState.isChangingVariantArrangement},variantOptions(){return this.productForm.variants.filter(l=>l.name).map(l=>({label:l.name,value:l.temporary_id}))},deliveryMethodOptions(){return this.deliveryMethods.map(l=>({label:l.name,value:l.id}))}},methods:{isEmpty:ne,goBack(){this.navigateToProducts()},async setup(){this.productForm==null&&this.productState.setProductForm(null,this.isCreating),this.isEditing&&this.store&&await this.showProduct(),this.store&&(this.tags=this.store.product_tags.map(l=>({label:l.name,value:l.id})),this.categories=this.store.categories.map(l=>({label:l.name,value:l.id})),!this.hasLoadedInitialDeliveryMethods&&!this.isLoadingDeliveryMethods&&this.showDeliveryMethods())},async navigateToProducts(){await this.$router.replace({name:"show-products",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},async onView(l){await this.$router.push({name:"edit-product",params:{product_id:l.id},query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},addVariant(){this.selectedVariants=[],this.productState.addVariant()},async removeVariant(l){this.selectedVariants=[];const t=this.productForm.variants[l];t.id?(this.deletableVariant=t,this.$refs.confirmDeleteVariantModal.showModal()):this.productState.removeVariant(l)},clearSelectedVariants(){this.selectedVariants=[]},isFilteredVariants(l){return this.selectedVariants.length==0||this.selectedVariants.includes(l.temporary_id)},toggleAdditionalVariantOptions(l){this.productForm.variants[l].show_more=!this.productForm.variants[l].show_more},showChangeArrangementModal(){this.setVariantsForArrangement(),this.$refs.changeArrangementModal.showModal()},setVariantsForArrangement(){this.variantsForArrangement=A(this.productForm.variants.map(l=>({name:l.name,temporary_id:l.temporary_id,photo:l.photos.length?l.photos[0]:null}))),this.$refs.changeArrangementModal.showModal()},async changeVariantArrangement(){var l,t;try{if(this.productState.isChangingVariantArrangement)return;const n=new Map(this.productForm.variants.map(e=>[e.temporary_id,e]));this.productForm.variants=this.variantsForArrangement.map(e=>n.get(e.temporary_id)).filter(e=>e!==void 0);const c=this.productForm.variants.filter(e=>e.id).map(e=>e.id);if(c.length==0)return;this.productState.isChangingVariantArrangement=!0;const o={store_id:this.store.id,product_ids:c,parent_product_id:this.product.id};await axios.post("/api/products/arrangement",o),this.notificationState.showSuccessNotification("Variant arrangement updated")}catch(n){const c=((t=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:t.message)||(n==null?void 0:n.message)||"Something went wrong while updating variant arrangement";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(n),console.error("Failed to update variant arrangement:",n)}finally{this.productState.isChangingVariantArrangement=!1,this.$refs.changeArrangementModal.hideModal()}},async showProduct(){var l,t,n;try{this.productState.isLoadingProduct=!0;let c={params:{store_id:this.store.id,_relationships:["photos","tags","categories","variants.photos","deliveryMethods"].join(",")}};const e=(await axios.get(`/api/products/${this.productId}`,c)).data;this.productState.setProduct(e),this.productState.setProductForm(e)}catch(c){const o=((t=(l=c==null?void 0:c.response)==null?void 0:l.data)==null?void 0:t.message)||(c==null?void 0:c.message)||"Something went wrong while fetching product";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(c),console.error("Failed to fetch product:",c),((n=c.response)==null?void 0:n.status)===404&&await this.$router.replace({name:"show-products",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}finally{this.productState.isLoadingProduct=!1}},async createProduct(l=null,t=null){var n,c;try{if(l==null){if(this.productState.isCreatingProduct||this.productState.isUploading)return;this.formState.hideFormErrors(),this.isEmpty(this.productForm.name)&&this.formState.setFormError("name","The name is required");for(let F=0;F<this.productForm.variants.length;F++){const _=this.productForm.variants[F];this.isEmpty(_.name)&&this.formState.setFormError(`variants.${F}.name`,"The name is required")}if(this.formState.hasErrors)return;this.productState.isCreatingProduct=!0,this.changeHistoryState.actionButtons[1].loading=!0}let o;l?o={store_id:this.store.id,parent_product_id:l.id,...this.productForm.variants[t]}:o={...this.productForm,store_id:this.store.id};const b=(await axios.post("/api/products",o)).data.product;if(l)this.productForm.variants[t].id=b.id,this.productForm.variants[t].photos.length&&await this.uploadImages(this.productForm.variants[t].id,null,t);else{this.productForm.id=b.id,this.productForm.photos.length&&await this.uploadImages(this.productForm.id);for(let F=0;F<this.productForm.variants.length;F++)await this.createProduct(b,F);(this.productForm.tags.length||this.productForm.categories.length)&&this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Product created"),this.productState.saveOriginalState("Original product"),await this.onView(b)}}catch(o){const e=((c=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:c.message)||(o==null?void 0:o.message)||"Something went wrong while creating product";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(o),console.error("Failed to create product:",o)}finally{l==null&&(this.productState.isUploading=!1,this.productState.isCreatingProduct=!1,this.changeHistoryState.actionButtons[1].loading=!1)}},async updateProduct(l=null,t=null){var n,c;try{if(l==null){if(this.productState.isUpdatingProduct||this.productState.isUploading)return;this.formState.hideFormErrors(),this.isEmpty(this.productForm.name)&&this.formState.setFormError("name","The name is required");for(let _=0;_<this.productForm.variants.length;_++){const w=this.productForm.variants[_];this.isEmpty(w.name)&&this.formState.setFormError(`variants.${_}.name`,"The name is required")}if(this.formState.hasErrors)return;this.productState.isUpdatingProduct=!0,this.changeHistoryState.actionButtons[1].loading=!0}let o,e;l?(o=this.productForm.variants[t].id,e={store_id:this.store.id,...this.productForm.variants[t]}):(o=this.productForm.id,e={...this.productForm,store_id:this.store.id});const F=(await axios.put(`/api/products/${o}`,e)).data.product;if(l)this.productForm.variants[t].photos.length&&await this.uploadImages(this.productForm.variants[t].id,null,t);else{this.productForm.photos.length&&await this.uploadImages(this.productForm.id);const _=this.changeHistoryState.getOriginalState();if(this.productForm.variants.length)for(let w=0;w<this.productForm.variants.length;w++){const f=A(this.productForm.variants[w]),x=A(_.variants.find(T=>T.temporary_id==f.temporary_id));x?(delete f.show_more,delete x.show_more,j(f,x)||await this.updateProduct(F,w)):await this.createProduct(F,w)}(!j(this.productForm.tags,_.tags)||!j(this.productForm.categories,_.categories))&&this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Product updated"),this.productState.saveOriginalState("Original product")}}catch(o){const e=((c=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:c.message)||(o==null?void 0:o.message)||"Something went wrong while updating product";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(o),console.error("Failed to update product:",o)}finally{this.productState.isUploading=!1,this.productState.isUpdatingProduct=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async deleteProduct(l){var t,n;try{if(this.productState.isDeletingProduct)return;this.productState.isDeletingProduct=!0;const c={data:{store_id:this.store.id}};await axios.delete(`/api/products/${this.product.id}`,c),l(),await new Promise(o=>setTimeout(o,500)),this.notificationState.showSuccessNotification("Product deleted"),await this.navigateToProducts()}catch(c){const o=((n=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:n.message)||(c==null?void 0:c.message)||"Something went wrong while deleting product";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(c),console.error("Failed to delete product:",c),l()}finally{this.productState.isDeletingProduct=!1}},async deleteVariant(l){var n,c;const t=this.deletableVariant;try{if(this.isDeletingVariantIds.includes(t.id))return;this.isDeletingVariantIds.push(t.id);const o={data:{store_id:this.store.id}};await axios.delete(`/api/products/${t.id}`,o),this.notificationState.showSuccessNotification("Variant deleted");const e=this.productForm.variants.findIndex(b=>b.id==t.id);this.productState.removeVariant(e)}catch(o){const e=((c=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:c.message)||(o==null?void 0:o.message)||"Something went wrong while deleting variant";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(o),console.error("Failed to delete variant:",o)}finally{l(),this.isDeletingVariantIds=this.isDeletingVariantIds.filter(o=>o!=t.id)}},async uploadImages(l,t=null,n=null){let c=n!==null?this.productForm.variants[n].photos:this.productForm.photos,o=[];for(let e=0;e<c.length;e++){let b=c[e];b.id==null&&b.uploading==!1&&(b.uploaded===null||b.uploaded===!1)&&(t==null||t==e)&&o.push(this.uploadSingleImage(l,c[e],e))}if(o.length===0){this.productState.isUploading=!1;return}return this.productState.isUploading=!0,Promise.allSettled(o).then(e=>{let b=e.filter(F=>F.status==="rejected").length;b>0&&this.notificationState.showWarningNotification(`⚠️ ${b} image(s) failed to upload. Try again or change the image.`),this.productState.isUploading=!1})},async uploadSingleImage(l,t,n,c=0,o=null){var e,b,F;try{if(c>2)return console.log(`❌ Image ${n+1} permanently failed after 3 attempts.`),t.uploaded=!1,t.uploading=!1,t.error_message=((b=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:b.message)||(o==null?void 0:o.message)||"Upload failed",Promise.reject("Failed after 3 attempts");let _=new FormData;_.append("file",t.file_ref),_.append("mediable_id",l),_.append("store_id",this.store.id),_.append("mediable_type","product"),_.append("upload_folder_name","product_photo"),t.uploading=!0,t.error_message=null;const w={headers:{"Content-Type":"multipart/form-data"}},f=await axios.post("/api/media-files",_,w),x=f.data.media_file;return t.uploaded=!0,t.uploading=!1,t.id=x.id,t.path=x.path,console.log(`✅ Image ${n+1} uploaded successfully.`),f}catch(_){return console.error(`⚠️ Image ${n+1} upload attempt ${c+1} failed.`,_),_.code==="ECONNABORTED"||((F=_.response)==null?void 0:F.status)===504?void 0:this.uploadSingleImage(l,t,n,c+1,_)}},async showDeliveryMethods(){var l,t;try{this.isLoadingDeliveryMethods=!0;let n={params:{per_page:100,store_id:this.store.id}};const c=await axios.get("/api/delivery-methods",n);this.deliveryMethods=c.data.data}catch(n){const c=((t=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:t.message)||(n==null?void 0:n.message)||"Something went wrong while fetching delivery methods";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(n),console.error("Failed to fetch delivery methods:",n)}finally{this.isLoadingDeliveryMethods=!1,this.hasLoadedInitialDeliveryMethods=!0}},setActionButtons(){(this.isCreating||this.isEditing)&&(this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Create Product",this.isEditing?this.updateProduct:this.createProduct,"primary",null))},setProductForm(l){this.productState.productForm=l}},beforeRouteLeave(l,t,n){if(this.changeHistoryState.hasChangeHistory&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return n(!1);n()},unmounted(){this.productState.reset()},created(){this.setup(),this.setActionButtons();const l=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let t=0;t<l.length;t++){let n=l[t];this.changeHistoryState.listeners[n]=this.setProductForm}}},dt={class:"pt-24 px-4"},nt={class:"grid grid-cols-12 gap-4 mb-4"},ut={class:"col-span-8"},ct={class:"select-none bg-white rounded-lg p-4 mb-4"},mt={class:"flex items-center space-x-4"},pt={key:0,class:"flex items-center space-x-2"},gt={key:1,class:"flex items-center space-x-1"},ht={class:"text-lg text-gray-700 font-semibold"},ft={class:"relative mb-4"},yt={class:"bg-white rounded-lg space-y-4 p-4"},vt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},bt={class:"text-sm text-gray-400"},_t={key:3,class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},St={class:"relative mb-4"},Ft={class:"bg-white rounded-lg space-y-4 p-4"},wt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Vt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},xt={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},kt={key:0,class:"flex items-end space-x-4 mb-2"},Tt={key:0,class:"relative mb-4"},Dt={class:"bg-white border border-gray-200 rounded-lg p-4"},Ct={class:"flex items-center space-x-4 justify-end"},Ut={class:"flex items-center space-x-1 text-gray-400"},Pt={class:"text-sm"},Et={class:"space-y-4 mb-4"},Mt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Lt={class:"flex items-center space-x-4"},At={key:0,class:"flex items-center justify-center w-16 h-16"},It=["src"],qt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},zt={class:"col-span-2"},Ot={class:"text-sm text-gray-400"},Bt={class:"flex justify-center"},Ht={key:0,class:"text-sm text-gray-700"},jt={class:"flex justify-end space-x-2"},Nt={class:"relative mb-4"},Rt={class:"bg-white rounded-lg p-4"},Wt={class:"col-span-4"},Qt={class:"relative mb-4"},Kt={class:"bg-white rounded-lg space-y-4 p-4"},Xt={class:"relative mb-4"},Gt={class:"bg-white rounded-lg space-y-4 p-4"},Yt={class:"relative mb-4"},Zt={class:"bg-white rounded-lg space-y-4 p-4"},Jt={class:"relative mb-4"},$t={class:"bg-white rounded-lg space-y-4 p-4"},er={class:"relative mb-4"},tr={class:"bg-white rounded-lg space-y-4 p-4"},rr={class:"overflow-y-auto rounded-lg h-60"},or=["src"],ar={class:"w-full flex items-center justify-between"},lr={class:"text-sm"},sr={class:"mb-4"},ir={class:"font-bold text-black"},dr={key:0,class:"flex justify-center space-x-2 mb-8"},nr=["src"],ur={class:"font-bold text-black"},cr={class:"flex justify-end"},mr={class:"mb-8"},pr={class:"font-bold text-black"};function gr(l,t,n,c,o,e){var H,h,m,y;const b=v("Button"),F=v("Skeleton"),_=v("Popover"),w=v("BackdropLoader"),f=v("Input"),x=v("Select"),T=v("Switch"),I=v("Alert"),P=v("SelectTags"),q=v("Split"),O=v("DataCollectionFields"),C=v("Image"),B=v("Move"),z=v("draggable"),L=v("Modal");return a(),g("div",dt,[s("div",nt,[s("div",ut,[s("div",ct,[s("div",mt,[d(b,{size:"xs",type:"light",action:e.goBack,leftIcon:o.MoveLeft},{default:V(()=>[...t[75]||(t[75]=[s("span",null,"Back",-1)])]),_:1},8,["action","leftIcon"]),e.isLoadingStore||e.isLoadingProduct||e.isEditing&&!e.hasProduct?(a(),g("div",pt,[d(F,{width:"w-40"}),d(F,{width:"w-4"})])):(a(),g("div",gt,[s("h1",ht,k(e.isCreating?"Add Product":e.productForm.name||"..."),1),d(_,{content:"Products are physical or non physical items that customers can place orders and pay for using your preferred payment methods",placement:"top"})]))])]),s("div",ft,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",yt,[d(f,{type:"text",label:"Name",modelValue:e.productForm.name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.productForm.name=r),placeholder:"Standard Ticket",errorText:e.formState.getFormError("name"),onInput:t[1]||(t[1]=r=>e.productState.saveStateDebounced("Name changed")),tooltipContent:"The name of your product e.g Standard Ticket"},null,8,["modelValue","errorText"]),s("div",vt,[d(x,{class:"w-full",search:!1,label:"Visibility",options:o.visibilityTypes,modelValue:e.productForm.visible,"onUpdate:modelValue":t[2]||(t[2]=r=>e.productForm.visible=r),errorText:e.formState.getFormError("visible"),onChange:t[3]||(t[3]=r=>e.productState.saveStateDebounced("Visibility status changed")),tooltipContent:"Turn on if you want your product to be visible (Made available to customers)"},null,8,["options","modelValue","errorText"]),d(x,{label:"Type",class:"w-full",search:!1,options:o.productTypes,modelValue:e.productForm.type,"onUpdate:modelValue":t[4]||(t[4]=r=>e.productForm.type=r),errorText:e.formState.getFormError("type"),onChange:t[5]||(t[5]=r=>e.productState.saveStateDebounced("Type changed"))},null,8,["options","modelValue","errorText"])]),e.productForm.type=="digital"?(a(),u(f,{key:0,type:"text",label:"Download Link",externalLinkName:"Learn more",modelValue:e.productForm.download_link,"onUpdate:modelValue":t[6]||(t[6]=r=>e.productForm.download_link=r),placeholder:"https://example.com/download",externalLinkUrl:"https://example.com/download",errorText:e.formState.getFormError("download_link"),tooltipContent:"This is the link to download this resource",onInput:t[7]||(t[7]=r=>e.productState.saveStateDebounced("Download link changed")),description:"Confirm your order to show download link on invoice"},null,8,["modelValue","errorText"])):i("",!0),d(f,{type:"checkbox",inputLabel:"Show Description",modelValue:e.productForm.show_description,"onUpdate:modelValue":t[8]||(t[8]=r=>e.productForm.show_description=r),onChange:t[9]||(t[9]=r=>e.productState.saveStateDebounced("Show description status changed"))},null,8,["modelValue"]),e.productForm.show_description?(a(),u(f,{key:1,rows:"2",type:"textarea",label:"Description",modelValue:e.productForm.description,"onUpdate:modelValue":t[10]||(t[10]=r=>e.productForm.description=r),placeholder:"1 day show with popular artists",errorText:e.formState.getFormError("description"),onInput:t[11]||(t[11]=r=>e.productState.saveStateDebounced("Description changed")),tooltipContent:"Sweet and short description of your product e.g 1 day show with popular artists"},null,8,["modelValue","errorText"])):i("",!0),e.hasVariants?i("",!0):(a(),u(f,{key:2,type:"text",label:"Weight",modelValue:e.productForm.unit_weight,"onUpdate:modelValue":t[12]||(t[12]=r=>e.productForm.unit_weight=r),errorText:e.formState.getFormError("unit_weight"),onInput:t[13]||(t[13]=r=>e.productState.saveStateDebounced("Weight changed")),tooltipContent:"The weight of the product. Useful for delivery calculations"},{suffix:V(()=>{var r;return[s("span",bt,k((r=e.store)==null?void 0:r.weight_unit),1)]}),_:1},8,["modelValue","errorText"])),e.hasVariants?i("",!0):(a(),g("div",_t,[d(f,{type:"text",label:"SKU",placeholder:"std-ticket",modelValue:e.productForm.sku,"onUpdate:modelValue":t[14]||(t[14]=r=>e.productForm.sku=r),errorText:e.formState.getFormError("sku"),onInput:t[15]||(t[15]=r=>e.productState.saveStateDebounced("SKU changed")),tooltipContent:"The stock keeping unit for this product. Useful for stock management"},null,8,["modelValue","errorText"]),d(f,{type:"text",label:"Barcode",placeholder:"123456789",modelValue:e.productForm.barcode,"onUpdate:modelValue":t[16]||(t[16]=r=>e.productForm.barcode=r),errorText:e.formState.getFormError("barcode"),onInput:t[17]||(t[17]=r=>e.productState.saveStateDebounced("Barcode changed")),tooltipContent:"The barcode for this product. Useful for stock management"},null,8,["modelValue","errorText"])]))])]),s("div",St,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",Ft,[t[77]||(t[77]=s("p",{class:"text-lg text-gray-700 font-semibold"},"Pricing",-1)),s("div",wt,[d(T,{size:"xs",suffixText:"Is Free",modelValue:e.productForm.is_free,"onUpdate:modelValue":t[18]||(t[18]=r=>e.productForm.is_free=r),errorText:e.formState.getFormError("is_free"),onChange:t[19]||(t[19]=r=>e.productState.saveStateDebounced("Free status changed")),tooltipContent:"Turn on if you want your product to be made Free for customers"},null,8,["modelValue","errorText"]),e.productForm.is_free?i("",!0):(a(),u(T,{key:0,size:"xs",suffixText:"Display as estimated price",modelValue:e.productForm.is_estimated_price,"onUpdate:modelValue":t[20]||(t[20]=r=>e.productForm.is_estimated_price=r),errorText:e.formState.getFormError("is_estimated_price"),onChange:t[21]||(t[21]=r=>e.productState.saveStateDebounced("Estimated price status changed")),tooltipContent:"The checkout page will display the price as an estimated price. Customers will confirm with you before payment"},null,8,["modelValue","errorText"]))]),e.productForm.is_free?(a(),u(I,{key:0,type:"success"},{description:V(()=>[...t[76]||(t[76]=[D(" This product is ",-1),s("span",{class:"font-bold"},"Free",-1)])]),_:1})):(a(),g(M,{key:1},[s("div",Vt,[d(f,{type:"money",label:"Regular Price",currency:(H=e.store)==null?void 0:H.currency,modelValue:e.productForm.unit_regular_price,"onUpdate:modelValue":t[22]||(t[22]=r=>e.productForm.unit_regular_price=r),errorText:e.formState.getFormError("unit_regular_price"),onInput:t[23]||(t[23]=r=>e.productState.saveStateDebounced("Regular price changed")),tooltipContent:"Set the regular price for this product (How much the product is sold when its not on sale)"},null,8,["currency","modelValue","errorText"]),d(f,{type:"money",label:"Sale Price",currency:(h=e.store)==null?void 0:h.currency,modelValue:e.productForm.unit_sale_price,"onUpdate:modelValue":t[24]||(t[24]=r=>e.productForm.unit_sale_price=r),errorText:e.formState.getFormError("unit_sale_price"),onInput:t[25]||(t[25]=r=>e.productState.saveStateDebounced("Sale price changed")),tooltipContent:"Set the sale price for this product (if the product is on sale)"},null,8,["currency","modelValue","errorText"])]),d(f,{type:"money",label:"Cost Price",currency:(m=e.store)==null?void 0:m.currency,description:"Invisible to customers",modelValue:e.productForm.unit_cost_price,"onUpdate:modelValue":t[26]||(t[26]=r=>e.productForm.unit_cost_price=r),errorText:e.formState.getFormError("unit_cost_price"),onInput:t[27]||(t[27]=r=>e.productState.saveStateDebounced("Cost price changed")),tooltipContent:"Set the cost price for this product (if the product is on sale)"},null,8,["currency","modelValue","errorText"]),d(f,{type:"checkbox",inputLabel:"Price per unit",modelValue:e.productForm.show_price_per_unit,"onUpdate:modelValue":t[28]||(t[28]=r=>e.productForm.show_price_per_unit=r),onChange:t[29]||(t[29]=r=>e.productState.saveStateDebounced("Price per unit status changed"))},null,8,["modelValue"]),e.productForm.show_price_per_unit?(a(),g("div",xt,[d(f,{type:"number",label:"Unit Value",modelValue:e.productForm.unit_value,"onUpdate:modelValue":t[30]||(t[30]=r=>e.productForm.unit_value=r),errorText:e.formState.getFormError("unit_value"),onInput:t[31]||(t[31]=r=>e.productState.saveStateDebounced("Unit value changed"))},null,8,["modelValue","errorText"]),d(x,{class:"w-full",search:!1,label:"Unit Type",options:o.pricePerUnitTypes,modelValue:e.productForm.unit_type,"onUpdate:modelValue":t[32]||(t[32]=r=>e.productForm.unit_type=r),errorText:e.formState.getFormError("unit_type"),onChange:t[33]||(t[33]=r=>e.productState.saveStateDebounced("Unit type changed"))},null,8,["options","modelValue","errorText"])])):i("",!0),d(f,{type:"checkbox",inputLabel:"Tax Overide",modelValue:e.productForm.tax_overide,"onUpdate:modelValue":t[34]||(t[34]=r=>e.productForm.tax_overide=r),onChange:t[35]||(t[35]=r=>e.productState.saveStateDebounced("Tax overide status changed"))},null,8,["modelValue"]),e.productForm.tax_overide?(a(),u(f,{key:1,type:"money",currency:(y=e.store)==null?void 0:y.currency,modelValue:e.productForm.tax_overide_amount,"onUpdate:modelValue":t[36]||(t[36]=r=>e.productForm.tax_overide_amount=r),errorText:e.formState.getFormError("tax_overide_amount"),onInput:t[37]||(t[37]=r=>e.productState.saveStateDebounced("Tax overide amount changed"))},null,8,["currency","modelValue","errorText"])):i("",!0)],64))])]),s("div",{class:U([{"bg-white rounded-lg p-4 space-y-4":!e.hasVariants},"mb-4"])},[s("p",{class:U(["text-lg text-gray-700 font-semibold",e.productForm.variants.length>=2?"mb-0":"mb-4",{"pl-4":e.hasVariants}])},"Variants",2),e.productForm.variants.length>=2&&e.variantOptions.length?(a(),g("div",kt,[d(P,{class:"w-full",allowCustom:!1,options:e.variantOptions,modelValue:o.selectedVariants,"onUpdate:modelValue":t[38]||(t[38]=r=>o.selectedVariants=r),placeholder:"Add variant filter"},null,8,["options","modelValue"]),d(b,{size:"xs",type:"light",leftIcon:o.X,action:e.clearSelectedVariants},{default:V(()=>[...t[78]||(t[78]=[s("span",null,"Clear Filter",-1)])]),_:1},8,["leftIcon","action"])])):i("",!0),(a(!0),g(M,null,N(e.productForm.variants,(r,p)=>{var R,W;return a(),g(M,{key:r.temporary_id},[e.isFilteredVariants(r)?(a(),g("div",Tt,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",Dt,[s("div",Ct,[s("div",Ut,[d(q,{size:"16"}),s("span",Pt,"variant "+k(`${p+1}`),1)]),d(b,{size:"xs",type:"bareDanger",leftIcon:o.Trash2,action:()=>e.removeVariant(p)},null,8,["leftIcon","action"])]),s("div",Et,[s("div",Mt,[s("div",Lt,[e.productForm.variants[p].photos.length?(a(),g("div",At,[s("img",{class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:e.productForm.variants[p].photos[0].path},null,8,It)])):i("",!0),d(f,{type:"text",label:"Name",class:"w-full",placeholder:"Standard Ticket",modelValue:e.productForm.variants[p].name,"onUpdate:modelValue":S=>e.productForm.variants[p].name=S,onInput:t[39]||(t[39]=S=>e.productState.saveStateDebounced("Name changed")),tooltipContent:"The name of your product e.g Standard Ticket",errorText:e.formState.getFormError(`variants.${p}.name`)},null,8,["modelValue","onUpdate:modelValue","errorText"])]),d(x,{class:"w-full",search:!1,label:"Visibility",options:o.visibilityTypes,modelValue:e.productForm.variants[p].visible,"onUpdate:modelValue":S=>e.productForm.variants[p].visible=S,errorText:e.formState.getFormError(`variants.${p}.visible`),onChange:t[40]||(t[40]=S=>e.productState.saveStateDebounced("Visibility status changed")),tooltipContent:"Turn on if you want your product to be visible (Made available to customers)"},null,8,["options","modelValue","onUpdate:modelValue","errorText"])]),s("div",qt,[d(f,{type:"money",label:"Regular Price",currency:(R=e.store)==null?void 0:R.currency,modelValue:e.productForm.variants[p].unit_regular_price,"onUpdate:modelValue":S=>e.productForm.variants[p].unit_regular_price=S,onInput:t[41]||(t[41]=S=>e.productState.saveStateDebounced("Regular price changed")),errorText:e.formState.getFormError(`variants.${p}.unit_regular_price`),tooltipContent:"Set the regular price for this product (How much the product is sold when its not on sale)"},null,8,["currency","modelValue","onUpdate:modelValue","errorText"]),d(f,{type:"money",label:"Sale Price",currency:(W=e.store)==null?void 0:W.currency,modelValue:e.productForm.variants[p].unit_sale_price,"onUpdate:modelValue":S=>e.productForm.variants[p].unit_sale_price=S,onInput:t[42]||(t[42]=S=>e.productState.saveStateDebounced("Sale price changed")),errorText:e.formState.getFormError(`variants.${p}.unit_sale_price`),tooltipContent:"Set the sale price for this product (if the product is on sale)"},null,8,["currency","modelValue","onUpdate:modelValue","errorText"]),e.productForm.variants[p].show_more?(a(),g(M,{key:0},[s("div",zt,[d(f,{type:"text",label:"Weight",class:"w-full",modelValue:e.productForm.variants[p].unit_weight,"onUpdate:modelValue":S=>e.productForm.variants[p].unit_weight=S,onInput:t[43]||(t[43]=S=>e.productState.saveStateDebounced("Weight changed")),errorText:e.formState.getFormError(`variants.${p}.unit_weight`),tooltipContent:"The weight of the product. Useful for delivery calculations"},{suffix:V(()=>{var S;return[s("span",Ot,k((S=e.store)==null?void 0:S.weight_unit),1)]}),_:1},8,["modelValue","onUpdate:modelValue","errorText"])]),d(f,{type:"text",label:"SKU",placeholder:"std-ticket",modelValue:e.productForm.variants[p].sku,"onUpdate:modelValue":S=>e.productForm.variants[p].sku=S,onInput:t[44]||(t[44]=S=>e.productState.saveStateDebounced("SKU changed")),errorText:e.formState.getFormError(`variants.${p}.sku`),tooltipContent:"The stock keeping unit for this product. Useful for stock management"},null,8,["modelValue","onUpdate:modelValue","errorText"]),d(f,{type:"text",label:"Barcode",placeholder:"123456789",modelValue:e.productForm.variants[p].barcode,"onUpdate:modelValue":S=>e.productForm.variants[p].barcode=S,onInput:t[45]||(t[45]=S=>e.productState.saveStateDebounced("Barcode changed")),errorText:e.formState.getFormError(`variants.${p}.barcode`),tooltipContent:"The barcode for this product. Useful for stock management"},null,8,["modelValue","onUpdate:modelValue","errorText"])],64)):i("",!0)]),e.productForm.variants[p].show_more?(a(),u(f,{key:0,type:"file",maxFiles:1,imagePreviewGridCols:1,singleFileUploadMessage:"Photo attached",modelValue:e.productForm.variants[p].photos,"onUpdate:modelValue":S=>e.productForm.variants[p].photos=S,onChange:t[46]||(t[46]=S=>e.productState.saveStateDebounced("Photos changed")),onRetryUploads:S=>e.uploadImages(e.productForm.variants[p].id,null,p),onRetryUpload:(S,oe)=>e.uploadImages(e.productForm.variants[p].id,oe,p)},null,8,["modelValue","onUpdate:modelValue","onRetryUploads","onRetryUpload"])):i("",!0)]),s("div",Bt,[d(b,{size:"sm",type:"bare",action:()=>e.toggleAdditionalVariantOptions(p),rightIcon:e.productForm.variants[p].show_more?o.ChevronUp:o.ChevronDown},{default:V(()=>[s("span",null,k(e.productForm.variants[p].show_more?"show less":"show more"),1)]),_:2},1032,["action","rightIcon"])])])])):i("",!0)],64)}),128)),s("div",{class:U([{"flex space-x-2 justify-between":!e.hasVariants}])},[e.hasVariants?i("",!0):(a(),g("p",Ht,"Add variants if your product supports different versions of itself e.g different sizes, materials, colors, etc")),s("div",jt,[e.productForm.variants.length>=2?(a(),u(b,{key:0,size:"xs",type:"light",leftIcon:o.ArrowDownUp,action:e.showChangeArrangementModal},{default:V(()=>[...t[79]||(t[79]=[s("span",null,"Change Arrangement",-1)])]),_:1},8,["leftIcon","action"])):i("",!0),d(b,{size:"xs",type:"light",leftIcon:o.Plus,action:e.addVariant},{default:V(()=>[...t[80]||(t[80]=[s("span",null,"Add Variants",-1)])]),_:1},8,["leftIcon","action"])])],2)],2),s("div",Nt,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",Rt,[t[81]||(t[81]=s("p",{class:"text-lg text-gray-700 font-semibold"},"Options",-1)),d(O)])])]),s("div",Wt,[s("div",Qt,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",Kt,[t[82]||(t[82]=s("p",{class:"text-lg text-gray-700 font-semibold"},"Images",-1)),d(f,{type:"file",maxFiles:5,modelValue:e.productForm.photos,"onUpdate:modelValue":t[47]||(t[47]=r=>e.productForm.photos=r),onRetryUploads:t[48]||(t[48]=r=>e.uploadImages(e.productForm.id)),onChange:t[49]||(t[49]=r=>e.productState.saveStateDebounced("Photos changed")),onRetryUpload:t[50]||(t[50]=(r,p)=>e.uploadImages(e.productForm.id,p))},null,8,["modelValue"])])]),s("div",Xt,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",Gt,[t[83]||(t[83]=s("p",{class:"text-lg text-gray-700 font-semibold"},"Inventory",-1)),d(x,{label:"Stock",class:"w-full",search:!1,options:o.stockQuantityTypes,modelValue:e.productForm.stock_quantity_type,"onUpdate:modelValue":t[51]||(t[51]=r=>e.productForm.stock_quantity_type=r),errorText:e.formState.getFormError("stock_quantity_type"),onChange:t[52]||(t[52]=r=>e.productState.saveStateDebounced("Stock quantity type changed")),tooltipContent:"Select the available stock e.g Unlimited means that stock is always available while limited means that stock is limited to the quatities specified"},null,8,["options","modelValue","errorText"]),e.productForm.stock_quantity_type=="limited"?(a(),u(f,{key:0,min:"1",type:"number",placeholder:"100",label:"Stock Quantity",modelValue:e.productForm.stock_quantity,"onUpdate:modelValue":t[53]||(t[53]=r=>e.productForm.stock_quantity=r),errorText:e.formState.getFormError("stock_quantity"),onInput:t[54]||(t[54]=r=>e.productState.saveStateDebounced("Stock quantity changed")),tooltipContent:"Set the stock quantity e.g 100 means that you only have 100 items for this product"},null,8,["modelValue","errorText"])):i("",!0),d(T,{size:"xs",suffixText:"Daily Capacity",modelValue:e.productForm.set_daily_capacity,"onUpdate:modelValue":t[55]||(t[55]=r=>e.productForm.set_daily_capacity=r),errorText:e.formState.getFormError("set_daily_capacity"),tooltipContent:"The maximum number number of items you can sell per day",onChange:t[56]||(t[56]=r=>e.productState.saveStateDebounced("Daily capacity status changed"))},null,8,["modelValue","errorText"]),e.productForm.set_daily_capacity?(a(),u(f,{key:1,min:"1",type:"number",placeholder:"10",modelValue:e.productForm.daily_capacity,"onUpdate:modelValue":t[57]||(t[57]=r=>e.productForm.daily_capacity=r),errorText:e.formState.getFormError("daily_capacity"),onInput:t[58]||(t[58]=r=>e.productState.saveStateDebounced("Daily capacity changed"))},null,8,["modelValue","errorText"])):i("",!0),d(T,{size:"xs",suffixText:"Minimum Order Quantity",modelValue:e.productForm.set_min_order_quantity,"onUpdate:modelValue":t[59]||(t[59]=r=>e.productForm.set_min_order_quantity=r),errorText:e.formState.getFormError("set_min_order_quantity"),onChange:t[60]||(t[60]=r=>e.productState.saveStateDebounced("Minimum order quantity status changed")),tooltipContent:"Set the minimum order quantity for this product (Used to manage supply and demand)"},null,8,["modelValue","errorText"]),e.productForm.set_min_order_quantity?(a(),u(f,{key:2,min:"1",type:"number",placeholder:"10",modelValue:e.productForm.min_order_quantity,"onUpdate:modelValue":t[61]||(t[61]=r=>e.productForm.min_order_quantity=r),errorText:e.formState.getFormError("min_order_quantity"),onInput:t[62]||(t[62]=r=>e.productState.saveStateDebounced("Minimum order quantity changed"))},null,8,["modelValue","errorText"])):i("",!0),d(T,{size:"xs",suffixText:"Maximum Order Quantity",modelValue:e.productForm.set_max_order_quantity,"onUpdate:modelValue":t[63]||(t[63]=r=>e.productForm.set_max_order_quantity=r),errorText:e.formState.getFormError("set_max_order_quantity"),onChange:t[64]||(t[64]=r=>e.productState.saveStateDebounced("Maximum order quantity status changed")),tooltipContent:"Set the maximum order quantity for this product (Used to manage supply and demand)"},null,8,["modelValue","errorText"]),e.productForm.set_max_order_quantity?(a(),u(f,{key:3,min:"1",type:"number",placeholder:"10",modelValue:e.productForm.max_order_quantity,"onUpdate:modelValue":t[65]||(t[65]=r=>e.productForm.max_order_quantity=r),errorText:e.formState.getFormError("max_order_quantity"),onInput:t[66]||(t[66]=r=>e.productState.saveStateDebounced("Maximum order quantity changed"))},null,8,["modelValue","errorText"])):i("",!0)])]),s("div",Yt,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",Zt,[t[84]||(t[84]=s("p",{class:"text-lg text-gray-700 font-semibold"},"Categories",-1)),d(P,{options:o.categories,placeholder:"Add category",modelValue:e.productForm.categories,"onUpdate:modelValue":t[67]||(t[67]=r=>e.productForm.categories=r),errorText:e.formState.getFormError("categories"),onChange:t[68]||(t[68]=r=>e.productState.saveStateDebounced("Categories changed"))},null,8,["options","modelValue","errorText"])])]),s("div",Jt,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",$t,[t[85]||(t[85]=s("p",{class:"text-lg text-gray-700 font-semibold"},"Tags",-1)),d(P,{options:o.tags,placeholder:"Add Tag",modelValue:e.productForm.tags,"onUpdate:modelValue":t[69]||(t[69]=r=>e.productForm.tags=r),errorText:e.formState.getFormError("tags"),onChange:t[70]||(t[70]=r=>e.productState.saveStateDebounced("Tags changed"))},null,8,["options","modelValue","errorText"])])]),s("div",er,[e.isLoadingProduct||e.isSubmitting?(a(),u(w,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):i("",!0),s("div",tr,[t[86]||(t[86]=s("p",{class:"text-lg text-gray-700 font-semibold"},"Delivery Methods",-1)),d(P,{options:e.deliveryMethodOptions,placeholder:"Add delivery method",modelValue:e.productForm.delivery_method_ids,"onUpdate:modelValue":t[71]||(t[71]=r=>e.productForm.delivery_method_ids=r),errorText:e.formState.getFormError("delivery_method_ids"),onChange:t[72]||(t[72]=r=>e.productState.saveStateDebounced("Delivery methods changed"))},null,8,["options","modelValue","errorText"])])])])]),d(L,{scrollOnContent:!1,ref:"changeArrangementModal",approveText:"Change Arrangement",approveAction:e.changeVariantArrangement,approveLoading:e.isChangingVariantArrangement},{content:V(()=>[t[87]||(t[87]=s("p",{class:"text-lg font-bold border-b border-gray-200 pb-4 mb-4"},"Change Arrangement",-1)),s("div",rr,[d(z,{class:"space-y-2",handle:".draggable-handle","ghost-class":"bg-yellow-50",modelValue:o.variantsForArrangement,"onUpdate:modelValue":t[74]||(t[74]=r=>o.variantsForArrangement=r)},{default:V(()=>[(a(!0),g(M,null,N(o.variantsForArrangement,(r,p)=>(a(),g("div",{key:p,class:"flex justify-between items-center p-2 space-x-4 rounded-lg bg-gray-50"},[s("div",{class:U(["flex items-center justify-center w-10 h-10 rounded-lg",{"border border-dashed border-gray-200":!r.photo}])},[r.photo?(a(),g("img",{key:0,class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:r.photo.path},null,8,or)):(a(),u(C,{key:1,size:"20",class:"text-gray-400 flex-shrink-0"}))],2),s("div",ar,[s("span",lr,k(r.name??"no name"),1),d(B,{onClick:t[73]||(t[73]=E(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})])]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["approveAction","approveLoading"]),d(L,{approveType:"danger",approveText:"Delete Variant",approveAction:e.deleteVariant,ref:"confirmDeleteVariantModal",approveLoading:o.isDeletingVariantIds.some(r=>r==o.deletableVariant.id)},G({_:2},[o.deletableVariant?{name:"content",fn:V(()=>[t[90]||(t[90]=s("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),s("p",sr,[t[88]||(t[88]=D("Are you sure you want to permanently delete ",-1)),s("span",ir,k(o.deletableVariant.name),1),t[89]||(t[89]=D("?",-1))]),o.deletableVariant.photos.length?(a(),g("div",dr,[s("img",{class:"w-20 max-h-20 object-contain rounded-lg flex-shrink-0",src:o.deletableVariant.photos[0].path},null,8,nr)])):i("",!0)]),key:"0"}:void 0]),1032,["approveAction","approveLoading"]),e.product?(a(),g("div",{key:0,class:U(["overflow-hidden rounded-lg space-y-4 p-4 border",e.isLoadingProduct?"border-gray-300 bg-gray-50":"border-red-300 bg-red-50"])},[s("p",null,[t[91]||(t[91]=D("Do you want to permanently delete ",-1)),s("span",ur,k(e.productForm.name),1),t[92]||(t[92]=D("? Once this product is deleted you will not be able to recover it.",-1))]),s("div",cr,[d(L,{triggerType:"danger",approveType:"danger",approveLeftIcon:o.Trash2,triggerText:"Delete Product",approveText:"Delete Product",approveAction:e.deleteProduct,triggerLoading:e.isDeletingProduct,approveLoading:e.isDeletingProduct},{content:V(()=>[t[95]||(t[95]=s("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),s("p",mr,[t[93]||(t[93]=D("Are you sure you want to permanently delete ",-1)),s("span",pr,k(e.productForm.name),1),t[94]||(t[94]=D("?",-1))])]),_:1},8,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])],2)):i("",!0)])}const eo=$(it,[["render",gr]]);export{eo as default};
