import{P as V}from"./Pill-aGbs_XL2.js";import{I as j}from"./Input-Ch5FVRoG.js";import{L as z}from"./Loader-DjUD9LDC.js";import{B as q}from"./Button-0Fhg4Aii.js";import{S as F}from"./Skeleton-DGkj9lRL.js";import{a as E}from"./stringUtils-Bvzw0-oW.js";import{M as Q}from"./Menu-DyG0-bNr.js";import{M as R}from"./DesignCardManager-DHRqG4iK.js";import{c as s,a as l,b as c,g as v,F as g,d as _,e as h,f as x,t as m,r as p,o as e,w,i as P,k as W}from"./app-811fDb4C.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as D}from"./chevron-right-B8Gu_Jj1.js";import{I as U}from"./image-2C7dvKgM.js";import"./Popover-DfwFh9bM.js";import"./Tooltip-5EEAR2_1.js";import"./Copy-XiSIbjW8.js";import"./ShineEffect-BW3gyXUb.js";import"./createLucideIcon-JVTSwxMK.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-fYK0zSuq.js";import"./circle-check-Ci8AvIUe.js";import"./circle-alert-DdTgr82K.js";import"./x-WVuudoOP.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./house-DJhrT9DT.js";import"./video-BJANt8NR.js";import"./Drawer-BuxdFOUN.js";import"./menu-DBFxDB1c.js";import"./user-CNOykAp6.js";import"./store-CDbe-uI4.js";import"./AddressInput-CNrrxVX9.js";import"./index-ChmBBGBv.js";import"./Modal-X3iEO6Sa.js";import"./GoogleMaps-RFPisK6o.js";import"./SelectCountry-CJD2sKOm.js";import"./Select-B89KxZtb.js";import"./move-left-C1am2jSW.js";import"./trash-2-COAOku7K.js";import"./plus-BU4OPlaU.js";import"./StoreLogo-CCMzoP_5.js";import"./link-Ebq6HyPQ.js";import"./at-sign-Ckexr1RE.js";import"./chevron-up-DcmVslGD.js";import"./Datepicker-DpIs3Os1.js";import"./arrow-right-DWMOGIdg.js";import"./arrow-left-oizamhNw.js";import"./Alert-CoP-lZmZ.js";import"./info-BoI19BZ7.js";import"./Switch-DrPP6l9i.js";import"./DeliveryTimePicker-C8OfieOk.js";import"./circle-check-big-CC1FR4MG.js";const G={inject:["formState","orderState","storeState","notificationState"],components:{Pill:V,Image:U,Input:j,Loader:z,Button:q,Skeleton:F,Menu:Q,ChevronRight:D,MyCartButton:R},data(){return{products:[],category:null,searchTerm:null,lastSearchTerm:null,isLoadingProducts:!1,isLoadingCategory:!1,hasLoadedInitialProducts:!1}},watch:{store(a,r){!r&&a&&this.setup()},categoryId(){this.showCategory(),this.showProducts()},searchTerm(){this.showProducts()}},computed:{store(){return this.storeState.store},shoppingCart(){return this.orderState.shoppingCart},isLoadingStore(){return this.storeState.isLoadingStore},hasSearchTerm(){return this.isNotEmpty(this.searchTerm)},hasProducts(){return this.products.length>0},categoryId(){return this.$route.params.category_id},breadcrumbTrail(){const a=[];let r=this.category;for(;r&&r.parent_category;)a.unshift(r.parent_category),r=r.parent_category;return this.category&&a.push(this.category),a}},methods:{isNotEmpty:E,setup(){this.store&&(this.category||this.showCategory(),this.hasLoadedInitialProducts||this.showProducts())},navigateToShowShopCategory(a){this.$router.push({name:"show-shop-category",params:{alias:this.store.alias,category_id:a.id}})},async onView(a){await this.$router.push({name:"show-shop-product",params:{alias:this.store.alias,product_id:a.id}})},getSelectedQuantity(a){if(this.shoppingCart&&a){const r=this.shoppingCart.order_products.find(o=>o.product_id==a.id);if(r)return r.quantity}return null},async showCategory(){var a,r;try{this.isLoadingCategory=!0;let o={params:{store_id:this.store.id,_relationships:["subCategories","parentCategory.parentCategory.parentCategory"].join(",")}};const d=await axios.get(`/api/categories/${this.categoryId}`,o);this.category=d.data}catch(o){const d=((r=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:r.message)||(o==null?void 0:o.message)||"Something went wrong while fetching category";this.notificationState.showWarningNotification(d),this.formState.setServerFormErrors(o),console.error("Failed to fetch category:",o)}finally{this.isLoadingCategory=!1}},async showProducts(){var a,r;try{this.isLoadingProducts=!0;let o={params:{store_id:this.store.id,association:"team member",category_ids:[this.categoryId],_relationships:"photo,variants"}};this.hasSearchTerm&&(o.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const d=await axios.get("/api/products",o);if(this.searchTerm===this.lastSearchTerm){const i=d.data;this.products=i.data,this.isLoadingProducts=!1,this.hasLoadedInitialProducts=!0}}catch(o){const d=((r=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:r.message)||(o==null?void 0:o.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(d),this.formState.setServerFormErrors(o),console.error("Failed to fetch products:",o)}finally{this.isLoadingProducts=!1}}},created(){this.setup()}},H={class:"max-w-4xl mx-auto pt-8 pb-40"},J={key:0,class:"pt-8 flex items-center justify-center"},K={class:"select-none"},O={key:0,class:"flex items-center space-x-2 mt-4"},X={key:1,class:"flex items-center space-x-2 mt-4"},Y={key:0,class:"text-lg font-semibold"},Z=["onClick"],$={class:"text-gray-900 text-sm"},tt={key:3,class:"text-sm mt-4"},et={key:4,class:"flex flex-wrap space-x-2 mt-4"},st={key:5,class:"flex flex-wrap space-x-2 mt-4"},rt=["onClick"],ot={class:"text-gray-900 text-sm"},at={key:6,class:"flex justify-center items-center space-x-4 mt-4 mb-2"},it={key:7,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},nt={class:"w-full max-h-60 aspect-square relative flex items-center justify-center bg-gray-100 rounded-lg overflow-hidden"},ct={class:"flex items-center space-x-2 flex-wrap gap-2"},lt={key:8,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},ht=["onClick"],mt={key:0,class:"absolute top-1 right-1 z-10 flex items-center justify-center min-w-6 w-fit h-6 p-1 bg-red-500 text-xs font-bold text-white rounded-full"},dt={class:"w-full max-h-60 aspect-square relative flex items-center justify-center bg-gray-100 rounded-lg overflow-hidden"},gt=["alt","src"],pt={class:"text-gray-900 text-sm font-medium truncate"},ut={class:"flex items-center space-x-2 flex-wrap gap-2"},yt={key:0,class:"text-gray-900 text-sm font-semibold"},_t={key:9,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function ft(a,r,o,d,i,n){var b,L,T;const I=p("Menu"),B=p("Loader"),y=p("Skeleton"),k=p("ChevronRight"),M=p("Input"),S=p("Image"),C=p("Pill"),N=p("MyCartButton");return e(),s("div",null,[l(I,{menuClass:"max-w-4xl mx-auto"}),c("div",H,[n.isLoadingStore?(e(),s("div",J,[l(B,null,{default:v(()=>[...r[2]||(r[2]=[c("span",{class:"text-sm ml-2"},"Loading store",-1)])]),_:1})])):(e(),s(g,{key:1},[c("div",K,[i.isLoadingCategory?(e(),s("div",O,[l(y,{width:"w-20",shine:!0,class:"my-2"}),l(k,{size:"16",class:"text-gray-300 text-sm"}),l(y,{width:"w-20",shine:!0,class:"my-2"})])):n.breadcrumbTrail.length?(e(),s("div",X,[(e(!0),s(g,null,x(n.breadcrumbTrail,(t,u)=>{var f;return e(),s(g,{key:t.id},[u==n.breadcrumbTrail.length-1?(e(),s("h1",Y,m((f=i.category)==null?void 0:f.name),1)):(e(),s("div",{key:1,onClick:w(xt=>n.navigateToShowShopCategory(t),["stop"]),class:"cursor-pointer group bg-gray-100 border border-gray-200 hover:bg-gray-200 py-1 px-4 rounded-lg"},[c("span",$,m(t.name),1)],8,Z)),u<n.breadcrumbTrail.length-1?(e(),_(k,{size:"16",key:"separator-"+u,class:"text-gray-500 text-sm"})):h("",!0)],64)}),128))])):h("",!0),i.isLoadingCategory?(e(),_(y,{key:2,width:"w-60",shine:!0,class:"mt-2"})):(b=i.category)!=null&&b.description?(e(),s("p",tt,m(i.category.description),1)):h("",!0),i.isLoadingCategory?(e(),s("div",et,[(e(),s(g,null,x(3,t=>l(y,{key:t,width:"w-20",height:"h-8",rounded:"rounded-md",shine:!0,class:"my-2"})),64))])):(T=(L=i.category)==null?void 0:L.sub_categories)!=null&&T.length?(e(),s("div",st,[(e(!0),s(g,null,x(i.category.sub_categories,t=>(e(),s("div",{key:t.id,onClick:w(u=>n.navigateToShowShopCategory(t),["stop"]),class:"cursor-pointer group bg-gray-100 border border-gray-200 hover:bg-gray-200 py-1 px-4 rounded-lg"},[c("span",ot,m(t.name),1)],8,rt))),128))])):h("",!0),i.hasLoadedInitialProducts?(e(),s("div",at,[l(M,{type:"search",debounced:!0,class:"w-full mb-4",modelValue:i.searchTerm,"onUpdate:modelValue":r[0]||(r[0]=t=>i.searchTerm=t),skeleton:n.isLoadingStore,placeholder:"Search products",onInput:r[1]||(r[1]=t=>i.isLoadingProducts=!0)},null,8,["modelValue","skeleton"])])):h("",!0),i.isLoadingProducts?(e(),s("div",it,[(e(!0),s(g,null,x([...Array(8).keys()].map(t=>t+1),t=>(e(),s("div",{key:t.id,class:"relative flex flex-col space-y-2 p-2 cursor-pointer rounded-lg hover:scale-105 transition-all duration-300"},[c("div",nt,[l(S,{size:"40",class:"text-gray-300"})]),l(y,{width:"w-4/5",shine:!0}),c("div",ct,[l(y,{width:"w-3/5",height:"h-2",shine:!0})])]))),128))])):n.hasProducts?(e(),s("div",lt,[(e(!0),s(g,null,x(i.products,t=>{var u,f;return e(),s("div",{key:t.id,onClick:w(()=>n.onView(t),["stop"]),class:"relative flex flex-col space-y-2 p-2 cursor-pointer rounded-lg hover:scale-105 transition-all duration-300"},[n.getSelectedQuantity(t)?(e(),s("div",mt,[c("span",null,m(n.getSelectedQuantity(t)),1)])):h("",!0),c("div",dt,[(u=(t??t.variant).photo)!=null&&u.path?(e(),s("img",{key:0,alt:(t??t.variant).name,class:"absolute w-full h-full object-cover",src:(f=(t??t.variant).photo)==null?void 0:f.path},null,8,gt)):(e(),_(S,{key:1,size:"40",class:"text-gray-300"}))]),c("h4",pt,m(t.name),1),c("div",ut,[(t.variant??t).is_free?(e(),_(C,{key:0,type:"success",size:"xs"},{default:v(()=>[...r[3]||(r[3]=[P("free",-1)])]),_:1})):(e(),s(g,{key:1},[(t.variant??t).on_sale?(e(),s("span",yt,m((t.variant??t).unit_sale_price.amount_with_currency),1)):h("",!0),c("span",{class:W(["text-sm",{"text-gray-400 line-through":(t.variant??t).on_sale,"text-gray-900 font-semibold":!(t.variant??t).on_sale}])},m((t.variant??t).unit_regular_price.amount_with_currency),3)],64)),(t.variant??t).stock_quantity_type=="limited"&&((t.variant??t).has_stock&&(t.variant??t).stock_quantity<=5||!(t.variant??t).has_stock)?(e(),_(C,{key:2,type:(t.variant??t).has_stock?"success":"warning",size:"xs"},{default:v(()=>[P(m((t.variant??t).has_stock?`${(t.variant??t).stock_quantity} left`:"no stock"),1)]),_:2},1032,["type"])):h("",!0)])],8,ht)}),128))])):(e(),s("p",_t," No products found "))]),n.shoppingCart?(e(),_(N,{key:0})):h("",!0)],64))])])}const ye=A(G,[["render",ft]]);export{ye as default};
