import{I as j}from"./Input-nrLqMDkp.js";import{M as A}from"./Modal-CB5khyw0.js";import{c as g,b as r,a as u,d as T,e as h,g as f,F as x,f as R,r as c,o as n,i as S,t as l,j as N,A as O}from"./app-GlJHzU_x.js";import{B as b}from"./Button-C5PjVjk3.js";import{L}from"./Loader-BQyLZa88.js";import{P as D}from"./Popover-CDw03pE7.js";import{i as H}from"./stringUtils-Bvzw0-oW.js";import{S as U}from"./Skeleton-CCmfEA-R.js";import{B as k}from"./BackdropLoader-BCy7BoLZ.js";import{P as B}from"./Pill-jpvJKogt.js";import{S as I}from"./Search-DHeddCt0.js";import{P as q}from"./Paginator-CB6E6TYL.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as F}from"./trash-2-1C5JYDaS.js";import{M as z}from"./move-left-CB0J3wAv.js";import"./Copy-By71uU1S.js";import"./ShineEffect-B9_RJRQO.js";import"./createLucideIcon-BHEQ_wZh.js";import"./Tooltip-C-cjSIU7.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-Bc4GdQ8O.js";import"./circle-check-D0AZ00dD.js";import"./circle-alert-DHQrfF2Y.js";import"./x-D9LU4_3P.js";import"./parsePhoneNumber-DR0S47Bc.js";const W={inject:["formState","tagState","storeState","notificationState"],components:{Pill:B,Button:b,Loader:L,Search:I,Paginator:q,BackdropLoader:k},data(){return{Trash2:F,page:1,tagProducts:[],pagination:null,productOptions:[],latestRequestId:null,cancelTokenSource:null,isLoadingProducts:!1,isLoadingTagProducts:!1}},watch:{store(s,e){!e&&s&&!this.isLoadingProducts&&this.productOptions.length==0&&this.showProducts()},tag(s){s&&(!this.isLoadingProducts&&this.productOptions.length==0&&this.showProducts(),this.showTagProducts())},isUpdatingTag(s,e){e&&!s&&this.showTagProducts()},productsReady(s){s&&this.$emit("tagProductsReady")}},computed:{tag(){return this.tagState.tag},store(){return this.storeState.store},isUpdatingTag(){return this.tagState.isUpdatingTag},isEditingProductTag(){return this.$route.name=="edit-product-tag"},isCreatingProductTag(){return this.$route.name=="create-product-tag"},tagForm(){return this.tagState.tagForm},totalTagProducts(){return this.tagProducts.length},hasTagProducts(){return this.totalTagProducts>0},productsReady(){return this.isCreatingProductTag?!this.isLoadingProducts:!this.isLoadingProducts&&!this.isLoadingTagProducts},productsToAdd(){return this.tagState.tagForm.products_to_add},productsToRemove(){return this.tagState.tagForm.products_to_remove},preparedProducts(){if(!this.productsReady)return[];const s=new Set(this.productsToAdd.map(t=>String(t.id))),e=new Set(this.productsToRemove.map(t=>String(t.id))),o=this.page==1?[...this.productsToAdd,...this.tagProducts]:this.tagProducts.filter(t=>!s.has(String(t.id))&&!e.has(String(t.id))),i=new Set;return o.filter(t=>e.has(String(t.id))||i.has(String(t.id))?!1:(i.add(String(t.id)),!0))}},methods:{paginate(s){this.showTagProducts(s)},async showProducts(s=null){var o,i;const e=++this.latestRequestId;try{this.isLoadingProducts=!0,this.cancelTokenSource&&this.cancelTokenSource.cancel("Request superseded by a newer one"),this.cancelTokenSource=axios.CancelToken.source();let t={params:{store_id:this.store.id,association:"team member",_relationships:["photo"].join(",")},cancelToken:this.cancelTokenSource.token};s&&(t.params.search=s);const a=await axios.get("/api/products",t);if(e!==this.latestRequestId)return;const p=a.data.data;this.productOptions=p.map(m=>({label:m.name,product:m}))}catch(t){if(axios.isCancel(t)||e!==this.latestRequestId)return;const a=((i=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(t),console.error("Failed to fetch products:",t)}finally{if(e!==this.latestRequestId)return;this.isLoadingProducts=!1,this.cancelTokenSource=null}},async showTagProducts(s=1){var e,o;try{this.page=s,this.isLoadingTagProducts=!0;let i={params:{per_page:15,page:this.page,tag_id:this.tag.id,store_id:this.store.id,_relationships:["photo"].join(",")}};const t=await axios.get("/api/products",i);this.pagination=t.data,this.tagProducts=this.pagination.data}catch(i){const t=((o=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:o.message)||(i==null?void 0:i.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(i),console.error("Failed to fetch products:",i)}finally{this.isLoadingTagProducts=!1}},addProduct(s){this.page>1&&this.showTagProducts(),this.tagState.addProduct(s.product)},removeProduct(s){this.tagState.removeProduct(s)}},created(){this.store&&this.showProducts()}},V={class:"bg-white rounded-lg p-4 shadow-sm"},M={class:"flex items-center space-x-2 mb-4"},Y={class:"w-full flex justify-between items-center"},G={class:"flex space-x-4 items-center"},J={key:0,class:"flex items-center justify-center w-10 h-10"},K=["src"],Q={class:"truncate"},X={class:"relative"},Z={class:"divide-y divide-gray-200"},$={class:"flex space-x-4 items-center"},tt={key:0,class:"flex items-center justify-center w-10 h-10"},et=["src"],st={class:"text-sm truncate"},at={key:0,class:"flex justify-end mt-4"},it={key:1,class:"flex justify-center bg-gray-50 rounded-lg p-4"},ot={key:0,class:"text-sm"},rt={key:1,class:"flex items-center justify-center"};function nt(s,e,o,i,t,a){const _=c("Pill"),p=c("Search"),m=c("BackdropLoader"),y=c("Button"),w=c("Paginator"),v=c("Loader");return n(),g("div",V,[r("div",M,[e[0]||(e[0]=r("p",{class:"text-lg text-gray-700 font-semibold"},"Products",-1)),t.pagination?(n(),T(_,{key:0,type:"light",size:"xs"},{default:f(()=>[S(l(`${t.pagination.meta.total} total`),1)]),_:1})):h("",!0)]),u(p,{class:"mb-4",onSelected:a.addProduct,options:t.productOptions,isLoading:t.isLoadingProducts,placeholder:"Search products to add",search:d=>a.showProducts(d)},{option:f(d=>[r("div",Y,[r("div",G,[d.option.product.photo?(n(),g("div",J,[r("img",{class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:d.option.product.photo.path},null,8,K)])):h("",!0),r("span",Q,l(d.option.label),1)]),u(_,{type:d.option.product.visible?"success":"warning",size:"xs"},{default:f(()=>[S(l(d.option.product.visible?"visible":"hidden"),1)]),_:2},1032,["type"])])]),_:1},8,["onSelected","options","isLoading","search"]),a.preparedProducts.length||a.productsToAdd.length||a.productsToRemove.length?(n(),g(x,{key:0},[r("div",X,[t.isLoadingTagProducts?(n(),T(m,{key:0,showBorder:!1,showSpinningLoader:!0})):h("",!0),r("div",Z,[(n(!0),g(x,null,R(a.preparedProducts,(d,C)=>(n(),g("div",{key:C,class:"flex items-center justify-between hover:bg-gray-100 min-h-16 px-4"},[r("div",$,[d.photo?(n(),g("div",tt,[r("img",{class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:d.photo.path},null,8,et)])):h("",!0),r("span",st,l(d.name),1),u(_,{type:d.visible?"success":"warning",size:"xs"},{default:f(()=>[S(l(d.visible?"visible":"hidden"),1)]),_:2},1032,["type"])]),u(y,{size:"xs",type:"bareDanger",leftIcon:t.Trash2,action:()=>a.removeProduct(d)},null,8,["leftIcon","action"])]))),128))])]),t.pagination?(n(),g("div",at,[u(w,{pagination:t.pagination,onPaginate:a.paginate},null,8,["pagination","onPaginate"])])):h("",!0)],64)):(n(),g("div",it,[a.isCreatingProductTag||a.isEditingProductTag&&t.pagination&&a.preparedProducts.length==0&&a.productsToAdd.length==0?(n(),g("p",ot,"No products added")):(n(),g("div",rt,[u(v,null,{default:f(()=>e[1]||(e[1]=[r("span",{class:"text-sm ml-2"},"Loading products",-1)])),_:1,__:[1]})]))]))])}const dt=E(W,[["render",nt]]),gt={inject:["formState","tagState","storeState","notificationState"],components:{Pill:B,Button:b,Loader:L,Search:I,Paginator:q,BackdropLoader:k},data(){return{Trash2:F,page:1,tagCustomers:[],pagination:null,customerOptions:[],latestRequestId:null,cancelTokenSource:null,isLoadingCustomers:!1,isLoadingTagCustomers:!1}},watch:{store(s,e){!e&&s&&!this.isLoadingCustomers&&this.customerOptions.length==0&&this.showCustomers()},tag(s){s&&(!this.isLoadingCustomers&&this.customerOptions.length==0&&this.showCustomers(),this.showTagCustomers())},isUpdatingTag(s,e){e&&!s&&this.showTagCustomers()},customersReady(s){s&&this.$emit("tagCustomersReady")}},computed:{tag(){return this.tagState.tag},store(){return this.storeState.store},isUpdatingTag(){return this.tagState.isUpdatingTag},isEditingCustomerTag(){return this.$route.name=="edit-customer-tag"},isCreatingCustomerTag(){return this.$route.name=="create-customer-tag"},tagForm(){return this.tagState.tagForm},totalTagCustomers(){return this.tagCustomers.length},hasTagCustomers(){return this.totalTagCustomers>0},customersReady(){return this.isCreatingCustomerTag?!this.isLoadingCustomers:!this.isLoadingCustomers&&!this.isLoadingTagCustomers},customersToAdd(){return this.tagState.tagForm.customers_to_add},customersToRemove(){return this.tagState.tagForm.customers_to_remove},preparedCustomers(){if(!this.customersReady)return[];const s=new Set(this.customersToAdd.map(t=>String(t.id))),e=new Set(this.customersToRemove.map(t=>String(t.id))),o=this.page==1?[...this.customersToAdd,...this.tagCustomers]:this.tagCustomers.filter(t=>!s.has(String(t.id))&&!e.has(String(t.id))),i=new Set;return o.filter(t=>e.has(String(t.id))||i.has(String(t.id))?!1:(i.add(String(t.id)),!0))}},methods:{paginate(s){this.showTagCustomers(s)},async showCustomers(s=null){var o,i;const e=++this.latestRequestId;try{this.isLoadingCustomers=!0,this.cancelTokenSource&&this.cancelTokenSource.cancel("Request superseded by a newer one"),this.cancelTokenSource=axios.CancelToken.source();let t={params:{store_id:this.store.id},cancelToken:this.cancelTokenSource.token};s&&(t.params.search=s);const a=await axios.get("/api/customers",t);if(e!==this.latestRequestId)return;const p=a.data.data;this.customerOptions=p.map(m=>({label:m.name,customer:m}))}catch(t){if(axios.isCancel(t)||e!==this.latestRequestId)return;const a=((i=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"Something went wrong while fetching customers";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(t),console.error("Failed to fetch customers:",t)}finally{if(e!==this.latestRequestId)return;this.isLoadingCustomers=!1,this.cancelTokenSource=null}},async showTagCustomers(s=1){var e,o;try{this.page=s,this.isLoadingTagCustomers=!0;let i={params:{per_page:15,page:this.page,tag_id:this.tag.id,store_id:this.store.id}};const t=await axios.get("/api/customers",i);this.pagination=t.data,this.tagCustomers=this.pagination.data}catch(i){const t=((o=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:o.message)||(i==null?void 0:i.message)||"Something went wrong while fetching customers";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(i),console.error("Failed to fetch customers:",i)}finally{this.isLoadingTagCustomers=!1}},addCustomer(s){this.page>1&&this.showTagCustomers(),this.tagState.addCustomer(s.customer)},removeCustomer(s){this.tagState.removeCustomer(s)}},created(){this.store&&this.showCustomers()}},ct={class:"bg-white rounded-lg p-4 shadow-sm"},ut={class:"flex items-center space-x-2 mb-4"},ht={class:"truncate"},lt={class:"relative"},mt={class:"divide-y divide-gray-200"},pt={class:"text-sm truncate"},ft={class:"flex items-center space-x-2 text-xs"},_t={key:0},Tt={key:1},St={key:0,class:"flex justify-end mt-4"},yt={key:1,class:"flex justify-center bg-gray-50 rounded-lg p-4"},wt={key:0,class:"text-sm"},vt={key:1,class:"flex items-center justify-center"};function Ct(s,e,o,i,t,a){const _=c("Pill"),p=c("Search"),m=c("BackdropLoader"),y=c("Button"),w=c("Paginator"),v=c("Loader");return n(),g("div",ct,[r("div",ut,[e[0]||(e[0]=r("p",{class:"text-lg text-gray-700 font-semibold"},"Customers",-1)),t.pagination?(n(),T(_,{key:0,type:"light",size:"xs"},{default:f(()=>[S(l(`${t.pagination.meta.total} total`),1)]),_:1})):h("",!0)]),u(p,{class:"mb-4",onSelected:a.addCustomer,options:t.customerOptions,isLoading:t.isLoadingCustomers,placeholder:"Search customers to add",search:d=>a.showCustomers(d)},{option:f(d=>[r("span",ht,l(d.option.label),1)]),_:1},8,["onSelected","options","isLoading","search"]),a.preparedCustomers.length||a.customersToAdd.length||a.customersToRemove.length?(n(),g(x,{key:0},[r("div",lt,[t.isLoadingTagCustomers?(n(),T(m,{key:0,showBorder:!1,showSpinningLoader:!0})):h("",!0),r("div",mt,[(n(!0),g(x,null,R(a.preparedCustomers,(d,C)=>(n(),g("div",{key:C,class:"flex items-center justify-between hover:bg-gray-100 min-h-16 px-4"},[r("div",null,[r("p",pt,l(d.name),1),r("div",ft,[d.mobile_number?(n(),g("span",_t,l(d.mobile_number.national),1)):h("",!0),d.email?(n(),g("span",Tt,l(d.email),1)):h("",!0)])]),u(y,{size:"xs",type:"bareDanger",leftIcon:t.Trash2,action:()=>a.removeCustomer(d)},null,8,["leftIcon","action"])]))),128))])]),t.pagination?(n(),g("div",St,[u(w,{pagination:t.pagination,onPaginate:a.paginate},null,8,["pagination","onPaginate"])])):h("",!0)],64)):(n(),g("div",yt,[a.isCreatingCustomerTag||a.isEditingCustomerTag&&t.pagination&&a.totalTagCustomers==0?(n(),g("p",wt,"No customers added")):(n(),g("div",vt,[u(v,null,{default:f(()=>e[1]||(e[1]=[r("span",{class:"text-sm ml-2"},"Loading customers",-1)])),_:1,__:[1]})]))]))])}const Pt=E(gt,[["render",Ct]]),xt={inject:["formState","storeState","tagState","changeHistoryState","notificationState"],components:{Input:j,Modal:A,Button:b,Loader:L,Popover:D,Skeleton:U,BackdropLoader:k,TagProducts:dt,TagCustomers:Pt},data(){return{Trash2:F,MoveLeft:z,products:[],tagProductsReady:!1,tagCustomersReady:!1}},watch:{store(s,e){!e&&s&&this.setup()},tagId(s){s&&(this.setup(),this.setActionButtons())},isReady(s){s&&this.changeHistoryState.data==null&&this.tagState.saveOriginalState("Original tag")}},computed:{store(){return this.storeState.store},tag(){return this.tagState.tag},hasTag(){return this.tagState.hasTag},tagId(){return this.$route.params.tag_id},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingTag(){return this.tagState.isLoadingTag},isEditing(){return this.isEditingProductTag||this.isEditingCustomerTag},isCreating(){return this.isCreatingProductTag||this.isCreatingCustomerTag},isEditingProductTag(){return this.$route.name=="edit-product-tag"},isCreatingProductTag(){return this.$route.name=="create-product-tag"},isEditingCustomerTag(){return this.$route.name=="edit-customer-tag"},isCreatingCustomerTag(){return this.$route.name=="create-customer-tag"},tagForm(){return this.tagState.tagForm},isReady(){return this.isEditingProductTag||this.isCreatingProductTag?this.tagProductsReady:this.tagCustomersReady},isSubmitting(){return this.changeHistoryState.actionButtons.length==0?!1:this.changeHistoryState.actionButtons[1].loading},isDeletingTag(){return this.tagState.isDeletingTag}},methods:{isEmpty:H,goBack(){this.navigateToTags()},async setup(){this.tagForm==null&&this.tagState.setTagForm(null),this.isEditing&&this.store&&await this.showTag()},async navigateToTags(){await this.$router.replace({name:this.isEditingProductTag||this.isCreatingProductTag?"show-product-tags":"show-customer-tags",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},async navigateToEditTag(s){await this.$router.push({name:this.isCreatingProductTag?"edit-product-tag":"edit-customer-tag",params:{tag_id:s.id},query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},async showTag(){var s,e,o;try{this.tagState.isLoadingTag=!0;let i={params:{store_id:this.store.id,_relationships:[this.isEditingProductTag||this.isCreatingProductTag?"products.photo":"customers"].join(",")}};const a=(await axios.get(`/api/tags/${this.tagId}`,i)).data;this.tagState.setTag(a),this.tagState.setTagForm(a)}catch(i){const t=((e=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:e.message)||(i==null?void 0:i.message)||"Something went wrong while fetching tag";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(i),console.error("Failed to fetch tag:",i),((o=i.response)==null?void 0:o.status)===404&&await this.$router.replace({name:"show-tags",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}finally{this.tagState.isLoadingTag=!1}},async createTag(){var s,e;try{if(this.tagState.isCreatingTag||(this.formState.hideFormErrors(),this.isEmpty(this.tagForm.name)&&this.formState.setFormError("name","The name is required"),this.formState.hasErrors))return;this.tagState.isCreatingTag=!0,this.changeHistoryState.actionButtons[1].loading=!0;const o={...this.getPayload(),store_id:this.store.id},t=(await axios.post("/api/tags",o)).data.tag;this.tagForm.id=t.id,this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Tag created"),this.tagState.saveOriginalState("Original tag"),await this.navigateToEditTag(t)}catch(o){const i=((e=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while creating tag";this.notificationState.showWarningNotification(i),this.formState.setServerFormErrors(o),console.error("Failed to create tag:",o)}finally{this.tagState.isCreatingTag=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async updateTag(){var s,e;try{if(this.tagState.isUpdatingTag||(this.formState.hideFormErrors(),this.isEmpty(this.tagForm.name)&&this.formState.setFormError("name","The name is required"),this.formState.hasErrors))return;this.tagState.isUpdatingTag=!0,this.changeHistoryState.actionButtons[1].loading=!0;const o={...this.getPayload(),store_id:this.store.id},t=(await axios.put(`/api/tags/${this.tagForm.id}`,o)).data.tag;this.tagState.setTag(t),this.tagState.setTagForm(t),this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Tag updated"),this.tagState.saveOriginalState("Original tag")}catch(o){const i=((e=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while updating tag";this.notificationState.showWarningNotification(i),this.formState.setServerFormErrors(o),console.error("Failed to update tag:",o)}finally{this.tagState.isUpdatingTag=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async deleteTag(s){var e,o;try{if(this.tagState.isDeletingTag)return;this.tagState.isDeletingTag=!0;const i={data:{store_id:this.store.id}};await axios.delete(`/api/tags/${this.tag.id}`,i),this.storeState.silentUpdate(),s(),await new Promise(t=>setTimeout(t,500)),this.notificationState.showSuccessNotification("Tag deleted"),await this.navigateToTags()}catch(i){const t=((o=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:o.message)||(i==null?void 0:i.message)||"Something went wrong while deleting tag";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(i),console.error("Failed to delete tag:",i),s()}finally{this.tagState.isDeletingTag=!1}},getPayload(){let s=O(this.tagForm);return this.isCreatingProductTag?s.product_ids=s.products_to_add.map(e=>e.id):this.isEditingProductTag?(s.product_ids_to_add=s.products_to_add.map(e=>e.id),s.product_ids_to_remove=s.products_to_remove.map(e=>e.id)):this.isCreatingCustomerTag?s.customer_ids=s.customers_to_add.map(e=>e.id):this.isEditingCustomerTag&&(s.customer_ids_to_add=s.customers_to_add.map(e=>e.id),s.customer_ids_to_remove=s.customers_to_remove.map(e=>e.id)),delete s.products_to_add,delete s.products_to_remove,delete s.customers_to_add,delete s.customers_to_remove,s},setActionButtons(){(this.isCreating||this.isEditing)&&(this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Create Tag",this.isEditing?this.updateTag:this.createTag,"primary",null))},setTagForm(s){this.tagState.tagForm=s}},beforeRouteLeave(s,e,o){if(this.changeHistoryState.hasChangeHistory&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return o(!1);o()},unmounted(){this.tagState.reset()},created(){this.setup(),this.setActionButtons();const s=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let e=0;e<s.length;e++){let o=s[e];this.changeHistoryState.listeners[o]=this.setTagForm}}},bt={class:"pt-24 px-4"},Lt={class:"grid grid-cols-12 gap-4 mb-4"},kt={class:"col-span-8 col-start-3"},Et={class:"select-none bg-white rounded-lg p-4 mb-4"},Ft={class:"flex items-center space-x-4"},Rt={key:0,class:"flex items-center space-x-2"},Bt={key:1,class:"flex items-center space-x-1"},It={class:"text-lg text-gray-700 font-semibold"},qt={class:"relative mb-8"},jt={class:"bg-white rounded-lg space-y-4 p-4"},At={class:"relative mb-8"},Nt={class:"space-y-2"},Ot={class:"font-bold text-black"},Dt={class:"flex justify-end"},Ht={class:"mb-8"},Ut={class:"font-bold text-black"};function zt(s,e,o,i,t,a){const _=c("Button"),p=c("Skeleton"),m=c("Popover"),y=c("BackdropLoader"),w=c("Input"),v=c("TagProducts"),d=c("TagCustomers"),C=c("Modal");return n(),g("div",bt,[r("div",Lt,[r("div",kt,[r("div",Et,[r("div",Ft,[u(_,{size:"xs",type:"light",action:a.goBack,leftIcon:t.MoveLeft},{default:f(()=>e[4]||(e[4]=[r("span",null,"Back",-1)])),_:1,__:[4]},8,["action","leftIcon"]),a.isLoadingStore||a.isLoadingTag||a.isEditing&&!a.hasTag?(n(),g("div",Rt,[u(p,{width:"w-40"}),u(p,{width:"w-4"})])):(n(),g("div",Bt,[r("h1",It,l(a.isCreating?"Add Tag":a.tagForm.name||"..."),1),u(m,{placement:"top",content:a.isEditingProductTag||a.isCreatingProductTag?"Tags are labels you add to products to highlight features, making it easier for customers to find related items e.g. organic, new arrival, or best seller.":"Tags are labels you add to customers to group them by traits or behavior, making it easier to organize and personalize interactions e.g vip, frequent buyer or needs follow-up"},null,8,["content"])]))])]),r("div",qt,[a.isLoadingTag||a.isSubmitting?(n(),T(y,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):h("",!0),r("div",jt,[u(w,{type:"text",label:"Name",modelValue:a.tagForm.name,"onUpdate:modelValue":e[0]||(e[0]=P=>a.tagForm.name=P),errorText:a.formState.getFormError("name"),onInput:e[1]||(e[1]=P=>a.tagState.saveStateDebounced("Name changed")),placeholder:a.isEditingProductTag||a.isCreatingProductTag?"main dish":"vip",disabled:a.isEditingProductTag||a.isCreatingProductTag?!t.tagProductsReady:!t.tagCustomersReady,tooltipContent:`The name of your tag e.g ${a.isEditingProductTag||a.isCreatingProductTag?"main dish":"vip"}`},null,8,["modelValue","errorText","placeholder","disabled","tooltipContent"])])]),r("div",At,[a.isLoadingTag||a.isSubmitting?(n(),T(y,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):h("",!0),a.isEditingProductTag||a.isCreatingProductTag?(n(),T(v,{key:1,onTagProductsReady:e[2]||(e[2]=P=>t.tagProductsReady=!0)})):(n(),T(d,{key:2,onTagCustomersReady:e[3]||(e[3]=P=>t.tagCustomersReady=!0)}))]),a.tag?(n(),g("div",{key:0,class:N(["flex items-center justify-between space-x-4 overflow-hidden rounded-lg p-4 border mb-20",a.isLoadingTag?"border-gray-300 bg-gray-50":"border-red-300 bg-red-50"])},[r("div",Nt,[r("p",null,[e[5]||(e[5]=S("Delete ")),r("span",Ot,l(a.tagForm.name),1),e[6]||(e[6]=S("?"))]),e[7]||(e[7]=r("p",{class:"text-sm"},"Once this tag is deleted you will not be able to recover it.",-1))]),r("div",Dt,[u(C,{triggerType:"danger",approveType:"danger",approveLeftIcon:t.Trash2,triggerText:"Delete Tag",approveText:"Delete Tag",approveAction:a.deleteTag,triggerLoading:a.isDeletingTag,approveLoading:a.isDeletingTag},{content:f(()=>[e[10]||(e[10]=r("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),r("p",Ht,[e[8]||(e[8]=S("Are you sure you want to permanently delete ")),r("span",Ut,l(a.tagForm.name),1),e[9]||(e[9]=S("?"))])]),_:1},8,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])],2)):h("",!0)])])])}const me=E(xt,[["render",zt]]);export{me as default};
