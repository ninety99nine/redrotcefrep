import{c as u,b as e,a,r as n,w as x,e as b,t as d,g as c,h as y,o as g,i as S}from"./app-BS747Cvj.js";import{L as _}from"./Logo-DPaaifdA.js";import{I as P}from"./Input-ChopJmt9.js";import{B as E}from"./Button-DwrvLHoq.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Copy-CF04rHR8.js";import"./ShineEffect-BJBuBPSg.js";import"./createLucideIcon-48nG323g.js";import"./Popover-RWMt7bQF.js";import"./Skeleton-CTU87mWK.js";import"./Loader-DjOVE8lE.js";const v={name:"ResetPassword",components:{Logo:_,Input:P,Button:E},inject:["formState","notificationState"],data(){return{form:{email:"",token:"",password:"",confirmPassword:""},loading:!1,currentYear:new Date().getFullYear()}},methods:{async submit(){var m,t;if(!this.loading&&(this.formState.hideFormErrors(),this.form.email.trim()===""&&this.formState.setFormError("email","Email is required"),this.form.password.trim()===""&&this.formState.setFormError("password","New Password is required"),this.form.confirmPassword.trim()===""&&this.formState.setFormError("confirmPassword","Confirm New Password is required"),this.form.password!==this.form.confirmPassword&&this.formState.setFormError("confirmPassword","Passwords do not match"),!this.formState.hasErrors)){this.loading=!0;try{await y.post("/api/auth/reset-password",this.form),this.notificationState.showSuccessNotification("Password reset successfully. Please log in with your new password."),this.$router.push({name:"login"})}catch(o){const f=((t=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:t.message)||(o==null?void 0:o.message)||"Something went wrong while resetting your password";this.notificationState.showWarningNotification(f),this.formState.setServerFormErrors(o),console.error("Failed to reset password:",o)}finally{this.loading=!1}}}},mounted(){this.form.email=this.$route.query.email||"",this.form.token=this.$route.query.token||"",this.form.email?this.form.token||(this.formState.setFormError("general","Missing token."),this.notificationState.showWarningNotification("Missing token.")):(this.formState.setFormError("general","Missing email."),this.notificationState.showWarningNotification("Missing email."))}},F={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},V={class:"flex items-center justify-center p-6 bg-gradient-to-b from-blue-100 to-white-100"},N={class:"w-full max-w-md"},T={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},B={key:0,class:"text-red-500 text-sm mb-3"},C={class:"ml-1"},L={class:"flex justify-center mt-4"},j={class:"text-sm text-center text-gray-500"};function q(m,t,o,f,r,s){const w=n("Logo"),l=n("Input"),p=n("Button"),h=n("router-link");return g(),u("div",F,[e("div",V,[e("div",N,[a(w,{height:"h-20 mx-auto mb-4"}),e("div",T,[t[5]||(t[5]=e("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Reset Password",-1)),t[6]||(t[6]=e("h1",{class:"text-sm text-gray-500 mb-4"},"Enter a new password for your account.",-1)),e("form",{onSubmit:t[3]||(t[3]=x((...i)=>s.submit&&s.submit(...i),["prevent"])),class:"space-y-4"},[a(l,{disabled:"",type:"email",label:"Email",modelValue:r.form.email,"onUpdate:modelValue":t[0]||(t[0]=i=>r.form.email=i),errorText:s.formState.getFormError("email")},null,8,["modelValue","errorText"]),a(l,{type:"password",label:"New Password",modelValue:r.form.password,"onUpdate:modelValue":t[1]||(t[1]=i=>r.form.password=i),errorText:s.formState.getFormError("password")},null,8,["modelValue","errorText"]),a(l,{type:"password",label:"Confirm New Password",modelValue:r.form.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=i=>r.form.confirmPassword=i),errorText:s.formState.getFormError("confirmPassword")},null,8,["modelValue","errorText"]),s.formState.generalErrorText?(g(),u("div",B,d(s.formState.generalErrorText),1)):b("",!0),a(p,{size:"md",type:"primary",action:s.submit,disabled:r.loading,buttonClass:"w-full"},{default:c(()=>[e("span",C,d(r.loading?"Resetting...":"Reset Password"),1)]),_:1},8,["action","disabled"]),e("div",L,[a(h,{to:{name:"login"},class:"text-sm text-blue-600 hover:underline"},{default:c(()=>t[4]||(t[4]=[S("Back to Login")])),_:1,__:[4]})])],32)]),e("p",j,"Â© "+d(r.currentYear)+" Perfect Order. All rights reserved.",1)])]),t[7]||(t[7]=e("div",{class:"hidden lg:block"},[e("img",{src:"/images/lady-with-laptop.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const H=k(v,[["render",q]]);export{H as default};
