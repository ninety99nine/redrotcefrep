import{P as j}from"./Pill-HxPM5V1z.js";import{X as oe,I as H}from"./Input-xmg1-jx3.js";import{S as G}from"./Select-DUICGF1h.js";import{B as z}from"./Button-B0TvGvIg.js";import{L as Y}from"./Loader-DpTxBFLW.js";import{c as n,F as U,f as L,o as s,b as i,n as N,w as v,R as J,s as I,e as h,a as d,r as c,d as y,g as k,i as M,t as F,v as P,T as le}from"./app-lQaTPIyZ.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{i as K}from"./isEqual-Cq0I55zt.js";import{c as E}from"./cloneDeep-DrLrU9Pi.js";import{S as se}from"./SelectCountry-BDdH8_Yh.js";import{D as re}from"./Datepicker-UWvUSLLk.js";import{C as ne,a as ie}from"./chevron-up-CBJ8c3UC.js";import{c as B}from"./createLucideIcon-DWtItcWc.js";import{S as ae}from"./Switch-BamBWQ_2.js";import{V as Q}from"./vue-draggable-next.esm-bundler-t6UJN0u2.js";import{M as Z}from"./move-CyVlt-5V.js";import{R as ue}from"./rotate-ccw-DQx7Bn6u.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=B("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=B("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=B("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=B("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=B("logs",[["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M3 18h1",key:"1eiwyy"}],["path",{d:"M3 6h1",key:"rgxa97"}],["path",{d:"M8 12h1",key:"1con00"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M8 6h1",key:"tn6mkg"}]]),de={props:{pagination:{type:Object}},methods:{onClick(t){if(t.url){const e=new URL(t.url).searchParams.get("page");this.$emit("paginate",e)}},isDisabled(t){return t.url==null},getLinkClass(t,e){var o;return t==0?o="flex items-center justify-center whitespace-nowrap px-3 h-8 ms-0 leading-tight border rounded-s-lg dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white":t==this.pagination.meta.links.length-1?o="flex items-center justify-center whitespace-nowrap px-3 h-8 leading-tight border rounded-e-lg hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white":o="flex items-center justify-center whitespace-nowrap px-3 h-8 leading-tight border dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",this.isDisabled(e)?o+=" cursor-not-allowed bg-gray-100":o+=e.active?" bg-blue-500 hover:bg-blue-500 border-blue-500 text-white":"bg-white hover:bg-gray-100 hover:text-gray-700 text-gray-500",o}}},ce={class:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8"},he=["href","onClick","disabled"],pe=["innerHTML"];function ge(t,e,o,m,r,l){return s(),n("ul",ce,[(s(!0),n(U,null,L(o.pagination.meta.links,(a,p)=>(s(),n("li",{key:p},[i("a",{href:a.url??"#",onClick:v(f=>l.onClick(a),["prevent"]),disabled:l.isDisabled(a),class:N(l.getLinkClass(p,a))},[i("span",{innerHTML:a.label},null,8,pe)],10,he)]))),128))])}const me=T(de,[["render",ge]]),ye={components:{X:oe,Button:z},props:{position:{type:String,default:"right",validator:t=>["left","right"].includes(t)},trigger:{type:[String,null],default:null},header:{type:[String,null],default:null},content:{type:[String,null],default:null},showFooter:{type:Boolean,default:!0},showCancelButton:{type:Boolean,default:!0},declineText:{type:String,default:"Cancel"},declineType:{type:String,default:"light"},declineSize:{type:String,default:"sm"},declineAction:{type:[Function,null],default:null},showApproveButton:{type:Boolean,default:!0},approveText:{type:String,default:"Confirm"},approveSize:{type:String,default:"sm"},approveType:{type:String,default:"primary"},approveAction:{type:[Function,null],default:null},scrollOnContent:{type:Boolean,default:!0},dismissable:{type:Boolean,default:!0},maxWidth:{type:String,default:"max-w-xs"},onShow:{type:[Function,null],default:null},onHide:{type:[Function,null],default:null}},data(){return{uniqueId:J("drawer")}},computed:{positionClass(){return this.position==="right"?"end-0 translate-x-full hs-overlay-open:translate-x-0":"start-0 -translate-x-full hs-overlay-open:translate-x-0"}},mounted(){setTimeout(()=>{window.HSOverlay&&window.HSOverlay.autoInit()},500)},methods:{showDrawer(){const t=document.querySelector(`#${this.uniqueId}`);t&&(window.HSOverlay.open(t),this.onShow&&this.onShow())},hideDrawer(){const t=document.querySelector(`#${this.uniqueId}`);t&&(window.HSOverlay.close(t),this.onHide&&this.onHide())}}},fe=["id"],ve={class:"relative flex flex-col h-full"},we={key:0,class:"flex justify-between items-center py-3 px-4 border-b border-gray-200 dark:border-neutral-700"},be={key:0,class:"font-bold text-gray-700 dark:text-white"},xe={class:"text-sm text-gray-700 dark:text-neutral-400"},_e={key:0,class:"flex justify-end items-center gap-x-2 py-3 px-4 border-t border-gray-200 dark:border-neutral-700"};function Se(t,e,o,m,r,l){const a=c("Button"),p=c("X");return s(),n("div",null,[I(t.$slots,"trigger",{showDrawer:l.showDrawer},()=>[o.trigger?(s(),y(a,{key:0,size:"sm",type:"primary",action:l.showDrawer},{default:k(()=>[M(F(o.trigger),1)]),_:1},8,["action"])):h("",!0)]),i("div",{id:r.uniqueId,class:N([o.maxWidth,"hs-overlay hidden fixed inset-y-0 z-50 w-full bg-white shadow-lg border-r border-gray-200 transition-transform duration-300 ease-in-out dark:bg-neutral-800 dark:border-neutral-700",l.positionClass,{"[--overlay-backdrop:static]":!o.dismissable}])},[i("div",ve,[i("button",{type:"button","aria-label":"Close",onClick:e[0]||(e[0]=v((...f)=>l.hideDrawer&&l.hideDrawer(...f),["prevent","stop"])),class:"absolute top-2 right-6 size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-700 hover:bg-gray-200 focus:outline-hidden focus:bg-gray-200 dark:bg-neutral-700 dark:hover:bg-neutral-600 dark:text-neutral-400 dark:focus:bg-neutral-600"},[e[1]||(e[1]=i("span",{class:"sr-only"},"Close",-1)),d(p,{size:"20"})]),o.header||t.$slots.header?(s(),n("div",we,[I(t.$slots,"header",{hideDrawer:l.hideDrawer},()=>[o.header?(s(),n("h3",be,F(o.header),1)):h("",!0)])])):h("",!0),o.content||t.$slots.content?(s(),n("div",{key:1,class:N(["flex-1 overflow-y-auto",{"p-4":o.content},{"max-h-80":o.scrollOnContent}])},[I(t.$slots,"content",{hideDrawer:l.hideDrawer},()=>[i("p",xe,F(o.content),1)])],2)):h("",!0),I(t.$slots,"footer",{hideDrawer:l.hideDrawer},()=>[o.showFooter&&(o.showCancelButton||o.showApproveButton)?(s(),n("div",_e,[o.showCancelButton?(s(),y(a,{key:0,size:o.declineSize,type:o.declineType,action:o.declineAction?()=>o.declineAction(l.hideDrawer):l.hideDrawer},{default:k(()=>[M(F(o.declineText),1)]),_:1},8,["size","type","action"])):h("",!0),o.showApproveButton?(s(),y(a,{key:1,size:o.approveSize,type:o.approveType,action:o.approveAction?()=>o.approveAction(l.hideDrawer):l.hideDrawer},{default:k(()=>[M(F(o.approveText),1)]),_:1},8,["size","type","action"])):h("",!0)])):h("",!0)])])],10,fe)])}const q=T(ye,[["render",Se]]),ke={inject:["notificationState"],components:{Pill:j,Input:H,Button:z,Drawer:q,Datepicker:re,Loader:Y,Select:G,SelectCountry:se,Funnel:W,ChevronUp:ie,ChevronDown:ne},props:{filterExpressions:{type:Array,default:()=>[]},resource:{type:String}},emits:["updatedFilters"],data(){return{Funnel:W,ArrowUp:ee,ArrowDown:$,showMore:!1,localFilters:null,filterDrawer:null,originalFilters:null,isLoadingFilters:!1,lastEmittedFilters:null}},watch:{localFilters:{handler(t){this.createFilterExpressions()},deep:!0}},computed:{hasFilterExpressions(){return this.filterExpressions.length>0},totalActiveFilters(){return this.localFilters==null?0:this.localFilters.filter(t=>t.options.some(e=>e.active)).length},hasPriorityFilters(){return this.localFilters==null?!1:this.localFilters.filter(t=>t.priority).length>0},hasNonPriorityFilters(){return this.localFilters==null?!1:this.localFilters.filter(t=>!t.priority).length>0}},methods:{countActiveOptions(t){return t.options.filter(e=>e.active).length},createFilterExpressions(){let t=[];for(let e=0;e<this.localFilters.length;e++){const o=this.localFilters[e];if(o.options.some(r=>r.active))if(o.type==="checkboxes"){const l=o.options.filter(f=>f.active).map(f=>f.value),a=`${o.label} = ${l.join(", ")}`,p=`${o.target}:in:${l.join(",")}`;t.push({label:a,expression:p,filterIndex:e})}else for(let r=0;r<o.options.length;r++){const l=o.options[r];if(l.active){let p=null,f=null,C=l.value,V=l.value2,w=l.operator;if(["bt","bt_ex"].includes(w)){if(!C||!V)continue;p=`${o.label} between ${l.value} - ${l.value2} ${w=="bt"?"(including)":"(excluding)"}`,f=`${o.target}:${w}:${C}:${V}`}else if(["in","not_in"].includes(w)){if(!C&&!V)continue;const D=(V?V.split(",").map(_=>_.trim()):[C]).join(",");p=`${o.label} ${w==="in"?"in":"not in"} ${D}`,f=`${o.target}:${w}:${D}`}else p=`${o.label} ${w??"="} ${l.value}`,f=`${o.target}:${w??"="}:${C}`;t.push({label:p,expression:f,filterIndex:e,optionIndex:r})}}}this.filtersHaveChanged(t,this.lastEmittedFilters)&&(this.$emit("updatedFilters",t),this.lastEmittedFilters=E(t))},applyFilterExpressions(){this.filterExpressions.forEach(t=>{const e=t.split(":"),o=e[0],m=e[1],r=e[2],l=e[3]??null,a=this.localFilters.find(p=>p.target===o);a&&a.options.forEach(p=>{p.value===m&&(p.active=!0,a.type==="date"&&r&&P(r).isValid()?(p.value=P(r).format("DD MMM YYYY"),l&&P(l).isValid()&&(p.value2=P(l).format("DD MMM YYYY"))):["in","not_in"].includes(m)?(p.value=r.split(",")[0],p.value2=r):(p.value=r,p.value2=l))})})},filtersHaveChanged(t,e){var o=E(t),m=E(e);return!K(o,m)},openFilterDrawer(){this.localFilters==null&&this.getFilters(),this.filterDrawer.showDrawer()},closeFilterDrawer(){this.filterDrawer.hideDrawer()},toggleFilterVisibility(t){this.localFilters[t].active||this.localFilters.forEach((e,o)=>{this.localFilters[o].active=!1}),this.localFilters[t].active=!this.localFilters[t].active},showMoreOrLess(){this.showMore=!this.showMore},removeAppliedFilter(t){t.hasOwnProperty("filterIndex")&&t.hasOwnProperty("optionIndex")?this.localFilters[t.filterIndex].options[t.optionIndex].active=!1:this.localFilters[t.filterIndex].options.forEach(e=>{e.active=!1})},clearFilters(){this.localFilters=E(this.originalFilters)},async getFilters(){var t,e;try{if(this.isLoadingFilters)return;this.isLoadingFilters=!0;const o={params:{type:this.resource}},m=await axios.get("/api/filters",o);this.localFilters=m.data.map(r=>({...r,active:!1,options:r.options.map(l=>{let a={...l,active:!1};return r.type==="money"?(a.value="0.00",a.value2="0.00"):r.type==="date"?(a.value=P().subtract(7,"day").format("YYYY-MM-DD"),a.value2=P().add(7,"day").format("YYYY-MM-DD")):(["text","number","uuid"].includes(r.type)||r.target==="country"||r.type==="select")&&(a.value="",a.value2=""),a})})),this.originalFilters=E(this.localFilters),this.applyFilterExpressions()}catch(o){const m=((e=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while fetching the filter options";this.notificationState.showWarningNotification(m),console.error("Failed to fetch filter options:",o)}finally{this.isLoadingFilters=!1}}},mounted(){this.filterDrawer=this.$refs.filterDrawer,this.hasFilterExpressions&&this.getFilters()}},De={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},Fe={key:0,class:"flex justify-center my-8"},Ce={key:1,class:"divide-y mb-4"},Ve={key:0},Ee=["onClick"],Ae={class:"flex items-center space-x-2"},Ie={key:0,class:"text-sm p-4"},Ue={key:0,class:"my-4"},Le={key:0,class:"space-y-4"},Me={key:1,class:"space-y-4"},Oe={key:2,class:"space-y-4"},Pe={key:3,class:"space-y-4"},Te={key:4,class:"space-y-4"},ze={key:5,class:"space-y-4"},Be={key:6,class:"space-y-4"},je={key:2,class:"flex flex-col items-center px-4 space-y-8 mb-60"};function He(t,e,o,m,r,l){const a=c("Button"),p=c("Funnel"),f=c("Loader"),C=c("Pill"),V=c("ChevronUp"),w=c("ChevronDown"),x=c("Input"),D=c("Datepicker"),_=c("SelectCountry"),S=c("Select"),A=c("Drawer");return s(),n("div",null,[d(a,{size:"xs",type:"bare",leftIcon:r.Funnel,action:l.openFilterDrawer},null,8,["leftIcon","action"]),d(A,{placement:"right",ref:"filterDrawer",showFooter:!1,scrollOnContent:!1},{content:k(()=>[i("div",De,[d(p,{size:"20"}),e[14]||(e[14]=i("h2",null,"Filters",-1))]),e[16]||(e[16]=i("p",{class:"p-4 text-sm bg-indigo-100"}," Find exactly what you need by applying filters to your data ",-1)),r.isLoadingFilters?(s(),n("div",Fe,[d(f)])):(s(),n("div",Ce,[(s(!0),n(U,null,L(r.localFilters,(b,O)=>(s(),n(U,{key:O},[r.showMore||b.priority?(s(),n("div",Ve,[i("div",{onClick:u=>l.toggleFilterVisibility(O),class:"text-sm p-4 bg-gray-50 hover:bg-gray-100 cursor-pointer flex items-center justify-between"},[i("span",null,F(b.label),1),i("div",Ae,[l.countActiveOptions(b)?(s(),y(C,{key:0,type:"primary",size:"xs",class:"flex-shrink-0"},{default:k(()=>[M(F(l.countActiveOptions(b)),1)]),_:2},1024)):h("",!0),b.active?(s(),y(V,{key:1,size:"16"})):(s(),y(w,{key:2,size:"16"}))])],8,Ee),b.active?(s(),n("div",Ie,[(s(!0),n(U,null,L(b.options,(u,te)=>(s(),n("div",{key:te},[d(x,{onClick:e[0]||(e[0]=v(()=>{},["stop"])),type:"checkbox",modelValue:u.active,"onUpdate:modelValue":g=>u.active=g,inputLabel:u.label},null,8,["modelValue","onUpdate:modelValue","inputLabel"]),u.active?(s(),n("div",Ue,[b.type==="date"?(s(),n("div",Le,[d(D,{onClick:e[1]||(e[1]=v(()=>{},["stop"])),modelValue:u.value,"onUpdate:modelValue":g=>u.value=g},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(u.operator)?(s(),y(D,{key:0,onClick:e[2]||(e[2]=v(()=>{},["stop"])),modelValue:u.value2,"onUpdate:modelValue":g=>u.value2=g},null,8,["modelValue","onUpdate:modelValue"])):h("",!0)])):b.type==="money"?(s(),n("div",Me,[d(x,{type:"money",onClick:e[3]||(e[3]=v(()=>{},["stop"])),modelValue:u.value,"onUpdate:modelValue":g=>u.value=g},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(u.operator)?(s(),y(x,{key:0,type:"money",onClick:e[4]||(e[4]=v(()=>{},["stop"])),modelValue:u.value2,"onUpdate:modelValue":g=>u.value2=g},null,8,["modelValue","onUpdate:modelValue"])):h("",!0)])):b.target==="country"?(s(),n("div",Oe,[d(_,{onClick:e[5]||(e[5]=v(()=>{},["stop"])),modelValue:u.value,"onUpdate:modelValue":g=>u.value=g,placeholder:"Select country"},null,8,["modelValue","onUpdate:modelValue"]),["in","not_in"].includes(u.operator)?(s(),y(x,{key:0,type:"text",onClick:e[6]||(e[6]=v(()=>{},["stop"])),modelValue:u.value2,"onUpdate:modelValue":g=>u.value2=g,placeholder:"Enter comma-separated country codes"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0)])):b.type==="text"?(s(),n("div",Pe,[d(x,{type:"text",onClick:e[7]||(e[7]=v(()=>{},["stop"])),modelValue:u.value,"onUpdate:modelValue":g=>u.value=g,placeholder:"Enter value"},null,8,["modelValue","onUpdate:modelValue"])])):b.type==="number"?(s(),n("div",Te,[d(x,{type:"number",onClick:e[8]||(e[8]=v(()=>{},["stop"])),modelValue:u.value,"onUpdate:modelValue":g=>u.value=g,placeholder:"Enter number"},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(u.operator)?(s(),y(x,{key:0,type:"number",onClick:e[9]||(e[9]=v(()=>{},["stop"])),modelValue:u.value2,"onUpdate:modelValue":g=>u.value2=g,placeholder:"Enter number"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0)])):b.type==="uuid"?(s(),n("div",ze,[d(x,{type:"text",onClick:e[10]||(e[10]=v(()=>{},["stop"])),modelValue:u.value,"onUpdate:modelValue":g=>u.value=g,placeholder:"Enter UUID"},null,8,["modelValue","onUpdate:modelValue"]),["in","not_in"].includes(u.operator)?(s(),y(x,{key:0,type:"text",onClick:e[11]||(e[11]=v(()=>{},["stop"])),modelValue:u.value2,"onUpdate:modelValue":g=>u.value2=g,placeholder:"Enter comma-separated UUIDs"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0)])):b.type==="select"?(s(),n("div",Be,[d(S,{onClick:e[12]||(e[12]=v(()=>{},["stop"])),modelValue:u.value,"onUpdate:modelValue":g=>u.value=g,options:b.options,placeholder:"Select value"},null,8,["modelValue","onUpdate:modelValue","options"]),["in","not_in"].includes(u.operator)?(s(),y(x,{key:0,type:"text",onClick:e[13]||(e[13]=v(()=>{},["stop"])),modelValue:u.value2,"onUpdate:modelValue":g=>u.value2=g,placeholder:"Enter comma-separated values"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0)])):h("",!0)])):h("",!0)]))),128))])):h("",!0)])):h("",!0)],64))),128))])),r.isLoadingFilters?h("",!0):(s(),n("div",je,[l.hasPriorityFilters&&l.hasNonPriorityFilters?(s(),y(a,{key:0,size:"xs",type:"outline",action:l.showMoreOrLess,leftIcon:r.showMore?r.ArrowUp:r.ArrowDown},{default:k(()=>[i("span",null,F(r.showMore?"show less options":"show more options"),1)]),_:1},8,["action","leftIcon"])):h("",!0),l.totalActiveFilters?(s(),y(a,{key:1,size:"sm",type:"light",buttonClass:"w-full",action:l.clearFilters},{default:k(()=>e[15]||(e[15]=[i("span",null,"Clear Filters",-1)])),_:1,__:[15]},8,["action"])):h("",!0)]))]),_:1},512)])}const Ne=T(ke,[["render",He]]),Ye={inject:["formState"],components:{Move:Z,Logs:X,draggable:Q,Input:H,Pill:j,Button:z,Drawer:q,Switch:ae},props:{columns:{type:Array,default:()=>[]}},emits:["updatedColumns"],data(){return{Logs:X,showMore:!1,columnsDrawer:null,showEverything:!1,localColumns:E(this.columns),originalColumns:E(this.columns)}},watch:{localColumns:{handler(t){this.showEverything!=this.isShowingEverything&&(this.showEverything=this.isShowingEverything),this.$emit("updatedColumns",t)},deep:!0},showEverything(t){t?this.localColumns.map(e=>e.active=!0):this.isShowingEverything&&this.localColumns.map(e=>e.active=e.priority)}},computed:{isShowingEverything(){return this.localColumns.filter(t=>t.active==!0).length==this.localColumns.length}},methods:{openColumnsDrawer(){this.columnsDrawer.showDrawer()},closeColumnsDrawer(){this.columnsDrawer.hideDrawer()},resetColumns(){this.localColumns=E(this.originalColumns)}},mounted(){this.columnsDrawer=this.$refs.columnsDrawer}},qe={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},Re={class:"p-4 border-b shadow-sm"},We={class:"divide-y mb-4"},Xe={class:"px-4 mb-60"};function Ge(t,e,o,m,r,l){const a=c("Button"),p=c("Logs"),f=c("Switch"),C=c("Input"),V=c("Move"),w=c("draggable"),x=c("Drawer");return s(),n("div",null,[d(a,{size:"xs",type:"bare",leftIcon:r.Logs,action:l.openColumnsDrawer},null,8,["leftIcon","action"]),d(x,{placement:"right",ref:"columnsDrawer",showFooter:!1,scrollOnContent:!1},{content:k(()=>[i("div",qe,[d(p,{size:"20"}),e[4]||(e[4]=i("h2",null,"Columns",-1))]),e[6]||(e[6]=i("p",{class:"p-4 text-sm bg-indigo-100"}," Show, hide and move your data they way you want to see it ",-1)),i("div",Re,[d(f,{size:"sm",modelValue:r.showEverything,"onUpdate:modelValue":e[0]||(e[0]=D=>r.showEverything=D),suffixText:"Show Everything"},null,8,["modelValue"])]),i("div",We,[d(w,{class:"divide-y mb-4",modelValue:r.localColumns,"onUpdate:modelValue":e[3]||(e[3]=D=>r.localColumns=D),handle:".draggable-handle","ghost-class":"bg-yellow-50"},{default:k(()=>[(s(!0),n(U,null,L(r.localColumns,(D,_)=>(s(),n("div",{key:_,class:"flex items-center justify-between p-4"},[d(C,{onClick:e[1]||(e[1]=v(()=>{},["stop"])),type:"checkbox",modelValue:D.active,"onUpdate:modelValue":S=>D.active=S,inputLabel:D.name},null,8,["modelValue","onUpdate:modelValue","inputLabel"]),d(V,{onClick:e[2]||(e[2]=v(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})]))),128))]),_:1},8,["modelValue"])]),i("div",Xe,[d(a,{size:"sm",type:"light",buttonClass:"w-full",action:l.resetColumns},{default:k(()=>e[5]||(e[5]=[i("span",null,"Reset Columns",-1)])),_:1,__:[5]},8,["action"])])]),_:1},512)])}const Je=T(Ye,[["render",Ge]]),Ke={inject:["notificationState"],components:{Move:Z,draggable:Q,Pill:j,Input:H,Button:z,Drawer:q,Loader:Y,ArrowDownWideNarrow:R},props:{sortingExpressions:{type:Array,default:()=>[]},resource:{type:String}},emits:["updatedSorting"],data(){return{ArrowUp:ee,ArrowDown:$,showMore:!1,sortDrawer:null,localSorting:null,ArrowDownWideNarrow:R,originalSorting:null,isLoadingSorting:!1,lastEmittedSorting:null}},watch:{localSorting:{handler(t){this.createSortingExpressions()},deep:!0}},computed:{hasSortingExpressions(){return this.sortingExpressions.length>0},totalActiveSortOptions(){return this.localSorting==null?0:this.localSorting.filter(t=>t.options.some(e=>e.active)).length},hasPrioritySortOptions(){return this.localSorting==null?!1:this.localSorting.filter(t=>t.priority).length>0},hasNonPrioritySortOptions(){return this.localSorting==null?!1:this.localSorting.filter(t=>!t.priority).length>0}},methods:{toggleSortOption(t,e){this.localSorting[t].options.forEach((o,m)=>{m!==e&&(o.active=!1)})},countActiveOptions(t){return t.options.filter(e=>e.active).length},createSortingExpressions(){let t=[];for(let e=0;e<this.localSorting.length;e++){const o=this.localSorting[e];if(o.options.some(r=>r.active)){const l=o.options.filter(f=>f.active)[0],a=`${o.label} (${l.label})`,p=`${o.target}:${l.value}`;t.push({label:a,sortIndex:e,expression:p})}}this.sortingHasChanged(t,this.lastEmittedSorting)&&(this.$emit("updatedSorting",t),this.lastEmittedSorting=E(t))},applySortingExpressions(){this.sortingExpressions.forEach(t=>{const e=t.split(":"),o=e[0],m=e[1],r=this.localSorting.find(l=>l.target===o);r&&r.options.forEach(l=>{l.value==m&&(l.active=!0)})})},sortingHasChanged(t,e){var o=E(t),m=E(e);return!K(o,m)},openSortDrawer(){this.localSorting==null&&this.getSorting(),this.sortDrawer.showDrawer()},closeSortDrawer(){this.sortDrawer.hideDrawer()},toggleSortingVisibility(t){this.localSorting[t].active||this.localSorting.forEach((e,o)=>{this.localSorting[o].active=!1}),this.localSorting[t].active=!this.localSorting[t].active},showMoreOrLess(){this.showMore=!this.showMore},removeAppliedSort(t){this.localSorting[t.sortIndex].options.forEach(e=>{e.active=!1})},clearSorting(){this.localSorting=E(this.originalSorting)},async getSorting(){var t,e;try{if(this.isLoadingSorting)return;this.isLoadingSorting=!0;const o={params:{type:this.resource}},m=await axios.get("/api/sorting",o);this.localSorting=m.data.map(r=>({...r,active:!1,options:r.options.map(l=>({...l,active:!1}))})),this.originalSorting=E(this.localSorting),this.applySortingExpressions()}catch(o){const m=((e=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while fetching the sorting options";this.notificationState.showWarningNotification(m),console.error("Failed to fetch sorting options:",o)}finally{this.isLoadingSorting=!1}}},mounted(){this.sortDrawer=this.$refs.sortDrawer,this.hasSortingExpressions&&this.getSorting()}},Qe={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},Ze={key:0,class:"flex justify-center my-8"},$e={key:0},et=["onClick"],tt={class:"flex items-center space-x-2"},ot={key:2,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},lt={key:3,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},st={key:0,class:"text-sm p-4"},rt={key:2,class:"flex flex-col items-center px-4 space-y-8 mb-60"};function nt(t,e,o,m,r,l){const a=c("Button"),p=c("ArrowDownWideNarrow"),f=c("Loader"),C=c("Pill"),V=c("Move"),w=c("Input"),x=c("draggable"),D=c("Drawer");return s(),n("div",null,[d(a,{size:"xs",type:"bare",action:l.openSortDrawer,leftIcon:r.ArrowDownWideNarrow},null,8,["action","leftIcon"]),d(D,{ref:"sortDrawer",placement:"right",showFooter:!1,scrollOnContent:!1},{content:k(()=>[i("div",Qe,[d(p,{size:"20"}),e[2]||(e[2]=i("h2",null,"Sorting",-1))]),e[6]||(e[6]=i("p",{class:"p-4 text-sm bg-indigo-100"}," When using two or more sorting options, you can rearrange their order to prioritize which criteria are applied first. ",-1)),r.isLoadingSorting?(s(),n("div",Ze,[d(f)])):(s(),y(x,{key:1,modelValue:r.localSorting,"onUpdate:modelValue":e[1]||(e[1]=_=>r.localSorting=_),class:"divide-y mb-4",handle:".draggable-handle","ghost-class":"bg-yellow-50"},{default:k(()=>[(s(!0),n(U,null,L(r.localSorting,(_,S)=>(s(),n(U,{key:S},[r.showMore||_.priority?(s(),n("div",$e,[i("div",{onClick:A=>l.toggleSortingVisibility(S),class:"text-sm p-4 bg-gray-50 hover:bg-gray-100 cursor-pointer flex items-center justify-between"},[i("span",null,F(_.label),1),i("div",tt,[l.countActiveOptions(_)?(s(),y(C,{key:0,type:"primary",size:"xs",class:"flex-shrink-0"},{default:k(()=>[M(F(l.countActiveOptions(_)),1)]),_:2},1024)):h("",!0),l.countActiveOptions(_)?(s(),y(V,{key:1,onClick:e[0]||(e[0]=v(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})):h("",!0),_.active?(s(),n("svg",ot,e[3]||(e[3]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"},null,-1)]))):(s(),n("svg",lt,e[4]||(e[4]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"},null,-1)])))])],8,et),_.active?(s(),n("div",st,[(s(!0),n(U,null,L(_.options,(A,b)=>(s(),n("div",{key:b},[d(w,{type:"checkbox",modelValue:A.active,"onUpdate:modelValue":O=>A.active=O,inputLabel:A.label,onClick:v(()=>l.toggleSortOption(S,b),["stop"])},null,8,["modelValue","onUpdate:modelValue","inputLabel","onClick"])]))),128))])):h("",!0)])):h("",!0)],64))),128))]),_:1},8,["modelValue"])),r.isLoadingSorting?h("",!0):(s(),n("div",rt,[l.hasPrioritySortOptions&&l.hasNonPrioritySortOptions?(s(),y(a,{key:0,size:"xs",type:"outline",action:l.showMoreOrLess,leftIcon:r.showMore?r.ArrowUp:r.ArrowDown},{default:k(()=>[i("span",null,F(r.showMore?"show less options":"show more options"),1)]),_:1},8,["action","leftIcon"])):h("",!0),l.totalActiveSortOptions?(s(),y(a,{key:1,size:"sm",type:"light",buttonClass:"w-full",action:l.clearSorting},{default:k(()=>e[5]||(e[5]=[i("span",null,"Clear Sorting",-1)])),_:1,__:[5]},8,["action"])):h("",!0)]))]),_:1},512)])}const it=T(Ke,[["render",nt]]),at={components:{Pill:j,Button:z,Input:H,Select:G,Paginator:me,Loader:Y,FilterDrawer:Ne,ColumnsDrawer:Je,SortingDrawer:it},props:{isLoading:{type:Boolean,default:!1},searchTerm:{type:String,default:null},searchPlaceholder:{type:String,default:null},pagination:{type:Object},perPage:{type:String,default:"15"},resource:{type:String},columns:{type:Array,default:()=>[]},filterExpressions:{type:Array,default:()=>[]},sortingExpressions:{type:Array,default:()=>[]}},emits:["search","refresh","paginate","updatedColumns","updatedFilters","updatedSorting","updatedPerPage"],data(){return{RotateCcw:ue,modal:null,filters:[],sorting:[],filterDrawer:null,isSearching:!1,sortingDrawer:null,totalTableHeaders:0,localPerPage:this.perPage,localIsLoading:this.isLoading,localSearchTerm:this.searchTerm,uniqueModalId:J("modal")}},watch:{isLoading(t){this.localIsLoading=t,this.isSearching=t&&this.hasSearchTerm},localSearchTerm(t){this.$emit("search",t)},localPerPage(t){this.$emit("updatedPerPage",t)},pagination(t){t&&this.$nextTick(()=>{this.filterDrawer=this.$refs.filterDrawer,this.sortingDrawer=this.$refs.sortingDrawer})},columns:{handler(){this.$nextTick(()=>{this.totalTableHeaders=this.$refs.tablehead.querySelectorAll("th").length})},deep:!0}},computed:{hasSearchTerm(){return this.localSearchTerm!=null&&this.localSearchTerm.trim()!=""},hasFilters(){return this.filters.length>0},hasSorting(){return this.sorting.length>0},hasFilterExpressions(){return this.filterExpressions.length>0},hasSortingExpressions(){return this.sortingExpressions.length>0},perPageOptions(){return["15","50","100","200"].map(t=>({label:`${t} per page`,value:t}))}},methods:{refresh(){this.localIsLoading||this.$emit("refresh")},paginate(t){this.$emit("paginate",t)},updatedColumns(t){this.$emit("updatedColumns",t)},updatedFilters(t){this.filters=t,this.$emit("updatedFilters",t)},updatedSorting(t){this.sorting=t,this.$emit("updatedSorting",t)},removeAppliedFilter(t){this.filterDrawer.removeAppliedFilter(t)},removeAppliedSort(t){this.sortingDrawer.removeAppliedSort(t)},onInputSearchTerm(t){t.target.value.length?this.isSearching=!0:this.isSearching=!1,this.localIsLoading=!0}},mounted(){this.totalTableHeaders=this.$refs.tablehead.querySelectorAll("th").length}},ut={class:"flex justify-between items-center space-x-4 mb-4"},dt={key:0,class:"flex justify-center items-center space-x-4"},ct={key:0},ht={key:1},pt={key:0,class:"flex flex-col items-center mb-4"},gt={class:"flex items-center space-x-2"},mt={key:1,class:"flex flex-col items-center mb-4"},yt={class:"flex items-center space-x-2"},ft={key:2,class:"flex flex-wrap gap-2 mb-4"},vt={class:"relative w-full overflow-x-auto border border-blue-200 rounded-lg"},wt={key:0,class:"absolute top-0 bottom-0 left-0 right-0 bg-white/50 flex justify-center items-center"},bt={class:"w-full text-left rtl:text-right"},xt={class:"text-sm bg-blue-50",ref:"tablehead"},_t={key:0},St={key:2},kt={key:2,class:"text-sm text-gray-700 text-center py-16 bg-blue-50 border-t border-blue-200"},Dt={key:0,class:"flex items-center justify-center space-x-2"},Ft={class:"text-sm text-gray-500"},Ct={key:1},Vt={key:0,class:"flex justify-between items-center mt-4"},Et={class:"text-sm font-normal text-gray-500 dark:text-gray-400"},At={class:"font-semibold text-gray-900 dark:text-white"},It={class:"font-semibold text-gray-900 dark:text-white"},Ut={class:"flex items-center space-x-4"};function Lt(t,e,o,m,r,l){const a=c("Input"),p=c("FilterDrawer"),f=c("SortingDrawer"),C=c("ColumnsDrawer"),V=c("Button"),w=c("Loader"),x=c("Pill"),D=c("Select"),_=c("Paginator");return s(),n("div",null,[I(t.$slots,"header"),i("div",ut,[d(a,{type:"search",class:"w-full",debounced:!0,modelValue:r.localSearchTerm,"onUpdate:modelValue":e[0]||(e[0]=S=>r.localSearchTerm=S),onInput:l.onInputSearchTerm,placeholder:o.searchPlaceholder},null,8,["modelValue","onInput","placeholder"]),o.pagination?(s(),n("div",dt,[d(p,{ref:"filterDrawer",resource:o.resource,filterExpressions:o.filterExpressions,onUpdatedFilters:l.updatedFilters},null,8,["resource","filterExpressions","onUpdatedFilters"]),d(f,{ref:"sortingDrawer",resource:o.resource,sortingExpressions:o.sortingExpressions,onUpdatedSorting:l.updatedSorting},null,8,["resource","sortingExpressions","onUpdatedSorting"]),d(C,{ref:"columnsDrawer",columns:o.columns,onUpdatedColumns:l.updatedColumns},null,8,["columns","onUpdatedColumns"]),t.$slots.beforeRefreshButton?(s(),n("div",ct,[I(t.$slots,"beforeRefreshButton")])):h("",!0),d(V,{action:l.refresh,type:"bare",size:"xs",leftIcon:r.RotateCcw},null,8,["action","leftIcon"]),t.$slots.afterRefreshButton?(s(),n("div",ht,[I(t.$slots,"afterRefreshButton")])):h("",!0)])):h("",!0)]),d(le,{name:"fade-1",mode:"out-in"},{default:k(()=>[l.hasFilterExpressions&&!l.hasFilters?(s(),n("div",pt,[i("div",gt,[d(w),e[2]||(e[2]=i("span",{class:"text-sm text-gray-500"},"Preparing filters",-1))])])):l.hasSortingExpressions&&!l.hasSorting?(s(),n("div",mt,[i("div",yt,[d(w),e[3]||(e[3]=i("span",{class:"text-sm text-gray-500"},"Preparing sorting",-1))])])):l.hasFilters||l.hasSorting?(s(),n("div",ft,[(s(!0),n(U,null,L(r.filters,(S,A)=>(s(),y(x,{key:A,type:"primary",size:"xs",closableAction:()=>l.removeAppliedFilter(S)},{default:k(()=>[M(F(S.label),1)]),_:2},1032,["closableAction"]))),128)),(s(!0),n(U,null,L(r.sorting,(S,A)=>(s(),y(x,{key:A,type:"success",size:"xs",closableAction:()=>l.removeAppliedSort(S)},{default:k(()=>[M(F(S.label),1)]),_:2},1032,["closableAction"]))),128))])):h("",!0)]),_:1}),I(t.$slots,"belowToolbar"),i("div",vt,[o.pagination&&o.pagination.meta.total>0&&(r.localIsLoading||r.isSearching)?(s(),n("div",wt,[d(w)])):h("",!0),i("table",bt,[i("thead",xt,[I(t.$slots,"head")],512),!o.pagination&&r.localIsLoading&&r.totalTableHeaders>0?(s(),n("tbody",_t,[(s(),n(U,null,L([1,2,3],(S,A)=>i("tr",{key:A,class:"animate-pulse"},[(s(!0),n(U,null,L(r.totalTableHeaders,(b,O)=>(s(),n("td",{key:O},e[4]||(e[4]=[i("div",{class:"h-2 bg-blue-200 rounded-full mx-4 my-4"},null,-1)])))),128))])),64))])):t.$slots.tbody?I(t.$slots,"tbody",{key:1}):(s(),n("tbody",St,[I(t.$slots,"body")]))]),t.$slots.noResults&&!r.localIsLoading&&o.pagination&&o.pagination.meta.total==0&&!l.hasSearchTerm?I(t.$slots,"noResults",{key:1}):o.pagination&&o.pagination.meta.total==0?(s(),n("div",kt,[r.localIsLoading||r.isSearching?(s(),n("div",Dt,[d(w),i("span",Ft,F(r.isSearching?"Searching":"Loading"),1)])):(s(),n("span",Ct,"No results found"))])):h("",!0)]),o.pagination&&o.pagination.meta.total>0?(s(),n("div",Vt,[i("span",Et,[e[5]||(e[5]=M("Showing ")),i("span",At,F(o.pagination.meta.from)+"-"+F(o.pagination.meta.to),1),e[6]||(e[6]=M(" of ")),i("span",It,F(o.pagination.meta.total),1)]),i("div",Ut,[d(D,{class:"w-40",search:!1,modelValue:r.localPerPage,"onUpdate:modelValue":e[1]||(e[1]=S=>r.localPerPage=S),options:l.perPageOptions},null,8,["modelValue","options"]),o.pagination?(s(),y(_,{key:0,pagination:o.pagination,onPaginate:l.paginate},null,8,["pagination","onPaginate"])):h("",!0)])])):h("",!0)])}const Qt=T(at,[["render",Lt]]);export{Qt as T};
