import{P as M}from"./Pill-jpvJKogt.js";import{M as A}from"./Modal-CB5khyw0.js";import{B as L}from"./Button-C5PjVjk3.js";import{S as C}from"./Skeleton-CCmfEA-R.js";import{V as D}from"./vue-draggable-next.esm-bundler-2B3kMfEa.js";import{c as f,e as T,d as N,a as l,g,F as k,f as y,b as t,w as h,q as V,r as w,o as d,t as m,i as p}from"./app-GlJHzU_x.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as F}from"./move-DsTP0itZ.js";import{c as I}from"./createLucideIcon-BHEQ_wZh.js";import{T as P}from"./trash-2-1C5JYDaS.js";import{P as z}from"./plus-xs22FjRq.js";import"./Popover-CDw03pE7.js";import"./Tooltip-C-cjSIU7.js";import"./x-D9LU4_3P.js";import"./Loader-BQyLZa88.js";import"./ShineEffect-B9_RJRQO.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=I("workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),j={inject:["formState","storeState","notificationState"],components:{Workflow:E,Pill:M,Modal:A,Button:L,Skeleton:C,Move:F,draggable:D},data(){return{Plus:z,Trash2:P,pagination:null,workflows:[],deletableWorkflow:null,isDeletingWorkflow:!1,isLoadingWorkflows:!1,isChangingWorkflowArrangement:!1}},watch:{store(s,o){!o&&s&&this.setup()}},computed:{store(){return this.storeState.store},isLoadingStore(){return this.storeState.isLoadingStore},hasWorkflows(){return this.workflows.length>0}},methods:{setup(){this.store&&this.showWorkflows()},showDeleteWorkflowModal(s){this.deletableWorkflow=s,this.$refs.deleteWorkflowModal.showModal()},async navigateToAddWorkflow(){await this.$router.push({name:"add-workflow",query:{store_id:this.store.id}})},async navigateToEditWorkflow(s){await this.$router.push({name:"edit-workflow",query:{store_id:this.store.id},params:{workflow_id:s.id}})},async showWorkflows(){var s,o;try{this.isLoadingWorkflows=!0;let e={params:{per_page:100,store_id:this.store.id,association:"team member"}};const n=await axios.get("/api/workflows",e);this.pagination=n.data,this.workflows=this.pagination.data}catch(e){const n=((o=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:o.message)||(e==null?void 0:e.message)||"Something went wrong while fetching workflows";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(e),console.error("Failed to fetch workflows:",e)}finally{this.isLoadingWorkflows=!1}},async changeWorkflowArrangement(){var s,o;try{if(this.isChangingWorkflowArrangement)return;const e=this.workflows.map(r=>r.id);if(e.length==0)return;this.isChangingWorkflowArrangement=!0;const n={store_id:this.store.id,workflow_ids:e};await axios.post("/api/workflows/arrangement",n),this.notificationState.showSuccessNotification("Arrangement changed")}catch(e){const n=((o=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:o.message)||(e==null?void 0:e.message)||"Something went wrong while updating workflow arrangement";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(e),console.error("Failed to update workflow arrangement:",e)}finally{this.isChangingWorkflowArrangement=!1}},async deleteWorkflow(){var s,o;try{if(this.isDeletingWorkflow)return;this.isDeletingWorkflow=!0;const e={data:{store_id:this.store.id}};await axios.delete(`/api/workflows/${this.deletableWorkflow.id}`,e),this.showWorkflows(),this.$refs.deleteWorkflowModal.hideModal(),this.notificationState.showSuccessNotification("Workflow deleted")}catch(e){const n=((o=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:o.message)||(e==null?void 0:e.message)||"Something went wrong while deleting workflow";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(e),console.error("Failed to delete workflow:",e),hideModal()}finally{this.isDeletingWorkflow=!1}}},created(){this.setup()}},q={class:"max-w-2xl mx-auto pt-32 pb-40"},U={key:0,class:"flex justify-end"},Y={key:1,class:"space-y-3 mt-4"},G={class:"flex justify-between items-center"},H={class:"flex items-center space-x-4"},J=["onClick"],K={class:"flex justify-between items-center"},O={class:"text-sm"},Q={class:"flex items-center space-x-4"},R={key:3,class:"flex flex-col items-center justify-center bg-gradient-to-br from-indigo-50 to-purple-50 border border-gray-300 shadow-lg rounded-2xl py-16 px-8 space-y-6"},X={class:"relative"},Z={class:"bg-gradient-to-br from-white-50 to-indigo-50 text-indigo-500 rounded-full p-2"},$={class:"mb-8"},ee={class:"font-bold text-black"};function oe(s,o,e,n,r,i){const u=w("Button"),c=w("Skeleton"),W=w("Pill"),b=w("Move"),v=w("draggable"),x=w("Workflow"),_=w("Modal");return d(),f("div",q,[!i.isLoadingStore&&!r.isLoadingWorkflows&&i.hasWorkflows?(d(),f("div",U,[l(u,{size:"md",class:"mb-4",type:"primary",leftIcon:r.Plus,action:i.navigateToAddWorkflow},{default:g(()=>o[3]||(o[3]=[t("span",null,"Add Workflow",-1)])),_:1,__:[3]},8,["leftIcon","action"])])):T("",!0),i.isLoadingStore||r.isLoadingWorkflows?(d(),f("div",Y,[(d(),f(k,null,y([1,2,3],(a,S)=>t("div",{key:S,class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300"},[t("div",G,[l(c,{width:"w-40",shine:!0}),t("div",H,[l(c,{width:"w-16",shine:!0}),l(c,{width:"w-4",height:"h-4",rounded:"rounded-md",shine:!0}),l(c,{width:"w-4",height:"h-4",rounded:"rounded-md",shine:!0})])])])),64))])):i.hasWorkflows?(d(),N(v,{key:2,modelValue:r.workflows,"onUpdate:modelValue":o[1]||(o[1]=a=>r.workflows=a),class:"space-y-3 mt-4",handle:".draggable-handle","ghost-class":"bg-yellow-50",onChange:i.changeWorkflowArrangement},{default:g(()=>[(d(!0),f(k,null,y(r.workflows,a=>(d(),f("div",{key:a.id,onClick:h(()=>i.navigateToEditWorkflow(a),["stop"]),class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},[t("div",K,[t("span",O,m(a.name),1),t("div",Q,[l(W,{type:a.active?"success":"warning",size:"xs"},{default:g(()=>[p(m(a.active?"active":"inactive"),1)]),_:2},1032,["type"]),l(u,{size:"xs",type:"bareDanger",leftIcon:r.Trash2,action:()=>i.showDeleteWorkflowModal(a)},null,8,["leftIcon","action"]),l(b,{onClick:o[0]||(o[0]=h(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})])])],8,J))),128))]),_:1},8,["modelValue","onChange"])):(d(),f("div",R,[t("div",X,[t("div",Z,[l(x,{size:"60"})]),o[4]||(o[4]=t("div",{class:"absolute inset-0 bg-indigo-300 opacity-20 rounded-full animate-ping"},null,-1))]),o[6]||(o[6]=t("div",{class:"text-center"},[t("h3",{class:"text-xl font-semibold text-gray-800"},"Set Up Your Workflows!"),t("span",{class:"text-sm text-gray-600 mt-2 block max-w-sm"}," Add a workflow to automate your communication. ")],-1)),t("button",{size:"lg",type:"bare",onClick:o[2]||(o[2]=h((...a)=>i.navigateToAddWorkflow&&i.navigateToAddWorkflow(...a),["stop"])),class:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-medium py-3 px-6 rounded-lg hover:from-indigo-600 hover:to-purple-700 transition-all duration-300 hover:scale-105 cursor-pointer"},o[5]||(o[5]=[t("span",null,"Add Workflow Now",-1)]))])),l(_,{approveType:"danger",approveLeftIcon:r.Trash2,ref:"deleteWorkflowModal",approveText:"Delete Workflow",approveAction:i.deleteWorkflow,triggerLoading:r.isDeletingWorkflow,approveLoading:r.isDeletingWorkflow},V({_:2},[r.deletableWorkflow?{name:"content",fn:g(()=>[o[9]||(o[9]=t("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",$,[o[7]||(o[7]=p("Are you sure you want to delete ")),t("span",ee,m(r.deletableWorkflow.name),1),o[8]||(o[8]=p("?"))])]),key:"0"}:void 0]),1032,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])}const ke=B(j,[["render",oe]]);export{ke as default};
