import{d,r as i,o as c,g as b,b as h,a as l,t as v,c as w,e as S,n as x,k as _,l as B}from"./app-Db6d8eSP.js";import{W as I}from"./WhatsappIcon-NLtUmags.js";import{B as y}from"./Button-BtGfnYDo.js";import{_ as u}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{H as k}from"./house-CCx7nGvv.js";import{S as M}from"./shopping-cart-SIrgk7gU.js";import{D}from"./Drawer-DYUAAZlv.js";import{D as z}from"./DesignCardManager-CMnOvuIU.js";import{M as O}from"./menu--W4bHL6D.js";import{U as j}from"./user-DrELgFUe.js";import{S as C}from"./Input-D4bxWOlL.js";import{T}from"./toastify-AK2YN0jf.js";import{S as F}from"./StoreLogo-DvVsuGMd.js";import{S as N}from"./star-CQC8ihYI.js";import"./Loader-Dvrn4ogS.js";import"./ShineEffect-B9CikJiy.js";import"./createLucideIcon-gPidoUUU.js";import"./x-CdcN8VHc.js";import"./store-d4Qk0Che.js";import"./MyCartButton-BH2KaED5.js";import"./Skeleton-BYb8KvFB.js";import"./Pill-CHeiffHO.js";import"./Popover-DtqKmQ9T.js";import"./Tooltip-Bf4GUCHE.js";import"./image-_IEdZ5tx.js";import"./stringUtils-Bvzw0-oW.js";import"./AddressInput-C4LfeBy4.js";import"./index-Lj-R-X8O.js";import"./Modal-BRr_Y_Xt.js";import"./GoogleMaps-B0GNQ3Cb.js";import"./SelectCountry-B1094ljo.js";import"./Select-DpPW7i7s.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-CMycWXoI.js";import"./move-left-DvTXXlun.js";import"./trash-2-BFE6eHWL.js";import"./plus-DlJccArV.js";import"./link-DQ-4FzK6.js";import"./video-BTs92dO8.js";import"./at-sign-CKTRk3H3.js";import"./chevron-right-ZhwqzcQq.js";import"./arrow-right-BaQgDzYn.js";import"./chevron-down-CnTyXEim.js";import"./chevron-up-lkku-VCR.js";import"./Datepicker-B6eTYTkX.js";import"./Alert-BwYf3M0G.js";import"./circle-check-DKc1TKPe.js";import"./info-D9RPbSCJ.js";import"./arrow-left-DjWGoDbb.js";import"./Switch-aC95xi1h.js";import"./DeliveryTimePicker-CQRagJCD.js";import"./circle-alert-D1pEDTPn.js";import"./circle-check-big-CspulPth.js";import"./Copy-DPmUtyus.js";import"./parsePhoneNumber-xMTQFMCS.js";const H={inject:["storeState","notificationState"],components:{Button:y},data(){return{House:k}},computed:{store(){return this.storeState.store},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)}},methods:{async navigateToStorefront(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-storefront",params:{alias:this.store.alias}})}}};function L(s,e,o,r,n,t){const a=i("Button");return c(),d(a,{size:"sm",type:"bare",leftIcon:n.House,leftIconSize:"18",action:t.navigateToStorefront},null,8,["leftIcon","action"])}const A=u(H,[["render",L]]),W={inject:["storeState"],components:{Button:y},data(){return{ShoppingCart:M}},computed:{store(){return this.storeState.store}},methods:{async navigateToStorefront(){await this.$router.push({name:"show-storefront",params:{alias:this.store.alias}})}}};function P(s,e,o,r,n,t){const a=i("Button");return c(),d(a,{size:"xs",type:"bare",leftIconSize:"18",leftIcon:n.ShoppingCart,action:t.navigateToStorefront},null,8,["leftIcon","action"])}const U=u(W,[["render",P]]),R={inject:["notificationState"],components:{Button:y,Drawer:D,DesignCardManager:z},data(){return{Menu:O}},watch:{isDesigningMenu(s){s?this.$refs.menuDrawer.showDrawer():this.$refs.menuDrawer.hideDrawer()}},computed:{isDesigningMenu(){return this.$route.name=="edit-menu"}},methods:{closeOnX(){this.isDesigningMenu?this.notificationState.showSuccessNotification("Only closes on the actual store"):this.$refs.menuDrawer.hideDrawer()}},mounted(){this.isDesigningMenu&&this.$refs.menuDrawer.showDrawer()}};function E(s,e,o,r,n,t){const a=i("Button"),m=i("DesignCardManager"),f=i("Drawer");return c(),d(f,{position:"left",contentClass:"",ref:"menuDrawer",showFooter:!1,closeOnX:t.closeOnX,scrollOnContent:!1,targetClass:"mockup-phone"},{trigger:b(g=>[l(a,{size:"xs",type:"bare",leftIcon:n.Menu,leftIconSize:"18",action:g.showDrawer},null,8,["leftIcon","action"])]),content:b(()=>[e[0]||(e[0]=h("h3",{class:"font-semibold text-gray-900 border-b border-gray-200 p-4"},"Menu",-1)),l(m,{placement:"menu"})]),_:1},8,["closeOnX"])}const X=u(R,[["render",E]]),V={inject:["authState","storeState","notificationState"],components:{Button:y},data(){return{User:j}},computed:{store(){return this.storeState.store},authUser(){return this.authState.user},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)}},methods:{navigateToStoreHome(){this.$router.push({name:"show-store-home",params:{store_id:this.store.id}})},async navigateToStoreLogin(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-login"})}}},q={class:"ml-1"};function G(s,e,o,r,n,t){const a=i("Button");return c(),d(a,{size:"sm",type:"primary",leftIcon:n.User,leftIconSize:"18",action:t.authUser?t.navigateToStoreHome:t.navigateToStoreLogin},{default:b(()=>[h("span",q,v(t.authUser?"Dashboard":"Login"),1)]),_:1},8,["leftIcon","action"])}const J=u(V,[["render",G]]),K={inject:["storeState","notificationState"],components:{Button:y},data(){return{Search:C}},computed:{store(){return this.storeState.store},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)}},methods:{async navigateToSearch(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-search",params:{alias:this.store.alias}})}}};function Q(s,e,o,r,n,t){const a=i("Button");return c(),d(a,{size:"xs",type:"bare",leftIconSize:"18",leftIcon:n.Search,action:t.navigateToSearch},null,8,["leftIcon","action"])}const Y=u(K,[["render",Q]]),Z={components:{HomeButton:A,CartButton:U,MenuButton:X,LoginButton:J,SearchButton:Y},data(){return{}},computed:{onStorefront(){return["show-storefront","edit-storefront"].includes(this.$route.name)},onSearchPage(){return this.$route.name==="show-search"},onReviewsPage(){return["show-shop-reviews","create-shop-review"].includes(this.$route.name)}},methods:{},created(){}},tt={style:{height:"52px"},class:"relative"},et={class:"fixed top-0 left-0 right-0 z-10 boder-b flex items-center justify-between space-x-2 bg-white shadow px-6 py-2.5 mx-auto"},ot={class:"flex items-center justify-between space-x-4"};function st(s,e,o,r,n,t){const a=i("MenuButton"),m=i("LoginButton"),f=i("HomeButton"),g=i("SearchButton"),p=i("CartButton");return c(),w("div",tt,[h("div",et,[l(a),h("div",ot,[l(m),!t.onStorefront&&!t.onSearchPage&&!t.onReviewsPage?(c(),d(f,{key:0})):S("",!0),!t.onStorefront&&!t.onSearchPage&&!t.onReviewsPage?(c(),d(g,{key:1})):S("",!0),l(p)])])])}const rt=u(Z,[["render",st]]),nt={inject:["notificationState"],watch:{"notifications.length"(s,e){if(s>e){const o=this.notifications[this.notifications.length-1];let r,n;o.type=="success"?(r=`
                            <div class="flex space-x-2 p-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mt-0.5 lucide shrink-0 lucide-circle-check-icon lucide-circle-check"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                                <p>${o.message}</p>
                                <div class="ms-auto">
                                    <button onclick="tostifyCustomClose(this)" type="button" class="inline-flex shrink-0 justify-center items-center size-5 rounded-lg text-green-800 opacity-50 hover:opacity-100 focus:outline-hidden focus:opacity-100 dark:text-white" aria-label="Close">
                                        <span class="sr-only">Close</span>
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                                    </button>
                                </div>
                            </div>
                            `,n="hs-toastify-on:opacity-100 opacity-0 fixed -top-37.5 right-5 z-90 transition-all duration-300 w-80 bg-green-200 text-sm text-green-900 border border-green-900 rounded-lg shadow-lg [&>.toast-close]:hidden dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-400"):o.type=="warning"?(r=`
                            <div class="flex space-x-2 p-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mt-0.5 lucide shrink-0 lucide-triangle-alert-icon lucide-triangle-alert"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>
                                <p>${o.message}</p>
                                <div class="ms-auto">
                                    <button onclick="tostifyCustomClose(this)" type="button" class="inline-flex shrink-0 justify-center items-center size-5 rounded-lg text-yellow-800 opacity-50 hover:opacity-100 focus:outline-hidden focus:opacity-100 dark:text-white" aria-label="Close">
                                        <span class="sr-only">Close</span>
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                                    </button>
                                </div>
                            </div>
                            `,n="hs-toastify-on:opacity-100 opacity-0 fixed -top-37.5 right-5 z-90 transition-all duration-300 w-80 bg-yellow-200 text-sm text-yellow-900 border border-yellow-900 rounded-lg shadow-lg [&>.toast-close]:hidden dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-400"):(r=`
                            <div class="flex space-x-2 p-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mt-0.5 lucide shrink-0 lucide-info-icon lucide-info"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                                <p>${o.message}</p>
                                <div class="ms-auto">
                                    <button onclick="tostifyCustomClose(this)" type="button" class="inline-flex shrink-0 justify-center items-center size-5 rounded-lg text-gray-800 opacity-50 hover:opacity-100 focus:outline-hidden focus:opacity-100 dark:text-white" aria-label="Close">
                                        <span class="sr-only">Close</span>
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                                    </button>
                                </div>
                            </div>
                            `,n="hs-toastify-on:opacity-100 opacity-0 fixed -top-37.5 right-5 z-90 transition-all duration-300 w-80 bg-gray-200 text-sm text-gray-900 border border-gray-900 rounded-lg shadow-lg [&>.toast-close]:hidden dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-400"),T({text:r,close:!0,escapeMarkup:!1,className:n,duration:o.duration}).showToast()}}},computed:{notifications(){return this.notificationState.notifications}},mounted(){window.tostifyCustomClose=function(s){const e=s.closest(".toastify");e&&(e.classList.remove("hs-toastify-on:opacity-100"),e.classList.add("opacity-0","scale-95"),setTimeout(()=>{const o=e.querySelector(".toast-close");o&&o.click()},300))}}};function it(s,e,o,r,n,t){return null}const at=u(nt,[["render",it]]),ct={inject:["storeState"],components:{Home:k,Star:N,Search:C,StoreLogo:F},computed:{store(){return this.storeState.store},isDesigning(){return["edit-storefront","edit-checkout","edit-payment","edit-menu"].includes(this.$route.name)},homeMenuActive(){return this.$route.name=="show-storefront"},searchMenuActive(){return this.$route.name=="show-search"},reviewMenuActive(){return this.$route.name=="show-shop-reviews"||this.$route.name=="create-shop-review"}},methods:{async navigateToStorefront(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-storefront",params:{alias:this.store.alias}})},async navigateToSearch(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-search",params:{alias:this.store.alias}})},async navigateToReviews(){if(this.isDesigning){this.notificationState.showSuccessNotification("Only opens on the actual store");return}await this.$router.push({name:"show-shop-reviews",params:{alias:this.store.alias}})}}},ht={key:0},lt={class:"flex flex-col items-center mb-8 space-y-4"},dt={class:"absolute -bottom-10 border-4 border-white rounded-full"},pt={class:"absolute -bottom-10 border-4 border-white rounded-full"},ut={class:"text-lg md:text-xl font-bold"},mt={class:"select-none flex justify-center mb-4"},ft={class:"text-sm md:text-base"};function gt(s,e,o,r,n,t){const a=i("StoreLogo"),m=i("Home"),f=i("Search"),g=i("Star");return t.store?(c(),w("div",ht,[h("div",lt,[t.store.show_background&&t.store.background_photo?(c(),w("div",{key:0,style:x({backgroundImage:`url(${t.store.background_photo.path})`}),class:"relative w-full flex justify-center min-h-48 mb-16 bg-no-repeat bg-cover bg-center"},[h("div",dt,[l(a,{size:"w-24 h-24",editable:!1,showButton:!1})])],4)):t.store.show_background?(c(),w("div",{key:1,style:x({background:`#${t.store.bg_color}`}),class:"relative w-full flex justify-center min-h-48 mb-16"},[h("div",pt,[l(a,{size:"w-24 h-24",editable:!1,showButton:!1})])],4)):(c(),d(a,{key:2,size:"w-24 h-24",class:"mt-8",editable:!1,showButton:!1})),h("h1",ut,v(t.store.name),1),t.store.description?(c(),w("p",{key:3,class:_(["text-center text-sm md:text-base max-w-xl",t.isDesigning?"px-4":"px-4 lg:px-0"])},v(t.store.description),3)):S("",!0)]),h("div",mt,[h("div",{onClick:e[0]||(e[0]=(...p)=>t.navigateToStorefront&&t.navigateToStorefront(...p)),class:_(["flex items-center space-x-2 py-2 px-4 border-b-4 hover:border-gray-300 transition-all duration-300 cursor-pointer",t.homeMenuActive?"border-gray-300":"border-transparent"])},[l(m,{size:"20"}),e[3]||(e[3]=h("span",{class:"text-sm md:text-base"},"Home",-1))],2),h("div",{onClick:e[1]||(e[1]=(...p)=>t.navigateToSearch&&t.navigateToSearch(...p)),class:_(["flex items-center space-x-2 py-2 px-4 border-b-4 hover:border-gray-300 transition-all duration-300 cursor-pointer",t.searchMenuActive?"border-gray-300":"border-transparent"])},[l(f,{size:"20"}),e[4]||(e[4]=h("span",{class:"text-sm md:text-base"},"Search",-1))],2),h("div",{onClick:e[2]||(e[2]=(...p)=>t.navigateToReviews&&t.navigateToReviews(...p)),class:_(["flex items-center space-x-2 py-2 px-4 border-b-4 hover:border-gray-300 transition-all duration-300 cursor-pointer",t.reviewMenuActive?"border-gray-300":"border-transparent"])},[l(g,{size:"20"}),h("span",ft,"Reviews"+v(t.store.reviews_count?` (${t.store.reviews_count})`:""),1)],2)])])):S("",!0)}const wt=u(ct,[["render",gt]]),St={inject:["formState","orderState","storeState","notificationState"],components:{Menu:rt,WhatsappIcon:I,Header:wt,Notifications:at},data(){return{orderAgain:!1}},watch:{$route(s,e){this.orderAgain=e.name==="show-shop-order"&&s.name==="show-checkout",this.showStore()},orderId(s){const e=this.orderAgain?this.order:null;this.orderState.resetOrderForm(),s?this.showOrder():this.prepareStoreForShopping(e)},orderForm:{handler(){this.canInspectShoppingCart&&(this.orderState.setIsInspectingShoppingCart(!0),this.inspectShoppingCartDelayed())},deep:!0}},computed:{store(){return this.storeState.store},alias(){return this.$route.params.alias||null},orderId(){return this.$route.params.order_id||null},order(){return this.orderState.order},hasOrder(){return this.order!=null},orderForm(){return this.orderState.orderForm},canInspectShoppingCart(){return this.orderState.canInspectShoppingCart},showHeader(){return["show-storefront","show-search","show-shop-reviews","create-shop-review","show-shop-category"].includes(this.$route.name)},showMenu(){return!["show-checkout","show-shop-payment-methods","show-shop-payment-method","show-shop-confirming-payment","show-shop-pending-payment"].includes(this.$route.name)},whatsappMobileNumber(){var s;return((s=this.store)==null?void 0:s.whatsapp_mobile_number)??null}},methods:{openWhatsappChat(){const s=`Hello, i'm interested in what you are selling on ${this.store.name}.`,e=`https://wa.me/?text=${encodeURIComponent(s)}&phone=${this.whatsappMobileNumber.international.replace("+","")}`;console.log(e),window.open(e,"_blank")},async prepareStoreForShopping(s=null){await this.orderState.hasStateFromLocalStorage()?(await this.orderState.setStateFromLocalStorage(),await this.inspectShoppingCart()):s?(this.orderState.setOrderForm(s,!1),this.orderState.canInspectShoppingCart=!0):(this.orderState.setOrderForm(null,!1),setTimeout(()=>{this.orderState.canInspectShoppingCart=!0},1e3))},async showStore(){var s,e;try{this.store||(this.storeState.isLoadingStore=!0);let o={params:{_relationships:["logo","backgroundPhoto","categories","myMembership"].join(","),_countable_relationships:["reviews"].join(",")}},r;if(window.storeId&&!this.alias)r=await axios.get(`/api/stores/${window.storeId}`,o);else if(this.alias)r=await axios.get(`/api/stores/alias/${this.alias}`,o);else return;this.storeState.setStore(r.data),document.body.style.backgroundColor=this.store.bg_color,this.orderId?await this.showOrder():await this.prepareStoreForShopping()}catch(o){const r=((e=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while fetching store";this.notificationState.showWarningNotification(r),this.formState.setServerFormErrors(o),console.error("Failed to fetch store:",o),this.$router.replace({name:"notFound"})}finally{this.storeState.isLoadingStore=!1}},async showOrder(){var s,e,o;try{this.orderState.isLoadingOrder=!0;let r={params:{store_id:this.store.id,_relationships:["orderProducts.photo","orderPromotions","orderFees","orderDiscounts","orderComments","customer","courier","deliveryMethod","deliveryAddress"].join(",")}};const t=(await axios.get(`/api/orders/${this.orderId||this.duplicateOrderId}`,r)).data;this.orderState.setOrder(t)}catch(r){const n=((e=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:e.message)||(r==null?void 0:r.message)||"Something went wrong while fetching order";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(r),console.error("Failed to fetch order:",r),((o=r.response)==null?void 0:o.status)===404&&await this.$router.replace({name:"show-storefront",params:{alias:window.storeId?null:this.store.alias}})}finally{this.orderState.isLoadingOrder=!1}},inspectShoppingCartDelayed:B(function(){this.inspectShoppingCart()},1e3),async inspectShoppingCart(){var s,e;try{this.orderState.setIsInspectingShoppingCart(!0);const o={inspect:!0,...this.orderForm,association:"shopper",store_id:this.store.id},r=await axios.post("/api/orders",o);this.orderState.setShoppingCart(r.data)}catch(o){const r=((e=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while inspecting shopping cart";this.notificationState.showWarningNotification(r),this.formState.setServerFormErrors(o),console.error("Failed to inspect shopping cart:",o)}finally{this.orderState.setIsInspectingShoppingCart(!1),this.orderState.setStateOnLocalStorage()}}},beforeUnmount(){this.orderState.resetOrderForm()},unmounted(){document.body.style.backgroundColor=null},created(){this.store?this.orderId?this.showOrder():this.prepareStoreForShopping():this.showStore()}},yt={class:"relative"};function _t(s,e,o,r,n,t){const a=i("Notifications"),m=i("Menu"),f=i("Header"),g=i("WhatsappIcon"),p=i("router-view");return c(),w("div",yt,[l(a),t.showMenu?(c(),d(m,{key:0})):S("",!0),t.showHeader?(c(),d(f,{key:1})):S("",!0),t.whatsappMobileNumber?(c(),w("div",{key:2,onClick:e[0]||(e[0]=(...$)=>t.openWhatsappChat&&t.openWhatsappChat(...$)),class:"fixed bottom-4 right-4 bg-green-500 hover:opacity-90 hover:scale-110 active:scale-100 transition-all duration-300 cursor-pointer rounded-full p-4 shadow-sm"},[l(g,{size:"w-8 h-8",color:"#ffffff"})])):S("",!0),l(p)])}const be=u(St,[["render",_t]]);export{be as default};
