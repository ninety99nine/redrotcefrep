import{c as a,m as v,F as g,f as x,aa as M,b as s,t as c,k as m,o,e as f,n as b}from"./app-BdtgzR1l.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L={props:{messages:{type:Array,default:()=>[],validator:t=>t.every(e=>typeof e=="object"&&"text"in e&&typeof e.text=="string"&&"sender"in e&&typeof e.sender=="string"&&"timestamp"in e&&typeof e.timestamp=="string"&&"isOwnMessage"in e&&typeof e.isOwnMessage=="boolean"&&(!("nameColor"in e)||typeof e.nameColor=="string")&&(!("attachments"in e)||Array.isArray(e.attachments)&&e.attachments.every(n=>typeof n=="object"&&"name"in n&&typeof n.name=="string"&&"pages"in n&&typeof n.pages=="number"&&"size"in n&&typeof n.size=="number")))},animate:{type:Boolean,default:!1},loopAnimation:{type:Boolean,default:!1},delayBeforeLoop:{type:Number,default:7},typingDuration:{type:Number,default:2e3},replyDelay:{type:Number,default:1500},userInteruptionDelay:{type:Number,default:15e3},scrollDuration:{type:Number,default:1e3}},data(){return{isTyping:!1,typingSender:"",scrollTimeout:null,displayedMessages:[],lastUserScrollTime:0,currentMessageIndex:0,ignoreAutoScrollUntil:0,isProgrammaticScroll:!1}},watch:{messages:{handler(t){this.animate?(this.resetAnimation(),this.animateMessages()):(this.displayedMessages=t,this.isTyping=!1,this.$nextTick(()=>this.scrollToBottom()))},immediate:!0,deep:!0}},methods:{formatMessage(t){return t?t.replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<strong>$1</strong>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/`(.*?)`/g,'<span class="text-xs font-mono p-1 rounded break-all" style="background:#cff4cd;">$1</span>').replace(/\[([^\]]+)\]\(([^\)]+)\)/g,'<a href="$2" target="_blank" class="text-blue-500 underline">$1</a>'):""},resetAnimation(){this.displayedMessages=[],this.currentMessageIndex=0,this.isTyping=!1,this.typingSender="",this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null),this.$nextTick(()=>this.scrollToTop())},smoothScrollTo(t,e,n){if(!t)return;this.isProgrammaticScroll=!0;const u=t.scrollTop,l=e-u,p=performance.now(),i=r=>r<.5?2*r*r:1-Math.pow(-2*r+2,2)/2,h=r=>{const d=r-p,y=Math.min(d/n,1),T=i(y);t.scrollTop=u+l*T,y<1?requestAnimationFrame(h):this.$nextTick(()=>{this.isProgrammaticScroll=!1})};requestAnimationFrame(h)},scrollToBottom(){if(this.$refs.chatContainer&&!this.scrollTimeout){if(Date.now()<this.ignoreAutoScrollUntil)return;const e=this.$refs.chatContainer.scrollHeight-this.$refs.chatContainer.clientHeight;this.smoothScrollTo(this.$refs.chatContainer,e,this.scrollDuration)}},scrollToTop(){if(this.$refs.chatContainer){if(Date.now()<this.ignoreAutoScrollUntil)return;this.smoothScrollTo(this.$refs.chatContainer,0,this.scrollDuration)}},handleUserScroll(){if(this.isProgrammaticScroll||!this.$refs.chatContainer)return;const t=Date.now();this.lastUserScrollTime=t,this.ignoreAutoScrollUntil=t+this.userInteruptionDelay,this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null)},animateMessages(){if(!this.animate||this.currentMessageIndex>=this.messages.length){this.isTyping=!1,this.loopAnimation&&this.animate&&setTimeout(()=>{this.resetAnimation(),this.animateMessages()},this.delayBeforeLoop*1e3);return}const t=this.messages[this.currentMessageIndex];this.isTyping=!0,this.typingSender=t.isOwnMessage?"you are":`${t.sender} is`,this.$nextTick(()=>this.scrollToBottom());const e=this.typingDuration<this.scrollDuration?this.scrollDuration:this.typingDuration;setTimeout(()=>{this.displayedMessages.push(t),this.isTyping=!1,this.currentMessageIndex++,this.$nextTick(()=>this.scrollToBottom());const n=this.replyDelay<this.scrollDuration?this.scrollDuration:this.replyDelay;setTimeout(()=>this.animateMessages(),n)},e)}},mounted(){this.$refs.chatContainer&&(this.$refs.chatContainer.addEventListener("scroll",this.handleUserScroll),this.$refs.chatContainer.addEventListener("wheel",this.handleUserScroll,{passive:!0}),this.$refs.chatContainer.addEventListener("touchstart",this.handleUserScroll,{passive:!0}))},beforeDestroy(){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.$refs.chatContainer){const t=this.$refs.chatContainer;t.removeEventListener("scroll",this.handleUserScroll),t.removeEventListener("wheel",this.handleUserScroll),t.removeEventListener("touchstart",this.handleUserScroll)}this.resetAnimation()}},S={ref:"chatContainer",class:"bg-[#efe9e0] p-4 space-y-4 overflow-y-auto pb-8"},C={key:0,class:"bg-[#d5f4cf] rounded-sm mt-2 space-y-2 p-4 mb-2"},$={class:"h-10",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 100 125",style:{"enable-background":"new 0 0 100 100"},"xml:space":"preserve"},_={class:"text-gray-500 space-x-1"},D=["innerHTML"],k={class:"absolute bottom-1 right-2 flex items-center space-x-1"},A={class:"text-xs text-gray-500"},B={key:0,class:"w-5 h-5 text-blue-500 shrink-0",viewBox:"0 -0.5 25 25",fill:"currentColor"},U={class:"text-sm text-gray-500"};function z(t,e,n,u,l,p){return o(),a("div",S,[(o(!0),a(g,null,x(l.displayedMessages,(i,h)=>(o(),a("div",{key:h,class:m(["flex mb-4 animate-slide-in",i.isOwnMessage?"justify-end":"justify-start"])},[s("div",{class:m(["p-2.5 rounded-lg max-w-xs shadow-md relative",i.isOwnMessage?"bg-[#d9fdd3]":"bg-white"])},[i.attachments&&i.attachments.length?(o(),a("div",C,[(o(!0),a(g,null,x(i.attachments,(r,d)=>(o(),a("div",{class:"flex items-center space-x-2 text-xs",key:d},[(o(),a("svg",$,[...e[0]||(e[0]=[s("g",null,[s("g",null,[s("path",{fill:"#e7000b",d:"M83.7,26.3c0-0.8-0.3-1.6-0.9-2.2L66,6.1c-0.6-0.7-1.5-1-2.4-1h-42c-2.9,0-5.3,2.4-5.3,5.3v79.3c0,2.9,2.4,5.3,5.3,5.3    h56.9c2.9,0,5.3-2.4,5.3-5.3L83.7,26.3z M36.7,71.3h-2.6v3.5c0,0.8-0.4,1.2-1.2,1.2h-1.4c-0.8,0-1.2-0.4-1.2-1.2V62.1    c0-0.8,0.4-1.2,1.2-1.2h5.1c2.9,0,4.9,2.1,4.9,5.2S39.6,71.3,36.7,71.3z M50.2,75.9H46c-0.8,0-1.2-0.4-1.2-1.2V62.1    c0-0.8,0.4-1.2,1.2-1.2h4.2c4.7,0,7.7,2.8,7.7,7.5S54.9,75.9,50.2,75.9z M70.7,62.9c0,0.8-0.4,1.2-1.2,1.2h-4.4v3.1h3.4    c0.8,0,1.2,0.4,1.2,1.2v0.8c0,0.8-0.4,1.2-1.2,1.2h-3.4v4.4c0,0.8-0.4,1.2-1.2,1.2h-1.4c-0.8,0-1.2-0.4-1.2-1.2V62.1    c0-0.8,0.4-1.2,1.2-1.2h6.9c0.8,0,1.2,0.4,1.2,1.2V62.9z M79.1,27.3h-11c-2.9,0-5.3-2.4-5.3-5.3V10.2c0-0.3,0.4-0.4,0.6-0.2    l16,16.7C79.5,26.9,79.4,27.3,79.1,27.3z"}),s("path",{fill:"#e7000b",d:"M36,64.1h-1.9v4.1h1.8c1.3,0,1.9-0.9,1.9-2.1S37.2,64.1,36,64.1z"}),s("path",{fill:"#e7000b",d:"M50,64.1h-1.5v8.7H50c2.5,0,4.1-1.5,4.1-4.4C54.1,65.5,52.5,64.1,50,64.1z"})])],-1)])])),s("div",null,[s("p",null,c(r.name||"Attachment"),1),s("p",_,[s("span",null,c(`${r.pages||1} ${(r.pages||1)==1?"page":"pages"}`),1),e[1]||(e[1]=s("span",null,"â€¢",-1)),s("span",null,c(`${r.size||"250"} KB`),1)])])]))),128))])):f("",!0),i.isOwnMessage?f("",!0):(o(),a("div",{key:1,class:"text-xs font-semibold mb-1",style:b({color:i.nameColor||"#000000"})},c(i.sender),5)),s("div",{class:"text-xs text-gray-700 pb-4 break-words whitespace-pre-wrap",innerHTML:p.formatMessage(i.text)},null,8,D),s("div",k,[s("span",A,c(i.timestamp),1),i.isOwnMessage?(o(),a("svg",B,[...e[2]||(e[2]=[s("path",{d:"M5.03033 11.4697C4.73744 11.1768 4.26256 11.1768 3.96967 11.4697C3.67678 11.7626 3.67678 12.2374 3.96967 12.5303L5.03033 11.4697ZM8.5 16L7.96967 16.5303C8.26256 16.8232 8.73744 16.8232 9.03033 16.5303L8.5 16ZM17.0303 8.53033C17.3232 8.23744 17.3232 7.76256 17.0303 7.46967C16.7374 7.17678 16.2626 7.17678 15.9697 7.46967L17.0303 8.53033ZM9.03033 11.4697C8.73744 11.1768 8.26256 11.1768 7.96967 11.4697C7.67678 11.7626 7.67678 12.2374 7.96967 12.5303L9.03033 11.4697ZM12.5 16L11.9697 16.5303C12.2626 16.8232 12.7374 16.8232 13.0303 16.5303L12.5 16ZM21.0303 8.53033C21.3232 8.23744 21.3232 7.76256 21.0303 7.46967C20.7374 7.17678 20.2626 7.17678 19.9697 7.46967L21.03033 8.53033ZM3.96967 12.5303L7.96967 16.5303L9.03033 15.4697L5.03033 11.4697L3.96967 12.5303ZM9.03033 16.5303L17.0303 8.53033L15.9697 7.46967L7.96967 15.4697L9.03033 16.5303ZM7.96967 12.5303L11.9697 16.5303L13.0303 15.4697L9.03033 11.4697L7.96967 12.5303ZM13.0303 16.5303L21.0303 8.53033L19.9697 7.46967L11.9697 15.4697L13.0303 16.5303Z",fill:"#027bfc"},null,-1)])])):f("",!0)])],2)],2))),128)),v(s("div",{class:m(["flex items-center space-x-2 p-3 bg-[#efe9e0] rounded-lg",l.typingSender==="you are"?"justify-end":"justify-start"])},[s("span",U,c(l.typingSender)+" typing",1),e[3]||(e[3]=s("div",{class:"flex space-x-1"},[s("div",{class:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{"animation-delay":"0s"}}),s("div",{class:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{"animation-delay":"0.2s"}}),s("div",{class:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{"animation-delay":"0.4s"}})],-1))],2),[[M,l.isTyping]])],512)}const O=w(L,[["render",z],["__scopeId","data-v-ca8dd023"]]);export{O as W};
