import{u as Te,c as C,b as r,e as ee,a as J,t as U,F as G,f as ne,D as De,i as Ae,g as de,d as Le,r as ge,o as x,n as Se}from"./app-CAsQYp3T.js";import{I as je}from"./Input-QwDj8T87.js";import{B as ze}from"./Button-Dy6BYOYD.js";import{S as Be}from"./Select-DopDm6jM.js";import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as Ue}from"./circle-alert-BwdAp8OB.js";import{C as Ie}from"./check-BXfc1gjC.js";import{A as Ne}from"./arrow-right-DO5RsmNG.js";import{R as Pe}from"./rotate-ccw-Cm4KXQNh.js";import{A as qe}from"./arrow-left-Cy1iBNmi.js";var ye={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Ve=ye.exports,Fe;function We(){return Fe||(Fe=1,(function(y,i){((p,m)=>{y.exports=m()})(Ve,function p(){var m=typeof self<"u"?self:typeof window<"u"?window:m!==void 0?m:{},c,O=!m.document&&!!m.postMessage,H=m.IS_PAPA_WORKER||!1,te={},ue=0,l={};function K(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var s=ve(t);s.chunkSize=parseInt(s.chunkSize),t.step||t.chunk||(s.chunkSize=null),this._handle=new ke(s),(this._handle.streamer=this)._config=s}).call(this,e),this.parseChunk=function(t,s){var o=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<o){let g=this._config.newline;g||(n=this._config.quoteChar||'"',g=this._handle.guessLineEndings(t,n)),t=[...t.split(g).slice(o)].join(g)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(n=this._config.beforeFirstChunk(t))!==void 0&&(t=n),this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+t,n=(this._partialLine="",this._handle.parse(o,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=n.meta.cursor,o=(this._finished||(this._partialLine=o.substring(t-this._baseIndex),this._baseIndex=t),n&&n.data&&(this._rowCount+=n.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),H)m.postMessage({results:n,workerId:l.WORKER_ID,finished:o});else if(S(this._config.chunk)&&!s){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=n=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!o||!S(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),o||n&&n.meta.paused||this._nextChunk(),n}this._halted=!0},this._sendError=function(t){S(this._config.error)?this._config.error(t):H&&this._config.error&&m.postMessage({workerId:l.WORKER_ID,error:t,finished:!1})}}function b(e){var t;(e=e||{}).chunkSize||(e.chunkSize=l.RemoteChunkSize),K.call(this,e),this._nextChunk=O?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(s){this._input=s,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),O||(t.onload=ae(this._chunkLoaded,this),t.onerror=ae(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!O),this._config.downloadRequestHeaders){var s,o=this._config.downloadRequestHeaders;for(s in o)t.setRequestHeader(s,o[s])}var n;this._config.chunkSize&&(n=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+n));try{t.send(this._config.downloadRequestBody)}catch(g){this._chunkError(g.message)}O&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(s=>(s=s.getResponseHeader("Content-Range"))!==null?parseInt(s.substring(s.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(s){s=t.statusText||s,this._sendError(new Error(s))}}function L(e){(e=e||{}).chunkSize||(e.chunkSize=l.LocalChunkSize),K.call(this,e);var t,s,o=typeof FileReader<"u";this.stream=function(n){this._input=n,s=n.slice||n.webkitSlice||n.mozSlice,o?((t=new FileReader).onload=ae(this._chunkLoaded,this),t.onerror=ae(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var n=this._input,g=(this._config.chunkSize&&(g=Math.min(this._start+this._config.chunkSize,this._input.size),n=s.call(n,this._start,g)),t.readAsText(n,this._config.encoding));o||this._chunkLoaded({target:{result:g}})},this._chunkLoaded=function(n){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(n.target.result)},this._chunkError=function(){this._sendError(t.error)}}function N(e){var t;K.call(this,e=e||{}),this.stream=function(s){return t=s,this._nextChunk()},this._nextChunk=function(){var s,o;if(!this._finished)return s=this._config.chunkSize,t=s?(o=t.substring(0,s),t.substring(s)):(o=t,""),this._finished=!t,this.parseChunk(o)}}function _e(e){K.call(this,e=e||{});var t=[],s=!0,o=!1;this.pause=function(){K.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){K.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(n){this._input=n,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){o&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):s=!0},this._streamData=ae(function(n){try{t.push(typeof n=="string"?n:n.toString(this._config.encoding)),s&&(s=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(g){this._streamError(g)}},this),this._streamError=ae(function(n){this._streamCleanUp(),this._sendError(n)},this),this._streamEnd=ae(function(){this._streamCleanUp(),o=!0,this._streamData("")},this),this._streamCleanUp=ae(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ke(e){var t,s,o,n,g=Math.pow(2,53),z=-g,Y=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Z=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,_=this,T=0,u=0,V=!1,h=!1,v=[],a={data:[],errors:[],meta:{}};function B(w){return e.skipEmptyLines==="greedy"?w.join("").trim()==="":w.length===1&&w[0].length===0}function j(){if(a&&o&&(X("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),o=!1),e.skipEmptyLines&&(a.data=a.data.filter(function(d){return!B(d)})),q()){let d=function(A,M){S(e.transformHeader)&&(A=e.transformHeader(A,M)),v.push(A)};if(a)if(Array.isArray(a.data[0])){for(var w=0;q()&&w<a.data.length;w++)a.data[w].forEach(d);a.data.splice(0,1)}else a.data.forEach(d)}function R(d,A){for(var M=e.header?{}:[],E=0;E<d.length;E++){var I=E,k=d[E],k=(($,f)=>(F=>(e.dynamicTypingFunction&&e.dynamicTyping[F]===void 0&&(e.dynamicTyping[F]=e.dynamicTypingFunction(F)),(e.dynamicTyping[F]||e.dynamicTyping)===!0))($)?f==="true"||f==="TRUE"||f!=="false"&&f!=="FALSE"&&((F=>{if(Y.test(F)&&(F=parseFloat(F),z<F&&F<g))return 1})(f)?parseFloat(f):Z.test(f)?new Date(f):f===""?null:f):f)(I=e.header?E>=v.length?"__parsed_extra":v[E]:I,k=e.transform?e.transform(k,I):k);I==="__parsed_extra"?(M[I]=M[I]||[],M[I].push(k)):M[I]=k}return e.header&&(E>v.length?X("FieldMismatch","TooManyFields","Too many fields: expected "+v.length+" fields but parsed "+E,u+A):E<v.length&&X("FieldMismatch","TooFewFields","Too few fields: expected "+v.length+" fields but parsed "+E,u+A)),M}var D;a&&(e.header||e.dynamicTyping||e.transform)&&(D=1,!a.data.length||Array.isArray(a.data[0])?(a.data=a.data.map(R),D=a.data.length):a.data=R(a.data,0),e.header&&a.meta&&(a.meta.fields=v),u+=D)}function q(){return e.header&&v.length===0}function X(w,R,D,d){w={type:w,code:R,message:D},d!==void 0&&(w.row=d),a.errors.push(w)}S(e.step)&&(n=e.step,e.step=function(w){a=w,q()?j():(j(),a.data.length!==0&&(T+=w.data.length,e.preview&&T>e.preview?s.abort():(a.data=a.data[0],n(a,_))))}),this.parse=function(w,R,D){var d=e.quoteChar||'"',d=(e.newline||(e.newline=this.guessLineEndings(w,d)),o=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(w),a.meta.delimiter=e.delimiter):((d=((A,M,E,I,k)=>{var $,f,F,le;k=k||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var ce=0;ce<k.length;ce++){for(var se,pe=k[ce],W=0,re=0,P=0,Q=(F=void 0,new be({comments:I,delimiter:pe,newline:M,preview:10}).parse(A)),oe=0;oe<Q.data.length;oe++)E&&B(Q.data[oe])?P++:(se=Q.data[oe].length,re+=se,F===void 0?F=se:0<se&&(W+=Math.abs(se-F),F=se));0<Q.data.length&&(re/=Q.data.length-P),(f===void 0||W<=f)&&(le===void 0||le<re)&&1.99<re&&(f=W,$=pe,le=re)}return{successful:!!(e.delimiter=$),bestDelimiter:$}})(w,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=d.bestDelimiter:(o=!0,e.delimiter=l.DefaultDelimiter),a.meta.delimiter=e.delimiter),ve(e));return e.preview&&e.header&&d.preview++,t=w,s=new be(d),a=s.parse(t,R,D),j(),V?{meta:{paused:!0}}:a||{meta:{paused:!1}}},this.paused=function(){return V},this.pause=function(){V=!0,s.abort(),t=S(e.chunk)?"":t.substring(s.getCharIndex())},this.resume=function(){_.streamer._halted?(V=!1,_.streamer.parseChunk(t,!0)):setTimeout(_.resume,3)},this.aborted=function(){return h},this.abort=function(){h=!0,s.abort(),a.meta.aborted=!0,S(e.complete)&&e.complete(a),t=""},this.guessLineEndings=function(A,d){A=A.substring(0,1048576);var d=new RegExp(fe(d)+"([^]*?)"+fe(d),"gm"),D=(A=A.replace(d,"")).split("\r"),d=A.split(`
`),A=1<d.length&&d[0].length<D[0].length;if(D.length===1||A)return`
`;for(var M=0,E=0;E<D.length;E++)D[E][0]===`
`&&M++;return M>=D.length/2?`\r
`:"\r"}}function fe(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function be(e){var t=(e=e||{}).delimiter,s=e.newline,o=e.comments,n=e.step,g=e.preview,z=e.fastMode,Y=null,Z=!1,_=e.quoteChar==null?'"':e.quoteChar,T=_;if(e.escapeChar!==void 0&&(T=e.escapeChar),(typeof t!="string"||-1<l.BAD_DELIMITERS.indexOf(t))&&(t=","),o===t)throw new Error("Comment character same as delimiter");o===!0?o="#":(typeof o!="string"||-1<l.BAD_DELIMITERS.indexOf(o))&&(o=!1),s!==`
`&&s!=="\r"&&s!==`\r
`&&(s=`
`);var u=0,V=!1;this.parse=function(h,v,a){if(typeof h!="string")throw new Error("Input must be a string");var B=h.length,j=t.length,q=s.length,X=o.length,w=S(n),R=[],D=[],d=[],A=u=0;if(!h)return W();if(z||z!==!1&&h.indexOf(_)===-1){for(var M=h.split(s),E=0;E<M.length;E++){if(d=M[E],u+=d.length,E!==M.length-1)u+=s.length;else if(a)return W();if(!o||d.substring(0,X)!==o){if(w){if(R=[],le(d.split(t)),re(),V)return W()}else le(d.split(t));if(g&&g<=E)return R=R.slice(0,g),W(!0)}}return W()}for(var I=h.indexOf(t,u),k=h.indexOf(s,u),$=new RegExp(fe(T)+fe(_),"g"),f=h.indexOf(_,u);;)if(h[u]===_)for(f=u,u++;;){if((f=h.indexOf(_,f+1))===-1)return a||D.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:R.length,index:u}),se();if(f===B-1)return se(h.substring(u,f).replace($,_));if(_===T&&h[f+1]===T)f++;else if(_===T||f===0||h[f-1]!==T){I!==-1&&I<f+1&&(I=h.indexOf(t,f+1));var F=ce((k=k!==-1&&k<f+1?h.indexOf(s,f+1):k)===-1?I:Math.min(I,k));if(h.substr(f+1+F,j)===t){d.push(h.substring(u,f).replace($,_)),h[u=f+1+F+j]!==_&&(f=h.indexOf(_,u)),I=h.indexOf(t,u),k=h.indexOf(s,u);break}if(F=ce(k),h.substring(f+1+F,f+1+F+q)===s){if(d.push(h.substring(u,f).replace($,_)),pe(f+1+F+q),I=h.indexOf(t,u),f=h.indexOf(_,u),w&&(re(),V))return W();if(g&&R.length>=g)return W(!0);break}D.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:R.length,index:u}),f++}}else if(o&&d.length===0&&h.substring(u,u+X)===o){if(k===-1)return W();u=k+q,k=h.indexOf(s,u),I=h.indexOf(t,u)}else if(I!==-1&&(I<k||k===-1))d.push(h.substring(u,I)),u=I+j,I=h.indexOf(t,u);else{if(k===-1)break;if(d.push(h.substring(u,k)),pe(k+q),w&&(re(),V))return W();if(g&&R.length>=g)return W(!0)}return se();function le(P){R.push(P),A=u}function ce(P){var Q=0;return Q=P!==-1&&(P=h.substring(f+1,P))&&P.trim()===""?P.length:Q}function se(P){return a||(P===void 0&&(P=h.substring(u)),d.push(P),u=B,le(d),w&&re()),W()}function pe(P){u=P,le(d),d=[],k=h.indexOf(s,u)}function W(P){if(e.header&&!v&&R.length&&!Z){var Q=R[0],oe=Object.create(null),we=new Set(Q);let Re=!1;for(let he=0;he<Q.length;he++){let ie=Q[he];if(oe[ie=S(e.transformHeader)?e.transformHeader(ie,he):ie]){let me,Ee=oe[ie];for(;me=ie+"_"+Ee,Ee++,we.has(me););we.add(me),Q[he]=me,oe[ie]++,Re=!0,(Y=Y===null?{}:Y)[me]=ie}else oe[ie]=1,Q[he]=ie;we.add(ie)}Re&&console.warn("Duplicate headers found and renamed."),Z=!0}return{data:R,errors:D,meta:{delimiter:t,linebreak:s,aborted:V,truncated:!!P,cursor:A+(v||0),renamedHeaders:Y}}}function re(){n(W()),R=[],D=[]}},this.abort=function(){V=!0},this.getCharIndex=function(){return u}}function Oe(e){var t=e.data,s=te[t.workerId],o=!1;if(t.error)s.userError(t.error,t.file);else if(t.results&&t.results.data){var n={abort:function(){o=!0,xe(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Ce,resume:Ce};if(S(s.userStep)){for(var g=0;g<t.results.data.length&&(s.userStep({data:t.results.data[g],errors:t.results.errors,meta:t.results.meta},n),!o);g++);delete t.results}else S(s.userChunk)&&(s.userChunk(t.results,n,t.file),delete t.results)}t.finished&&!o&&xe(t.workerId,t.results)}function xe(e,t){var s=te[e];S(s.userComplete)&&s.userComplete(t),s.terminate(),delete te[e]}function Ce(){throw new Error("Not implemented.")}function ve(e){if(typeof e!="object"||e===null)return e;var t,s=Array.isArray(e)?[]:{};for(t in e)s[t]=ve(e[t]);return s}function ae(e,t){return function(){e.apply(t,arguments)}}function S(e){return typeof e=="function"}return l.parse=function(e,t){var s=(t=t||{}).dynamicTyping||!1;if(S(s)&&(t.dynamicTypingFunction=s,s={}),t.dynamicTyping=s,t.transform=!!S(t.transform)&&t.transform,!t.worker||!l.WORKERS_SUPPORTED)return s=null,l.NODE_STREAM_INPUT,typeof e=="string"?(e=(o=>o.charCodeAt(0)!==65279?o:o.slice(1))(e),s=new(t.download?b:N)(t)):e.readable===!0&&S(e.read)&&S(e.on)?s=new _e(t):(m.File&&e instanceof File||e instanceof Object)&&(s=new L(t)),s.stream(e);(s=(()=>{var o;return!!l.WORKERS_SUPPORTED&&(o=(()=>{var n=m.URL||m.webkitURL||null,g=p.toString();return l.BLOB_URL||(l.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",g,")();"],{type:"text/javascript"})))})(),(o=new m.Worker(o)).onmessage=Oe,o.id=ue++,te[o.id]=o)})()).userStep=t.step,s.userChunk=t.chunk,s.userComplete=t.complete,s.userError=t.error,t.step=S(t.step),t.chunk=S(t.chunk),t.complete=S(t.complete),t.error=S(t.error),delete t.worker,s.postMessage({input:e,config:t,workerId:s.id})},l.unparse=function(e,t){var s=!1,o=!0,n=",",g=`\r
`,z='"',Y=z+z,Z=!1,_=null,T=!1,u=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||l.BAD_DELIMITERS.filter(function(v){return t.delimiter.indexOf(v)!==-1}).length||(n=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(s=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(Z=t.skipEmptyLines),typeof t.newline=="string"&&(g=t.newline),typeof t.quoteChar=="string"&&(z=t.quoteChar),typeof t.header=="boolean"&&(o=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}t.escapeChar!==void 0&&(Y=t.escapeChar+z),t.escapeFormulae instanceof RegExp?T=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(T=/^[=+\-@\t\r].*$/)}})(),new RegExp(fe(z),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return V(null,e,Z);if(typeof e[0]=="object")return V(_||Object.keys(e[0]),e,Z)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||_),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),V(e.fields||[],e.data||[],Z);throw new Error("Unable to serialize unrecognized input");function V(v,a,B){var j="",q=(typeof v=="string"&&(v=JSON.parse(v)),typeof a=="string"&&(a=JSON.parse(a)),Array.isArray(v)&&0<v.length),X=!Array.isArray(a[0]);if(q&&o){for(var w=0;w<v.length;w++)0<w&&(j+=n),j+=h(v[w],w);0<a.length&&(j+=g)}for(var R=0;R<a.length;R++){var D=(q?v:a[R]).length,d=!1,A=q?Object.keys(a[R]).length===0:a[R].length===0;if(B&&!q&&(d=B==="greedy"?a[R].join("").trim()==="":a[R].length===1&&a[R][0].length===0),B==="greedy"&&q){for(var M=[],E=0;E<D;E++){var I=X?v[E]:E;M.push(a[R][I])}d=M.join("").trim()===""}if(!d){for(var k=0;k<D;k++){0<k&&!A&&(j+=n);var $=q&&X?v[k]:k;j+=h(a[R][$],k)}R<a.length-1&&(!B||0<D&&!A)&&(j+=g)}}return j}function h(v,a){var B,j;return v==null?"":v.constructor===Date?JSON.stringify(v).slice(1,25):(j=!1,T&&typeof v=="string"&&T.test(v)&&(v="'"+v,j=!0),B=v.toString().replace(u,Y),(j=j||s===!0||typeof s=="function"&&s(v,a)||Array.isArray(s)&&s[a]||((q,X)=>{for(var w=0;w<X.length;w++)if(-1<q.indexOf(X[w]))return!0;return!1})(B,l.BAD_DELIMITERS)||-1<B.indexOf(n)||B.charAt(0)===" "||B.charAt(B.length-1)===" ")?z+B+z:B)}},l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!O&&!!m.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=be,l.ParserHandle=ke,l.NetworkStreamer=b,l.FileStreamer=L,l.StringStreamer=N,l.ReadableStreamStreamer=_e,m.jQuery&&((c=m.jQuery).fn.parse=function(e){var t=e.config||{},s=[];return this.each(function(g){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&m.FileReader)||!this.files||this.files.length===0)return!0;for(var z=0;z<this.files.length;z++)s.push({file:this.files[z],inputElem:this,instanceConfig:c.extend({},t)})}),o(),this;function o(){if(s.length===0)S(e.complete)&&e.complete();else{var g,z,Y,Z,_=s[0];if(S(e.before)){var T=e.before(_.file,_.inputElem);if(typeof T=="object"){if(T.action==="abort")return g="AbortError",z=_.file,Y=_.inputElem,Z=T.reason,void(S(e.error)&&e.error({name:g},z,Y,Z));if(T.action==="skip")return void n();typeof T.config=="object"&&(_.instanceConfig=c.extend(_.instanceConfig,T.config))}else if(T==="skip")return void n()}var u=_.instanceConfig.complete;_.instanceConfig.complete=function(V){S(u)&&u(V,_.file,_.inputElem),n()},l.parse(_.file,_.instanceConfig)}}function n(){s.splice(0,1),o()}}),H&&(m.onmessage=function(e){e=e.data,l.WORKER_ID===void 0&&e&&(l.WORKER_ID=e.workerId),typeof e.input=="string"?m.postMessage({workerId:l.WORKER_ID,results:l.parse(e.input,e.config),finished:!0}):(m.File&&e.input instanceof File||e.input instanceof Object)&&(e=l.parse(e.input,e.config))&&m.postMessage({workerId:l.WORKER_ID,results:e,finished:!0})}),(b.prototype=Object.create(K.prototype)).constructor=b,(L.prototype=Object.create(K.prototype)).constructor=L,(N.prototype=Object.create(N.prototype)).constructor=N,(_e.prototype=Object.create(K.prototype)).constructor=_e,l})})(ye)),ye.exports}var Ke=We();const He=Te(Ke),Qe={inject:["notificationState"],components:{Check:Ie,CircleAlert:Ue,Input:je,Button:ze,Select:Be},props:{heading:{type:String,default:"Import"},instruction:{type:String,default:null},submitButtonText:{type:String,default:"Import"},sampleFile:{type:String,default:"csvsexample.csv"},endpoint:{type:String,default:"/api/example/import"},formData:{type:Object,default:()=>{}},columns:{type:Array,default:()=>[]},goBack:{type:Function,default:null},goBackButtonText:{type:String,default:"Go Back"},fileName:{type:String,default:"example"}},emits:["imported"],data(){return{Check:Ie,step:1,ArrowLeft:qe,RotateCcw:Pe,ArrowRight:Ne,csvFile:[],csvColumns:[],imported:!1,parsedCsvData:[],failedImports:[],csvFileReady:!1,steps:[{name:"Upload"},{name:"Map Columns"},{name:"Review"}]}},watch:{csvFile(y){if(y.length>0){const i=y[0].file_ref;i.type==="text/csv"||i.name.toLowerCase().endsWith(".csv")?(this.step=2,this.parseCsvFile(i),this.csvFileReady=!0):(this.notificationState.showWarningNotification("Please upload a valid CSV file."),this.csvFileReady=!1,this.csvFile=[])}else this.csvFileReady=!1}},computed:{columnOptions(){return this.columns.map(y=>({label:y.name,value:y.name.toLowerCase()}))},includedColumns(){const y=this.csvColumns.filter(i=>i.include&&i.mappedTo).map(i=>i.mappedTo);return this.columns.filter(i=>y.includes(i.name.toLowerCase()))},mappedRows(){return this.parsedCsvData.slice(1).map(y=>{const i={};return this.csvColumns.forEach((p,m)=>{p.include&&p.mappedTo&&(i[p.mappedTo]=y[m]||"")}),i})},failedMappedRows(){return this.failedImports.map(y=>{const i=this.parsedCsvData[y.row]||[],p={};return this.csvColumns.forEach((m,c)=>{m.include&&m.mappedTo&&(p[m.mappedTo]=i[c]||"")}),{row:y.row,messages:y.messages,...p}})}},methods:{reset(){this.step=1,this.csvFile=[],this.csvColumns=[],this.imported=!1,this.parsedCsvData=[],this.csvFileReady=!1},parseCsvFile(y){He.parse(y,{complete:i=>{if(i.data.length>0){const p=i.data[0],m=i.data[1]||[];this.csvColumns=p.map((c,O)=>({name:c,sample:m[O]||"",mappedTo:this.autoMapColumn(c),include:!0})),this.parsedCsvData=i.data,this.step=2}else this.notificationState.showWarningNotification("The CSV file is empty or invalid."),this.csvFile=[],this.csvFileReady=!1},header:!1,skipEmptyLines:!0,error:()=>{this.notificationState.showWarningNotification("Error parsing CSV file."),this.csvFile=[],this.csvFileReady=!1}})},autoMapColumn(y){const i=y.toLowerCase(),p=this.columnOptions.find(m=>m.value===i||m.label.toLowerCase()===y.toLowerCase());return p?p.value:""},escapeCsvValue(y){return y==null?"":(y=String(y),y=y.replace(/"/g,'""'),/[",\n]/.test(y)&&(y=`"${y}"`),y)},async importCsvFile(){var y,i;try{if(this.isImporting)return;this.isImporting=!0;const p=this.includedColumns.map(l=>l.name),m=this.mappedRows.map(l=>p.map(K=>this.escapeCsvValue(l[K.toLowerCase()])).join(",")),c=[p.join(","),...m].join(`
`),O=new FormData,H=new Blob([c],{type:"text/csv"});O.append("file",H,`${this.fileName}.csv`),Object.entries(this.formData).forEach(([l,K])=>{O.append(l,K)});const te={headers:{"Content-Type":"multipart/form-data"}},ue=await axios.post(this.endpoint,O,te);this.imported=!0,this.failedImports=ue.data.errors,this.notificationState.showSuccessNotification(ue.data.message),this.$emit("imported")}catch(p){const m=((i=(y=p==null?void 0:p.response)==null?void 0:y.data)==null?void 0:i.message)||(p==null?void 0:p.message)||"Something went wrong while importing products";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(p),console.error("Failed to import products:",p),this.imported=!1}finally{this.isImporting=!1}}}},Je={class:"pt-24 px-8 relative select-none"},Ge={class:"relative bg-white/80 p-4 rounded-md mb-60"},Ye={class:"flex items-center space-x-4 mb-4"},Ze={class:"text-lg text-gray-700 font-semibold"},Xe={class:"w-full flex items-center justify-center space-x-4 text-sm font-medium text-center text-gray-500 mb-8"},$e={class:"flex items-center space-x-2"},et={key:0,class:"flex w-8 h-8 items-center justify-center rounded-full text-white bg-blue-500"},tt={key:0},st={class:"grid grid-cols-2 gap-8"},rt={class:"col-span-1 border border-gray-300 rounded-lg p-4"},it={class:"flex flex-col justify-center h-full"},nt={class:"text-sm mb-4"},ot=["href"],at={key:0,class:"text-sm mb-4"},lt={class:"col-span-1 border border-gray-300 rounded-lg"},ut={class:"max-h-80 overflow-auto rounded-b-lg"},dt={class:"text-sm"},ct={class:"flex items-center space-x-2"},ht={key:0,class:"flex w-4 h-4 items-center justify-center rounded-full text-white bg-blue-500"},ft={key:1,class:"text-xs italic"},pt={key:0,class:"flex justify-end mt-4"},mt={class:"border border-gray-300 rounded-lg"},gt={class:"max-h-96 overflow-auto pt-4 pb-8"},_t={class:"text-sm"},yt={class:"text-sm truncate"},bt={class:"flex justify-end space-x-2 mt-4 mb-20"},vt={class:"w-full max-h-96 overflow-auto border border-blue-200 rounded-lg"},wt={class:"w-full text-left"},kt={class:"text-sm bg-blue-50"},xt={class:"text-sm text-center whitespace-nowrap p-3 border border-gray-200"},Ct={class:"flex justify-end space-x-2 mt-4 mb-20"},Rt={key:3,class:"w-full bg-gray-50 border border-gray-300 rounded-lg py-20"},Et={class:"flex items-center justify-center mx-auto w-20 h-20 rounded-full text-white bg-green-500 mb-4"},St={class:"flex items-center justify-center mx-auto space-x-2"},It={key:0,class:"mx-4 mt-8"},Ft={class:"flex items-center justify-center space-x-2 pt-4 mb-4 border-t border-gray-300 border-dashed"},Ot={class:"text-sm font-bold"},Tt={class:"w-full max-h-96 overflow-auto border border-blue-200 rounded-lg"},Dt={class:"w-full text-left"},At={class:"text-sm bg-blue-50"},Lt={class:"text-sm text-center whitespace-nowrap p-3 border border-gray-200"},jt={class:"text-sm text-red-500 p-3 border border-gray-200"};function zt(y,i,p,m,c,O){const H=ge("Button"),te=ge("Check"),ue=ge("Input"),l=ge("Select"),K=ge("CircleAlert");return x(),C("div",Je,[i[17]||(i[17]=r("img",{src:"/images/clouds.png",class:"absolute bottom-0"},null,-1)),r("div",Ge,[r("div",Ye,[J(H,{size:"sm",type:"light",action:p.goBack,leftIcon:c.ArrowLeft},null,8,["action","leftIcon"]),r("h1",Ze,U(p.heading),1)]),r("div",Xe,[(x(!0),C(G,null,ne(c.steps,(b,L)=>(x(),C(G,{key:L},[r("div",$e,[c.step>L+1?(x(),C("div",et,[J(te,{size:"16"})])):(x(),C("div",{key:1,class:Se(["flex w-8 h-8 items-center justify-center rounded-full",c.step===L+1?"bg-blue-100 border border-blue-300 text-blue-500 animate-pulse":"bg-white border border-gray-300"])},[r("span",null,U(L+1),1)],2)),r("span",null,U(b.name),1)]),L<c.steps.length-1?(x(),C("div",tt,[...i[3]||(i[3]=[r("div",{class:"w-20 border-t"},null,-1)])])):ee("",!0)],64))),128))]),c.step==1?(x(),C(G,{key:0},[r("div",st,[r("div",rt,[r("div",it,[i[5]||(i[5]=r("p",{class:"font-bold mb-4"},"Upload CSV",-1)),r("p",nt,[i[4]||(i[4]=Ae("Start by downloading our ",-1)),r("a",{href:p.sampleFile,target:"_blank",class:"cursor-pointer text-blue-500 hover:underline"},"sample CSV template",8,ot)]),De(y.$slots,"instruction",{},()=>[p.instruction?(x(),C("span",at,U(p.instruction),1)):ee("",!0)]),J(ue,{type:"file",maxFiles:1,modelValue:c.csvFile,"onUpdate:modelValue":i[0]||(i[0]=b=>c.csvFile=b),mimeTypes:["text/csv"],imagePreviewGridCols:1,onRetryUploads:i[1]||(i[1]=b=>null),onRetryUpload:i[2]||(i[2]=(b,L)=>null),placeholder:"Click or Drag & Drop CSV template"},null,8,["modelValue"])])]),r("div",lt,[i[6]||(i[6]=r("div",{class:"grid grid-cols-2 gap-8 py-2 px-4 bg-gray-100 rounded-t-lg text-sm font-bold"},[r("div",null,[r("span",null,"Expected Column")]),r("div",null,[r("span",null,"Required")])],-1)),r("div",ut,[(x(!0),C(G,null,ne(p.columns,(b,L)=>(x(),C("div",{key:L,class:Se(["grid grid-cols-2 gap-8 py-1.5 px-4",b.required?"bg-blue-50":"hover:bg-gray-100"])},[r("div",null,[r("span",dt,U(b.name),1)]),r("div",ct,[b.required?(x(),C("div",ht,[J(te,{size:"10"})])):ee("",!0),b.instruction?(x(),C("span",ft,U(b.instruction),1)):ee("",!0)])],2))),128))])])]),c.csvFileReady?(x(),C("div",pt,[J(H,{size:"sm",type:"primary",rightIcon:c.ArrowRight,action:()=>c.step=2},{default:de(()=>[...i[7]||(i[7]=[r("span",null,"Continue",-1)])]),_:1},8,["rightIcon","action"])])):ee("",!0)],64)):ee("",!0),c.step==2?(x(),C(G,{key:1},[r("div",mt,[i[8]||(i[8]=r("div",{class:"grid grid-cols-4 gap-4 py-2 px-4 bg-gray-100 rounded-t-lg text-sm font-bold"},[r("div",null,[r("span",null,"Your CSV Column")]),r("div",null,[r("span",null,"Your Sample Data")]),r("div",null,[r("span",null,"Destination Column")]),r("div",null,[r("span",null,"Include")])],-1)),r("div",gt,[(x(!0),C(G,null,ne(c.csvColumns,(b,L)=>(x(),C("div",{key:L,class:"grid grid-cols-4 gap-4 py-1.5 px-4 hover:bg-gray-100 items-center"},[r("div",_t,U(b.name),1),r("div",yt,U(b.sample),1),r("div",null,[J(l,{search:!0,options:O.columnOptions,modelValue:b.mappedTo,"onUpdate:modelValue":N=>b.mappedTo=N},null,8,["options","modelValue","onUpdate:modelValue"])]),r("div",null,[J(ue,{type:"checkbox",modelValue:b.include,"onUpdate:modelValue":N=>b.include=N},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),r("div",bt,[J(H,{size:"sm",type:"light",leftIcon:c.ArrowLeft,action:()=>c.step=1},{default:de(()=>[...i[9]||(i[9]=[r("span",null,"Back",-1)])]),_:1},8,["leftIcon","action"]),J(H,{size:"sm",type:"primary",rightIcon:c.ArrowRight,action:()=>c.step=3},{default:de(()=>[...i[10]||(i[10]=[r("span",null,"Continue",-1)])]),_:1},8,["rightIcon","action"])])],64)):ee("",!0),c.step==3&&!c.imported?(x(),C(G,{key:2},[r("div",vt,[r("table",wt,[r("thead",kt,[r("tr",null,[i[11]||(i[11]=r("th",{scope:"col",class:"text-sm text-center whitespace-nowrap p-3 border border-gray-200"},[r("div",null,"Row")],-1)),(x(!0),C(G,null,ne(O.includedColumns,b=>(x(),C("th",{scope:"col",key:b.name,class:"text-sm whitespace-nowrap p-3 border border-gray-200"},[r("div",null,U(b.name),1)]))),128))])]),r("tbody",null,[(x(!0),C(G,null,ne(O.mappedRows,(b,L)=>(x(),C("tr",{key:L,class:"hover:bg-gray-100"},[r("td",xt,U(L+1),1),(x(!0),C(G,null,ne(O.includedColumns,N=>(x(),C("td",{key:N.name,class:"text-sm whitespace-nowrap p-3 border border-gray-200"},U(b[N.name.toLowerCase()]||""),1))),128))]))),128))])])]),r("div",Ct,[J(H,{size:"sm",type:"light",leftIcon:c.ArrowLeft,action:()=>c.step=2},{default:de(()=>[...i[12]||(i[12]=[r("span",null,"Back",-1)])]),_:1},8,["leftIcon","action"]),J(H,{size:"sm",type:"primary",leftIcon:c.Check,action:O.importCsvFile},{default:de(()=>[r("span",null,U(p.submitButtonText),1)]),_:1},8,["leftIcon","action"])])],64)):ee("",!0),c.step==3&&c.imported?(x(),C("div",Rt,[r("div",Et,[J(te,{size:"40"})]),i[16]||(i[16]=r("p",{class:"w-fit mx-auto text-sm font-bold mb-10"},"Import Successful",-1)),r("div",St,[p.goBack?(x(),Le(H,{key:0,size:"sm",type:"light",action:p.goBack},{default:de(()=>[r("span",null,U(p.goBackButtonText),1)]),_:1},8,["action"])):ee("",!0),J(H,{size:"sm",type:"primary",action:O.reset,leftIcon:c.RotateCcw},{default:de(()=>[...i[13]||(i[13]=[r("span",null,"Upload Another File",-1)])]),_:1},8,["action","leftIcon"])]),c.failedImports.length?(x(),C("div",It,[r("div",Ft,[J(K,{size:"16"}),r("p",Ot,"Failed Imports ("+U(c.failedImports.length)+" / "+U(O.mappedRows.length)+")",1)]),r("div",Tt,[r("table",Dt,[r("thead",At,[r("tr",null,[i[14]||(i[14]=r("th",{scope:"col",class:"text-sm text-center whitespace-nowrap p-3 border border-gray-200"},[r("div",null,"Row")],-1)),i[15]||(i[15]=r("th",{scope:"col",class:"text-sm whitespace-nowrap p-3 border border-gray-200"},[r("div",null,"Error Messages")],-1)),(x(!0),C(G,null,ne(O.includedColumns,b=>(x(),C("th",{scope:"col",key:b.name,class:"text-sm whitespace-nowrap p-3 border border-gray-200"},[r("div",null,U(b.name),1)]))),128))])]),r("tbody",null,[(x(!0),C(G,null,ne(O.failedMappedRows,(b,L)=>(x(),C("tr",{key:L,class:"hover:bg-gray-100"},[r("td",Lt,U(b.row),1),r("td",jt,[r("ul",null,[(x(!0),C(G,null,ne(b.messages,N=>(x(),C("li",{key:N,class:"whitespace-nowrap"},U(N),1))),128))])]),(x(!0),C(G,null,ne(O.includedColumns,N=>(x(),C("td",{key:N.name,class:"text-sm whitespace-nowrap p-3 border border-gray-200"},U(b[N.name.toLowerCase()]||""),1))),128))]))),128))])])])])):ee("",!0)])):ee("",!0)])])}const Qt=Me(Qe,[["render",zt]]);export{Qt as I};
