import{I as y}from"./Input-Ch5FVRoG.js";import{B as _}from"./Button-0Fhg4Aii.js";import{S as x}from"./StoreLogo-CCMzoP_5.js";import{W as w}from"./WhatsappIcon-DCsw6v1H.js";import{S as C}from"./SelectCountry-CJD2sKOm.js";import{a as E,i as V}from"./stringUtils-Bvzw0-oW.js";import{S as T}from"./SelectCurrency-DwoQPb2T.js";import{c as v,b as r,d as B,e as k,a as l,g as p,r as n,o as f}from"./app-811fDb4C.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as W}from"./earth-Bakm81YW.js";import{M as I}from"./move-left-C1am2jSW.js";import"./Copy-XiSIbjW8.js";import"./ShineEffect-BW3gyXUb.js";import"./createLucideIcon-JVTSwxMK.js";import"./Popover-DfwFh9bM.js";import"./Tooltip-5EEAR2_1.js";import"./Skeleton-DGkj9lRL.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-fYK0zSuq.js";import"./circle-check-Ci8AvIUe.js";import"./circle-alert-DdTgr82K.js";import"./x-WVuudoOP.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-DjUD9LDC.js";import"./plus-BU4OPlaU.js";import"./Select-B89KxZtb.js";const N={inject:["authState","storeState","formState","notificationState"],components:{Earth:W,Input:y,Button:_,StoreLogo:x,WhatsappIcon:w,SelectCountry:C,SelectCurrency:T},data(){return{MoveLeft:I,form:{name:"",alias:"",country:"BW",currency:"BWP",whatsapp_mobile_number:""},logo:null,aliasModified:!1,isCreatingStore:!1}},computed:{canGoBackToDashboard(){var s;return((s=this.$route.query)==null?void 0:s.can_go_back)==1}},methods:{isEmpty:V,isNotEmpty:E,syncWithAlias(){this.aliasModified==!1&&(this.form.alias=this.form.name,this.formatAlias())},formatAlias(s=!1){this.form.alias.length?(this.form.alias=this.form.alias.replace(/[^a-zA-Z0-9\s-]/g,"").replace(/\s+/g,"-").trim().toLowerCase(),this.aliasModified=s):this.aliasModified=!1},handleSelectedFile(s){this.logo=s},navigateToShowStores(){this.$router.push({name:"show-stores"})},async createStore(){var s,e;try{if(this.isCreatingStore||(this.formState.hideFormErrors(),this.isEmpty(this.form.name)&&this.formState.setFormError("name","Enter store name"),this.formState.hasErrors))return;this.isCreatingStore=!0;let t=new FormData;t.append("return",1),t.append("name",this.form.name),t.append("country",this.form.country),t.append("currency",this.form.currency),this.isNotEmpty(this.form.alias)&&t.append("alias",this.form.alias.trim()),this.isNotEmpty(this.form.whatsapp_mobile_number)&&t.append("whatsapp_mobile_number",this.form.whatsapp_mobile_number.trim()),this.logo&&t.append("logo",this.logo);const m={headers:{"Content-Type":"multipart/form-data"}},o=await axios.post("/api/stores",t,m);this.notificationState.showSuccessNotification("Store created!"),this.$router.push({name:"add-products",params:{store_id:o.data.store.id}})}catch(t){const m=((e=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while creating store";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(t),console.error("Failed to create store:",t)}finally{this.isCreatingStore=!1}}},created(){this.storeState.setStore(null),this.authState.user.mobile_number&&(this.form.whatsapp_mobile_number=this.authState.user.mobile_number.international)}},A={class:"flex flex-col items-center justify-center pb-40"},D={class:"w-full max-w-lg"},L={class:"bg-white p-8 rounded-2xl shadow-lg"},M={class:"space-y-4 mb-4"},z={class:"flex items-center space-x-1 pl-2 rounded-l-md bg-gray-50 text-gray-500 whitespace-nowrap"};function P(s,e,t,m,o,a){const d=n("StoreLogo"),u=n("Input"),h=n("WhatsappIcon"),S=n("Earth"),g=n("SelectCountry"),b=n("SelectCurrency"),c=n("Button");return f(),v("div",A,[e[10]||(e[10]=r("div",{class:"w-full max-w-lg"},[r("h2",{class:"text-2xl font-semibold text-center"},"Start Your Store"),r("p",{class:"text-gray-500 text-center mb-6"},"Tell us a little about your store to get started")],-1)),r("div",D,[r("div",L,[l(d,{onSelectedFile:a.handleSelectedFile,uploading:o.logo&&o.isCreatingStore,class:"flex justify-center mb-4"},null,8,["onSelectedFile","uploading"]),r("div",M,[l(u,{type:"text",label:"Name",modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=i=>o.form.name=i),showAsterisk:!0,onKeyup:a.syncWithAlias,placeholder:"Baby Cakes ðŸ§",autocomplete:"organization",errorText:a.formState.getFormError("name")},null,8,["modelValue","onKeyup","errorText"]),l(u,{type:"text",label:"WhatsApp Number",placeholder:"+26772000001",modelValue:o.form.whatsapp_mobile_number,"onUpdate:modelValue":e[1]||(e[1]=i=>o.form.whatsapp_mobile_number=i),errorText:a.formState.getFormError("whatsapp_mobile_number"),description:"Customers can send orders to this number after shopping"},{prefix:p(()=>[l(h,{class:"mx-2"})]),_:1},8,["modelValue","errorText"]),l(u,{type:"text",label:"Store Link",modelValue:o.form.alias,"onUpdate:modelValue":e[2]||(e[2]=i=>o.form.alias=i),placeholder:"baby-cakes",onKeyup:e[3]||(e[3]=()=>a.formatAlias(!0)),errorText:a.formState.getFormError("alias"),description:"Your storeâ€™s shopping link. Custom domains can be set later."},{prefix:p(()=>[r("div",z,[l(S,{size:"18",class:"mt-0.5"}),e[6]||(e[6]=r("span",{class:"text-sm"},"perfectorder.shop",-1)),e[7]||(e[7]=r("span",{class:"text-gray-400 text-sm"},"/",-1))])]),_:1},8,["modelValue","errorText"]),l(g,{class:"w-full",label:"Country",modelValue:o.form.country,"onUpdate:modelValue":e[4]||(e[4]=i=>o.form.country=i),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your storeâ€™s country of operation"},null,8,["modelValue"]),l(b,{class:"w-full",label:"Currency",modelValue:o.form.currency,"onUpdate:modelValue":e[5]||(e[5]=i=>o.form.currency=i),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your storeâ€™s currency"},null,8,["modelValue"])]),l(c,{size:"lg",type:"primary",buttonClass:"w-full",action:a.createStore,loading:o.isCreatingStore,disabled:o.isCreatingStore},{default:p(()=>[...e[8]||(e[8]=[r("span",null,"Create Store",-1)])]),_:1},8,["action","loading","disabled"])]),a.canGoBackToDashboard?(f(),B(c,{key:0,size:"lg",class:"mt-4",type:"light",leftIcon:o.MoveLeft,buttonClass:"w-full",disabled:o.isCreatingStore,action:a.navigateToShowStores},{default:p(()=>[...e[9]||(e[9]=[r("span",{class:"ml-1"},"Back To Dashboard",-1)])]),_:1},8,["leftIcon","disabled","action"])):k("",!0)])])}const ce=F(N,[["render",P]]);export{ce as default};
