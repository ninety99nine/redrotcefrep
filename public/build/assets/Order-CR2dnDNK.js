import{B as k}from"./Button-DwrvLHoq.js";import{S as q}from"./Skeleton-CTU87mWK.js";import{a as H,P as F,S as j}from"./PaymentStatus-CKThRSrF.js";import{d as v,g as f,r as c,o as a,b as s,h as x,a as d,c as h,e as m,F as S,f as I,n as N,t as b,i as L,w as D}from"./app-BS747Cvj.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as A}from"./move-left-BO-fqvmZ.js";import{M as O}from"./Modal-DFgbUQSx.js";import{I as V}from"./info-Yd9kB0GK.js";import{D as P}from"./Dropdown-Dnn4WUjp.js";import{T as z}from"./trash-2-sbHw9UGk.js";import{A as Z}from"./arrow-down-to-line-BQ73rsy8.js";import{P as R}from"./Pill-CDGvVlRG.js";import{I as U}from"./Input-ChopJmt9.js";import{S as Y}from"./Select-oImkjFwu.js";import{S as G}from"./Switch-C7NpZjIx.js";import{V as K}from"./vue-draggable-next.esm-bundler-D5YB87j-.js";import{M as J}from"./move-CbjHNjVC.js";import{c as W}from"./createLucideIcon-48nG323g.js";import"./Loader-DjOVE8lE.js";import"./ShineEffect-BJBuBPSg.js";import"./Popover-RWMt7bQF.js";import"./Copy-CF04rHR8.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=W("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=W("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ee={inject:["storeState","orderState"],components:{Button:k},data(){return{MoveLeft:A,searchTerm:null,filterExpressions:[],sortingExpressions:[]}},computed:{store(){return this.storeState.store},order(){return this.orderState.order},isEditing(){return this.$route.name==="edit-order"},duplicateOrderId(){return this.$route.query.duplicate_order_id}},methods:{goBack(){this.isEditing||this.duplicateOrderId?this.navigateToOrder():this.navigateToOrders()},navigateToOrder(){this.$router.push({name:"show-order",params:{order_id:this.order.id||this.duplicateOrderId},query:{store_id:this.store.id}})},navigateToOrders(){this.$router.replace({name:"show-orders",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}}};function te(r,e,t,n,o,i){const u=c("Button");return a(),v(u,{size:"xs",type:"light",action:i.goBack,leftIcon:o.MoveLeft},{default:f(()=>e[0]||(e[0]=[s("span",null,"Back",-1)])),_:1,__:[0]},8,["action","leftIcon"])}const re=w(ee,[["render",te]]),se={inject:["storeState","orderState"],components:{Button:k},computed:{order(){return this.orderState.order},store(){return this.storeState.store},isLoadingOrder(){return this.orderState.isLoadingOrder},isLoadingStore(){return this.storeState.isLoadingStore}},methods:{navigateToEditOrder(){this.$router.push({name:"edit-order",params:{order_id:this.order.id},query:{store_id:this.store.id}})}}};function oe(r,e,t,n,o,i){const u=c("Button");return a(),v(u,{size:"xs",type:"light",action:i.navigateToEditOrder,skeleton:i.isLoadingStore||i.isLoadingOrder},{default:f(()=>e[0]||(e[0]=[s("span",null,"Edit",-1)])),_:1,__:[0]},8,["action","skeleton"])}const ie=w(se,[["render",oe]]),ne={inject:["formState","orderState","storeState","notificationState"],components:{Info:V,Modal:O,Button:k},data(){return{Printer:H,isPrintingOrder:!1}},computed:{order(){return this.orderState.order},store(){return this.storeState.store},isLoadingOrder(){return this.orderState.isLoadingOrder},isLoadingStore(){return this.storeState.isLoadingStore}},methods:{async printOrder(r){var e,t;try{if(this.isPrintingOrder)return;const n={store_id:this.store.id,order_ids:[this.order.id]},o={responseType:"blob"};this.isPrintingOrder=!0;const i=await x.post("/api/orders/download",n,o),u=new Blob([i.data],{type:"application/pdf"}),p=window.URL.createObjectURL(u),g=window.open(p);g&&(g.onload=()=>{g.focus(),g.print()}),r()}catch(n){const o=((t=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:t.message)||(n==null?void 0:n.message)||"Something went wrong while printing order";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(n),console.error("Failed to print order:",n)}finally{this.isPrintingOrder=!1}}}},ae={class:"flex space-x-2 p-4 text-xs bg-blue-100 rounded-lg"};function de(r,e,t,n,o,i){const u=c("Info"),p=c("Modal");return a(),v(p,{triggerSize:"xs",triggerType:"light",header:"Print PDF",triggerText:"Print",approveType:"primary",leftApproveIcon:o.Printer,leftTriggerIcon:o.Printer,approveText:"Print PDF",approveAction:i.printOrder,approveLoading:o.isPrintingOrder,triggerLoading:i.isLoadingStore||i.isLoadingOrder},{content:f(()=>[s("div",ae,[d(u,{size:"20",class:"shrink-0"}),e[0]||(e[0]=s("span",null,"Creating the PDF to print may take a moment. Please do not close this window.",-1))])]),_:1},8,["leftApproveIcon","leftTriggerIcon","approveAction","approveLoading","triggerLoading"])}const le=w(ne,[["render",de]]),ce={inject:["formState","orderState","storeState","notificationState"],components:{Modal:O,Dropdown:P},data(){return{Trash2:z,isDeletingOrder:!1,options:[{label:"Duplicate",action:this.duplicateOrder},{label:"Delete",action:this.confirmDeleteOrder}]}},computed:{order(){return this.orderState.order},store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingOrder(){return this.orderState.isLoadingOrder},isLoadingStore(){return this.storeState.isLoadingStore}},methods:{confirmDeleteOrder(){this.$refs.deleteOrderModal.showModal()},duplicateOrder(){this.$router.push({name:"create-order",query:{store_id:this.store.id,duplicate_order_id:this.order.id}})},async deleteOrder(){var r,e;try{if(this.isDeletingOrder)return;this.isDeletingOrder=!0;const t={data:{store_id:this.store.id}};await x.delete(`/api/orders/${this.order.id}`,t),this.$refs.deleteOrderModal.hideModal(),await new Promise(n=>setTimeout(n,1e3)),this.notificationState.showSuccessNotification("Order deleted"),await this.$router.replace({name:"show-orders",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}catch(t){const n=((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while deleting order";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(t),console.error("Failed to delete order:",t)}finally{this.isDeletingOrder=!1,this.$refs.deleteOrderModal.hideModal()}}}},he={class:"max-h-60 overflow-auto"},pe=["onClick"],ue={class:"truncate"},me={class:"mb-8"},ge={class:"font-bold text-black"};function fe(r,e,t,n,o,i){const u=c("Dropdown"),p=c("Modal");return a(),h("div",null,[d(u,{position:"left",options:o.options,dropdownClasses:"w-40"},{content:f(g=>[s("ul",he,[(a(!0),h(S,null,I(g.options,(_,y)=>(a(),h("li",{key:y,onClick:()=>g.handleItemClick(_),class:N(["flex items-center space-x-2 px-4 py-2 text-sm cursor-pointer",_.label=="Delete"?"hover:bg-red-100 text-red-700":"hover:bg-gray-100 text-gray-700"])},[s("span",ue,b(_.label),1)],10,pe))),128))])]),_:1},8,["options"]),!i.isLoadingStore&&!i.isLoadingOrder&&i.hasOrder?(a(),v(p,{key:0,approveType:"danger",ref:"deleteOrderModal",leftApproveIcon:o.Trash2,approveText:"Delete Order",approveAction:i.deleteOrder,approveLoading:o.isDeletingOrder},{content:f(()=>[e[2]||(e[2]=s("p",{class:"text-lg font-bold border-b border-dashed border-gray-200 pb-4 mb-4"},"Confirm Delete",-1)),s("p",me,[e[0]||(e[0]=L("Are you sure you want to permanently delete ")),s("span",ge,"Order #"+b(i.order.number),1),e[1]||(e[1]=L("?"))])]),_:1},8,["leftApproveIcon","approveAction","approveLoading"])):m("",!0)])}const we=w(ce,[["render",fe]]),_e={inject:["formState","orderState","storeState","notificationState"],components:{Info:V,Button:k,Modal:O},data(){return{ArrowDownToLine:Z,isDownloadingOrder:!1}},computed:{order(){return this.orderState.order},store(){return this.storeState.store},isLoadingOrder(){return this.orderState.isLoadingOrder},isLoadingStore(){return this.storeState.isLoadingStore}},methods:{async downloadOrder(r){var e,t;try{if(this.isDownloadingOrder)return;const n={store_id:this.store.id,order_ids:[this.order.id]},o={responseType:"blob"};this.isDownloadingOrder=!0;const i=await x.post("/api/orders/download",n,o),u=new Blob([i.data],{type:"application/pdf"}),p=document.createElement("a");p.href=window.URL.createObjectURL(u),p.download=`Order #${this.order.number}.pdf`,document.body.appendChild(p),p.click(),document.body.removeChild(p),r()}catch(n){const o=((t=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:t.message)||(n==null?void 0:n.message)||"Something went wrong while downloading order";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(n),console.error("Failed to download order:",n)}finally{this.isDownloadingOrder=!1}}}},ye={class:"flex space-x-2 p-4 text-xs bg-blue-100 rounded-lg"};function ve(r,e,t,n,o,i){const u=c("Info"),p=c("Modal");return a(),v(p,{triggerSize:"xs",triggerType:"light",header:"Download PDF",triggerText:"Download",approveType:"primary",approveText:"Download PDF",leftApproveIcon:o.ArrowDownToLine,leftTriggerIcon:o.ArrowDownToLine,approveAction:i.downloadOrder,approveLoading:o.isDownloadingOrder,triggerLoading:i.isLoadingStore||i.isLoadingOrder},{content:f(()=>[s("div",ye,[d(u,{size:"20",class:"shrink-0"}),e[0]||(e[0]=s("span",null,"Creating the PDF to download may take a moment. Please do not close this window.",-1))])]),_:1},8,["leftApproveIcon","leftTriggerIcon","approveAction","approveLoading","triggerLoading"])}const xe=w(_e,[["render",ve]]),Se={props:{message:{type:String,default:""}},computed:{formattedMessage(){return this.message?this.message.replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<strong>$1</strong>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/`(.*?)`/g,'<span class="text-xs font-mono p-1 rounded break-all" style="background:#cff4cd;">$1</span>'):""}}},ke={class:"flex justify-end bg-[#efe9e0] rounded-lg p-4 mb-8"},be={class:"bg-[#d0fecf] p-3 rounded-lg max-w-xs shadow-md relative"},Le=["innerHTML"],Oe={class:"absolute bottom-1 right-2 flex items-center space-x-1"},Ce={class:"text-xs text-gray-500"};function Me(r,e,t,n,o,i){return a(),h("div",ke,[s("div",be,[s("div",{class:"text-sm text-gray-700 pb-4 break-words whitespace-pre-wrap",innerHTML:i.formattedMessage},null,8,Le),s("div",Oe,[s("span",Ce,b(new Date().toLocaleTimeString().slice(0,5)),1),e[0]||(e[0]=s("svg",{class:"w-5 h-5 text-blue-500 flex-shrink-0",viewBox:"0 -0.5 25 25",fill:"currentColor"},[s("path",{d:"M5.03033 11.4697C4.73744 11.1768 4.26256 11.1768 3.96967 11.4697C3.67678 11.7626 3.67678 12.2374 3.96967 12.5303L5.03033 11.4697ZM8.5 16L7.96967 16.5303C8.26256 16.8232 8.73744 16.8232 9.03033 16.5303L8.5 16ZM17.0303 8.53033C17.3232 8.23744 17.3232 7.76256 17.0303 7.46967C16.7374 7.17678 16.2626 7.17678 15.9697 7.46967L17.0303 8.53033ZM9.03033 11.4697C8.73744 11.1768 8.26256 11.1768 7.96967 11.4697C7.67678 11.7626 7.67678 12.2374 7.96967 12.5303L9.03033 11.4697ZM12.5 16L11.9697 16.5303C12.2626 16.8232 12.7374 16.8232 13.0303 16.5303L12.5 16ZM21.0303 8.53033C21.3232 8.23744 21.3232 7.76256 21.0303 7.46967C20.7374 7.17678 20.2626 7.17678 19.9697 7.46967L21.0303 8.53033ZM3.96967 12.5303L7.96967 16.5303L9.03033 15.4697L5.03033 11.4697L3.96967 12.5303ZM9.03033 16.5303L17.0303 8.53033L15.9697 7.46967L7.96967 15.4697L9.03033 16.5303ZM7.96967 12.5303L11.9697 16.5303L13.0303 15.4697L9.03033 11.4697L7.96967 12.5303ZM13.0303 16.5303L21.0303 8.53033L19.9697 7.46967L11.9697 15.4697L13.0303 16.5303Z",fill:"#027bfc"})],-1))])])])}const Te=w(Se,[["render",Me]]),$e={inject:["orderState","storeState"],components:{Move:J,Pill:R,Input:U,Modal:O,Select:Y,Switch:G,Dropdown:P,draggable:K,WhatsappMessage:Te},data(){return{activeTab:"edit",whatsappAction:null,whatsappMessage:null,includeOrderFieldNames:!0,sendableWhatsappMessage:null,whatsappFields:this.prepareWhatsappFields(),whatsappActions:this.prepareWhatsappActions()}},watch:{whatsappAction(r){this.setWhatsappMessage(r),this.generateWhatsappMessage()},activeTab(){this.generateWhatsappMessage()}},computed:{order(){return this.orderState.order},store(){return this.storeState.store},isLoadingOrder(){return this.orderState.isLoadingOrder},isLoadingStore(){return this.storeState.isLoadingStore}},methods:{selectEditTab(){this.activeTab="edit"},selectPreviewTab(){this.activeTab="preview"},prepareWhatsappActions(){return["Write message","Request review","Share order details","Remind about payment","Request proof of payment","Send payment confirmation","Send completion confirmation","Send cancellation confirmation","Send thank you message"].map(e=>({label:e,value:e}))},prepareWhatsappFields(){const r=["Number","Customer","Summary","Status","Payment Status","Collection Status","Grand Total","Paid","Pending","Outstanding","Customer Note","Created Date","Order Link"],e=["Number","Customer","Summary","Status","Grand Total","Created Date","Order Link"];return r.map(t=>({name:t,linebreak:!1,active:e.includes(t),priority:e.includes(t)}))},showSendToWhatsappModal(r){this.selectEditTab(),this.$refs.dropdown.hideDropdown(),this.whatsappAction=r,this.$refs.sendToWhatsappModal.showModal()},setWhatsappMessage(){const r={"Request review":`Hello ${this.order.customer_first_name}, we hope you enjoyed your order! Could you take a moment to leave us a review? Your feedback is greatly appreciated!`,"Share order details":`Hello ${this.order.customer_first_name}, here are the details of your order:

Order #${this.order.number}
----------------------
`,"Remind about payment":`Hello ${this.order.customer_first_name}, just a friendly reminder that your order (#${this.order.number}) is currently unpaid. The total amount due is ${this.order.outstanding_total.amount_with_currency}. Kindly make payment at your earliest convenience. Let us know if you need assistance!`,"Request proof of payment":`Hello ${this.order.customer_first_name}, could you please send us the proof of payment for order #${this.order.number}? This will help us process your order faster. Thank you!`,"Send payment confirmation":`Hello ${this.order.customer_first_name}, we've received your payment for order #${this.order.number}. Your order is now being processed. Thank you for your prompt payment!`,"Send completion confirmation":`Hello ${this.order.customer_first_name}, your order (#${this.order.number}) has been completed successfully! We hope you enjoy your meal. Thank you for ordering with us!`,"Send cancellation confirmation":`Hello ${this.order.customer_first_name}, your order (#${this.order.number}) has been cancelled. If you have any questions or need further assistance, feel free to reach out to us.`,"Send thank you message":`Hello ${this.order.customer_first_name}, thank you for your order! We truly appreciate your support and look forward to serving you again. Have a great day!`,"Write message":`Write anything to ${this.order.customer_first_name}`};this.whatsappMessage=r[this.whatsappAction]||null},generateWhatsappMessage(){if(this.sendableWhatsappMessage=this.whatsappMessage,this.whatsappAction=="Share order details"){let r="";this.whatsappFields.forEach(e=>{if(e.active)switch(e.linebreak&&(r+=`
`),this.includeOrderFieldNames&&(r+=`${e.name}: `),e.name){case"Number":r+=`${this.order.number}
`;break;case"Customer":r+=`${this.order.customer_name}
`;break;case"Summary":r+=`${this.order.summary}
`;break;case"Status":r+=`${this.order.status.name}
`;break;case"Payment Status":r+=`${this.order.payment_status.name}
`;break;case"Collection Status":r+=`${this.order.collection_verified}
`;break;case"Grand Total":r+=`${this.order.grand_total.amount_with_currency}
`;break;case"Paid":r+=`${this.order.paid_total.amount_with_currency}
`;break;case"Pending":r+=`${this.order.pending_total.amount_with_currency}
`;break;case"Outstanding":r+=`${this.order.outstanding_total.amount_with_currency}
`;break;case"Customer Note":r+=`${this.order.customer_note||"None"}
`;break;case"Created Date":r+=`${this.order.created_at}
`;break;case"Order Link":r+=`${window.location.origin+this.$router.resolve({name:"show-order",params:{order_id:this.order.id},query:{store_id:this.store.id}}).href}
`;break}}),this.sendableWhatsappMessage+=`

${r.trim()}`}},async sendToWhatsapp(){this.generateWhatsappMessage(),window.open(`https://wa.me/?text=${encodeURIComponent(this.sendableWhatsappMessage)}`,"_blank"),this.$refs.sendToWhatsappModal.hideModal()}}},Ee=["onClick"],Be={class:"flex space-x-2 items-center"},Ie={key:0,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},De={key:1,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Ve={key:2,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Pe={key:3,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},We={key:4,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},qe={key:5,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},He={key:6,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Fe={key:7,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},je={key:8,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Ne={key:9,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Ae={class:"text-xs text-gray-500 group-hover:text-gray-900"},ze={key:0,class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Ze={class:"flex items-center space-x-2 mb-4"},Re={key:1,class:"space-y-4 mb-8"},Ue={class:"border divide-y overflow-y-auto rounded-lg px-4 mb-4"},Ye={class:"flex items-center space-x-4"};function Ge(r,e,t,n,o,i){const u=c("Dropdown"),p=c("Select"),g=c("Pill"),_=c("WhatsappMessage"),y=c("Input"),C=c("Switch"),M=c("Move"),T=c("draggable"),$=c("Modal");return a(),h("div",null,[d(u,{ref:"dropdown",triggerSize:"xs",triggerType:"light",triggerText:"Whatsapp",dropdownClasses:"w-80",triggerLoading:i.isLoadingStore||i.isLoadingOrder},{content:f(()=>[e[16]||(e[16]=s("div",{class:"flex space-x-2 items-center px-2 py-1 text-sm bg-green-100"},[s("svg",{class:"w-8 h-8",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"96px",height:"96px","fill-rule":"evenodd","clip-rule":"evenodd"},[s("path",{fill:"#fff",d:"M4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98c-0.001,0,0,0,0,0h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303z"}),s("path",{fill:"#fff",d:"M4.868,43.803c-0.132,0-0.26-0.052-0.355-0.148c-0.125-0.127-0.174-0.312-0.127-0.483l2.639-9.636c-1.636-2.906-2.499-6.206-2.497-9.556C4.532,13.238,13.273,4.5,24.014,4.5c5.21,0.002,10.105,2.031,13.784,5.713c3.679,3.683,5.704,8.577,5.702,13.781c-0.004,10.741-8.746,19.48-19.486,19.48c-3.189-0.001-6.344-0.788-9.144-2.277l-9.875,2.589C4.953,43.798,4.911,43.803,4.868,43.803z"}),s("path",{fill:"#cfd8dc",d:"M24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,4C24.014,4,24.014,4,24.014,4C12.998,4,4.032,12.962,4.027,23.979c-0.001,3.367,0.849,6.685,2.461,9.622l-2.585,9.439c-0.094,0.345,0.002,0.713,0.254,0.967c0.19,0.192,0.447,0.297,0.711,0.297c0.085,0,0.17-0.011,0.254-0.033l9.687-2.54c2.828,1.468,5.998,2.243,9.197,2.244c11.024,0,19.99-8.963,19.995-19.98c0.002-5.339-2.075-10.359-5.848-14.135C34.378,6.083,29.357,4.002,24.014,4L24.014,4z"}),s("path",{fill:"#40c351",d:"M35.176,12.832c-2.98-2.982-6.941-4.625-11.157-4.626c-8.704,0-15.783,7.076-15.787,15.774c-0.001,2.981,0.833,5.883,2.413,8.396l0.376,0.597l-1.595,5.821l5.973-1.566l0.577,0.342c2.422,1.438,5.2,2.198,8.032,2.199h0.006c8.698,0,15.777-7.077,15.78-15.776C39.795,19.778,38.156,15.814,35.176,12.832z"}),s("path",{fill:"#fff","fill-rule":"evenodd",d:"M19.268,16.045c-0.355-0.79-0.729-0.806-1.068-0.82c-0.277-0.012-0.593-0.011-0.909-0.011c-0.316,0-0.83,0.119-1.265,0.594c-0.435,0.475-1.661,1.622-1.661,3.956c0,2.334,1.7,4.59,1.937,4.906c0.237,0.316,3.282,5.259,8.104,7.161c4.007,1.58,4.823,1.266,5.693,1.187c0.87-0.079,2.807-1.147,3.202-2.255c0.395-1.108,0.395-2.057,0.277-2.255c-0.119-0.198-0.435-0.316-0.909-0.554s-2.807-1.385-3.242-1.543c-0.435-0.158-0.751-0.237-1.068,0.238c-0.316,0.474-1.225,1.543-1.502,1.859c-0.277,0.317-0.554,0.357-1.028,0.119c-0.474-0.238-2.002-0.738-3.815-2.354c-1.41-1.257-2.362-2.81-2.639-3.285c-0.277-0.474-0.03-0.731,0.208-0.968c0.213-0.213,0.474-0.554,0.712-0.831c0.237-0.277,0.316-0.475,0.474-0.791c0.158-0.317,0.079-0.594-0.04-0.831C20.612,19.329,19.69,16.983,19.268,16.045z","clip-rule":"evenodd"})]),s("span",{class:"text-xs"},"Send using Whatsapp")],-1)),(a(!0),h(S,null,I(o.whatsappActions,(l,E)=>(a(),h("div",{key:E,onClick:D(()=>i.showSendToWhatsappModal(l.label),["stop"]),class:"cursor-pointer flex justify-between items-center py-2 px-4 text-gray-900 hover:bg-gray-100 group"},[s("div",Be,[l.label=="Write message"?(a(),h("svg",Ie,e[5]||(e[5]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"},null,-1)]))):m("",!0),l.label=="Request review"?(a(),h("svg",De,e[6]||(e[6]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"},null,-1)]))):m("",!0),l.label=="Share order details"?(a(),h("svg",Ve,e[7]||(e[7]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"},null,-1)]))):m("",!0),l.label=="Remind about payment"?(a(),h("svg",Pe,e[8]||(e[8]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m15 15-6 6m0 0-6-6m6 6V9a6 6 0 0 1 12 0v3"},null,-1)]))):m("",!0),l.label=="Request proof of payment"?(a(),h("svg",We,e[9]||(e[9]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9 14.25 6-6m4.5-3.493V21.75l-3.75-1.5-3.75 1.5-3.75-1.5-3.75 1.5V4.757c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0c1.1.128 1.907 1.077 1.907 2.185ZM9.75 9h.008v.008H9.75V9Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm4.125 4.5h.008v.008h-.008V13.5Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"},null,-1)]))):m("",!0),l.label=="Send payment confirmation"?(a(),h("svg",qe,e[10]||(e[10]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 0 0-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 0 1-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 0 0 3 15h-.75M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm3 0h.008v.008H18V10.5Zm-12 0h.008v.008H6V10.5Z"},null,-1)]))):m("",!0),l.label=="Send completion confirmation"?(a(),h("svg",He,e[11]||(e[11]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"},null,-1)]))):m("",!0),l.label=="Send cancellation confirmation"?(a(),h("svg",Fe,e[12]||(e[12]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575a1.575 1.575 0 1 0-3.15 0v8.175a6.75 6.75 0 0 0 6.75 6.75h2.018a5.25 5.25 0 0 0 3.712-1.538l1.732-1.732a5.25 5.25 0 0 0 1.538-3.712l.003-2.024a.668.668 0 0 1 .198-.471 1.575 1.575 0 1 0-2.228-2.228 3.818 3.818 0 0 0-1.12 2.687M6.9 7.575V12m6.27 4.318A4.49 4.49 0 0 1 16.35 15m.002 0h-.002"},null,-1)]))):m("",!0),l.label=="Send thank you message"?(a(),h("svg",je,e[13]||(e[13]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"},null,-1)]))):m("",!0),l.label=="Suggest another option"?(a(),h("svg",Ne,e[14]||(e[14]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"},null,-1)]))):m("",!0),s("span",Ae,b(l.label),1)]),l.label=="Suggest another option"?(a(),h("svg",ze,e[15]||(e[15]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"},null,-1)]))):m("",!0)],8,Ee))),128)),e[17]||(e[17]=s("a",{href:"#",target:"_blank",class:"cursor-pointer flex justify-between items-center py-2 px-4 text-gray-900 hover:bg-gray-100 group"},[s("div",{class:"flex space-x-2 items-center"},[s("svg",{class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"})]),s("span",{class:"text-xs text-gray-500 group-hover:text-gray-900"}," Suggest another option ")]),s("svg",{class:"w-4 h-4 shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})])],-1))]),_:1},8,["triggerLoading"]),d($,{approveText:"Send",approveType:"success",ref:"sendToWhatsappModal",header:"Send To Whatsapp",scrollOnContent:!1,approveAction:i.sendToWhatsapp},{approveIcon:f(()=>e[18]||(e[18]=[s("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"96px",height:"96px","fill-rule":"evenodd","clip-rule":"evenodd"},[s("path",{fill:"#fff",d:"M4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98c-0.001,0,0,0,0,0h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303z"}),s("path",{fill:"#fff",d:"M4.868,43.803c-0.132,0-0.26-0.052-0.355-0.148c-0.125-0.127-0.174-0.312-0.127-0.483l2.639-9.636c-1.636-2.906-2.499-6.206-2.497-9.556C4.532,13.238,13.273,4.5,24.014,4.5c5.21,0.002,10.105,2.031,13.784,5.713c3.679,3.683,5.704,8.577,5.702,13.781c-0.004,10.741-8.746,19.48-19.486,19.48c-3.189-0.001-6.344-0.788-9.144-2.277l-9.875,2.589C4.953,43.798,4.911,43.803,4.868,43.803z"}),s("path",{fill:"#cfd8dc",d:"M24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,4C24.014,4,24.014,4,24.014,4C12.998,4,4.032,12.962,4.027,23.979c-0.001,3.367,0.849,6.685,2.461,9.622l-2.585,9.439c-0.094,0.345,0.002,0.713,0.254,0.967c0.19,0.192,0.447,0.297,0.711,0.297c0.085,0,0.17-0.011,0.254-0.033l9.687-2.54c2.828,1.468,5.998,2.243,9.197,2.244c11.024,0,19.99-8.963,19.995-19.98c0.002-5.339-2.075-10.359-5.848-14.135C34.378,6.083,29.357,4.002,24.014,4L24.014,4z"}),s("path",{fill:"#40c351",d:"M35.176,12.832c-2.98-2.982-6.941-4.625-11.157-4.626c-8.704,0-15.783,7.076-15.787,15.774c-0.001,2.981,0.833,5.883,2.413,8.396l0.376,0.597l-1.595,5.821l5.973-1.566l0.577,0.342c2.422,1.438,5.2,2.198,8.032,2.199h0.006c8.698,0,15.777-7.077,15.78-15.776C39.795,19.778,38.156,15.814,35.176,12.832z"}),s("path",{fill:"#fff","fill-rule":"evenodd",d:"M19.268,16.045c-0.355-0.79-0.729-0.806-1.068-0.82c-0.277-0.012-0.593-0.011-0.909-0.011c-0.316,0-0.83,0.119-1.265,0.594c-0.435,0.475-1.661,1.622-1.661,3.956c0,2.334,1.7,4.59,1.937,4.906c0.237,0.316,3.282,5.259,8.104,7.161c4.007,1.58,4.823,1.266,5.693,1.187c0.87-0.079,2.807-1.147,3.202-2.255c0.395-1.108,0.395-2.057,0.277-2.255c-0.119-0.198-0.435-0.316-0.909-0.554s-2.807-1.385-3.242-1.543c-0.435-0.158-0.751-0.237-1.068,0.238c-0.316,0.474-1.225,1.543-1.502,1.859c-0.277,0.317-0.554,0.357-1.028,0.119c-0.474-0.238-2.002-0.738-3.815-2.354c-1.41-1.257-2.362-2.81-2.639-3.285c-0.277-0.474-0.03-0.731,0.208-0.968c0.213-0.213,0.474-0.554,0.712-0.831c0.237-0.277,0.316-0.475,0.474-0.791c0.158-0.317,0.079-0.594-0.04-0.831C20.612,19.329,19.69,16.983,19.268,16.045z","clip-rule":"evenodd"})],-1)])),content:f(()=>[s("div",Ze,[d(p,{class:"w-full",modelValue:o.whatsappAction,"onUpdate:modelValue":e[0]||(e[0]=l=>o.whatsappAction=l),options:o.whatsappActions},null,8,["modelValue","options"]),d(g,{type:o.activeTab=="edit"?"primary":"light",size:"md",action:i.selectEditTab},{default:f(()=>e[19]||(e[19]=[L("Edit")])),_:1,__:[19]},8,["type","action"]),d(g,{type:o.activeTab=="preview"?"primary":"light",size:"md",action:i.selectPreviewTab},{default:f(()=>e[20]||(e[20]=[L("Preview")])),_:1,__:[20]},8,["type","action"])]),o.activeTab=="preview"?(a(),v(_,{key:0,class:"mb-8",message:o.sendableWhatsappMessage},null,8,["message"])):(a(),h("div",Re,[d(y,{rows:"6",type:"textarea",label:"Message to send",modelValue:o.whatsappMessage,"onUpdate:modelValue":e[1]||(e[1]=l=>o.whatsappMessage=l),placeholder:"Your whatsapp message"},null,8,["modelValue"]),o.whatsappAction=="Share order details"?(a(),h(S,{key:0},[e[21]||(e[21]=s("div",{class:"flex space-x-2 p-4 text-sm bg-green-100 rounded-lg"},[s("svg",{class:"w-16 h-8",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"96px",height:"96px","fill-rule":"evenodd","clip-rule":"evenodd"},[s("path",{fill:"#fff",d:"M4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98c-0.001,0,0,0,0,0h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303z"}),s("path",{fill:"#fff",d:"M4.868,43.803c-0.132,0-0.26-0.052-0.355-0.148c-0.125-0.127-0.174-0.312-0.127-0.483l2.639-9.636c-1.636-2.906-2.499-6.206-2.497-9.556C4.532,13.238,13.273,4.5,24.014,4.5c5.21,0.002,10.105,2.031,13.784,5.713c3.679,3.683,5.704,8.577,5.702,13.781c-0.004,10.741-8.746,19.48-19.486,19.48c-3.189-0.001-6.344-0.788-9.144-2.277l-9.875,2.589C4.953,43.798,4.911,43.803,4.868,43.803z"}),s("path",{fill:"#cfd8dc",d:"M24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,4C24.014,4,24.014,4,24.014,4C12.998,4,4.032,12.962,4.027,23.979c-0.001,3.367,0.849,6.685,2.461,9.622l-2.585,9.439c-0.094,0.345,0.002,0.713,0.254,0.967c0.19,0.192,0.447,0.297,0.711,0.297c0.085,0,0.17-0.011,0.254-0.033l9.687-2.54c2.828,1.468,5.998,2.243,9.197,2.244c11.024,0,19.99-8.963,19.995-19.98c0.002-5.339-2.075-10.359-5.848-14.135C34.378,6.083,29.357,4.002,24.014,4L24.014,4z"}),s("path",{fill:"#40c351",d:"M35.176,12.832c-2.98-2.982-6.941-4.625-11.157-4.626c-8.704,0-15.783,7.076-15.787,15.774c-0.001,2.981,0.833,5.883,2.413,8.396l0.376,0.597l-1.595,5.821l5.973-1.566l0.577,0.342c2.422,1.438,5.2,2.198,8.032,2.199h0.006c8.698,0,15.777-7.077,15.78-15.776C39.795,19.778,38.156,15.814,35.176,12.832z"}),s("path",{fill:"#fff","fill-rule":"evenodd",d:"M19.268,16.045c-0.355-0.79-0.729-0.806-1.068-0.82c-0.277-0.012-0.593-0.011-0.909-0.011c-0.316,0-0.83,0.119-1.265,0.594c-0.435,0.475-1.661,1.622-1.661,3.956c0,2.334,1.7,4.59,1.937,4.906c0.237,0.316,3.282,5.259,8.104,7.161c4.007,1.58,4.823,1.266,5.693,1.187c0.87-0.079,2.807-1.147,3.202-2.255c0.395-1.108,0.395-2.057,0.277-2.255c-0.119-0.198-0.435-0.316-0.909-0.554s-2.807-1.385-3.242-1.543c-0.435-0.158-0.751-0.237-1.068,0.238c-0.316,0.474-1.225,1.543-1.502,1.859c-0.277,0.317-0.554,0.357-1.028,0.119c-0.474-0.238-2.002-0.738-3.815-2.354c-1.41-1.257-2.362-2.81-2.639-3.285c-0.277-0.474-0.03-0.731,0.208-0.968c0.213-0.213,0.474-0.554,0.712-0.831c0.237-0.277,0.316-0.475,0.474-0.791c0.158-0.317,0.079-0.594-0.04-0.831C20.612,19.329,19.69,16.983,19.268,16.045z","clip-rule":"evenodd"})]),s("span",null,"Show, hide and move the order information to include with this whatsapp message")],-1)),d(y,{type:"checkbox",modelValue:o.includeOrderFieldNames,"onUpdate:modelValue":e[2]||(e[2]=l=>o.includeOrderFieldNames=l),inputLabel:"Include Order field names"},null,8,["modelValue"]),s("div",Ue,[d(T,{class:"divide-y mb-4",modelValue:o.whatsappFields,"onUpdate:modelValue":e[4]||(e[4]=l=>o.whatsappFields=l),handle:".draggable-handle","ghost-class":"bg-yellow-50"},{default:f(()=>[(a(!0),h(S,null,I(o.whatsappFields,(l,E)=>(a(),h("div",{key:E,class:"flex items-center justify-between p-4"},[d(C,{size:"xs",modelValue:l.active,"onUpdate:modelValue":B=>l.active=B,suffixText:l.name},null,8,["modelValue","onUpdate:modelValue","suffixText"]),s("div",Ye,[l.active?(a(),v(y,{key:0,type:"checkbox",inputLabel:"Gap",modelValue:l.linebreak,"onUpdate:modelValue":B=>l.linebreak=B},null,8,["modelValue","onUpdate:modelValue"])):m("",!0),d(M,{onClick:e[3]||(e[3]=D(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})])]))),128))]),_:1},8,["modelValue"])])],64)):m("",!0)]))]),_:1},8,["approveAction"])])}const Ke=w($e,[["render",Ge]]),Je={inject:["formState","orderState","storeState","notificationState"],components:{Button:k},data(){return{ChevronLeft:Q,ChevronRight:X,pagination:null,searchTerm:null,latestRequestId:0,filterExpressions:[],sortingExpressions:[],isLoadingOrders:!1,cancelTokenSource:null}},watch:{isLoadingOrder(r){r||this.getOrders()}},computed:{order(){return this.orderState.order},store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingOrder(){return this.orderState.isLoadingOrder},isLoadingStore(){return this.storeState.isLoadingStore},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},hasFilterExpressions(){return this.filterExpressions.length>0},hasSortingExpressions(){return this.sortingExpressions.length>0},hasNextOrder(){return this.isLoadingStore||this.isLoadingOrder||this.isLoadingOrders||!this.pagination||!this.pagination.data.length?!1:this.pagination.data.findIndex(e=>e===this.order.id)<this.pagination.data.length-1||this.pagination.next_page_url!==null},hasPreviousOrder(){return this.isLoadingStore||this.isLoadingOrder||this.isLoadingOrders||!this.pagination||!this.pagination.data.length?!1:this.pagination.data.findIndex(e=>e===this.order.id)>0||this.pagination.prev_page_url!==null}},methods:{onView(r){let e=this.pagination.data.findIndex(n=>n===this.order.id);const t={store_id:this.store.id,searchTerm:this.searchTerm,filterExpressions:this.filterExpressions.join("|"),sortingExpressions:this.sortingExpressions.join("|")};if(r==="next"){if(e<this.pagination.data.length-1)this.$router.push({name:"show-order",params:{order_id:this.pagination.data[e+1]},query:t});else if(this.pagination.next_page_url){const n=new URL(this.pagination.next_page_url).searchParams.get("page");this.getOrders(parseInt(n))}}else if(r==="prev"){if(e>0)this.$router.push({name:"show-order",params:{order_id:this.pagination.data[e-1]},query:t});else if(this.pagination.prev_page_url){const n=new URL(this.pagination.prev_page_url).searchParams.get("page");this.getOrders(parseInt(n))}}},async getOrders(r=1){var t,n;const e=++this.latestRequestId;try{this.isLoadingOrders=!0,this.cancelTokenSource&&this.cancelTokenSource.cancel("Request superseded by a newer one"),this.cancelTokenSource=x.CancelToken.source();let o={params:{page:r,_pagination:"1",store_id:this.store.id},cancelToken:this.cancelTokenSource.token};this.hasSearchTerm&&(o.params.search=this.searchTerm),this.hasFilterExpressions&&(o.params._filters=this.filterExpressions.join("|")),this.hasSortingExpressions&&(o.params._sort=this.sortingExpressions.join("|"));const i=await x.get("/api/orders",o);if(e!==this.latestRequestId)return;this.pagination=i.data}catch(o){if(x.isCancel(o)||e!==this.latestRequestId)return;const i=((n=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:n.message)||(o==null?void 0:o.message)||"Something went wrong while fetching order navigation";this.notificationState.showWarningNotification(i),this.formState.setServerFormErrors(o),console.error("Failed to fetch order navigation:",o)}finally{if(e!==this.latestRequestId)return;this.isLoadingOrders=!1,this.cancelTokenSource=null}}},created(){this.searchTerm=this.$route.query.searchTerm,this.$route.query.filterExpressions&&(this.filterExpressions=this.$route.query.filterExpressions.split("|")),this.$route.query.sortingExpressions&&(this.sortingExpressions=this.$route.query.sortingExpressions.split("|"))}},Qe={class:"flex space-x-2 items-center"};function Xe(r,e,t,n,o,i){const u=c("Button");return a(),h("div",Qe,[d(u,{size:"xs",type:"light",leftIcon:o.ChevronLeft,disabled:!i.hasPreviousOrder,action:()=>i.onView("prev"),skeleton:i.isLoadingStore||i.isLoadingOrder||!i.hasOrder},null,8,["leftIcon","disabled","action","skeleton"]),d(u,{size:"xs",type:"light",leftIcon:o.ChevronRight,disabled:!i.hasNextOrder,action:()=>i.onView("next"),skeleton:i.isLoadingStore||i.isLoadingOrder||!i.hasOrder},null,8,["leftIcon","disabled","action","skeleton"])])}const et=w(Je,[["render",Xe]]),tt={inject:["storeState","orderState"],components:{Button:k,Skeleton:q,Status:j,BackButton:re,EditButton:ie,PrintButton:le,MoreDropdown:we,PaymentStatus:F,DownloadButton:xe,WhatsappButton:Ke,NavigationArrows:et},computed:{order(){return this.orderState.order},hasOrder(){return this.orderState.hasOrder},isLoadingOrder(){return this.orderState.isLoadingOrder},isLoadingStore(){return this.storeState.isLoadingStore},isEditting(){return this.$route.name==="edit-order"},isCreating(){return this.$route.name==="create-order"}}},rt={class:"select-none bg-white rounded-lg p-4 mb-4"},st={class:"flex justify-between items-center"},ot={class:"flex items-center space-x-4"},it={key:0,class:"flex items-center space-x-4"},nt={class:"flex items-center space-x-2"},at={class:"flex space-x-1"},dt={class:"flex space-x-1"},lt={class:"text-lg text-gray-700 font-semibold"},ct={key:0,class:"flex space-x-2 items-center"};function ht(r,e,t,n,o,i){const u=c("BackButton"),p=c("Skeleton"),g=c("Status"),_=c("PaymentStatus"),y=c("WhatsappButton"),C=c("EditButton"),M=c("PrintButton"),T=c("DownloadButton"),$=c("MoreDropdown"),l=c("NavigationArrows");return a(),h("div",rt,[s("div",st,[s("div",ot,[d(u),i.isLoadingStore||i.isLoadingOrder||i.isEditting&&!i.hasOrder?(a(),h("div",it,[s("div",nt,[e[0]||(e[0]=s("span",{class:"text-2xl font-bold tracking-tight text-gray-300"},"#",-1)),d(p,{width:"w-12",shine:!0}),d(p,{width:"w-4",shine:!0})]),s("div",at,[d(p,{width:"w-16",shine:!0}),d(p,{width:"w-4",shine:!0})]),s("div",dt,[d(p,{width:"w-24",shine:!0}),d(p,{width:"w-4",shine:!0})])])):(a(),h(S,{key:1},[s("h1",lt,b(i.isCreating?"Add Order":`#${i.order.number} ${i.order.customer_first_name}`),1),i.isCreating?m("",!0):(a(),h(S,{key:0},[d(g),d(_)],64))],64))]),!i.isEditting&&!i.isCreating?(a(),h("div",ct,[d(y),d(C),d(M),d(T),d($),d(l)])):m("",!0)])])}const pt=w(tt,[["render",ht]]),ut={inject:["orderState","storeState","formState","notificationState","changeHistoryState"],components:{OrderHeader:pt},watch:{store(r,e){!e&&r&&this.setup()}},computed:{store(){return this.storeState.store},order(){return this.orderState.order},orderId(){return this.$route.params.order_id},duplicateOrderId(){return this.$route.query.duplicate_order_id},isEditing(){return this.$route.name==="edit-order"},isCreating(){return this.$route.name==="create-order"},orderForm(){return this.orderState.orderForm}},methods:{setup(){this.store&&(this.orderId||this.duplicateOrderId?this.showOrder():this.orderState.setOrderForm(null),(this.isCreating||this.isEditing)&&(this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Create Order",this.isEditing?this.updateOrder:this.createOrder,"primary",null)))},async showOrder(){var r,e;try{this.orderState.isLoadingOrder=!0;let t={params:{store_id:this.store.id,_relationships:["orderProducts.photo","orderPromotions","orderFees","orderDiscounts","orderComments","customer","courier","deliveryMethod","deliveryAddress"].join(",")}};const o=(await axios.get(`/api/orders/${this.orderId||this.duplicateOrderId}`,t)).data;this.orderState.setOrder(o),this.orderState.setOrderForm(o)}catch(t){const n=((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while fetching order";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(t),console.error("Failed to fetch order:",t),t.status==404&&await this.$router.replace({name:"show-orders",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}finally{this.orderState.isLoadingOrder=!1}},async createOrder(){var r,e;try{this.changeHistoryState.actionButtons[1].loading=!0;const t={...this.orderForm,guest_id:this.guestId,store_id:this.store.id,association:"team member"},n=await axios.post("/api/orders",t);this.notificationState.showSuccessNotification("Order created"),this.changeHistoryState.resetHistoryToCurrent(),this.orderState.setShoppingCart(null);const o=n.data.order;this.onView(o)}catch(t){const n=((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while creating order";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(t),console.error("Failed to create order:",t)}finally{this.changeHistoryState.actionButtons[1].loading=!1}},async updateOrder(){var r,e;try{this.changeHistoryState.actionButtons[1].loading=!0;const t={...this.orderForm,guest_id:this.guestId,store_id:this.store.id,association:"team member"},n=await axios.put(`/api/orders/${this.order.id}`,t);this.notificationState.showSuccessNotification("Order updated"),this.changeHistoryState.resetHistoryToCurrent(),this.orderState.setShoppingCart(null);const o=n.data.order;this.onView(o)}catch(t){const n=((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while updating order";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(t),console.error("Failed to update order:",t)}finally{this.changeHistoryState.actionButtons[1].loading=!1}},onView(r){this.$router.push({name:"show-order",params:{order_id:r.id},query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},setOrderForm(r){this.orderState.orderForm=r}},beforeRouteUpdate(r,e,t){if(this.changeHistoryState.hasChangeHistory&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return t(!1);t()},beforeRouteLeave(r,e,t){if(this.changeHistoryState.hasChangeHistory&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return t(!1);t()},unmounted(){this.orderState.reset(),this.changeHistoryState.reset()},created(){this.setup();const r=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let e=0;e<r.length;e++){let t=r[e];this.changeHistoryState.listeners[t]=this.setOrderForm}}},mt={class:"pt-24 px-4"};function gt(r,e,t,n,o,i){const u=c("OrderHeader"),p=c("router-view");return a(),h("div",mt,[d(u),d(p)])}const qt=w(ut,[["render",gt]]);export{qt as default};
