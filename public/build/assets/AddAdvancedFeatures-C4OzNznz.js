import{i as Li}from"./isEqual-D_8aNiOR.js";import{A as ji}from"./Alert-DLv8D8f2.js";import{I as ut,p as ct}from"./Input-CE4RPfme.js";import{c as ge}from"./cloneDeep-CRZrXCcn.js";import{B as mt}from"./Button-gD2nuYEJ.js";import{S as Bi}from"./Switch-Bn46wuTp.js";import{S as Ri}from"./Skeleton-caFmp0IF.js";import{S as Wi}from"./StoreLogo-Df2VlIwX.js";import{q as ye,m as Hi,s as ot,d as Z,g as C,r as v,o as g,b as o,n as Gi,u as lt,c as T,a as p,F as Ie,f as Pe,t as ae,e as se,T as qi}from"./app-DzEmJHii.js";import{P as Ki}from"./Pill-DvJ1xfHb.js";import{M as Yi}from"./Modal-onlEinK3.js";import{_ as ft}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as Zi}from"./plus-9ZeBx_gh.js";import{C as Ji}from"./Popover-DanCA_pE.js";import{S as Xi}from"./smartphone-LOxdy19d.js";import{c as we}from"./createLucideIcon-B1C9m8SV.js";import{M as Qi}from"./move-right-dsRLGEJ0.js";import"./info-P1D1b4JP.js";import"./Copy-BxvDy_-Q.js";import"./ShineEffect-7ISWLx82.js";import"./Loader-BbY_PjoY.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=we("bell-ring",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=we("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=we("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=we("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);var re={exports:{}};re.exports;var dt;function ss(){return dt||(dt=1,function(a,r){var s=200,u="__lodash_hash_undefined__",l=1,d=2,z=9007199254740991,F="[object Arguments]",W="[object Array]",I="[object AsyncFunction]",S="[object Boolean]",U="[object Date]",L="[object Error]",ne="[object Function]",ve="[object GeneratorFunction]",J="[object Map]",oe="[object Number]",xe="[object Null]",P="[object Object]",m="[object Promise]",Q="[object Proxy]",Oe="[object RegExp]",le="[object Set]",De="[object String]",ht="[object Symbol]",pt="[object Undefined]",Se="[object WeakMap]",Ve="[object ArrayBuffer]",de="[object DataView]",_t="[object Float32Array]",bt="[object Float64Array]",gt="[object Int8Array]",yt="[object Int16Array]",wt="[object Int32Array]",vt="[object Uint8Array]",xt="[object Uint8ClampedArray]",St="[object Uint16Array]",Ft="[object Uint32Array]",Nt=/[\\^$.*+?()[\]{}|]/g,Mt=/^\[object .+?Constructor\]$/,At=/^(?:0|[1-9]\d*)$/,f={};f[_t]=f[bt]=f[gt]=f[yt]=f[wt]=f[vt]=f[xt]=f[St]=f[Ft]=!0,f[F]=f[W]=f[Ve]=f[S]=f[de]=f[U]=f[L]=f[ne]=f[J]=f[oe]=f[P]=f[Oe]=f[le]=f[De]=f[Se]=!1;var ze=typeof ye=="object"&&ye&&ye.Object===Object&&ye,Tt=typeof self=="object"&&self&&self.Object===Object&&self,O=ze||Tt||Function("return this")(),Ue=r&&!r.nodeType&&r,Le=Ue&&!0&&a&&!a.nodeType&&a,je=Le&&Le.exports===Ue,Fe=je&&ze.process,Be=function(){try{return Fe&&Fe.binding&&Fe.binding("util")}catch{}}(),Re=Be&&Be.isTypedArray;function kt(e,t){for(var i=-1,n=e==null?0:e.length,h=0,c=[];++i<n;){var b=e[i];t(b,i,e)&&(c[h++]=b)}return c}function Ct(e,t){for(var i=-1,n=t.length,h=e.length;++i<n;)e[h+i]=t[i];return e}function Et(e,t){for(var i=-1,n=e==null?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1}function It(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}function Pt(e){return function(t){return e(t)}}function Ot(e,t){return e.has(t)}function Dt(e,t){return e==null?void 0:e[t]}function Vt(e){var t=-1,i=Array(e.size);return e.forEach(function(n,h){i[++t]=[h,n]}),i}function zt(e,t){return function(i){return e(t(i))}}function Ut(e){var t=-1,i=Array(e.size);return e.forEach(function(n){i[++t]=n}),i}var Lt=Array.prototype,jt=Function.prototype,ue=Object.prototype,Ne=O["__core-js_shared__"],We=jt.toString,E=ue.hasOwnProperty,He=function(){var e=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ge=ue.toString,Bt=RegExp("^"+We.call(E).replace(Nt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=je?O.Buffer:void 0,ce=O.Symbol,Ke=O.Uint8Array,Ye=ue.propertyIsEnumerable,Rt=Lt.splice,H=ce?ce.toStringTag:void 0,Ze=Object.getOwnPropertySymbols,Wt=qe?qe.isBuffer:void 0,Ht=zt(Object.keys,Object),Me=X(O,"DataView"),$=X(O,"Map"),Ae=X(O,"Promise"),Te=X(O,"Set"),ke=X(O,"WeakMap"),ee=X(Object,"create"),Gt=K(Me),qt=K($),Kt=K(Ae),Yt=K(Te),Zt=K(ke),Je=ce?ce.prototype:void 0,Ce=Je?Je.valueOf:void 0;function G(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function Jt(){this.__data__=ee?ee(null):{},this.size=0}function Xt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Qt(e){var t=this.__data__;if(ee){var i=t[e];return i===u?void 0:i}return E.call(t,e)?t[e]:void 0}function $t(e){var t=this.__data__;return ee?t[e]!==void 0:E.call(t,e)}function ei(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=ee&&t===void 0?u:t,this}G.prototype.clear=Jt,G.prototype.delete=Xt,G.prototype.get=Qt,G.prototype.has=$t,G.prototype.set=ei;function D(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function ti(){this.__data__=[],this.size=0}function ii(e){var t=this.__data__,i=fe(t,e);if(i<0)return!1;var n=t.length-1;return i==n?t.pop():Rt.call(t,i,1),--this.size,!0}function si(e){var t=this.__data__,i=fe(t,e);return i<0?void 0:t[i][1]}function ri(e){return fe(this.__data__,e)>-1}function ai(e,t){var i=this.__data__,n=fe(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this}D.prototype.clear=ti,D.prototype.delete=ii,D.prototype.get=si,D.prototype.has=ri,D.prototype.set=ai;function q(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function ni(){this.size=0,this.__data__={hash:new G,map:new($||D),string:new G}}function oi(e){var t=he(this,e).delete(e);return this.size-=t?1:0,t}function li(e){return he(this,e).get(e)}function di(e){return he(this,e).has(e)}function ui(e,t){var i=he(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this}q.prototype.clear=ni,q.prototype.delete=oi,q.prototype.get=li,q.prototype.has=di,q.prototype.set=ui;function me(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new q;++t<i;)this.add(e[t])}function ci(e){return this.__data__.set(e,u),this}function mi(e){return this.__data__.has(e)}me.prototype.add=me.prototype.push=ci,me.prototype.has=mi;function j(e){var t=this.__data__=new D(e);this.size=t.size}function fi(){this.__data__=new D,this.size=0}function hi(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function pi(e){return this.__data__.get(e)}function _i(e){return this.__data__.has(e)}function bi(e,t){var i=this.__data__;if(i instanceof D){var n=i.__data__;if(!$||n.length<s-1)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new q(n)}return i.set(e,t),this.size=i.size,this}j.prototype.clear=fi,j.prototype.delete=hi,j.prototype.get=pi,j.prototype.has=_i,j.prototype.set=bi;function gi(e,t){var i=pe(e),n=!i&&Pi(e),h=!i&&!n&&Ee(e),c=!i&&!n&&!h&&at(e),b=i||n||h||c,y=b?It(e.length,String):[],w=y.length;for(var _ in e)E.call(e,_)&&!(b&&(_=="length"||h&&(_=="offset"||_=="parent")||c&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Ti(_,w)))&&y.push(_);return y}function fe(e,t){for(var i=e.length;i--;)if(tt(e[i][0],t))return i;return-1}function yi(e,t,i){var n=t(e);return pe(e)?n:Ct(n,i(e))}function te(e){return e==null?e===void 0?pt:xe:H&&H in Object(e)?Mi(e):Ii(e)}function Xe(e){return ie(e)&&te(e)==F}function Qe(e,t,i,n,h){return e===t?!0:e==null||t==null||!ie(e)&&!ie(t)?e!==e&&t!==t:wi(e,t,i,n,Qe,h)}function wi(e,t,i,n,h,c){var b=pe(e),y=pe(t),w=b?W:B(e),_=y?W:B(t);w=w==F?P:w,_=_==F?P:_;var N=w==P,k=_==P,x=w==_;if(x&&Ee(e)){if(!Ee(t))return!1;b=!0,N=!1}if(x&&!N)return c||(c=new j),b||at(e)?$e(e,t,i,n,h,c):Fi(e,t,w,i,n,h,c);if(!(i&l)){var M=N&&E.call(e,"__wrapped__"),A=k&&E.call(t,"__wrapped__");if(M||A){var R=M?e.value():e,V=A?t.value():t;return c||(c=new j),h(R,V,i,n,c)}}return x?(c||(c=new j),Ni(e,t,i,n,h,c)):!1}function vi(e){if(!rt(e)||Ci(e))return!1;var t=it(e)?Bt:Mt;return t.test(K(e))}function xi(e){return ie(e)&&st(e.length)&&!!f[te(e)]}function Si(e){if(!Ei(e))return Ht(e);var t=[];for(var i in Object(e))E.call(e,i)&&i!="constructor"&&t.push(i);return t}function $e(e,t,i,n,h,c){var b=i&l,y=e.length,w=t.length;if(y!=w&&!(b&&w>y))return!1;var _=c.get(e);if(_&&c.get(t))return _==t;var N=-1,k=!0,x=i&d?new me:void 0;for(c.set(e,t),c.set(t,e);++N<y;){var M=e[N],A=t[N];if(n)var R=b?n(A,M,N,t,e,c):n(M,A,N,e,t,c);if(R!==void 0){if(R)continue;k=!1;break}if(x){if(!Et(t,function(V,Y){if(!Ot(x,Y)&&(M===V||h(M,V,i,n,c)))return x.push(Y)})){k=!1;break}}else if(!(M===A||h(M,A,i,n,c))){k=!1;break}}return c.delete(e),c.delete(t),k}function Fi(e,t,i,n,h,c,b){switch(i){case de:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ve:return!(e.byteLength!=t.byteLength||!c(new Ke(e),new Ke(t)));case S:case U:case oe:return tt(+e,+t);case L:return e.name==t.name&&e.message==t.message;case Oe:case De:return e==t+"";case J:var y=Vt;case le:var w=n&l;if(y||(y=Ut),e.size!=t.size&&!w)return!1;var _=b.get(e);if(_)return _==t;n|=d,b.set(e,t);var N=$e(y(e),y(t),n,h,c,b);return b.delete(e),N;case ht:if(Ce)return Ce.call(e)==Ce.call(t)}return!1}function Ni(e,t,i,n,h,c){var b=i&l,y=et(e),w=y.length,_=et(t),N=_.length;if(w!=N&&!b)return!1;for(var k=w;k--;){var x=y[k];if(!(b?x in t:E.call(t,x)))return!1}var M=c.get(e);if(M&&c.get(t))return M==t;var A=!0;c.set(e,t),c.set(t,e);for(var R=b;++k<w;){x=y[k];var V=e[x],Y=t[x];if(n)var nt=b?n(Y,V,x,t,e,c):n(V,Y,x,e,t,c);if(!(nt===void 0?V===Y||h(V,Y,i,n,c):nt)){A=!1;break}R||(R=x=="constructor")}if(A&&!R){var _e=e.constructor,be=t.constructor;_e!=be&&"constructor"in e&&"constructor"in t&&!(typeof _e=="function"&&_e instanceof _e&&typeof be=="function"&&be instanceof be)&&(A=!1)}return c.delete(e),c.delete(t),A}function et(e){return yi(e,Vi,Ai)}function he(e,t){var i=e.__data__;return ki(t)?i[typeof t=="string"?"string":"hash"]:i.map}function X(e,t){var i=Dt(e,t);return vi(i)?i:void 0}function Mi(e){var t=E.call(e,H),i=e[H];try{e[H]=void 0;var n=!0}catch{}var h=Ge.call(e);return n&&(t?e[H]=i:delete e[H]),h}var Ai=Ze?function(e){return e==null?[]:(e=Object(e),kt(Ze(e),function(t){return Ye.call(e,t)}))}:zi,B=te;(Me&&B(new Me(new ArrayBuffer(1)))!=de||$&&B(new $)!=J||Ae&&B(Ae.resolve())!=m||Te&&B(new Te)!=le||ke&&B(new ke)!=Se)&&(B=function(e){var t=te(e),i=t==P?e.constructor:void 0,n=i?K(i):"";if(n)switch(n){case Gt:return de;case qt:return J;case Kt:return m;case Yt:return le;case Zt:return Se}return t});function Ti(e,t){return t=t??z,!!t&&(typeof e=="number"||At.test(e))&&e>-1&&e%1==0&&e<t}function ki(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ci(e){return!!He&&He in e}function Ei(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||ue;return e===i}function Ii(e){return Ge.call(e)}function K(e){if(e!=null){try{return We.call(e)}catch{}try{return e+""}catch{}}return""}function tt(e,t){return e===t||e!==e&&t!==t}var Pi=Xe(function(){return arguments}())?Xe:function(e){return ie(e)&&E.call(e,"callee")&&!Ye.call(e,"callee")},pe=Array.isArray;function Oi(e){return e!=null&&st(e.length)&&!it(e)}var Ee=Wt||Ui;function Di(e,t){return Qe(e,t)}function it(e){if(!rt(e))return!1;var t=te(e);return t==ne||t==ve||t==I||t==Q}function st(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=z}function rt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ie(e){return e!=null&&typeof e=="object"}var at=Re?Pt(Re):xi;function Vi(e){return Oi(e)?gi(e):Si(e)}function zi(){return[]}function Ui(){return!1}a.exports=Di}(re,re.exports)),re.exports}var rs=ss();const as=Hi(rs),ns={inject:["formState","notificationState"],components:{Pill:Ki,Input:ut,Modal:Yi,Button:mt},props:{modelValue:{type:[String,Array]},isSubmitting:{type:Boolean,default:!1},createMobileNumber:{type:Function,default:null},updateMobileNumber:{type:Function,default:null},deleteMobileNumber:{type:Function,default:null},bodyClass:{type:String,default:null}},data(){return{Plus:Zi,form:{mobile_number:""},InputKey:0,originalForm:null,mobileNumber:null,mobileNumberIndex:null}},computed:{hasMobileNumbers(){return this.modelValue.length>0},nationalMobileNumbers(){return this.modelValue.map(a=>ct(a).formatNational().replace(/\s+/g,""))},formHasChanged(){return!as(this.form,this.originalForm)},mustSaveChanges(){return this.formHasChanged&&!this.isSubmitting}},methods:{onShow(){++this.InputKey},showMobileNumber(a,r,s){this.mobileNumberIndex=s,this.mobileNumber=r,this.mobileNumber?this.setForm():this.resetForm(),a()},setForm(){this.form.mobile_number=this.mobileNumber,this.originalForm=ot(this.form)},resetForm(){this.form.mobile_number="",this.originalForm=ot(this.form)},_createMobileNumber(a){if(this.modelValue.some(s=>s===this.form.mobile_number)){this.notificationState.showWarningNotification("Mobile number already exists"),a();return}this.createMobileNumber?this.createMobileNumber(this.form.mobile_number,this.resetForm,a):(this.modelValue.push(this.form.mobile_number),this.$emit("change",this.modelValue),this.resetForm(),a())},_updateMobileNumber(a){if(this.modelValue.some(s=>s===this.form.mobile_number)){this.notificationState.showWarningNotification("Mobile number already exists"),a();return}this.updateMobileNumber?this.updateMobileNumber(this.form.mobile_number,this.mobileNumberIndex,this.resetForm,a):(this.modelValue.splice(this.mobileNumberIndex,1,this.form.mobile_number),this.$emit("change",this.modelValue),this.resetForm(),a())},_deleteMobileNumber(a){this.deleteMobileNumber?this.deleteMobileNumber(this.mobileNumberIndex,this.resetForm,a):(this.modelValue.splice(this.mobileNumberIndex,1),this.$emit("change",this.modelValue),this.resetForm(),a())}}},os={class:"flex space-x-2 mt-4"},ls={key:0,class:"flex flex-wrap gap-2"},ds={class:"flex items-center"},us={class:"mx-2"};function cs(a,r,s,u,l,d){const z=v("Input"),F=v("Button"),W=v("Pill"),I=v("Modal");return g(),Z(I,{onShow:d.onShow,showFooter:!1,scrollOnContent:!1,header:l.mobileNumber?"Edit Mobile Number":"Add Mobile Number"},{content:C(S=>[o("div",null,[(g(),Z(z,{type:"text",key:l.InputKey,label:"Mobile Number",modelValue:l.form.mobile_number,"onUpdate:modelValue":r[0]||(r[0]=U=>l.form.mobile_number=U),errorText:d.formState.getFormError("mobile_number")},null,8,["modelValue","errorText"])),o("div",os,[l.mobileNumber?(g(),Z(F,{key:0,size:"sm",type:"danger",disabled:s.isSubmitting,action:()=>d._deleteMobileNumber(S.hideModal)},{default:C(()=>r[1]||(r[1]=[o("span",null,"Delete",-1)])),_:2,__:[1]},1032,["disabled","action"])):se("",!0),p(F,{size:"sm",type:"success",buttonClass:"w-full",disabled:!d.mustSaveChanges,action:()=>l.mobileNumber?d._updateMobileNumber(S.hideModal):d._createMobileNumber(S.hideModal)},{default:C(()=>[o("span",null,ae(l.mobileNumber?"Save Changes":"Add Mobile Number"),1)]),_:2},1032,["disabled","action"])])])]),trigger:C(S=>[o("div",{class:Gi(s.bodyClass)},[lt(a.$slots,"content"),d.hasMobileNumbers?(g(),T("div",ls,[lt(a.$slots,"prefix"),(g(!0),T(Ie,null,Pe(d.nationalMobileNumbers,(U,L)=>(g(),Z(W,{size:"xs",key:L,type:"primary",showDot:!1,action:()=>d.showMobileNumber(S.showModal,s.modelValue[L],L)},{default:C(()=>[o("div",ds,[o("span",us,ae(U),1),r[2]||(r[2]=o("svg",{class:"w-3 h-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})],-1))])]),_:2},1032,["action"]))),128)),p(F,{size:"sm",icon:"add",leftIcon:l.Plus,leftIconSize:"16",buttonClass:"w-48",rounded:"rounded-full",action:()=>d.showMobileNumber(S.showModal,null,null)},{default:C(()=>r[3]||(r[3]=[o("span",{class:"text-xs"},"Add Mobile Number",-1)])),_:2,__:[3]},1032,["leftIcon","action"])])):(g(),Z(F,{key:1,type:"light",size:"xs",action:()=>d.showMobileNumber(S.showModal,null,null),buttonClass:"w-48"},{default:C(()=>r[4]||(r[4]=[o("span",{class:"whitespace-nowrap ml-2"},"Add Mobile Number",-1)])),_:2,__:[4]},1032,["action"]))],2)]),_:3},8,["onShow","header"])}const ms=ft(ns,[["render",cs]]),fs={inject:["formState","storeState","notificationState"],components:{Alert:ji,Input:ut,Button:mt,StoreLogo:Wi,Skeleton:Ri,Switch:Bi,InputMobileNumbers:ms,Gift:es,Truck:is,MapPin:ts,BellRing:$i,Smartphone:Xi,CircleCheck:Ji},data(){return{MoveRight:Qi,workflows:[],isLoading:!1,deliveryMethods:[],isSubmitting:!1,additionalFeatures:{delivery:{active:!1,name:"Delivery",flat_fee_rate:"0.00"},self_pick_up_delivery:{active:!1,name:"Self-Pickup"},rewards:{active:!1,percentage_rate:"0"},automated_whatsapp_notifications:{active:!1,mobile_numbers:[],name:"Whatsapp a waiting order to the team"},ussd:{active:!1,call_to_action:"",mobile_number:""}},workflow:null,delivery:null,selfPickUpDelivery:null,originalAdditionalFeatures:null,options:[{name:"Accept credit cards"},{name:"Buy or connect existing domains"},{name:"Receive order notifications via SMS"}],appName:"Perfect Order"}},computed:{store(){return this.storeState.store},ussdMobileNumberWithoutExtension(){return this.additionalFeatures.ussd.mobile_number?ct(this.additionalFeatures.ussd.mobile_number).formatNational().replace(/\s+/g,""):""},additionalFeaturesHaveChanged(){var a=ge(this.additionalFeatures),r=ge(this.originalAdditionalFeatures);return!Li(a,r)}},methods:{async setup(){try{this.isLoading=!0,await Promise.all([this.showDeliveryMethods()]),this.additionalFeatures.rewards.active=this.store.offer_rewards,this.store.offer_rewards&&(this.additionalFeatures.rewards.percentage_rate=this.store.reward_percentage_rate.toString()),this.store.ussd_mobile_number&&(this.additionalFeatures.ussd.active=!0,this.additionalFeatures.ussd.call_to_action=this.store.call_to_action,this.additionalFeatures.ussd.mobile_number=this.store.ussd_mobile_number.international),this.originalAdditionalFeatures=ge(this.additionalFeatures)}catch(a){console.error("Error in setup():",a)}finally{this.isLoading=!1}},createMobileNumber(a,r,s){this.additionalFeatures.automated_whatsapp_notifications.mobile_numbers.push(a),s(),r()},updateMobileNumber(a,r,s,u){this.additionalFeatures.automated_whatsapp_notifications.mobile_numbers[r]=a,u(),s()},deleteMobileNumber(a,r,s){this.additionalFeatures.automated_whatsapp_notifications.mobile_numbers.splice(a,1),s(),r()},async addAdvancedFeatures(){try{const a=[];this.isSubmitting=!0,a.push(this.updateStore()),this.delivery?a.push(this.updateDeliveryOption()):this.additionalFeatures.delivery.active&&a.push(this.addDeliveryOption()),this.selfPickUpDelivery?a.push(this.updateSelfPickUpOption()):this.additionalFeatures.self_pick_up_delivery.active&&a.push(this.addSelfPickUpOption()),await Promise.all(a)}catch(a){const r=(a==null?void 0:a.message)||"Something went wrong while setting up";this.notificationState.showWarningNotification(r),console.error("Failed to setup:",a)}finally{this.isSubmitting=!1,this.originalAdditionalFeatures=ge(this.additionalFeatures),this.navigateToShare()}},async updateStore(){var a,r,s,u,l;try{let d={offer_rewards:this.additionalFeatures.rewards.active};((a=this.additionalFeatures.ussd.call_to_action)==null?void 0:a.trim())!=""&&(d.call_to_action=this.additionalFeatures.ussd.call_to_action),((r=this.additionalFeatures.ussd.mobile_number)==null?void 0:r.trim())!=""&&(d.ussd_mobile_number=this.additionalFeatures.ussd.mobile_number),((s=this.additionalFeatures.rewards.percentage_rate)==null?void 0:s.trim())!=""&&(d.reward_percentage_rate=this.additionalFeatures.rewards.percentage_rate),await axios.put(`/api/stores/${this.store.id}`,d),this.storeState.setStore({...this.store,...d})}catch(d){const z=((l=(u=d==null?void 0:d.response)==null?void 0:u.data)==null?void 0:l.message)||(d==null?void 0:d.message)||"Something went wrong while updating store";this.notificationState.showWarningNotification(z),this.formState.setServerFormErrors(d),console.error("Failed to update store changes:",d)}},async addDeliveryOption(){var a,r;try{let s={return:!0,active:!0,charge_fee:!0,fee_type:"flat fee",store_id:this.store.id,description:"We deliver to you",name:this.additionalFeatures.delivery.name,flat_fee_rate:this.additionalFeatures.delivery.flat_fee_rate};const u=await axios.post("/api/delivery-methods",s);this.delivery=u.data.delivery_method}catch(s){const u=((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.message)||(s==null?void 0:s.message)||"Something went wrong while creating delivery method";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(s),console.error("Failed to create delivery method:",s)}},async updateDeliveryOption(){var a,r;try{let s={return:!0,charge_fee:!0,fee_type:"flat fee",store_id:this.store.id,description:"We deliver to you",name:this.additionalFeatures.delivery.name,active:this.additionalFeatures.delivery.active,flat_fee_rate:this.additionalFeatures.delivery.flat_fee_rate};const u=await axios.put(`/api/delivery-methods/${this.delivery.id}`,s);this.delivery=u.data.delivery_method}catch(s){const u=((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.message)||(s==null?void 0:s.message)||"Something went wrong while updating delivery method";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(s),console.error("Failed to update delivery method:",s)}},async addSelfPickUpOption(){var a,r;try{let s={return:!0,active:!0,store_id:this.store.id,description:"You collect the order yourself",name:this.additionalFeatures.self_pick_up_delivery.name};const u=await axios.post("/api/delivery-methods",s);this.selfPickUpDelivery=u.data.delivery_method}catch(s){const u=((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.message)||(s==null?void 0:s.message)||"Something went wrong while creating self pickup delivery method";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(s),console.error("Failed to create self pickup delivery method:",s)}},async updateSelfPickUpOption(){var a,r;try{let s={return:!0,store_id:this.store.id,description:"You collect the order yourself",name:this.additionalFeatures.self_pick_up_delivery.name,active:this.additionalFeatures.self_pick_up_delivery.active};const u=await axios.put(`/api/delivery-methods/${this.selfPickUpDelivery.id}`,s);this.selfPickUpDelivery=u.data.delivery_method}catch(s){const u=((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.message)||(s==null?void 0:s.message)||"Something went wrong while updating self pickup delivery method";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(s),console.error("Failed to update self pickup delivery method:",s)}},async addAutomatedWhatsAppNotifications(){var a,r;try{let s={return:!0,active:!0,resource:"order",trigger:"waiting",store_id:this.store.id,name:this.additionalFeatures.automated_whatsapp_notifications.name},u=await axios.post("/api/workflows",s);this.workflow=u.data.workflow,s={return:!0,settings:{recipient:"team",action:"whatsapp",mobile_numbers:this.additionalFeatures.automated_whatsapp_notifications.mobile_numbers},workflow_id:this.workflow.id},u=await axios.post("/api/workflow-steps",s),this.workflowStep=u.data.workflow_step}catch(s){const u=((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.message)||(s==null?void 0:s.message)||"Something went wrong while creating workflow";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(s),console.error("Failed to create workflow:",s)}},async updateAutomatedWhatsAppNotifications(){try{let a={return:!0,resource:"order",trigger:"waiting",store_id:this.store.id,name:this.additionalFeatures.automated_whatsapp_notifications.name,active:this.additionalFeatures.automated_whatsapp_notifications.active};const r=await axios.put(`/api/workflows/${this.workflow.id}`,a);this.workflow=r.data.workflow}catch(a){this.formState.setServerFormErrors(a)}},async showWorkflows(){var a,r;try{let s={params:{store_id:this.store.id,_relationships:"workflowSteps"}};const u=await axios.get("/api/workflows",s);this.workflows=u.data.data,this.workflow=this.workflows.find(l=>l.name==this.additionalFeatures.automated_whatsapp_notifications.name),this.workflow&&(this.additionalFeatures.automated_whatsapp_notifications.active=this.workflow.active)}catch(s){const u=((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.message)||(s==null?void 0:s.message)||"Something went wrong while fetching workflows";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(s),console.error("Failed to fetch workflows:",s)}},async showDeliveryMethods(){var a,r;try{let s={params:{store_id:this.store.id}};const u=await axios.get("/api/delivery-methods",s);this.deliveryMethods=u.data.data,this.delivery=this.deliveryMethods.find(l=>l.name==this.additionalFeatures.delivery.name),this.selfPickUpDelivery=this.deliveryMethods.find(l=>l.name==this.additionalFeatures.self_pick_up_delivery.name),this.delivery&&(this.additionalFeatures.delivery.active=this.delivery.active,this.additionalFeatures.delivery.flat_fee_rate=this.delivery.flat_fee_rate.amount_without_currency),this.selfPickUpDelivery&&(this.additionalFeatures.self_pick_up_delivery.active=this.selfPickUpDelivery.active)}catch(s){const u=((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.message)||(s==null?void 0:s.message)||"Something went wrong while fetching delivery methods";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(s),console.error("Failed to fetch delivery methods:",s)}},navigateToShare(){this.$router.push({name:"share",params:{store_id:this.store.id}})}},beforeRouteLeave(a,r,s){if((this.isSubmitting||this.additionalFeaturesHaveChanged)&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return s(!1);s()},created(){this.setup()}},hs={class:"min-h-screen flex flex-col items-center pt-20 pb-40"},ps={class:"w-full max-w-lg"},_s={class:"w-full max-w-lg"},bs={class:"mb-4"},gs={key:0,class:"space-y-2"},ys={class:"flex justify-between"},ws={class:"w-full flex items-center space-x-2"},vs={key:1,class:"space-y-3 mb-4"},xs={class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},Ss={class:"flex justify-between space-x-4 items-center"},Fs={class:"flex items-center space-x-2"},Ns={key:0,class:"w-full space-y-4 mt-4"},Ms={class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},As={class:"flex justify-between space-x-4 items-center"},Ts={class:"flex items-center space-x-2"},ks={class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},Cs={class:"flex justify-between space-x-4 items-center"},Es={class:"flex space-x-2"},Is={key:0,class:"w-full space-y-4 mt-4"},Ps={class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},Os={class:"flex justify-between space-x-4 items-center"},Ds={class:"flex space-x-2"},Vs={class:"space-y-1"},zs={class:"text-xs text-gray-400"},Us={key:0,class:"w-full space-y-4 mt-4 border-t border-dashed border-gray-200 pt-4"},Ls={class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},js={class:"flex justify-between space-x-4 items-center"},Bs={class:"flex space-x-2"},Rs={class:"space-y-1"},Ws={class:"text-xs text-gray-400"},Hs={key:0,class:"w-full space-y-4 mt-4"},Gs={class:"bg-white p-4 shadow-sm rounded-xl"},qs={class:"space-y-2"},Ks={class:"text-xs"},Ys={class:"flex justify-end"};function Zs(a,r,s,u,l,d){const z=v("StoreLogo"),F=v("Skeleton"),W=v("Truck"),I=v("Switch"),S=v("Input"),U=v("MapPin"),L=v("Gift"),ne=v("BellRing"),ve=v("InputMobileNumbers"),J=v("Smartphone"),oe=v("Alert"),xe=v("CircleCheck"),P=v("Button");return g(),T("div",hs,[o("div",ps,[p(z,{showButton:!1,class:"flex justify-center mb-4"}),r[10]||(r[10]=o("h2",{class:"text-2xl font-semibold text-center mb-2"},"Unlock More Possibilities",-1)),r[11]||(r[11]=o("p",{class:"text-gray-500 text-center mb-6"},"Enhance your store’s functionality with optional upgrades",-1))]),o("div",_s,[o("div",bs,[l.isLoading?(g(),T("div",gs,[(g(),T(Ie,null,Pe([1,2,3],(m,Q)=>o("div",{key:Q,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[o("div",ys,[o("div",null,[o("div",ws,[p(F,{width:"w-4",shine:!0}),p(F,{width:"w-40",shine:!0})])]),o("div",null,[p(F,{width:"w-8",shine:!0})])])])),64))])):(g(),T("div",vs,[o("div",xs,[o("div",Ss,[o("div",Fs,[p(W,{size:"20",class:"shrink-0"}),r[12]||(r[12]=o("p",{class:"text-sm"}," Add Delivery option ",-1))]),p(I,{size:"md",modelValue:l.additionalFeatures.delivery.active,"onUpdate:modelValue":r[0]||(r[0]=m=>l.additionalFeatures.delivery.active=m)},null,8,["modelValue"])]),l.additionalFeatures.delivery.active?(g(),T("div",Ns,[p(S,{type:"money",label:"Delivery fee",errorText:d.formState.getFormError("flat_fee_rate"),modelValue:l.additionalFeatures.delivery.flat_fee_rate,"onUpdate:modelValue":r[1]||(r[1]=m=>l.additionalFeatures.delivery.flat_fee_rate=m),description:"You can set more rules in Settings » Delivery Methods"},null,8,["errorText","modelValue"])])):se("",!0)]),o("div",Ms,[o("div",As,[o("div",Ts,[p(U,{size:"20",class:"shrink-0"}),r[13]||(r[13]=o("p",{class:"text-sm"}," Add Self Pick-up option ",-1))]),p(I,{size:"md",modelValue:l.additionalFeatures.self_pick_up_delivery.active,"onUpdate:modelValue":r[2]||(r[2]=m=>l.additionalFeatures.self_pick_up_delivery.active=m)},null,8,["modelValue"])])]),o("div",ks,[o("div",Cs,[o("div",Es,[p(L,{size:"20",class:"shrink-0"}),r[14]||(r[14]=o("div",{class:"space-y-1"},[o("p",{class:"text-sm"}," Loyalty & Rewards "),o("p",{class:"text-xs text-gray-400"}," Reward your customers with store credits calculated as a percentage of their total purchase amount ")],-1))]),p(I,{size:"md",modelValue:l.additionalFeatures.rewards.active,"onUpdate:modelValue":r[3]||(r[3]=m=>l.additionalFeatures.rewards.active=m)},null,8,["modelValue"])]),l.additionalFeatures.rewards.active?(g(),T("div",Is,[p(S,{placeholder:"10",type:"percentage",label:"Rewards (%)",modelValue:l.additionalFeatures.rewards.percentage_rate,"onUpdate:modelValue":r[4]||(r[4]=m=>l.additionalFeatures.rewards.percentage_rate=m),errorText:d.formState.getFormError("reward_percentage_rate")},null,8,["modelValue","errorText"])])):se("",!0)]),o("div",Ps,[o("div",Os,[o("div",Ds,[p(ne,{size:"20",class:"shrink-0"}),o("div",Vs,[r[15]||(r[15]=o("p",{class:"text-sm"}," Automated WhatsApp notifications ",-1)),o("p",zs,ae(l.appName)+" will automatically send you Whatsapp notifications when you receive orders ",1)])]),p(I,{size:"md",modelValue:l.additionalFeatures.automated_whatsapp_notifications.active,"onUpdate:modelValue":r[5]||(r[5]=m=>l.additionalFeatures.automated_whatsapp_notifications.active=m)},null,8,["modelValue"])]),l.additionalFeatures.automated_whatsapp_notifications.active?(g(),T("div",Us,[p(ve,{isSubmitting:!1,createMobileNumber:d.createMobileNumber,updateMobileNumber:d.updateMobileNumber,deleteMobileNumber:d.deleteMobileNumber,modelValue:l.additionalFeatures.automated_whatsapp_notifications.mobile_numbers,"onUpdate:modelValue":r[6]||(r[6]=m=>l.additionalFeatures.automated_whatsapp_notifications.mobile_numbers=m)},null,8,["createMobileNumber","updateMobileNumber","deleteMobileNumber","modelValue"])])):se("",!0)]),o("div",Ls,[o("div",js,[o("div",Bs,[p(J,{size:"20",class:"shrink-0"}),o("div",Rs,[r[16]||(r[16]=o("p",{class:"text-sm"}," Available on USSD ",-1)),o("p",Ws," Your store will be available on "+ae(l.appName)+" supported Mobile Networks ",1)])]),p(I,{size:"md",modelValue:l.additionalFeatures.ussd.active,"onUpdate:modelValue":r[7]||(r[7]=m=>l.additionalFeatures.ussd.active=m)},null,8,["modelValue"])]),l.additionalFeatures.ussd.active?(g(),T("div",Hs,[p(oe,{dismissable:!1},{description:C(()=>r[17]||(r[17]=[o("p",{class:"font-semibold mb-4"},"Supported Networks",-1),o("img",{src:"/images/mobile-network-icons/orange.png",class:"w-10 rounded-sm"},null,-1)])),_:1}),p(S,{label:"Mobile Number",modelValue:l.additionalFeatures.ussd.mobile_number,"onUpdate:modelValue":r[8]||(r[8]=m=>l.additionalFeatures.ussd.mobile_number=m),errorText:d.formState.getFormError("ussd_mobile_number"),description:d.ussdMobileNumberWithoutExtension?`Customers dial *250*${d.ussdMobileNumberWithoutExtension}# to access your store`:"Enter your mobile number to create your shortcode"},null,8,["modelValue","errorText","description"]),p(S,{maxlength:"20",label:"Call To Action",placeholder:"Order pizza",modelValue:l.additionalFeatures.ussd.call_to_action,"onUpdate:modelValue":r[9]||(r[9]=m=>l.additionalFeatures.ussd.call_to_action=m),errorText:d.formState.getFormError("call_to_action"),description:"The call to action to start the shopping experience on USSD"},null,8,["modelValue","errorText"])])):se("",!0)]),o("div",Gs,[r[18]||(r[18]=o("p",{class:"text-sm font-bold mb-4"},"What Else Can I Do?",-1)),o("div",qs,[(g(!0),T(Ie,null,Pe(l.options,(m,Q)=>(g(),T("div",{key:Q,class:"flex items-center space-x-2"},[p(xe,{size:"16",class:"text-green-500"}),o("p",Ks,ae(m.name),1)]))),128))])])]))]),o("div",Ys,[p(qi,{name:"fade-1",mode:"out-in"},{default:C(()=>[d.additionalFeaturesHaveChanged?(g(),Z(P,{key:0,size:"md",type:"primary",buttonClass:"w-full",loading:l.isSubmitting,disabled:l.isSubmitting,action:d.addAdvancedFeatures},{default:C(()=>r[19]||(r[19]=[o("span",null,"Continue",-1)])),_:1,__:[19]},8,["loading","disabled","action"])):(g(),Z(P,{key:1,size:"md",type:"light",buttonClass:"w-40",rightIconSize:"24",rightIcon:l.MoveRight,action:d.navigateToShare},{default:C(()=>r[20]||(r[20]=[o("span",null,"Skip",-1)])),_:1,__:[20]},8,["rightIcon","action"]))]),_:1})])])])}const br=ft(fs,[["render",Zs]]);export{br as default};
