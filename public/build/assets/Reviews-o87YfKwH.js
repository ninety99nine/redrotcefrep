import{P as k}from"./Pill-CuSw6nga.js";import{I as L}from"./Input-DBnU4wzW.js";import{L as b}from"./Loader-DZWJgCmt.js";import{B as T}from"./Button-B134edVj.js";import{S as I}from"./Skeleton-Dmr_VmHU.js";import{a as _}from"./stringUtils-Bvzw0-oW.js";import{p as B,c as i,a as n,g as w,b as t,t as c,F as g,f,r as d,o as a,e as N}from"./app-CGNgl8eN.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as v}from"./star-Bmp9wHC5.js";import"./Popover-BZ2E_DR-.js";import"./Tooltip-BCHxPPLL.js";import"./Copy-Bp4ENaQe.js";import"./ShineEffect-D1V-RWKB.js";import"./createLucideIcon-BakIve7O.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-DblrTBks.js";import"./circle-check-Bkm_qb2i.js";import"./circle-alert-uARVagVJ.js";import"./x-DHw5U7EU.js";import"./parsePhoneNumber-xMTQFMCS.js";const j={inject:["formState","storeState","notificationState"],components:{Pill:k,Input:L,Loader:b,Button:T,Skeleton:I,Star:v},data(){return{Star:v,reviews:[],searchTerm:null,lastSearchTerm:null,isLoadingReviews:!1,hasLoadedInitialReviews:!1}},watch:{store(m,e){!e&&m&&this.setup()},searchTerm(){this.showReviews()}},computed:{store(){return this.storeState.store},isLoadingStore(){return this.storeState.isLoadingStore},hasSearchTerm(){return _(this.searchTerm)},hasReviews(){return this.reviews.length>0}},methods:{isNotEmpty:_,formattedRelativeDate:B,async setup(){this.store&&(this.hasLoadedInitialReviews||await this.showReviews())},onAddReview(){this.$router.push({name:"create-shop-review",params:{alias:this.store.alias}})},async showReviews(){var m,e;try{this.isLoadingReviews=!0;let o={params:{store_id:this.store.id}};this.hasSearchTerm&&(o.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const h=await axios.get("/api/reviews",o);if(this.searchTerm===this.lastSearchTerm){const r=h.data;this.reviews=r.data,this.hasLoadedInitialReviews=!0}}catch(o){const h=((e=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while fetching reviews";this.notificationState.showWarningNotification(h),this.formState.setServerFormErrors(o),console.error("Failed to fetch reviews:",o)}finally{this.isLoadingReviews=!1}}},created(){this.setup()}},A={class:"max-w-4xl mx-auto pt-8 pb-40"},C={key:0,class:"pt-8 flex items-center justify-center"},F={key:1,class:"select-none"},D={class:"flex justify-between items-end mb-4"},E={class:"space-y-2"},z={class:"text-lg font-semibold"},P={class:"flex justify-center items-center space-x-4 mb-4"},W={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},U={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},q={class:"flex items-center space-x-2 mb-2"},G={class:"flex space-x-1"},H={class:"text-sm font-medium text-gray-900"},J={key:0,class:"text-sm text-gray-900 mb-2"},K={class:"flex items-center space-x-2"},M={class:"text-sm text-gray-600"},O={class:"text-xs text-gray-600"},Q={key:2,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function X(m,e,o,h,r,l){const x=d("Loader"),y=d("Button"),S=d("Input"),p=d("Skeleton"),R=d("Star");return a(),i("div",A,[l.isLoadingStore?(a(),i("div",C,[n(x,null,{default:w(()=>[...e[2]||(e[2]=[t("span",{class:"text-sm ml-2"},"Loading store",-1)])]),_:1})])):(a(),i("div",F,[t("div",D,[t("div",E,[t("h1",z,c(l.store.name),1),e[3]||(e[3]=t("h1",{class:"text-lg font-semibold"},"Customer Reviews",-1))]),n(y,{size:"sm",type:"primary",leftIcon:r.Star,action:l.onAddReview},{default:w(()=>[...e[4]||(e[4]=[t("span",{class:"ml-1"},"Write A Review",-1)])]),_:1},8,["leftIcon","action"])]),t("div",P,[n(S,{type:"search",debounced:!0,class:"w-full",modelValue:r.searchTerm,"onUpdate:modelValue":e[0]||(e[0]=s=>r.searchTerm=s),skeleton:l.isLoadingStore,onInput:e[1]||(e[1]=s=>r.isLoadingReviews=!0),placeholder:"name, comment or rating e.g 3"},null,8,["modelValue","skeleton"])]),r.isLoadingReviews?(a(),i("div",W,[(a(),i(g,null,f(4,s=>t("div",{key:s,class:"p-4 bg-gray-100 rounded-lg"},[n(p,{width:"w-1/2",shine:!0,class:"mb-2"}),n(p,{width:"w-3/4",shine:!0,class:"mb-2"}),n(p,{width:"w-full",height:"h-4",shine:!0})])),64))])):l.hasReviews?(a(),i("div",U,[(a(!0),i(g,null,f(r.reviews,s=>(a(),i("div",{key:s.id,class:"p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-300"},[t("div",q,[t("div",G,[(a(),i(g,null,f(5,u=>n(R,{size:16,key:u,fill:u<=s.rating?"gold":"none",stroke:u<=s.rating?"gold":"gray"},null,8,["fill","stroke"])),64))]),t("span",H,c(s.rating)+"/5",1)]),s.comment?(a(),i("p",J,c(s.comment),1)):N("",!0),t("div",K,[t("span",M,c(s.name||"Anonymous"),1),e[5]||(e[5]=t("span",{class:"text-xs text-gray-400"},"â€¢",-1)),t("span",O,c(l.formattedRelativeDate(s.created_at)),1)])]))),128))])):(a(),i("p",Q," No reviews found. Be the first to share your experience! "))]))])}const _e=V(j,[["render",X]]);export{_e as default};
