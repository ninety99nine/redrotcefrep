import{i as j}from"./isEqual-Cg9VpqPn.js";import{P as K}from"./Pill-CfvZYk9z.js";import{A as le}from"./Alert-CB3c9GAw.js";import{I as X,X as se}from"./Input-CS_IpxN-.js";import{M as G}from"./Modal-Chnw6sO2.js";import{c as A}from"./cloneDeep-DOV9gdHf.js";import{B as Y}from"./Button-CbwcBUhP.js";import{L as ie}from"./Loader-9AWAUH8r.js";import{S as de}from"./Switch-CBb68870.js";import{S as Z}from"./Select-BwhuZWSS.js";import{P as ne}from"./Popover-CYo5yYtG.js";import{S as ue}from"./Skeleton-ConmgPQ-.js";import{S as ce}from"./SelectTags-BwGNbf4k.js";import{V as J}from"./vue-draggable-next.esm-bundler-CbjZCvl4.js";import{B as me}from"./BackdropLoader-CqYGKTy1.js";import{C as pe,c as p,b as l,a as n,e as d,w as M,g as V,r as S,n as E,d as c,D as $,o as s,F as L,f as H,t as D,i as U}from"./app-Cn46GS3I.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as I}from"./createLucideIcon-BlsGDRHQ.js";import{I as te}from"./image-CtGRLgTm.js";import{T as ge}from"./type-CdDrNpHq.js";import{M as re}from"./move-wYMAQvKe.js";import{P as oe}from"./plus-DXXu9REn.js";import{C as he,a as fe}from"./chevron-up-CLUG3vsa.js";import{M as ye}from"./move-left-CW6_gyp8.js";import{T as ve}from"./trash-2-DGdomozV.js";import"./info-EKKYiE0H.js";import"./Copy-BjK3wMF-.js";import"./ShineEffect-BLGg8IQO.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=I("arrow-down-up",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=I("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=I("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=I("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=I("split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=I("square-check",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),we={inject:["formState","productState"],components:{Move:re,List:Fe,Type:ge,Hash:Se,Image:te,Calendar:_e,SquareCheck:Ve,Pill:K,Input:X,Modal:G,Button:Y,Select:Z,draggable:J},data(){return{Plus:oe,originalFields:[],deletableDataCollectionField:null,typeOptions:[{label:"Text",value:"text"},{label:"Number",value:"number"},{label:"Date",value:"date"},{label:"Checkbox",value:"checkbox"},{label:"Selection",value:"selection"},{label:"Media",value:"media"}],validationOptions:[{label:"Not applicable",value:"not applicable"},{label:"Select at least",value:"select at least"},{label:"Select at most",value:"select at most"},{label:"Select between",value:"select between"}]}},computed:{productForm(){return this.productState.productForm},hasFields(){return this.productForm.data_collection_fields.length>0},hasOriginalFields(){return this.originalFields.length>0},hasCollapsedAll(){return this.productForm.data_collection_fields.every(a=>a.is_editable===!1)},hasExpandedAll(){return this.productForm.data_collection_fields.every(a=>a.is_editable===!0)},fieldsHaveChanged(){var a=A(this.productForm.data_collection_fields),t=A(this.originalFields);return a.forEach(i=>delete i.is_editable),t.forEach(i=>delete i.is_editable),!j(a,t)}},methods:{onAddField(){this.productForm.data_collection_fields.push({validation:"not applicable",temporary_id:pe(),enable_quantity:!0,is_editable:!0,required:!1,type:"text",options:[],name:"",min:"1",max:"2"}),this.productState.saveStateDebounced("Option added")},onRemoveField(a){const t=this.productForm.data_collection_fields.findIndex(i=>i.temporary_id==this.deletableDataCollectionField.temporary_id);this.productForm.data_collection_fields.splice(t,1),a(),this.productState.saveStateDebounced("Option removed")},onResetFields(){this.productForm.data_collection_fields=A(this.originalFields),this.productState.saveStateDebounced("Options restored")},onAddOption(a){this.productForm.data_collection_fields[a].options.push({name:"",fee:"0.00"}),this.productState.saveStateDebounced("Sub option added")},onRemoveOption(a,t){this.productForm.data_collection_fields[a].options.splice(t,1),this.productState.saveStateDebounced("Sub option removed")},collapseAll(){this.productForm.data_collection_fields.forEach(a=>{a.is_editable=!1})},expandAll(){this.productForm.data_collection_fields.forEach(a=>{a.is_editable=!0})},showDeleteConfirmationModal(a){this.deletableDataCollectionField=a,this.$refs.confirmDeleteModal.showModal()},supportsOptions(a){return a.type=="checkbox"||a.type=="selection"},hasOptions(a){return this.productForm.data_collection_fields[a].options.length>0}}},ke={key:0,class:"flex justify-end items-center space-x-2 px-2"},Te=["onClick"],De={class:"absolute top-2 right-2 flex items-center space-x-2 opacity-20 group-hover:opacity-100"},Ce=["onClick"],Ue=["onClick"],Pe={key:0,"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"},Ee={key:1,"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"},Me=["onClick"],Le={key:0,class:"space-y-4"},Ae={class:"flex items-center space-x-2"},Ie={class:"flex items-center justify-between space-x-8"},qe={class:"flex items-center space-x-4"},Oe={class:"w-full flex items-center space-x-4"},ze={class:"flex items-center space-x-4"},Be=["onClick"],je={key:0,class:"flex items-end space-x-2"},He={class:"relative"},Ne={class:"absolute -bottom-12 left-1/2 transform -translate-x-1/2"},Re={key:0,class:"animate-bounce text-4xl"},We=["onClick"],Qe={class:"flex items-center space-x-2 text-sm text-gray-500"},Ke={key:6},Xe={key:7,class:"font-medium text-red-500 text-xs ml-1"},Ge={key:0,class:"text-sm text-gray-700"},Ye={class:"flex justify-end space-x-2"},Ze={key:0,class:"flex items-start space-x-2 border border-gray-300 rounded-lg p-2 mb-4"},Je={class:"text-sm"},$e={class:"mb-8"};function et(a,t,i,m,o,e){const b=S("Move"),x=S("Type"),v=S("Hash"),F=S("Calendar"),h=S("SquareCheck"),w=S("List"),C=S("Image"),O=S("Select"),k=S("Input"),z=S("draggable"),q=S("Button"),B=S("Pill"),N=S("Modal");return s(),p("div",null,[l("div",{class:E(["space-y-4",{"mt-4":e.productForm.data_collection_fields.length<2}])},[e.productForm.data_collection_fields.length>=2?(s(),p("div",ke,[e.hasCollapsedAll?d("",!0):(s(),p("span",{key:0,class:"text-sm text-gray-500 underline hover:text-black cursor-pointer",onClick:t[0]||(t[0]=(...f)=>e.collapseAll&&e.collapseAll(...f))}," collapse all ")),e.hasExpandedAll?d("",!0):(s(),p("span",{key:1,class:"text-sm text-gray-500 underline hover:text-black cursor-pointer",onClick:t[1]||(t[1]=M((...f)=>e.expandAll&&e.expandAll(...f),["stop"]))}," expand all "))])):d("",!0),n(z,{class:"space-y-2",handle:".draggable-handle","ghost-class":"bg-yellow-50",modelValue:e.productForm.data_collection_fields,"onUpdate:modelValue":t[13]||(t[13]=f=>e.productForm.data_collection_fields=f)},{default:V(()=>[(s(!0),p(L,null,H(e.productForm.data_collection_fields,(f,u)=>(s(),p("div",{key:f.temporary_id,onClick:y=>e.productForm.data_collection_fields[u].is_editable?null:e.productForm.data_collection_fields[u].is_editable=!0,class:E(["w-full relative bg-gray-50 p-4 border border-gray-300 rounded-lg hover:bg-gray-100 group",{"cursor-pointer":!e.productForm.data_collection_fields[u].is_editable}])},[l("div",De,[e.productForm.data_collection_fields[u].is_editable?(s(),p("span",{key:0,class:"text-sm text-gray-500 underline hover:text-black cursor-pointer",onClick:M(y=>e.productForm.data_collection_fields[u].is_editable=!1,["stop"])}," close ",8,Ce)):(s(),p("svg",{key:1,class:"w-4 h-4 cursor-pointer hover:opacity-50",onClick:M(y=>e.productForm.data_collection_fields[u].is_editable=!0,["stop"]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e.productForm.data_collection_fields[u].is_editable?(s(),p("path",Pe)):(s(),p("path",Ee))],8,Ue)),(s(),p("svg",{onClick:M(y=>e.showDeleteConfirmationModal(f),["stop"]),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},t[14]||(t[14]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)]),8,Me)),n(b,{onClick:t[2]||(t[2]=M(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})]),e.productForm.data_collection_fields[u].is_editable?(s(),p("div",Le,[l("div",Ae,[f.type=="text"?(s(),c(x,{key:0,size:"20"})):d("",!0),f.type=="number"?(s(),c(v,{key:1,size:"20"})):d("",!0),f.type=="date"?(s(),c(F,{key:2,size:"20"})):d("",!0),f.type=="checkbox"?(s(),c(h,{key:3,size:"20"})):d("",!0),f.type=="selection"?(s(),c(w,{key:4,size:"20"})):d("",!0),f.type=="media"?(s(),c(C,{key:5,size:"20"})):d("",!0),n(O,{class:"w-60",search:!1,options:o.typeOptions,modelValue:e.productForm.data_collection_fields[u].type,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].type=y,onChange:t[3]||(t[3]=y=>e.productState.saveStateDebounced("Option type changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"type")},null,8,["options","modelValue","onUpdate:modelValue","errorText"])]),l("div",Ie,[n(k,{class:"w-full",placeholder:"Name",modelValue:e.productForm.data_collection_fields[u].name,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].name=y,onInput:t[4]||(t[4]=y=>e.productState.saveStateDebounced("Option name changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"name")},null,8,["modelValue","onUpdate:modelValue","errorText"]),l("div",qe,[n(k,{type:"checkbox",inputLabel:"Required",modelValue:e.productForm.data_collection_fields[u].required,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].required=y,onChange:t[5]||(t[5]=y=>e.productState.saveStateDebounced("Required status changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"required")},null,8,["modelValue","onUpdate:modelValue","errorText"]),e.supportsOptions(f)?(s(),c(k,{key:0,type:"checkbox",class:"whitespace-nowrap",inputLabel:"Enable quantity",modelValue:e.productForm.data_collection_fields[u].enable_quantity,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].enable_quantity=y,onChange:t[6]||(t[6]=y=>e.productState.saveStateDebounced("Enable quantity status changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"enable_quantity")},null,8,["modelValue","onUpdate:modelValue","errorText"])):d("",!0)])]),e.supportsOptions(f)?(s(),c(z,{key:0,class:"space-y-0",handle:".draggable-handle-2","ghost-class":"bg-yellow-50",modelValue:e.productForm.data_collection_fields[u].options,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].options=y},{default:V(()=>[(s(!0),p(L,null,H(e.productForm.data_collection_fields[u].options,(y,T)=>(s(),p("div",{key:T,class:"flex items-center justify-between space-x-4 rounded-lg py-2 px-2 hover:border-blue-200 hover:bg-gray-50 group"},[l("div",Oe,[n(k,{class:"w-full",placeholder:`Option ${T+1}`,modelValue:e.productForm.data_collection_fields[u].options[T].name,"onUpdate:modelValue":P=>e.productForm.data_collection_fields[u].options[T].name=P,onInput:t[7]||(t[7]=P=>e.productState.saveStateDebounced("Sub option name changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"options"+T+"name")},null,8,["placeholder","modelValue","onUpdate:modelValue","errorText"]),n(k,{type:"money",modelValue:e.productForm.data_collection_fields[u].options[T].fee,"onUpdate:modelValue":P=>e.productForm.data_collection_fields[u].options[T].fee=P,onInput:t[8]||(t[8]=P=>e.productState.saveStateDebounced("Sub option amount changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"options"+T+"fee")},null,8,["modelValue","onUpdate:modelValue","errorText"])]),l("div",ze,[(s(),p("svg",{onClick:P=>e.onRemoveOption(u,T),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},t[15]||(t[15]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)]),8,Be)),n(b,{onClick:t[9]||(t[9]=M(()=>{},["stop"])),size:"16",class:"draggable-handle-2 cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})])]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):d("",!0),e.supportsOptions(f)?(s(),p("div",{key:1,class:E(["flex",f.type=="checkbox"?"justify-between items-start":"justify-end"])},[f.type=="checkbox"?(s(),p("div",je,[n(O,{class:"w-60",search:!1,label:"Validation",options:o.validationOptions,modelValue:e.productForm.data_collection_fields[u].validation,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].validation=y,onChange:t[10]||(t[10]=y=>e.productState.saveStateDebounced("Validation changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"validation")},null,8,["options","modelValue","onUpdate:modelValue","errorText"]),e.productForm.data_collection_fields[u].validation=="select at least"||e.productForm.data_collection_fields[u].validation=="select between"?(s(),c(k,{key:0,min:"0",class:"w-24",type:"number",modelValue:e.productForm.data_collection_fields[u].min,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].min=y,onChange:t[11]||(t[11]=y=>e.productState.saveStateDebounced("Validation changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"min"),label:e.productForm.data_collection_fields[u].validation=="select at least"?null:"Min"},null,8,["modelValue","onUpdate:modelValue","errorText","label"])):d("",!0),e.productForm.data_collection_fields[u].validation=="select at most"||e.productForm.data_collection_fields[u].validation=="select between"?(s(),c(k,{key:1,min:"0",class:"w-24",type:"number",modelValue:e.productForm.data_collection_fields[u].max,"onUpdate:modelValue":y=>e.productForm.data_collection_fields[u].max=y,onChange:t[12]||(t[12]=y=>e.productState.saveStateDebounced("Validation changed")),errorText:e.formState.getFormError("data_collection_fields"+u+"max"),label:e.productForm.data_collection_fields[u].validation=="select at most"?null:"Max"},null,8,["modelValue","onUpdate:modelValue","errorText","label"])):d("",!0)])):d("",!0),l("div",He,[l("div",Ne,[e.hasOptions(u)?d("",!0):(s(),p("div",Re,"👆"))]),n(q,{size:"xs",type:"primary",leftIcon:o.Plus,action:()=>e.onAddOption(u)},{default:V(()=>t[16]||(t[16]=[l("span",null,"Add Choice",-1)])),_:2,__:[16]},1032,["leftIcon","action"])])],2)):d("",!0)])):(s(),p("div",{key:1,class:"space-y-2",onClick:y=>e.productForm.data_collection_fields[u].is_editable=!0},[l("div",Qe,[f.type=="text"?(s(),c(x,{key:0,size:"20"})):d("",!0),f.type=="number"?(s(),c(v,{key:1,size:"20"})):d("",!0),f.type=="date"?(s(),c(F,{key:2,size:"20"})):d("",!0),f.type=="checkbox"?(s(),c(h,{key:3,size:"20"})):d("",!0),f.type=="selection"?(s(),c(w,{key:4,size:"20"})):d("",!0),f.type=="media"?(s(),c(C,{key:5,size:"20"})):d("",!0),f.name?(s(),p("span",Ke,D(f.name),1)):(s(),p("span",Xe," No name ")),f.required?(s(),c(B,{key:8,type:"primary",size:"xs",showDot:!1},{default:V(()=>t[17]||(t[17]=[U("required")])),_:1,__:[17]})):d("",!0)])],8,We))],10,Te))),128))]),_:1},8,["modelValue"]),l("div",{class:E([{"flex space-x-2 justify-between":!e.hasFields}])},[e.hasFields?d("",!0):(s(),p("p",Ge,"Add options if your product must capture additional information from the customer")),l("div",Ye,[e.fieldsHaveChanged&&e.hasOriginalFields?(s(),c(q,{key:0,size:"xs",type:"primary",action:e.onResetFields},{default:V(()=>t[18]||(t[18]=[l("span",null,"Undo",-1)])),_:1,__:[18]},8,["action"])):d("",!0),n(q,{size:"xs",type:"light",leftIcon:o.Plus,action:e.onAddField},{default:V(()=>t[19]||(t[19]=[l("span",null,"Add Option",-1)])),_:1,__:[19]},8,["leftIcon","action"])])],2)],2),n(N,{approveType:"danger",approveText:"Delete",ref:"confirmDeleteModal",approveAction:f=>e.onRemoveField(f)},$({_:2},[o.deletableDataCollectionField?{name:"content",fn:V(()=>[t[22]||(t[22]=l("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),o.deletableDataCollectionField.name?(s(),p("div",Ze,[o.deletableDataCollectionField.type=="text"?(s(),c(x,{key:0,size:"20"})):d("",!0),o.deletableDataCollectionField.type=="number"?(s(),c(v,{key:1,size:"20"})):d("",!0),o.deletableDataCollectionField.type=="date"?(s(),c(F,{key:2,size:"20"})):d("",!0),o.deletableDataCollectionField.type=="checkbox"?(s(),c(h,{key:3,size:"20"})):d("",!0),o.deletableDataCollectionField.type=="selection"?(s(),c(w,{key:4,size:"20"})):d("",!0),o.deletableDataCollectionField.type=="media"?(s(),c(C,{key:5,size:"20"})):d("",!0),l("span",Je,D(o.deletableDataCollectionField.name),1)])):d("",!0),l("p",$e,[t[20]||(t[20]=U("Are you sure you want to delete this ")),n(B,{type:"primary",size:"xs",showDot:!1},{default:V(()=>[U(D(o.deletableDataCollectionField.type),1)]),_:1}),t[21]||(t[21]=U(" field?"))])]),key:"0"}:void 0]),1032,["approveAction"])])}const tt=ee(we,[["render",et]]),rt={inject:["formState","storeState","productState","changeHistoryState","notificationState"],components:{Move:re,Image:te,Split:xe,Pill:K,Alert:le,Input:X,Modal:G,Button:Y,Loader:ie,Switch:de,Select:Z,Popover:ne,Skeleton:ue,SelectTags:ce,draggable:J,BackdropLoader:me,DataCollectionFields:tt},data(){return{X:se,Plus:oe,Trash2:ve,MoveLeft:ye,tags:[],ChevronUp:fe,ArrowDownUp:be,ChevronDown:he,categories:[],deliveryMethods:[],selectedVariants:[],deletableVariant:null,isDeletingVariantIds:[],variantsForArrangement:[],isLoadingDeliveryMethods:!1,hasLoadedInitialDeliveryMethods:!1,pricePerUnitTypes:[{label:"G",value:"g"},{label:"KG",value:"kg"},{label:"L",value:"l"},{label:"ML",value:"ml"},{label:"PSC",value:"psc"},{label:"PAX",value:"pax"},{label:"PERSON",value:"person"},{label:"ROOM",value:"room"},{label:"PACK",value:"pack"},{label:"QTY",value:"qty"},{label:"LBS",value:"lbs"},{label:"HOUR",value:"hour"},{label:"BOX",value:"box"}],productTypes:[{label:"Physical",value:"physical"},{label:"Digital",value:"digital"},{label:"Booking",value:"booking"},{label:"Subscription",value:"subscription"},{label:"Other",value:"other"}],visibilityTypes:[{label:"Visible",value:!0},{label:"Hidden",value:!1}],stockQuantityTypes:[{label:"Unlimited",value:"unlimited"},{label:"Limited",value:"limited"}],allowedQuantityPerOrder:[{label:"Unlimited",value:"unlimited"},{label:"Limited",value:"limited"}]}},watch:{store(a,t){!t&&a&&this.setup()},productId(a){a&&(this.setup(),this.setActionButtons())}},computed:{store(){return this.storeState.store},product(){return this.productState.product},hasProduct(){return this.productState.hasProduct},productId(){return this.$route.params.product_id},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingProduct(){return this.productState.isLoadingProduct},isEditing(){return this.$route.name==="edit-product"},isCreating(){return this.$route.name==="create-product"},productForm(){return this.productState.productForm},isSubmitting(){return this.changeHistoryState.actionButtons.length==0?!1:this.changeHistoryState.actionButtons[1].loading},hasVariants(){return this.productState.hasVariants},isDeletingProduct(){return this.productState.isDeletingProduct},isCreatingVariants(){return this.productState.isCreatingVariants},isChangingVariantArrangement(){return this.productState.isChangingVariantArrangement},variantOptions(){return this.productForm.variants.filter(a=>a.name).map(a=>({label:a.name,value:a.temporary_id}))},deliveryMethodOptions(){return this.deliveryMethods.map(a=>({label:a.name,value:a.id}))}},methods:{goBack(){this.navigateToProducts()},async setup(){this.productForm==null&&this.productState.setProductForm(null,this.isCreating),this.isEditing&&this.store&&await this.showProduct(),this.store&&(this.tags=this.store.product_tags.map(a=>({label:a.name,value:a.id})),this.categories=this.store.categories.map(a=>({label:a.name,value:a.id})),!this.hasLoadedInitialDeliveryMethods&&!this.isLoadingDeliveryMethods&&this.showDeliveryMethods())},async navigateToProducts(){await this.$router.replace({name:"show-products",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},async onView(a){await this.$router.push({name:"edit-product",params:{product_id:a.id},query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},addVariant(){this.selectedVariants=[],this.productState.addVariant()},async removeVariant(a){this.selectedVariants=[];const t=this.productForm.variants[a];t.id?(this.deletableVariant=t,this.$refs.confirmDeleteVariantModal.showModal()):this.productState.removeVariant(a)},clearSelectedVariants(){this.selectedVariants=[]},isFilteredVariants(a){return this.selectedVariants.length==0||this.selectedVariants.includes(a.temporary_id)},toggleAdditionalVariantOptions(a){this.productForm.variants[a].show_more=!this.productForm.variants[a].show_more},showChangeArrangementModal(){this.setVariantsForArrangement(),this.$refs.changeArrangementModal.showModal()},setVariantsForArrangement(){this.variantsForArrangement=A(this.productForm.variants.map(a=>({name:a.name,temporary_id:a.temporary_id,photo:a.photos.length?a.photos[0]:null}))),this.$refs.changeArrangementModal.showModal()},async changeVariantArrangement(){var a,t;try{if(this.productState.isChangingVariantArrangement)return;const i=new Map(this.productForm.variants.map(e=>[e.temporary_id,e]));this.productForm.variants=this.variantsForArrangement.map(e=>i.get(e.temporary_id)).filter(e=>e!==void 0);const m=this.productForm.variants.filter(e=>e.id).map(e=>e.id);if(m.length==0)return;this.productState.isChangingVariantArrangement=!0;const o={store_id:this.store.id,product_ids:m,parent_product_id:this.product.id};await axios.post("/api/products/arrangement",o),this.notificationState.showSuccessNotification("Variant arrangement updated")}catch(i){const m=((t=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while updating variant arrangement";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(i),console.error("Failed to update variant arrangement:",i)}finally{this.productState.isChangingVariantArrangement=!1,this.$refs.changeArrangementModal.hideModal()}},async showProduct(){var a,t;try{this.productState.isLoadingProduct=!0;let i={params:{store_id:this.store.id,_relationships:["photos","tags","categories","variants.photos","deliveryMethods"].join(",")}};const o=(await axios.get(`/api/products/${this.productId}`,i)).data;this.productState.setProduct(o),this.productState.setProductForm(o)}catch(i){const m=((t=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching product";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(i),console.error("Failed to fetch product:",i),i.status==404&&await this.$router.replace({name:"show-products",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}finally{this.productState.isLoadingProduct=!1}},async createProduct(a=null,t=null){var i,m;try{if(a==null){if(this.productState.isCreatingProduct||this.productState.isUploading)return;this.formState.hideFormErrors(),(this.productForm.name==null||this.productForm.name.trim()==="")&&this.formState.setFormError("name","The name is required");for(let x=0;x<this.productForm.variants.length;x++){const v=this.productForm.variants[x];(v.name==null||v.name.trim()==="")&&this.formState.setFormError(`variants.${x}.name`,"The name is required")}if(this.formState.hasErrors)return;this.productState.isCreatingProduct=!0,this.changeHistoryState.actionButtons[1].loading=!0}let o;a?o={store_id:this.store.id,parent_product_id:a.id,...this.productForm.variants[t]}:o={...this.productForm,store_id:this.store.id};const b=(await axios.post("/api/products",o)).data.product;if(a)this.productForm.variants[t].id=b.id,this.productForm.variants[t].photos.length&&await this.uploadImages(this.productForm.variants[t].id,null,t);else{this.productForm.id=b.id,this.productForm.photos.length&&await this.uploadImages(this.productForm.id);for(let x=0;x<this.productForm.variants.length;x++)await this.createProduct(b,x);(this.productForm.tags.length||this.productForm.categories.length)&&this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Product created"),this.productState.saveOriginalState("Original product"),await this.onView(b)}}catch(o){const e=((m=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:m.message)||(o==null?void 0:o.message)||"Something went wrong while creating product";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(o),console.error("Failed to create product:",o)}finally{a==null&&(this.productState.isUploading=!1,this.productState.isCreatingProduct=!1,this.changeHistoryState.actionButtons[1].loading=!1)}},async updateProduct(a=null,t=null){var i,m;try{if(a==null){if(this.productState.isUpdatingProduct||this.productState.isUploading)return;this.formState.hideFormErrors(),(this.productForm.name==null||this.productForm.name.trim()==="")&&this.formState.setFormError("name","The name is required");for(let v=0;v<this.productForm.variants.length;v++){const F=this.productForm.variants[v];(F.name==null||F.name.trim()==="")&&this.formState.setFormError(`variants.${v}.name`,"The name is required")}if(this.formState.hasErrors)return;this.productState.isUpdatingProduct=!0,this.changeHistoryState.actionButtons[1].loading=!0}let o,e;a?(o=this.productForm.variants[t].id,e={store_id:this.store.id,...this.productForm.variants[t]}):(o=this.productForm.id,e={...this.productForm,store_id:this.store.id});const x=(await axios.put(`/api/products/${o}`,e)).data.product;if(a)this.productForm.variants[t].photos.length&&await this.uploadImages(this.productForm.variants[t].id,null,t);else{this.productForm.photos.length&&await this.uploadImages(this.productForm.id);const v=this.changeHistoryState.getOriginalState();if(this.productForm.variants.length)for(let F=0;F<this.productForm.variants.length;F++){const h=A(this.productForm.variants[F]),w=A(v.variants.find(C=>C.temporary_id==h.temporary_id));w?(delete h.show_more,delete w.show_more,j(h,w)||await this.updateProduct(x,F)):await this.createProduct(x,F)}(!j(this.productForm.tags,v.tags)||!j(this.productForm.categories,v.categories))&&this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Product updated"),this.productState.saveOriginalState("Original product")}}catch(o){const e=((m=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:m.message)||(o==null?void 0:o.message)||"Something went wrong while updating product";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(o),console.error("Failed to update product:",o)}finally{this.productState.isUploading=!1,this.productState.isUpdatingProduct=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async deleteProduct(a){var t,i;try{if(this.productState.isDeletingProduct)return;this.productState.isDeletingProduct=!0;const m={data:{store_id:this.store.id}};await axios.delete(`/api/products/${this.product.id}`,m),a(),await new Promise(o=>setTimeout(o,1e3)),this.notificationState.showSuccessNotification("Product deleted"),await this.navigateToProducts()}catch(m){const o=((i=(t=m==null?void 0:m.response)==null?void 0:t.data)==null?void 0:i.message)||(m==null?void 0:m.message)||"Something went wrong while deleting product";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(m),console.error("Failed to delete product:",m)}finally{this.productState.isDeletingProduct=!1,a()}},async deleteVariant(a){var i,m;const t=this.deletableVariant;try{if(this.isDeletingVariantIds.includes(t.id))return;this.isDeletingVariantIds.push(t.id);const o={data:{store_id:this.store.id}};await axios.delete(`/api/products/${t.id}`,o),this.notificationState.showSuccessNotification("Variant deleted");const e=this.productForm.variants.findIndex(b=>b.id==t.id);this.productState.removeVariant(e)}catch(o){const e=((m=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:m.message)||(o==null?void 0:o.message)||"Something went wrong while deleting variant";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(o),console.error("Failed to delete variant:",o)}finally{a(),this.isDeletingVariantIds=this.isDeletingVariantIds.filter(o=>o!=t.id)}},async uploadImages(a,t=null,i=null){let m=i!==null?this.productForm.variants[i].photos:this.productForm.photos,o=[];for(let e=0;e<m.length;e++){let b=m[e];b.id==null&&b.uploading==!1&&(b.uploaded===null||b.uploaded===!1)&&(t==null||t==e)&&o.push(this.uploadSingleImage(a,m[e],e))}if(o.length===0){this.productState.isUploading=!1;return}return this.productState.isUploading=!0,Promise.allSettled(o).then(e=>{let b=e.filter(x=>x.status==="rejected").length;b>0&&this.notificationState.showWarningNotification(`⚠️ ${b} image(s) failed to upload. Try again or change the image.`),this.productState.isUploading=!1})},async uploadSingleImage(a,t,i,m=0,o=null){var e,b,x;try{if(m>2)return console.log(`❌ Image ${i+1} permanently failed after 3 attempts.`),t.uploaded=!1,t.uploading=!1,t.error_message=((b=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:b.message)||(o==null?void 0:o.message)||"Upload failed",Promise.reject("Failed after 3 attempts");let v=new FormData;v.append("file",t.file_ref),v.append("mediable_id",a),v.append("store_id",this.store.id),v.append("mediable_type","product"),v.append("upload_folder_name","product_photo"),t.uploading=!0,t.error_message=null;const F={headers:{"Content-Type":"multipart/form-data"}},h=await axios.post("/api/media-files",v,F),w=h.data.media_file;return t.uploaded=!0,t.uploading=!1,t.id=w.id,t.path=w.path,console.log(`✅ Image ${i+1} uploaded successfully.`),h}catch(v){return console.error(`⚠️ Image ${i+1} upload attempt ${m+1} failed.`,v),v.code==="ECONNABORTED"||((x=v.response)==null?void 0:x.status)===504?void 0:this.uploadSingleImage(a,t,i,m+1,v)}},async showDeliveryMethods(){var a,t;try{this.isLoadingDeliveryMethods=!0;let i={params:{per_page:100,store_id:this.store.id}};const m=await axios.get("/api/delivery-methods",i);this.deliveryMethods=m.data.data}catch(i){const m=((t=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching delivery methods";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(i),console.error("Failed to fetch delivery methods:",i)}finally{this.isLoadingDeliveryMethods=!1,this.hasLoadedInitialDeliveryMethods=!0}},setActionButtons(){(this.isCreating||this.isEditing)&&(this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(this.onDiscard),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Create Product",this.isEditing?this.updateProduct:this.createProduct,"primary",null))},setProductForm(a){this.productState.productForm=a}},beforeRouteLeave(a,t,i){if(this.changeHistoryState.hasChangeHistory&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return i(!1);i()},unmounted(){this.productState.reset(),this.changeHistoryState.reset()},created(){this.setup(),this.setActionButtons();const a=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let t=0;t<a.length;t++){let i=a[t];this.changeHistoryState.listeners[i]=this.setProductForm}}},ot={class:"pt-24 px-4"},at={class:"grid grid-cols-12 gap-4 mb-4"},lt={class:"col-span-8"},st={class:"select-none bg-white rounded-lg p-4 mb-4"},it={class:"flex items-center space-x-4"},dt={key:0,class:"flex items-center space-x-2"},nt={key:1,class:"flex items-center space-x-1"},ut={class:"text-lg text-gray-700 font-semibold"},ct={class:"relative mb-4"},mt={class:"bg-white rounded-lg space-y-4 p-4"},pt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},gt={class:"text-sm text-gray-400"},ht={key:3,class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ft={class:"relative mb-4"},yt={class:"bg-white rounded-lg space-y-4 p-4"},vt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},bt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},_t={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},St={key:0,class:"flex items-end space-x-4 mb-2"},Ft={key:0,class:"relative mb-4"},xt={class:"bg-white border border-gray-200 rounded-lg p-4"},Vt={class:"flex items-center space-x-4 justify-end"},wt={class:"flex items-center space-x-1 text-gray-400"},kt={class:"text-sm"},Tt={class:"space-y-4 mb-4"},Dt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ct={class:"flex items-center space-x-4"},Ut={key:0,class:"flex items-center justify-center w-16 h-16"},Pt=["src"],Et={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Mt={class:"col-span-2"},Lt={class:"text-sm text-gray-400"},At={class:"flex justify-center"},It={key:0,class:"text-sm text-gray-700"},qt={class:"flex justify-end space-x-2"},Ot={class:"relative mb-4"},zt={class:"bg-white rounded-lg p-4"},Bt={class:"col-span-4"},jt={class:"relative mb-4"},Ht={class:"bg-white rounded-lg space-y-4 p-4"},Nt={class:"relative mb-4"},Rt={class:"bg-white rounded-lg space-y-4 p-4"},Wt={class:"relative mb-4"},Qt={class:"bg-white rounded-lg space-y-4 p-4"},Kt={class:"relative mb-4"},Xt={class:"bg-white rounded-lg space-y-4 p-4"},Gt={class:"relative mb-4"},Yt={class:"bg-white rounded-lg space-y-4 p-4"},Zt={class:"overflow-y-auto rounded-lg h-60"},Jt=["src"],$t={class:"w-full flex items-center justify-between"},er={class:"text-sm"},tr={class:"mb-4"},rr={class:"font-bold text-black"},or={key:0,class:"flex justify-center space-x-2 mb-8"},ar=["src"],lr={class:"font-bold text-black"},sr={class:"flex justify-end"},ir={class:"mb-8"},dr={class:"font-bold text-black"};function nr(a,t,i,m,o,e){var y,T,P,R;const b=S("Button"),x=S("Skeleton"),v=S("Popover"),F=S("BackdropLoader"),h=S("Input"),w=S("Select"),C=S("Switch"),O=S("Alert"),k=S("SelectTags"),z=S("Split"),q=S("DataCollectionFields"),B=S("Image"),N=S("Move"),f=S("draggable"),u=S("Modal");return s(),p("div",ot,[l("div",at,[l("div",lt,[l("div",st,[l("div",it,[n(b,{size:"xs",type:"light",action:e.goBack,leftIcon:o.MoveLeft},{default:V(()=>t[75]||(t[75]=[l("span",null,"Back",-1)])),_:1,__:[75]},8,["action","leftIcon"]),e.isLoadingStore||e.isLoadingProduct||e.isEditing&&!e.hasProduct?(s(),p("div",dt,[n(x,{width:"w-40"}),n(x,{width:"w-4"})])):(s(),p("div",nt,[l("h1",ut,D(e.isCreating?"Add Product":e.productForm.name||"..."),1),n(v,{content:"Products are physical or non physical items that customers can place orders and pay for using your preferred payment methods",placement:"top"})]))])]),l("div",ct,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",mt,[n(h,{type:"text",label:"Name",modelValue:e.productForm.name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.productForm.name=r),placeholder:"Standard Ticket",errorText:e.formState.getFormError("name"),onInput:t[1]||(t[1]=r=>e.productState.saveStateDebounced("Name changed")),tooltipContent:"The name of your product e.g Standard Ticket"},null,8,["modelValue","errorText"]),l("div",pt,[n(w,{class:"w-full",search:!1,label:"Visibility",options:o.visibilityTypes,modelValue:e.productForm.visible,"onUpdate:modelValue":t[2]||(t[2]=r=>e.productForm.visible=r),errorText:e.formState.getFormError("visible"),onChange:t[3]||(t[3]=r=>e.productState.saveStateDebounced("Visibility status changed")),tooltipContent:"Turn on if you want your product to be visible (Made available to customers)"},null,8,["options","modelValue","errorText"]),n(w,{label:"Type",class:"w-full",search:!1,options:o.productTypes,modelValue:e.productForm.type,"onUpdate:modelValue":t[4]||(t[4]=r=>e.productForm.type=r),errorText:e.formState.getFormError("type"),onChange:t[5]||(t[5]=r=>e.productState.saveStateDebounced("Type changed"))},null,8,["options","modelValue","errorText"])]),e.productForm.type=="digital"?(s(),c(h,{key:0,type:"text",label:"Download Link",externalLinkName:"Learn more",modelValue:e.productForm.download_link,"onUpdate:modelValue":t[6]||(t[6]=r=>e.productForm.download_link=r),placeholder:"https://example.com/download",externalLinkUrl:"https://example.com/download",errorText:e.formState.getFormError("download_link"),tooltipContent:"This is the link to download this resource",onInput:t[7]||(t[7]=r=>e.productState.saveStateDebounced("Download link changed")),description:"Confirm your order to show download link on invoice"},null,8,["modelValue","errorText"])):d("",!0),n(h,{type:"checkbox",inputLabel:"Show Description",modelValue:e.productForm.show_description,"onUpdate:modelValue":t[8]||(t[8]=r=>e.productForm.show_description=r),onChange:t[9]||(t[9]=r=>e.productState.saveStateDebounced("Show description status changed"))},null,8,["modelValue"]),e.productForm.show_description?(s(),c(h,{key:1,rows:"2",type:"textarea",label:"Description",modelValue:e.productForm.description,"onUpdate:modelValue":t[10]||(t[10]=r=>e.productForm.description=r),placeholder:"1 day show with popular artists",errorText:e.formState.getFormError("description"),onInput:t[11]||(t[11]=r=>e.productState.saveStateDebounced("Description changed")),tooltipContent:"Sweet and short description of your product e.g 1 day show with popular artists"},null,8,["modelValue","errorText"])):d("",!0),e.hasVariants?d("",!0):(s(),c(h,{key:2,type:"text",label:"Weight",modelValue:e.productForm.unit_weight,"onUpdate:modelValue":t[12]||(t[12]=r=>e.productForm.unit_weight=r),errorText:e.formState.getFormError("unit_weight"),onInput:t[13]||(t[13]=r=>e.productState.saveStateDebounced("Weight changed")),tooltipContent:"The weight of the product. Useful for delivery calculations"},{suffix:V(()=>{var r;return[l("span",gt,D((r=e.store)==null?void 0:r.weight_unit),1)]}),_:1},8,["modelValue","errorText"])),e.hasVariants?d("",!0):(s(),p("div",ht,[n(h,{type:"text",label:"SKU",placeholder:"std-ticket",modelValue:e.productForm.sku,"onUpdate:modelValue":t[14]||(t[14]=r=>e.productForm.sku=r),errorText:e.formState.getFormError("sku"),onInput:t[15]||(t[15]=r=>e.productState.saveStateDebounced("SKU changed")),tooltipContent:"The stock keeping unit for this product. Useful for stock management"},null,8,["modelValue","errorText"]),n(h,{type:"text",label:"Barcode",placeholder:"123456789",modelValue:e.productForm.barcode,"onUpdate:modelValue":t[16]||(t[16]=r=>e.productForm.barcode=r),errorText:e.formState.getFormError("barcode"),onInput:t[17]||(t[17]=r=>e.productState.saveStateDebounced("Barcode changed")),tooltipContent:"The barcode for this product. Useful for stock management"},null,8,["modelValue","errorText"])]))])]),l("div",ft,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",yt,[t[77]||(t[77]=l("p",{class:"text-lg text-gray-700 font-semibold"},"Pricing",-1)),l("div",vt,[n(C,{size:"xs",suffixText:"Is Free",modelValue:e.productForm.is_free,"onUpdate:modelValue":t[18]||(t[18]=r=>e.productForm.is_free=r),errorText:e.formState.getFormError("is_free"),onChange:t[19]||(t[19]=r=>e.productState.saveStateDebounced("Free status changed")),tooltipContent:"Turn on if you want your product to be made Free for customers"},null,8,["modelValue","errorText"]),e.productForm.is_free?d("",!0):(s(),c(C,{key:0,size:"xs",suffixText:"Display as estimated price",modelValue:e.productForm.is_estimated_price,"onUpdate:modelValue":t[20]||(t[20]=r=>e.productForm.is_estimated_price=r),errorText:e.formState.getFormError("is_estimated_price"),onChange:t[21]||(t[21]=r=>e.productState.saveStateDebounced("Estimated price status changed")),tooltipContent:"The checkout page will display the price as an estimated price. Customers will confirm with you before payment"},null,8,["modelValue","errorText"]))]),e.productForm.is_free?(s(),c(O,{key:0,type:"success"},{description:V(()=>t[76]||(t[76]=[U(" This product is "),l("span",{class:"font-bold"},"Free",-1)])),_:1})):(s(),p(L,{key:1},[l("div",bt,[n(h,{type:"money",label:"Regular Price",currency:(y=e.store)==null?void 0:y.currency,modelValue:e.productForm.unit_regular_price,"onUpdate:modelValue":t[22]||(t[22]=r=>e.productForm.unit_regular_price=r),errorText:e.formState.getFormError("unit_regular_price"),onInput:t[23]||(t[23]=r=>e.productState.saveStateDebounced("Regular price changed")),tooltipContent:"Set the regular price for this product (How much the product is sold when its not on sale)"},null,8,["currency","modelValue","errorText"]),n(h,{type:"money",label:"Sale Price",currency:(T=e.store)==null?void 0:T.currency,modelValue:e.productForm.unit_sale_price,"onUpdate:modelValue":t[24]||(t[24]=r=>e.productForm.unit_sale_price=r),errorText:e.formState.getFormError("unit_sale_price"),onInput:t[25]||(t[25]=r=>e.productState.saveStateDebounced("Sale price changed")),tooltipContent:"Set the sale price for this product (if the product is on sale)"},null,8,["currency","modelValue","errorText"])]),n(h,{type:"money",label:"Cost Price",currency:(P=e.store)==null?void 0:P.currency,description:"Invisible to customers",modelValue:e.productForm.unit_cost_price,"onUpdate:modelValue":t[26]||(t[26]=r=>e.productForm.unit_cost_price=r),errorText:e.formState.getFormError("unit_cost_price"),onInput:t[27]||(t[27]=r=>e.productState.saveStateDebounced("Cost price changed")),tooltipContent:"Set the cost price for this product (if the product is on sale)"},null,8,["currency","modelValue","errorText"]),n(h,{type:"checkbox",inputLabel:"Price per unit",modelValue:e.productForm.show_price_per_unit,"onUpdate:modelValue":t[28]||(t[28]=r=>e.productForm.show_price_per_unit=r),onChange:t[29]||(t[29]=r=>e.productState.saveStateDebounced("Price per unit status changed"))},null,8,["modelValue"]),e.productForm.show_price_per_unit?(s(),p("div",_t,[n(h,{type:"number",label:"Unit Value",modelValue:e.productForm.unit_value,"onUpdate:modelValue":t[30]||(t[30]=r=>e.productForm.unit_value=r),errorText:e.formState.getFormError("unit_value"),onInput:t[31]||(t[31]=r=>e.productState.saveStateDebounced("Unit value changed"))},null,8,["modelValue","errorText"]),n(w,{class:"w-full",search:!1,label:"Unit Type",options:o.pricePerUnitTypes,modelValue:e.productForm.unit_type,"onUpdate:modelValue":t[32]||(t[32]=r=>e.productForm.unit_type=r),errorText:e.formState.getFormError("unit_type"),onChange:t[33]||(t[33]=r=>e.productState.saveStateDebounced("Unit type changed"))},null,8,["options","modelValue","errorText"])])):d("",!0),n(h,{type:"checkbox",inputLabel:"Tax Overide",modelValue:e.productForm.tax_overide,"onUpdate:modelValue":t[34]||(t[34]=r=>e.productForm.tax_overide=r),onChange:t[35]||(t[35]=r=>e.productState.saveStateDebounced("Tax overide status changed"))},null,8,["modelValue"]),e.productForm.tax_overide?(s(),c(h,{key:1,type:"money",currency:(R=e.store)==null?void 0:R.currency,modelValue:e.productForm.tax_overide_amount,"onUpdate:modelValue":t[36]||(t[36]=r=>e.productForm.tax_overide_amount=r),errorText:e.formState.getFormError("tax_overide_amount"),onInput:t[37]||(t[37]=r=>e.productState.saveStateDebounced("Tax overide amount changed"))},null,8,["currency","modelValue","errorText"])):d("",!0)],64))])]),l("div",{class:E([{"bg-white rounded-lg p-4 space-y-4":!e.hasVariants},"mb-4"])},[l("p",{class:E(["text-lg text-gray-700 font-semibold",e.productForm.variants.length>=2?"mb-0":"mb-4",{"pl-4":e.hasVariants}])},"Variants",2),e.productForm.variants.length>=2&&e.variantOptions.length?(s(),p("div",St,[n(k,{class:"w-full",allowCustom:!1,options:e.variantOptions,modelValue:o.selectedVariants,"onUpdate:modelValue":t[38]||(t[38]=r=>o.selectedVariants=r),placeholder:"Add variant filter"},null,8,["options","modelValue"]),n(b,{size:"xs",type:"light",leftIcon:o.X,action:e.clearSelectedVariants},{default:V(()=>t[78]||(t[78]=[l("span",null,"Clear Filter",-1)])),_:1,__:[78]},8,["leftIcon","action"])])):d("",!0),(s(!0),p(L,null,H(e.productForm.variants,(r,g)=>{var W,Q;return s(),p(L,{key:r.temporary_id},[e.isFilteredVariants(r)?(s(),p("div",Ft,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",xt,[l("div",Vt,[l("div",wt,[n(z,{size:"16"}),l("span",kt,"variant "+D(`${g+1}`),1)]),n(b,{size:"xs",type:"bareDanger",leftIcon:o.Trash2,action:()=>e.removeVariant(g)},null,8,["leftIcon","action"])]),l("div",Tt,[l("div",Dt,[l("div",Ct,[e.productForm.variants[g].photos.length?(s(),p("div",Ut,[l("img",{class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:e.productForm.variants[g].photos[0].path},null,8,Pt)])):d("",!0),n(h,{type:"text",label:"Name",class:"w-full",placeholder:"Standard Ticket",modelValue:e.productForm.variants[g].name,"onUpdate:modelValue":_=>e.productForm.variants[g].name=_,onInput:t[39]||(t[39]=_=>e.productState.saveStateDebounced("Name changed")),tooltipContent:"The name of your product e.g Standard Ticket",errorText:e.formState.getFormError(`variants.${g}.name`)},null,8,["modelValue","onUpdate:modelValue","errorText"])]),n(w,{class:"w-full",search:!1,label:"Visibility",options:o.visibilityTypes,modelValue:e.productForm.variants[g].visible,"onUpdate:modelValue":_=>e.productForm.variants[g].visible=_,errorText:e.formState.getFormError(`variants.${g}.visible`),onChange:t[40]||(t[40]=_=>e.productState.saveStateDebounced("Visibility status changed")),tooltipContent:"Turn on if you want your product to be visible (Made available to customers)"},null,8,["options","modelValue","onUpdate:modelValue","errorText"])]),l("div",Et,[n(h,{type:"money",label:"Regular Price",currency:(W=e.store)==null?void 0:W.currency,modelValue:e.productForm.variants[g].unit_regular_price,"onUpdate:modelValue":_=>e.productForm.variants[g].unit_regular_price=_,onInput:t[41]||(t[41]=_=>e.productState.saveStateDebounced("Regular price changed")),errorText:e.formState.getFormError(`variants.${g}.unit_regular_price`),tooltipContent:"Set the regular price for this product (How much the product is sold when its not on sale)"},null,8,["currency","modelValue","onUpdate:modelValue","errorText"]),n(h,{type:"money",label:"Sale Price",currency:(Q=e.store)==null?void 0:Q.currency,modelValue:e.productForm.variants[g].unit_sale_price,"onUpdate:modelValue":_=>e.productForm.variants[g].unit_sale_price=_,onInput:t[42]||(t[42]=_=>e.productState.saveStateDebounced("Sale price changed")),errorText:e.formState.getFormError(`variants.${g}.unit_sale_price`),tooltipContent:"Set the sale price for this product (if the product is on sale)"},null,8,["currency","modelValue","onUpdate:modelValue","errorText"]),e.productForm.variants[g].show_more?(s(),p(L,{key:0},[l("div",Mt,[n(h,{type:"text",label:"Weight",class:"w-full",modelValue:e.productForm.variants[g].unit_weight,"onUpdate:modelValue":_=>e.productForm.variants[g].unit_weight=_,onInput:t[43]||(t[43]=_=>e.productState.saveStateDebounced("Weight changed")),errorText:e.formState.getFormError(`variants.${g}.unit_weight`),tooltipContent:"The weight of the product. Useful for delivery calculations"},{suffix:V(()=>{var _;return[l("span",Lt,D((_=e.store)==null?void 0:_.weight_unit),1)]}),_:2},1032,["modelValue","onUpdate:modelValue","errorText"])]),n(h,{type:"text",label:"SKU",placeholder:"std-ticket",modelValue:e.productForm.variants[g].sku,"onUpdate:modelValue":_=>e.productForm.variants[g].sku=_,onInput:t[44]||(t[44]=_=>e.productState.saveStateDebounced("SKU changed")),errorText:e.formState.getFormError(`variants.${g}.sku`),tooltipContent:"The stock keeping unit for this product. Useful for stock management"},null,8,["modelValue","onUpdate:modelValue","errorText"]),n(h,{type:"text",label:"Barcode",placeholder:"123456789",modelValue:e.productForm.variants[g].barcode,"onUpdate:modelValue":_=>e.productForm.variants[g].barcode=_,onInput:t[45]||(t[45]=_=>e.productState.saveStateDebounced("Barcode changed")),errorText:e.formState.getFormError(`variants.${g}.barcode`),tooltipContent:"The barcode for this product. Useful for stock management"},null,8,["modelValue","onUpdate:modelValue","errorText"])],64)):d("",!0)]),e.productForm.variants[g].show_more?(s(),c(h,{key:0,type:"file",maxFiles:1,singleFileUploadMessage:"Photo attached",modelValue:e.productForm.variants[g].photos,"onUpdate:modelValue":_=>e.productForm.variants[g].photos=_,onChange:t[46]||(t[46]=_=>e.productState.saveStateDebounced("Photos changed")),onRetryUploads:_=>e.uploadImages(e.productForm.variants[g].id,null,g),onRetryUpload:(_,ae)=>e.uploadImages(e.productForm.variants[g].id,ae,g)},null,8,["modelValue","onUpdate:modelValue","onRetryUploads","onRetryUpload"])):d("",!0)]),l("div",At,[n(b,{size:"sm",type:"bare",action:()=>e.toggleAdditionalVariantOptions(g),rightIcon:e.productForm.variants[g].show_more?o.ChevronUp:o.ChevronDown},{default:V(()=>[l("span",null,D(e.productForm.variants[g].show_more?"show less":"show more"),1)]),_:2},1032,["action","rightIcon"])])])])):d("",!0)],64)}),128)),l("div",{class:E([{"flex space-x-2 justify-between":!e.hasVariants}])},[e.hasVariants?d("",!0):(s(),p("p",It,"Add variants if your product supports different versions of itself e.g different sizes, materials, colors, etc")),l("div",qt,[e.productForm.variants.length>=2?(s(),c(b,{key:0,size:"xs",type:"light",leftIcon:o.ArrowDownUp,action:e.showChangeArrangementModal},{default:V(()=>t[79]||(t[79]=[l("span",null,"Change Arrangement",-1)])),_:1,__:[79]},8,["leftIcon","action"])):d("",!0),n(b,{size:"xs",type:"light",leftIcon:o.Plus,action:e.addVariant},{default:V(()=>t[80]||(t[80]=[l("span",null,"Add Variants",-1)])),_:1,__:[80]},8,["leftIcon","action"])])],2)],2),l("div",Ot,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",zt,[t[81]||(t[81]=l("p",{class:"text-lg text-gray-700 font-semibold"},"Options",-1)),n(q)])])]),l("div",Bt,[l("div",jt,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",Ht,[t[82]||(t[82]=l("p",{class:"text-lg text-gray-700 font-semibold"},"Images",-1)),n(h,{type:"file",maxFiles:5,modelValue:e.productForm.photos,"onUpdate:modelValue":t[47]||(t[47]=r=>e.productForm.photos=r),onRetryUploads:t[48]||(t[48]=r=>e.uploadImages(e.productForm.id)),onChange:t[49]||(t[49]=r=>e.productState.saveStateDebounced("Photos changed")),onRetryUpload:t[50]||(t[50]=(r,g)=>e.uploadImages(e.productForm.id,g))},null,8,["modelValue"])])]),l("div",Nt,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",Rt,[t[83]||(t[83]=l("p",{class:"text-lg text-gray-700 font-semibold"},"Inventory",-1)),n(w,{label:"Stock",class:"w-full",search:!1,options:o.stockQuantityTypes,modelValue:e.productForm.stock_quantity_type,"onUpdate:modelValue":t[51]||(t[51]=r=>e.productForm.stock_quantity_type=r),errorText:e.formState.getFormError("stock_quantity_type"),onChange:t[52]||(t[52]=r=>e.productState.saveStateDebounced("Stock quantity type changed")),tooltipContent:"Select the available stock e.g Unlimited means that stock is always available while limited means that stock is limited to the quatities specified"},null,8,["options","modelValue","errorText"]),e.productForm.stock_quantity_type=="limited"?(s(),c(h,{key:0,min:"1",type:"number",placeholder:"100",label:"Stock Quantity",modelValue:e.productForm.stock_quantity,"onUpdate:modelValue":t[53]||(t[53]=r=>e.productForm.stock_quantity=r),errorText:e.formState.getFormError("stock_quantity"),onInput:t[54]||(t[54]=r=>e.productState.saveStateDebounced("Stock quantity changed")),tooltipContent:"Set the stock quantity e.g 100 means that you only have 100 items for this product"},null,8,["modelValue","errorText"])):d("",!0),n(C,{size:"xs",suffixText:"Daily Capacity",modelValue:e.productForm.set_daily_capacity,"onUpdate:modelValue":t[55]||(t[55]=r=>e.productForm.set_daily_capacity=r),errorText:e.formState.getFormError("set_daily_capacity"),tooltipContent:"The maximum number number of items you can sell per day",onChange:t[56]||(t[56]=r=>e.productState.saveStateDebounced("Daily capacity status changed"))},null,8,["modelValue","errorText"]),e.productForm.set_daily_capacity?(s(),c(h,{key:1,min:"1",type:"number",placeholder:"10",modelValue:e.productForm.daily_capacity,"onUpdate:modelValue":t[57]||(t[57]=r=>e.productForm.daily_capacity=r),errorText:e.formState.getFormError("daily_capacity"),onInput:t[58]||(t[58]=r=>e.productState.saveStateDebounced("Daily capacity changed"))},null,8,["modelValue","errorText"])):d("",!0),n(C,{size:"xs",suffixText:"Minimum Order Quantity",modelValue:e.productForm.set_min_order_quantity,"onUpdate:modelValue":t[59]||(t[59]=r=>e.productForm.set_min_order_quantity=r),errorText:e.formState.getFormError("set_min_order_quantity"),onChange:t[60]||(t[60]=r=>e.productState.saveStateDebounced("Minimum order quantity status changed")),tooltipContent:"Set the minimum order quantity for this product (Used to manage supply and demand)"},null,8,["modelValue","errorText"]),e.productForm.set_min_order_quantity?(s(),c(h,{key:2,min:"1",type:"number",placeholder:"10",modelValue:e.productForm.min_order_quantity,"onUpdate:modelValue":t[61]||(t[61]=r=>e.productForm.min_order_quantity=r),errorText:e.formState.getFormError("min_order_quantity"),onInput:t[62]||(t[62]=r=>e.productState.saveStateDebounced("Minimum order quantity changed"))},null,8,["modelValue","errorText"])):d("",!0),n(C,{size:"xs",suffixText:"Maximum Order Quantity",modelValue:e.productForm.set_max_order_quantity,"onUpdate:modelValue":t[63]||(t[63]=r=>e.productForm.set_max_order_quantity=r),errorText:e.formState.getFormError("set_max_order_quantity"),onChange:t[64]||(t[64]=r=>e.productState.saveStateDebounced("Maximum order quantity status changed")),tooltipContent:"Set the maximum order quantity for this product (Used to manage supply and demand)"},null,8,["modelValue","errorText"]),e.productForm.set_max_order_quantity?(s(),c(h,{key:3,min:"1",type:"number",placeholder:"10",modelValue:e.productForm.max_order_quantity,"onUpdate:modelValue":t[65]||(t[65]=r=>e.productForm.max_order_quantity=r),errorText:e.formState.getFormError("max_order_quantity"),onInput:t[66]||(t[66]=r=>e.productState.saveStateDebounced("Maximum order quantity changed"))},null,8,["modelValue","errorText"])):d("",!0)])]),l("div",Wt,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",Qt,[t[84]||(t[84]=l("p",{class:"text-lg text-gray-700 font-semibold"},"Categories",-1)),n(k,{options:o.categories,placeholder:"Add category",modelValue:e.productForm.categories,"onUpdate:modelValue":t[67]||(t[67]=r=>e.productForm.categories=r),errorText:e.formState.getFormError("categories"),onChange:t[68]||(t[68]=r=>e.productState.saveStateDebounced("Categories changed"))},null,8,["options","modelValue","errorText"])])]),l("div",Kt,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",Xt,[t[85]||(t[85]=l("p",{class:"text-lg text-gray-700 font-semibold"},"Tags",-1)),n(k,{options:o.tags,placeholder:"Add Tag",modelValue:e.productForm.tags,"onUpdate:modelValue":t[69]||(t[69]=r=>e.productForm.tags=r),errorText:e.formState.getFormError("tags"),onChange:t[70]||(t[70]=r=>e.productState.saveStateDebounced("Tags changed"))},null,8,["options","modelValue","errorText"])])]),l("div",Gt,[e.isLoadingProduct||e.isSubmitting?(s(),c(F,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):d("",!0),l("div",Yt,[t[86]||(t[86]=l("p",{class:"text-lg text-gray-700 font-semibold"},"Delivery Methods",-1)),n(k,{options:e.deliveryMethodOptions,placeholder:"Add delivery method",modelValue:e.productForm.delivery_method_ids,"onUpdate:modelValue":t[71]||(t[71]=r=>e.productForm.delivery_method_ids=r),errorText:e.formState.getFormError("delivery_method_ids"),onChange:t[72]||(t[72]=r=>e.productState.saveStateDebounced("Delivery methods changed"))},null,8,["options","modelValue","errorText"])])])])]),n(u,{scrollOnContent:!1,ref:"changeArrangementModal",approveText:"Change Arrangement",approveAction:e.changeVariantArrangement,approveLoading:e.isChangingVariantArrangement},{content:V(()=>[t[87]||(t[87]=l("p",{class:"text-lg font-bold border-b border-gray-200 pb-4 mb-4"},"Change Arrangement",-1)),l("div",Zt,[n(f,{class:"space-y-2",handle:".draggable-handle","ghost-class":"bg-yellow-50",modelValue:o.variantsForArrangement,"onUpdate:modelValue":t[74]||(t[74]=r=>o.variantsForArrangement=r)},{default:V(()=>[(s(!0),p(L,null,H(o.variantsForArrangement,(r,g)=>(s(),p("div",{key:g,class:"flex justify-between items-center p-2 space-x-4 rounded-lg bg-gray-50"},[l("div",{class:E(["flex items-center justify-center w-10 h-10 rounded-lg",{"border border-dashed border-gray-200":!r.photo}])},[r.photo?(s(),p("img",{key:0,class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:r.photo.path},null,8,Jt)):(s(),c(B,{key:1,size:"20",class:"text-gray-400 flex-shrink-0"}))],2),l("div",$t,[l("span",er,D(r.name??"no name"),1),n(N,{onClick:t[73]||(t[73]=M(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})])]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["approveAction","approveLoading"]),n(u,{approveType:"danger",approveText:"Delete Variant",approveAction:e.deleteVariant,ref:"confirmDeleteVariantModal",approveLoading:o.isDeletingVariantIds.some(r=>r==o.deletableVariant.id)},$({_:2},[o.deletableVariant?{name:"content",fn:V(()=>[t[90]||(t[90]=l("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),l("p",tr,[t[88]||(t[88]=U("Are you sure you want to permanently delete ")),l("span",rr,D(o.deletableVariant.name),1),t[89]||(t[89]=U("?"))]),o.deletableVariant.photos.length?(s(),p("div",or,[l("img",{class:"w-20 max-h-20 object-contain rounded-lg flex-shrink-0",src:o.deletableVariant.photos[0].path},null,8,ar)])):d("",!0)]),key:"0"}:void 0]),1032,["approveAction","approveLoading"]),e.product?(s(),p("div",{key:0,class:E(["overflow-hidden rounded-lg space-y-4 p-4 border",e.isLoadingProduct?"border-gray-300 bg-gray-50":"border-red-300 bg-red-50"])},[l("p",null,[t[91]||(t[91]=U("Do you want to permanently delete ")),l("span",lr,D(e.productForm.name),1),t[92]||(t[92]=U("? Once this product is deleted you will not be able to recover it."))]),l("div",sr,[n(u,{triggerType:"danger",approveType:"danger",approveLeftIcon:o.Trash2,triggerText:"Delete Product",approveText:"Delete Product",approveAction:e.deleteProduct,triggerLoading:e.isDeletingProduct,approveLoading:e.isDeletingProduct},{content:V(()=>[t[95]||(t[95]=l("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),l("p",ir,[t[93]||(t[93]=U("Are you sure you want to permanently delete ")),l("span",dr,D(e.productForm.name),1),t[94]||(t[94]=U("?"))])]),_:1},8,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])],2)):d("",!0)])}const Or=ee(rt,[["render",nr]]);export{Or as default};
