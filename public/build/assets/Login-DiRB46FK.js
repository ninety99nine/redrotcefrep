import{c,b as r,a as l,r as m,w as E,d as g,e as y,F as k,f as v,t as u,g as d,h as F,o as n,i as b}from"./app-CaCDZNvD.js";import{P as V}from"./Pill-CfzFjwDX.js";import{L}from"./Logo-BWZyPyPX.js";import{I as T}from"./Input-CI0gKfpk.js";import{B}from"./Button-CMAESCwz.js";import{i as P}from"./stringUtils-Bvzw0-oW.js";import{S as j}from"./SocialLinks-EbIaLUmN.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Popover-1WlbTYZh.js";import"./x-Do1GLDRA.js";import"./createLucideIcon-hJfW1V63.js";import"./Copy-DtqSf0U1.js";import"./ShineEffect-9Bzjo95p.js";import"./Skeleton-KK-V-B9B.js";import"./refresh-ccw-C1cdGvMt.js";import"./circle-check-CFrnoQ4d.js";import"./circle-alert-ChEGa5ss.js";import"./parsePhoneNumber-DR0S47Bc.js";import"./Loader-C6t2-ZQM.js";const N={name:"Login",components:{Pill:V,Logo:L,Input:T,Button:B,SocialLinks:j},inject:["authState","formState","notificationState"],data(){return{form:{email:"",password:"",type:"email",mobile_number:""},loginTypes:[{label:"Email",value:"email"},{label:"Mobile Number",value:"mobile_number"}],loading:!1,currentYear:new Date().getFullYear()}},methods:{isEmpty:P,async submit(){var p,e;if(!this.loading&&(this.formState.hideFormErrors(),this.form.type=="email"&&this.isEmpty(this.form.email)?this.formState.setFormError("email","Enter your email"):this.form.type=="mobile_number"&&this.isEmpty(this.form.mobile_number)?this.formState.setFormError("mobile_number","Enter your mobile number"):this.isEmpty(this.form.password)&&this.formState.setFormError("password","Enter your password"),!this.formState.hasErrors)){this.loading=!0;try{const a=(await F.post("/api/auth/login",this.form)).data.token;this.authState.setTokenOnRequest(a),this.authState.setTokenOnLocalStorage(a);const t=this.$route.query.redirect;t?this.$router.push(t):this.$router.push({name:"show-stores"})}catch(s){const a=((e=(p=s==null?void 0:s.response)==null?void 0:p.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while signing in";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(s),console.error("Failed to sign in:",s)}finally{this.loading=!1}}}}},I={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},M={class:"flex items-center justify-center p-6 bg-gradient-to-b from-blue-100 to-white-100"},O={class:"w-full max-w-md"},U={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},Y={class:"flex space-x-2"},q={key:2,class:"text-red-500 text-sm mb-3"},D={class:"flex justify-between mb-6"},z={class:"ml-1"},A={class:"text-sm text-center text-gray-500"};function R(p,e,s,a,t,i){const _=m("Logo"),x=m("Pill"),f=m("Input"),h=m("router-link"),w=m("Button"),S=m("SocialLinks");return n(),c("div",I,[r("div",M,[r("div",O,[l(_,{height:"h-20 mx-auto mb-4"}),r("div",U,[e[6]||(e[6]=r("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Sign in",-1)),e[7]||(e[7]=r("h1",{class:"text-sm text-gray-500 mb-4"},"Pick how you would like to sign in",-1)),r("form",{onSubmit:e[3]||(e[3]=E((...o)=>i.submit&&i.submit(...o),["prevent"])),class:"space-y-4"},[r("div",Y,[(n(!0),c(k,null,v(t.loginTypes,o=>(n(),g(x,{type:t.form.type===o.value?"primary":"light",action:()=>t.form.type=o.value,key:o.value},{default:d(()=>[b(u(o.label),1)]),_:2},1032,["type","action"]))),128))]),t.form.type=="email"?(n(),g(f,{key:0,type:"email",label:"Email",modelValue:t.form.email,"onUpdate:modelValue":e[0]||(e[0]=o=>t.form.email=o),placeholder:"john@gmail.com",errorText:i.formState.getFormError("email")},null,8,["modelValue","errorText"])):t.form.type=="mobile_number"?(n(),g(f,{key:1,type:"text",label:"Mobile",placeholder:"+26772000001",modelValue:t.form.mobile_number,"onUpdate:modelValue":e[1]||(e[1]=o=>t.form.mobile_number=o),errorText:i.formState.getFormError("mobile_number")},null,8,["modelValue","errorText"])):y("",!0),l(f,{type:"password",label:"Password",modelValue:t.form.password,"onUpdate:modelValue":e[2]||(e[2]=o=>t.form.password=o),placeholder:"******",errorText:i.formState.getFormError("password")},null,8,["modelValue","errorText"]),i.formState.generalErrorText?(n(),c("div",q,u(i.formState.generalErrorText),1)):y("",!0),r("div",D,[l(h,{to:{name:"register"},class:"text-sm text-blue-600 hover:underline"},{default:d(()=>e[4]||(e[4]=[b("Create account")])),_:1,__:[4]}),l(h,{to:{name:"forgot-password"},class:"text-sm text-blue-600 hover:underline"},{default:d(()=>e[5]||(e[5]=[b("Forgot password?")])),_:1,__:[5]})]),l(w,{size:"md",type:"primary",action:i.submit,buttonClass:"w-full"},{default:d(()=>[r("span",z,u(t.loading?"Signing in...":"Continue"),1)]),_:1},8,["action"])],32)]),l(S,{class:"mb-6"}),r("p",A,"Â© "+u(t.currentYear)+" Perfect Order. All rights reserved.",1)])]),e[8]||(e[8]=r("div",{class:"hidden lg:block"},[r("img",{src:"/images/lady-holding-boxes.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const ue=C(N,[["render",R]]);export{ue as default};
