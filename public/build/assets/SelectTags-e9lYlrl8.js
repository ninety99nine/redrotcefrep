import{b}from"./Input-ChopJmt9.js";import{V as v}from"./vue-draggable-next.esm-bundler-D5YB87j-.js";import{S as O,c as i,b as l,e as a,u as c,n as f,F as p,U as x,i as C,t as d,p as S,d as V,g as _,f as m,V as L,w as y,W as M,r as Q,X as I,o as n}from"./app-BS747Cvj.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={inject:["notificationState"],directives:{capitalize:b},components:{draggable:v},props:{modelValue:{type:Array,default:()=>[]},label:{type:[String,null],default:null},secondaryLabel:{type:[String,null],default:null},showAsterisk:{type:Boolean,default:!1},description:{type:[String,null],default:null},externalLinkName:{type:[String,null],default:null},externalLinkUrl:{type:[String,null],default:null},placeholder:{type:[String,null],default:null},disabled:{type:Boolean,default:!1},alignItems:{type:[String,null],default:"items-center"},errorText:{type:[String,null],default:null},options:{type:Array,default:()=>[]},search:{type:Boolean,default:!0},noResultsText:{type:[String,null],default:"No tags available"},searchableFields:{type:[Array,null],default:()=>["label","value"]},isDraggable:{type:Boolean,default:!0},allowCustom:{type:Boolean,default:!0},addNewText:{type:[String,null],default:"+ Create"},onAddCustomOption:{type:Function,default:null}},emits:["update:modelValue","update:options","change"],data(){return{isOpen:!1,searchQuery:null,uniqueId:O("input")}},computed:{localModelValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e),this.$emit("change",e)}},localOptions:{get(){return this.options},set(e){this.$emit("update:options",e)}},selectedOptions:{get(){return this.modelValue.map(e=>{const t=this.localOptions.find(s=>s.value===e);return t||{label:e,value:e}}).filter(e=>e)},set(e){this.localModelValue=e.map(t=>t.value)}},hasSelectedOptions(){return this.selectedOptions.length>0},hasSearchQuery(){return this.searchQuery&&this.searchQuery.trim().length>0},filteredOptions(){return this.searchQuery?this.localOptions.filter(e=>this.searchableFields.some(t=>{var s;return(s=e[t])==null?void 0:s.toLowerCase().includes(this.searchQuery.toLowerCase())})):this.localOptions}},methods:{openDropdown(){this.disabled||(this.isOpen||(this.isOpen=!0),this.focusOnInput())},toggleDropdown(){this.disabled||(this.isOpen=!this.isOpen,this.focusOnInput())},focusOnInput(){this.$nextTick(()=>{this.$refs.search&&this.$refs.search.focus()})},toggleOption(e){if(this.disabled||(this.focusOnInput(),e.disabled))return;this.isSelected(e)?this.removeOption(e):this.localModelValue=[...this.localModelValue,e.value],this.searchQuery=""},removeOption(e){this.focusOnInput(),this.localModelValue=this.localModelValue.filter(t=>t!==e.value)},isSelected(e){return this.localModelValue.includes(e.value)},isOptionInList(e){return this.localOptions.some(t=>this.searchableFields.some(s=>{var g;return((g=t[s])==null?void 0:g.toLowerCase())===e.toLowerCase()}))},isOptionCaptured(e){return this.localModelValue.some(t=>t.toLowerCase()===e.toLowerCase())},handleClickOutside(e){this.$refs.dropdown.contains(e.target)||(this.isOpen=!1)},handleEnterKey(){this.allowCustom&&this.hasSearchQuery&&!this.isOptionInList(this.searchQuery)&&this.addCustomOption()},addCustomOption(){if(this.isOptionCaptured(this.searchQuery)){this.notificationState.showWarningNotification("This option already exists"),this.searchQuery="";return}const e=this.searchQuery,t={label:this.searchQuery,value:e};this.onAddCustomOption?this.onAddCustomOption(this.localOptions,this.localModelValue,e):(this.localOptions=[...this.localOptions,t],this.localModelValue=[...this.localModelValue,e]),this.searchQuery="",this.focusOnInput()}},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}},D={class:"space-y-2"},N=["for"],T={key:0,class:"font-normal text-gray-400 ml-1"},j={key:1,class:"text-red-500"},z={key:2,class:"leading-4"},E={key:0,class:"text-xs text-gray-400 mr-1"},U=["href"],F={class:"w-full relative",ref:"dropdown"},K={class:"flex items-center space-x-1 bg-gray-100 rounded-full px-2 py-1"},q={class:"text-xs font-medium text-gray-900"},H=["onClick"],R={class:"flex items-center space-x-1 bg-gray-100 rounded-full px-2 py-1"},W={class:"text-xs font-medium text-gray-900"},P=["onClick"],X=["id","disabled","placeholder"],G={key:0,class:"w-full absolute z-10 mt-1 select-none bg-white border border-gray-300 rounded-md shadow-lg overflow-hidden"},J={class:"max-h-60 overflow-auto"},Y=["onClick"],Z={class:"truncate"},$={key:0},ee={class:"w-full flex items-center gap-3"},te={class:"flex items-center space-x-2 bg-gray-100 rounded-full px-3 py-1 border shadow-sm"},se={class:"text-xs font-medium text-gray-900"},le={class:"text-xs text-gray-500"},re={key:0,class:"text-center px-4 py-2 text-gray-500 text-sm"},oe={key:0,class:"scroll-to-error font-medium text-red-500 text-xs mt-1 ml-1"};function ne(e,t,s,g,u,o){const w=Q("draggable"),k=I("capitalize");return n(),i("div",null,[l("div",D,[l("div",null,[e.$slots.label||s.label||s.secondaryLabel||s.showAsterisk?(n(),i("label",{key:0,for:u.uniqueId,class:f({"text-sm leading-6 font-medium text-gray-900 space-x-1":!e.$slots.label})},[e.$slots.label?c(e.$slots,"label",{key:0}):(n(),i(p,{key:1},[x((n(),i("span",null,[C(d(s.label),1)])),[[k]]),s.secondaryLabel?(n(),i("span",T,d(s.secondaryLabel),1)):a("",!0),s.showAsterisk?(n(),i("span",j,"*")):a("",!0)],64))],10,N)):a("",!0),e.$slots.description?c(e.$slots,"description",{key:1}):s.description||s.externalLinkName?(n(),i("div",z,[s.description?(n(),i("span",E,d(s.description),1)):a("",!0),s.externalLinkName?(n(),i("a",S({key:1,target:"_blank",href:s.externalLinkUrl},e.type==="file"?e.fileEventListeners:{},{class:"inline-block text-xs text-blue-700 hover:underline hover:text-blue-90"}),[l("span",null,d(s.externalLinkName),1),t[7]||(t[7]=l("svg",{class:"w-3 h-3 inline-block ml-0.5 -mt-1",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})],-1))],16,U)):a("",!0)])):a("",!0)]),l("div",{class:f(["w-full flex",s.alignItems,{"opacity-50":s.disabled}])},[e.$slots.prefix?c(e.$slots,"prefix",{key:0}):a("",!0),l("div",F,[l("div",{onClick:t[5]||(t[5]=(...r)=>o.toggleDropdown&&o.toggleDropdown(...r)),class:f(["w-full select-none bg-white border border-gray-300 rounded-md py-1 px-2 flex flex-wrap gap-2 items-center overflow-hidden",s.disabled?"cursor-not-allowed":"cursor-pointer"])},[s.isDraggable?(n(),V(w,{key:0,modelValue:o.selectedOptions,"onUpdate:modelValue":t[0]||(t[0]=r=>o.selectedOptions=r),handle:".draggable-handle","ghost-class":"bg-yellow-50",class:"flex flex-wrap gap-2"},{default:_(()=>[(n(!0),i(p,null,m(o.selectedOptions,(r,h)=>(n(),i("div",{key:h,class:"draggable-handle"},[c(e.$slots,"selectedOption",{selectedOption:r,removeOption:()=>o.removeOption(r)},()=>[l("div",K,[l("span",q,d(r.label),1),l("button",{onClick:y(()=>o.removeOption(r),["prevent","stop"]),class:"focus:outline-none"},t[8]||(t[8]=[l("svg",{class:"w-3 h-3 text-gray-500 hover:text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,H)])])]))),128))]),_:3},8,["modelValue"])):(n(!0),i(p,{key:1},m(o.selectedOptions,(r,h)=>c(e.$slots,"selectedOption",{key:h,selectedOption:r,removeOption:()=>o.removeOption(r)},()=>[l("div",R,[l("span",W,d(r.label),1),l("button",{onClick:y(()=>o.removeOption(r),["prevent","stop"]),class:"focus:outline-none"},t[9]||(t[9]=[l("svg",{class:"w-3 h-3 text-gray-500 hover:text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,P)])])),128)),s.search?x((n(),i("input",{key:2,type:"text",ref:"search",onKeydown:[t[1]||(t[1]=y(()=>{},["stop"])),t[4]||(t[4]=M(y((...r)=>o.handleEnterKey&&o.handleEnterKey(...r),["prevent"]),["enter"]))],id:u.uniqueId,disabled:s.disabled,"onUpdate:modelValue":t[2]||(t[2]=r=>u.searchQuery=r),placeholder:s.placeholder,onClick:t[3]||(t[3]=y((...r)=>o.openDropdown&&o.openDropdown(...r),["stop"])),class:f(["flex-1 outline-none text-sm text-gray-900 placeholder:text-gray-400 border-0 focus:ring-0 py-1",o.hasSelectedOptions?"px-2":"px-0"])},null,42,X)),[[L,u.searchQuery]]):a("",!0)],2),u.isOpen?(n(),i("div",G,[l("ul",J,[(n(!0),i(p,null,m(o.filteredOptions,(r,h)=>(n(),i(p,{key:h},[r.label?(n(),i("li",{key:0,onClick:()=>o.toggleOption(r),class:f(["px-4 py-2 text-sm flex justify-between items-center hover:bg-gray-100",r.disabled?"cursor-not-allowed text-gray-400":"cursor-pointer text-gray-700"])},[c(e.$slots,"option",{option:r,isSelected:o.isSelected(r)},()=>[l("span",Z,d(r.label),1)]),o.isSelected(r)?(n(),i("span",$,t[10]||(t[10]=[l("svg",{class:"w-4 h-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):a("",!0)],10,Y)):a("",!0)],64))),128)),s.allowCustom&&o.hasSearchQuery&&!o.isOptionInList(u.searchQuery)?(n(),i("li",{key:0,onClick:t[6]||(t[6]=(...r)=>o.addCustomOption&&o.addCustomOption(...r)),class:"w-full flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-gray-50 text-gray-700"},[l("div",ee,[l("div",te,[l("span",se,d(u.searchQuery),1)]),l("span",le,d(s.addNewText),1)]),t[11]||(t[11]=l("div",{class:"size-6 flex flex-col justify-center items-center bg-white border border-gray-200 text-xs uppercase text-gray-400 shadow-2xs rounded-sm dark:bg-neutral-800 dark:border-neutral-700"},[l("svg",{class:"shrink-0 size-3.5",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("polyline",{points:"9 10 4 15 9 20"}),l("path",{d:"M20 4v7a4 4 0 0 1-4 4H4"})])],-1))])):a("",!0)]),o.filteredOptions.length===0&&!(s.allowCustom&&o.hasSearchQuery)?(n(),i("div",re,d(s.noResultsText),1)):a("",!0)])):a("",!0)],512),e.$slots.suffix?c(e.$slots,"suffix",{key:1}):a("",!0)],2)]),s.errorText?(n(),i("span",oe,d(s.errorText),1)):a("",!0)])}const ce=B(A,[["render",ne]]);export{ce as S};
