import{i as F}from"./index-DhTHOtvJ.js";import{P as S}from"./Pill-Tc8R0SoQ.js";import{I as V}from"./Input-D2CpQCT5.js";import{M as I}from"./Modal-Cn5tyxTP.js";import{H as N,d as u,g as m,r as d,o as n,b as l,k as C,D as p,c as _,a as M,F as v,f as k,t as w,e as B}from"./app-BFRszLDY.js";import{B as E}from"./Button-DCQzWhi0.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{p as c}from"./parsePhoneNumber-xMTQFMCS.js";import{P as A}from"./plus-B7cTGDAB.js";const D={inject:["formState","notificationState"],components:{Pill:S,Input:V,Modal:I,Button:E},props:{modelValue:{type:[String,Array]},isSubmitting:{type:Boolean,default:!1},createMobileNumber:{type:Function,default:null},updateMobileNumber:{type:Function,default:null},deleteMobileNumber:{type:Function,default:null},bodyClass:{type:String,default:null}},data(){return{Plus:A,form:{mobile_number:""},InputKey:0,originalForm:null,mobileNumber:null,mobileNumberIndex:null}},computed:{hasMobileNumbers(){return this.modelValue.length>0},nationalMobileNumbers(){return this.modelValue.map(t=>{const e=c(t)||null;return e&&e.isValid()?e.formatNational().replace(/\s+/g,""):null}).filter(t=>t!=null)},formHasChanged(){return!F(this.form,this.originalForm)},mustSaveChanges(){return this.formHasChanged&&!this.isSubmitting}},methods:{onShow(){++this.InputKey},showMobileNumber(t,e,s){this.mobileNumberIndex=s,this.mobileNumber=e,this.mobileNumber?this.setForm():this.resetForm(),t()},setForm(){this.form.mobile_number=this.mobileNumber,this.originalForm=N(this.form)},resetForm(){this.form.mobile_number="",this.originalForm=N(this.form)},_createMobileNumber(t){const e=c(this.form.mobile_number)||null;if(!e||!e.isValid()){this.formState.setFormError("mobile_number","This is not a valid mobile number");return}if(this.modelValue.some(a=>a===this.form.mobile_number)){this.notificationState.showWarningNotification("Mobile number already exists"),t();return}this.createMobileNumber?this.createMobileNumber(this.form.mobile_number,this.resetForm,t):(this.modelValue.push(this.form.mobile_number),this.$emit("change",this.modelValue),this.resetForm(),t())},_updateMobileNumber(t){const e=c(this.form.mobile_number)||null;if(!e||!e.isValid()){this.formState.setFormError("mobile_number","This is not a valid mobile number");return}if(this.modelValue.some(a=>a===this.form.mobile_number)){this.notificationState.showWarningNotification("Mobile number already exists"),t();return}this.updateMobileNumber?this.updateMobileNumber(this.form.mobile_number,this.mobileNumberIndex,this.resetForm,t):(this.modelValue.splice(this.mobileNumberIndex,1,this.form.mobile_number),this.$emit("change",this.modelValue),this.resetForm(),t())},_deleteMobileNumber(t){this.deleteMobileNumber?this.deleteMobileNumber(this.mobileNumberIndex,this.resetForm,t):(this.modelValue.splice(this.mobileNumberIndex,1),this.$emit("change",this.modelValue),this.resetForm(),t())}}},P={class:"flex space-x-2 mt-4"},L={key:0,class:"flex flex-wrap gap-2"},T={class:"flex items-center"},H={class:"mx-2"};function K(t,e,s,a,i,o){const x=d("Input"),b=d("Button"),y=d("Pill"),g=d("Modal");return n(),u(g,{onShow:o.onShow,showFooter:!1,scrollOnContent:!0,header:i.mobileNumber?"Edit Mobile Number":"Add Mobile Number"},{content:m(r=>[l("div",null,[(n(),u(x,{type:"text",key:i.InputKey,label:"Mobile Number",placeholder:"+26772000001",modelValue:i.form.mobile_number,"onUpdate:modelValue":e[0]||(e[0]=h=>i.form.mobile_number=h),errorText:o.formState.getFormError("mobile_number")},null,8,["modelValue","errorText"])),l("div",P,[i.mobileNumber?(n(),u(b,{key:0,size:"sm",type:"danger",disabled:s.isSubmitting,action:()=>o._deleteMobileNumber(r.hideModal)},{default:m(()=>[...e[1]||(e[1]=[l("span",null,"Delete",-1)])]),_:1},8,["disabled","action"])):B("",!0),M(b,{size:"sm",type:"success",class:"w-full",buttonClass:"w-full",disabled:!o.mustSaveChanges,action:()=>i.mobileNumber?o._updateMobileNumber(r.hideModal):o._createMobileNumber(r.hideModal)},{default:m(()=>[l("span",null,w(i.mobileNumber?"Save Changes":"Add Mobile Number"),1)]),_:1},8,["disabled","action"])])])]),trigger:m(r=>[l("div",{class:C(s.bodyClass)},[p(t.$slots,"content"),o.hasMobileNumbers?(n(),_("div",L,[p(t.$slots,"prefix"),(n(!0),_(v,null,k(o.nationalMobileNumbers,(h,f)=>(n(),u(y,{size:"xs",key:f,type:"primary",showDot:!1,action:()=>o.showMobileNumber(r.showModal,s.modelValue[f],f)},{default:m(()=>[l("div",T,[l("span",H,w(h),1),e[2]||(e[2]=l("svg",{class:"w-3 h-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})],-1))])]),_:2},1032,["action"]))),128)),M(b,{size:"sm",icon:"add",leftIcon:i.Plus,leftIconSize:"16",buttonClass:"w-48",rounded:"rounded-full",action:()=>o.showMobileNumber(r.showModal,null,null)},{default:m(()=>[...e[3]||(e[3]=[l("span",{class:"text-xs"},"Add Mobile Number",-1)])]),_:1},8,["leftIcon","action"])])):(n(),u(b,{key:1,size:"xs",type:"light",leftIcon:i.Plus,action:()=>o.showMobileNumber(r.showModal,null,null),buttonClass:"w-48"},{default:m(()=>[...e[4]||(e[4]=[l("span",{class:"whitespace-nowrap"},"Add Mobile Number",-1)])]),_:1},8,["leftIcon","action"]))],2)]),_:3},8,["onShow","header"])}const R=z(D,[["render",K]]);export{R as I};
