import{c as u,b as o,a,r as m,w as y,e as x,t as d,g as p,h as b,o as c,i as S}from"./app-C3gvvzwr.js";import{L as E}from"./Logo-DehrYKCV.js";import{I as _}from"./Input-Ky0M0gBr.js";import{B as P}from"./Button-H5-4pReg.js";import{i as k}from"./stringUtils-Bvzw0-oW.js";import{_ as v}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Copy-2MtTss3I.js";import"./ShineEffect-Bjy7l8nq.js";import"./createLucideIcon-DcEzUACP.js";import"./Popover-CueE8CKU.js";import"./x-DysaB_8N.js";import"./Skeleton-BmfWv9Ad.js";import"./refresh-ccw-CCOkutNK.js";import"./circle-check-Bpb6vmpJ.js";import"./circle-alert-jW_RoXi8.js";import"./parsePhoneNumber-DR0S47Bc.js";import"./Loader-CenJqq8u.js";const F={name:"ResetPassword",components:{Logo:E,Input:_,Button:P},inject:["formState","notificationState"],data(){return{form:{email:"",token:"",password:"",confirmPassword:""},loading:!1,currentYear:new Date().getFullYear()}},methods:{isEmpty:k,async submit(){var n,t;if(!this.loading&&(this.formState.hideFormErrors(),this.isEmpty(this.form.email)&&this.formState.setFormError("email","Email is required"),this.isEmpty(this.form.password)&&this.formState.setFormError("password","New Password is required"),this.isEmpty(this.form.confirmPassword)&&this.formState.setFormError("confirmPassword","Confirm New Password is required"),this.form.password!==this.form.confirmPassword&&this.formState.setFormError("confirmPassword","Passwords do not match"),!this.formState.hasErrors)){this.loading=!0;try{await b.post("/api/auth/reset-password",this.form),this.notificationState.showSuccessNotification("Password reset successfully. Please log in with your new password."),this.$router.push({name:"login"})}catch(e){const f=((t=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:t.message)||(e==null?void 0:e.message)||"Something went wrong while resetting your password";this.notificationState.showWarningNotification(f),this.formState.setServerFormErrors(e),console.error("Failed to reset password:",e)}finally{this.loading=!1}}}},mounted(){this.form.email=this.$route.query.email||"",this.form.token=this.$route.query.token||"",this.form.email?this.form.token||(this.formState.setFormError("general","Missing token."),this.notificationState.showWarningNotification("Missing token.")):(this.formState.setFormError("general","Missing email."),this.notificationState.showWarningNotification("Missing email."))}},V={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},N={class:"flex items-center justify-center p-6 bg-gradient-to-b from-blue-100 to-white-100"},T={class:"w-full max-w-md"},B={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},C={key:0,class:"text-red-500 text-sm mb-3"},L={class:"ml-1"},j={class:"flex justify-center mt-4"},q={class:"text-sm text-center text-gray-500"};function M(n,t,e,f,r,s){const g=m("Logo"),l=m("Input"),w=m("Button"),h=m("router-link");return c(),u("div",V,[o("div",N,[o("div",T,[a(g,{height:"h-20 mx-auto mb-4"}),o("div",B,[t[5]||(t[5]=o("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Reset Password",-1)),t[6]||(t[6]=o("h1",{class:"text-sm text-gray-500 mb-4"},"Enter a new password for your account.",-1)),o("form",{onSubmit:t[3]||(t[3]=y((...i)=>s.submit&&s.submit(...i),["prevent"])),class:"space-y-4"},[a(l,{disabled:"",type:"email",label:"Email",modelValue:r.form.email,"onUpdate:modelValue":t[0]||(t[0]=i=>r.form.email=i),errorText:s.formState.getFormError("email")},null,8,["modelValue","errorText"]),a(l,{type:"password",label:"New Password",modelValue:r.form.password,"onUpdate:modelValue":t[1]||(t[1]=i=>r.form.password=i),errorText:s.formState.getFormError("password")},null,8,["modelValue","errorText"]),a(l,{type:"password",label:"Confirm New Password",modelValue:r.form.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=i=>r.form.confirmPassword=i),errorText:s.formState.getFormError("confirmPassword")},null,8,["modelValue","errorText"]),s.formState.generalErrorText?(c(),u("div",C,d(s.formState.generalErrorText),1)):x("",!0),a(w,{size:"md",type:"primary",action:s.submit,disabled:r.loading,buttonClass:"w-full"},{default:p(()=>[o("span",L,d(r.loading?"Resetting...":"Reset Password"),1)]),_:1},8,["action","disabled"]),o("div",j,[a(h,{to:{name:"login"},class:"text-sm text-blue-600 hover:underline"},{default:p(()=>t[4]||(t[4]=[S("Back to Login")])),_:1,__:[4]})])],32)]),o("p",q,"Â© "+d(r.currentYear)+" Perfect Order. All rights reserved.",1)])]),t[7]||(t[7]=o("div",{class:"hidden lg:block"},[o("img",{src:"/images/lady-with-laptop.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const tt=v(F,[["render",M]]);export{tt as default};
