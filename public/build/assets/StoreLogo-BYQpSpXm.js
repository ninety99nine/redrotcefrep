import{B as _}from"./Button-Bf8PGHdu.js";import{c as p,b as l,d as f,e as d,a as w,r as c,n as u,g as P,o as a,t as B}from"./app-CLfu_pic.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as k}from"./createLucideIcon-FkRKWxCW.js";import{P as g}from"./plus-e8yeq13D.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m=k("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),v={inject:["formState","storeState","notificationState"],components:{Plus:g,RefreshCw:m,Button:_},props:{size:{type:String,default:"w-20 h-20"},store:{type:[Object,null],default:null},showButton:{type:Boolean,default:!0},uploading:{type:Boolean,default:!1}},emits:["selectedFile"],data(){return{Plus:g,RefreshCw:m,filePath:null,localStore:null,isUploading:!1,filePathBefore:null}},computed:{isUploadingAny(){return this.uploading??this.isUploading}},methods:{triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(o){const t=o.target.files[0];t&&(this.filePath=URL.createObjectURL(t),this.$emit("selectedFile",this.$refs.fileInput.files[0]),this.localStore&&this.uploadStoreLogo())},async uploadStoreLogo(){var o,t;try{if(this.isUploadingAny||this.$refs.fileInput.files.length==0)return;let e=new FormData;e.append("return",1),e.append("type","store_logo"),e.append("store_id",this.localStore.id),e.append("file",this.$refs.fileInput.files[0]);const n={headers:{"Content-Type":"multipart/form-data"}};this.isUploading=!0;const i=await axios.post("/api/media-files",e,n);this.notificationState.showSuccessNotification("Store logo updated!"),this.storeState.store&&this.localStore.id==this.storeState.store.id&&(this.storeState.store.logo=i.data.media_file,this.filePath=i.data.media_file.path,this.filePathBefore=this.filePath)}catch(e){const n=((t=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:t.message)||(e==null?void 0:e.message)||"Something went wrong while uploading store logo";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(e),console.error("Failed to upload store logo:",e),this.filePath=this.filePathBefore}finally{this.isUploading=!1,this.$refs.fileInput.value=""}}},created(){var o;this.localStore=this.store?this.store:this.storeState.store,(o=this.localStore)!=null&&o.logo&&(this.filePath=this.localStore.logo.path,this.filePathBefore=this.filePath)}},b={key:0,class:"absolute inset-0 text-white bg-blue-500/80 bg-opacity-50 flex items-center justify-center rounded-full transition-opacity"},x={class:"absolute inset-0 text-white bg-black/80 bg-opacity-50 flex items-center justify-center rounded-full opacity-0 group-hover:opacity-100 transition-opacity"},C=["src"];function F(o,t,e,n,i,s){const h=c("RefreshCw"),y=c("Plus"),S=c("Button");return a(),p("div",{class:u({"flex flex-col items-center space-y-2":e.showButton})},[l("div",{onClick:t[0]||(t[0]=(...r)=>s.triggerFileUpload&&s.triggerFileUpload(...r)),class:u([e.size,"bg-gray-200 rounded-full flex items-center justify-center cursor-pointer active:scale-95 transition-all relative group"])},[s.isUploadingAny?(a(),p("div",b,[w(h,{size:"16",class:"animate-spin"})])):d("",!0),l("div",x,[i.filePath?(a(),f(h,{key:0,size:"16"})):(a(),f(y,{key:1,size:"16"}))]),l("img",{src:i.filePath?i.filePath:"/images/logo-black-transparent.png",alt:"Store Logo",class:"w-full h-full rounded-full"},null,8,C)],2),l("input",{type:"file",class:"hidden",ref:"fileInput",onChange:t[1]||(t[1]=(...r)=>s.handleFileUpload&&s.handleFileUpload(...r)),accept:"image/jpeg, image/jpg, image/png, image/gif"},null,544),e.showButton?(a(),f(S,{key:0,size:"xs",type:"light",buttonClass:"w-40",action:s.triggerFileUpload,leftIcon:i.filePath?i.RefreshCw:i.Plus},{default:P(()=>[l("span",null,B(i.filePath?"Change":"Add")+" store logo",1)]),_:1},8,["action","leftIcon"])):d("",!0)],2)}const N=U(v,[["render",F]]);export{m as R,N as S};
