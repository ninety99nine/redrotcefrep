import{I as Z}from"./Input-nrLqMDkp.js";import{M as G}from"./Modal-CB5khyw0.js";import{B as K}from"./Button-C5PjVjk3.js";import{L as Q}from"./Loader-BQyLZa88.js";import{S as Y}from"./Switch-CrsvtGnj.js";import{S as X}from"./Select-K0z1EWjn.js";import{P as $}from"./Popover-CDw03pE7.js";import{i as ee}from"./stringUtils-Bvzw0-oW.js";import{S as te}from"./Skeleton-CCmfEA-R.js";import{D as oe}from"./Datepicker-gJdSEtaR.js";import{S as ie}from"./SelectTags-Dql7VcGC.js";import{B as re}from"./BackdropLoader-BCy7BoLZ.js";import{c as u,b as o,e as c,a as i,g as P,t as F,d as v,F as y,f as M,j as se,i as b,r as _,o as m}from"./app-GlJHzU_x.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as f}from"./createLucideIcon-BHEQ_wZh.js";import{M as V}from"./move-left-CB0J3wAv.js";import{C as ae}from"./calendar-DxAY9EBu.js";import{H as de}from"./hourglass-B0iYd5Uu.js";import{C as me}from"./clock-11vp7dsc.js";import{B as le}from"./box-MF7JD9BV.js";import{T as E}from"./trash-2-1C5JYDaS.js";import{T as ue}from"./truck-s2PSZ1v8.js";import{P as I}from"./plus-xs22FjRq.js";import"./Copy-By71uU1S.js";import"./ShineEffect-B9_RJRQO.js";import"./Tooltip-C-cjSIU7.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-Bc4GdQ8O.js";import"./circle-check-D0AZ00dD.js";import"./circle-alert-DHQrfF2Y.js";import"./x-D9LU4_3P.js";import"./parsePhoneNumber-DR0S47Bc.js";import"./vue-draggable-next.esm-bundler-2B3kMfEa.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=f("asterisk",[["path",{d:"M12 6v12",key:"1vza4d"}],["path",{d:"M17.196 9 6.804 15",key:"1ah31z"}],["path",{d:"m6.804 9 10.392 6",key:"1b6pxd"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=f("boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=f("circle-percent",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 15h.01",key:"lqbp3k"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=f("clock-9",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 7.5 12",key:"1k60p0"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=f("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=f("user-round-plus",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M22 19h-6",key:"vcuq98"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=f("user-round-search",[["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M2 21a8 8 0 0 1 10.434-7.62",key:"1yezr2"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["path",{d:"m22 22-1.9-1.9",key:"1e5ubv"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=f("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),be={inject:["formState","storeState","promotionState","changeHistoryState","notificationState"],components:{Input:Z,Modal:G,Button:K,Loader:Q,Switch:Y,Select:X,Popover:$,Skeleton:te,Datepicker:oe,SelectTags:ie,BackdropLoader:re,Plus:I,Truck:ue,Trash2:E,Box:le,Boxes:_e,Users:ye,Clock:me,Hourglass:de,Clock9:ge,Receipt:fe,Calendar:ae,Asterisk:ce,UserRoundSearch:ve,UserRoundPlus:he,MoveLeft:V,CirclePercent:pe},data(){return{Plus:I,Trash2:E,MoveLeft:V,selectedOffers:[],offerOptions:[{label:"Discount",value:"offer_discount"},{label:"Free Delivery",value:"offer_free_delivery"}],selectedConditions:[],conditionOptions:[{label:"Promo Code",value:"activate_using_code"},{label:"New Customers",value:"activate_for_new_customer"},{label:"Existing Customers",value:"activate_for_existing_customer"},{label:"Usage Limit",value:"activate_using_usage_limit"},{label:"Minimum Grand Total",value:"activate_using_minimum_grand_total"},{label:"Minimum Total Products",value:"activate_using_minimum_total_products"},{label:"Minimum Total Product Quantities",value:"activate_using_minimum_total_product_quantities"},{label:"Start Datetime",value:"activate_using_start_datetime"},{label:"End Datetime",value:"activate_using_end_datetime"},{label:"Hours of Day",value:"activate_using_hours_of_day"},{label:"Days of the Week",value:"activate_using_days_of_the_week"},{label:"Days of the Month",value:"activate_using_days_of_the_month"},{label:"Months of the Year",value:"activate_using_months_of_the_year"}],activeTypes:[{label:"Active",value:!0},{label:"Inactive",value:!1}],discountRateTypes:[{label:"Flat",value:"flat"},{label:"Percentage",value:"percentage"}],hourOptions:Array.from({length:24},(r,e)=>({label:e.toString().padStart(2,"0")+":00",value:e.toString().padStart(2,"0")+":00"})),dayOptions:[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],dayOfMonthOptions:Array.from({length:31},(r,e)=>({label:`${e+1}`,value:(e+1).toString().padStart(2,"0")})),monthOptions:[{label:"January",value:"January"},{label:"February",value:"February"},{label:"March",value:"March"},{label:"April",value:"April"},{label:"May",value:"May"},{label:"June",value:"June"},{label:"July",value:"July"},{label:"August",value:"August"},{label:"September",value:"September"},{label:"October",value:"October"},{label:"November",value:"November"},{label:"December",value:"December"}]}},watch:{store(r,e){!e&&r&&this.setup()},promotionId(r){r&&(this.setup(),this.setActionButtons())},promotionForm:{handler(){this.setSelectedOffers(),this.setSelectedConditions()},deep:!0}},computed:{store(){return this.storeState.store},promotion(){return this.promotionState.promotion},hasPromotion(){return this.promotionState.hasPromotion},promotionId(){return this.$route.params.promotion_id},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingPromotion(){return this.promotionState.isLoadingPromotion},isEditing(){return this.$route.name==="edit-promotion"},isCreating(){return this.$route.name==="create-promotion"},promotionForm(){return this.promotionState.promotionForm},isSubmitting(){return this.changeHistoryState.actionButtons.length==0?!1:this.changeHistoryState.actionButtons[1].loading},isDeletingPromotion(){return this.promotionState.isDeletingPromotion},hasSelectedConditions(){return this.selectedConditions.length>0}},methods:{isEmpty:ee,goBack(){this.navigateToPromotions()},async setup(){this.promotionForm==null&&this.promotionState.setPromotionForm(null,this.isCreating),this.isEditing&&this.store&&await this.showPromotion()},async navigateToPromotions(){await this.$router.replace({name:"show-promotions",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},async navigateToEditPromotion(r){await this.$router.push({name:"edit-promotion",params:{promotion_id:r.id},query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},setSelectedItems(r,e){this[e]=r.filter(s=>this.promotionForm[s])},setSelectedOffers(){const r=["offer_discount","offer_free_delivery"];this.setSelectedItems(r,"selectedOffers")},setSelectedConditions(){const r=["activate_using_code","activate_for_new_customer","activate_for_existing_customer","activate_using_usage_limit","activate_using_minimum_grand_total","activate_using_minimum_total_products","activate_using_minimum_total_product_quantities","activate_using_start_datetime","activate_using_end_datetime","activate_using_hours_of_day","activate_using_days_of_the_week","activate_using_days_of_the_month","activate_using_months_of_the_year"];this.setSelectedItems(r,"selectedConditions")},addOffer(r){const e={offer_discount:"Discount added",offer_free_delivery:"Free delivery added"};this.promotionForm[r]=!0,this.promotionState.saveStateDebounced(e[r])},removeOffer(r){const e={offer_discount:"Discount removed",offer_free_delivery:"Free delivery removed"};this.promotionForm[r]=!1,this.promotionState.saveStateDebounced(e[r])},handleOffersChange(r){["offer_discount","offer_free_delivery"].forEach(s=>{r.includes(s)&&!this.promotionForm[s]?this.addOffer(s):!r.includes(s)&&this.promotionForm[s]&&this.removeOffer(s)})},addCondition(r){const e={activate_using_code:"Promo code added",activate_for_new_customer:"New customers added",activate_for_existing_customer:"Existing customers added",activate_using_usage_limit:"Usage limit added",activate_using_minimum_grand_total:"Minimum grand total added",activate_using_minimum_total_products:"Minimum total products added",activate_using_minimum_total_product_quantities:"Minimum total product quantities added",activate_using_start_datetime:"Start datetime added",activate_using_end_datetime:"End datetime added",activate_using_hours_of_day:"Hours of day added",activate_using_days_of_the_week:"Days of the week added",activate_using_days_of_the_month:"Days of the month added",activate_using_months_of_the_year:"Months of the year added"};this.promotionForm[r]=!0,this.promotionState.saveStateDebounced(e[r])},removeCondition(r){const e={activate_using_code:"Promo code removed",activate_for_new_customer:"New customers removed",activate_for_existing_customer:"Existing customers removed",activate_using_usage_limit:"Usage limit removed",activate_using_minimum_grand_total:"Minimum grand total removed",activate_using_minimum_total_products:"Minimum total products removed",activate_using_minimum_total_product_quantities:"Minimum total product quantities removed",activate_using_start_datetime:"Start datetime removed",activate_using_end_datetime:"End datetime removed",activate_using_hours_of_day:"Hours of day removed",activate_using_days_of_the_week:"Days of the week removed",activate_using_days_of_the_month:"Days of the month removed",activate_using_months_of_the_year:"Months of the year removed"};this.promotionForm[r]=!1,this.promotionState.saveStateDebounced(e[r])},handleConditionsChange(r){["activate_using_code","activate_for_new_customer","activate_for_existing_customer","activate_using_usage_limit","activate_using_minimum_grand_total","activate_using_minimum_total_products","activate_using_minimum_total_product_quantities","activate_using_start_datetime","activate_using_end_datetime","activate_using_hours_of_day","activate_using_days_of_the_week","activate_using_days_of_the_month","activate_using_months_of_the_year"].forEach(s=>{r.includes(s)&&!this.promotionForm[s]?this.addCondition(s):!r.includes(s)&&this.promotionForm[s]&&this.removeCondition(s)})},async showPromotion(){var r,e,s;try{this.promotionState.isLoadingPromotion=!0;let l={params:{store_id:this.store.id}};const t=(await axios.get(`/api/promotions/${this.promotionId}`,l)).data;this.promotionState.setPromotion(t),this.promotionState.setPromotionForm(t)}catch(l){const n=((e=(r=l==null?void 0:l.response)==null?void 0:r.data)==null?void 0:e.message)||(l==null?void 0:l.message)||"Something went wrong while fetching promotion";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(l),console.error("Failed to fetch promotion:",l),((s=l.response)==null?void 0:s.status)===404&&await this.$router.replace({name:"show-promotions",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}finally{this.promotionState.isLoadingPromotion=!1}},async createPromotion(){var r,e;try{if(this.promotionState.isCreatingPromotion||(this.formState.hideFormErrors(),this.isEmpty(this.promotionForm.name)&&this.formState.setFormError("name","The name is required"),this.formState.hasErrors))return;this.promotionState.isCreatingPromotion=!0,this.changeHistoryState.actionButtons[1].loading=!0;const s={...this.promotionForm,store_id:this.store.id},n=(await axios.post("/api/promotions",s)).data.promotion;this.notificationState.showSuccessNotification("Promotion created"),this.promotionState.saveOriginalState("Original promotion"),await this.navigateToEditPromotion(n)}catch(s){const l=((e=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while creating promotion";this.notificationState.showWarningNotification(l),this.formState.setServerFormErrors(s),console.error("Failed to create promotion:",s)}finally{this.promotionState.isCreatingPromotion=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async updatePromotion(){var r,e;try{if(this.promotionState.isUpdatingPromotion||(this.formState.hideFormErrors(),this.isEmpty(this.promotionForm.name)&&this.formState.setFormError("name","The name is required"),this.formState.hasErrors))return;this.promotionState.isUpdatingPromotion=!0,this.changeHistoryState.actionButtons[1].loading=!0;const s={...this.promotionForm,store_id:this.store.id};await axios.put(`/api/promotions/${this.promotionForm.id}`,s),this.notificationState.showSuccessNotification("Promotion updated"),this.promotionState.saveOriginalState("Original promotion")}catch(s){const l=((e=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while updating promotion";this.notificationState.showWarningNotification(l),this.formState.setServerFormErrors(s),console.error("Failed to update promotion:",s)}finally{this.promotionState.isUpdatingPromotion=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async deletePromotion(r){var e,s;try{if(this.promotionState.isDeletingPromotion)return;this.promotionState.isDeletingPromotion=!0;const l={data:{store_id:this.store.id}};await axios.delete(`/api/promotions/${this.promotion.id}`,l),r(),await new Promise(n=>setTimeout(n,500)),this.notificationState.showSuccessNotification("Promotion deleted"),await this.navigateToPromotions()}catch(l){const n=((s=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:s.message)||(l==null?void 0:l.message)||"Something went wrong while deleting promotion";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(l),console.error("Failed to delete promotion:",l),r()}finally{this.promotionState.isDeletingPromotion=!1}},setActionButtons(){(this.isCreating||this.isEditing)&&(this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Create Promotion",this.isEditing?this.updatePromotion:this.createPromotion,"primary",null))},setPromotionForm(r){this.promotionState.promotionForm=r}},beforeRouteLeave(r,e,s){if(this.changeHistoryState.hasChangeHistory&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return s(!1);s()},unmounted(){this.promotionState.reset()},created(){this.setup(),this.setActionButtons();const r=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let e=0;e<r.length;e++){let s=r[e];this.changeHistoryState.listeners[s]=this.setPromotionForm}}},xe={class:"pt-24 px-4 pb-80"},Se={class:"grid grid-cols-12 gap-4 mb-4"},ke={class:"col-span-8 col-start-3"},Fe={class:"select-none bg-white rounded-lg p-4 mb-4"},we={class:"flex items-center space-x-4"},Te={key:0,class:"flex items-center space-x-2"},Ce={key:1,class:"flex items-center space-x-1"},De={class:"text-lg text-gray-700 font-semibold"},Pe={class:"relative mb-4"},Me={class:"bg-white rounded-lg space-y-4 p-4"},Ve={class:"grid grid-cols-2 gap-4"},Ee={class:"relative mb-4"},Ie={class:"bg-white rounded-lg space-y-4 p-4"},ze={key:0,class:"border border-green-200 rounded-lg mb-4"},qe={class:"bg-green-50 flex items-center justify-between rounded-lg space-x-4 py-2 px-4"},Oe={class:"flex items-center space-x-2"},He={key:1,class:"border border-green-200 rounded-lg mb-4"},Ue={class:"bg-green-50 border-b border-green-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},Be={class:"flex items-center space-x-2"},Le={class:"w-full grid grid-cols-2 gap-4 p-4"},Ae={class:"relative mb-4"},je={class:"bg-white rounded-lg space-y-4 p-4"},Ne={key:0,class:"border border-green-200 rounded-lg mb-4"},Re={class:"bg-green-50 flex items-center justify-between rounded-lg space-x-4 py-2 px-4"},Je={class:"flex items-center space-x-2"},We={key:1,class:"border border-indigo-200 rounded-lg mb-4"},Ze={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},Ge={class:"flex items-center space-x-2"},Ke={class:"p-4"},Qe={key:2,class:"border border-indigo-200 rounded-lg mb-4"},Ye={class:"bg-indigo-50 flex items-center justify-between rounded-lg space-x-4 py-2 px-4"},Xe={class:"flex items-center space-x-2"},$e={key:3,class:"border border-indigo-200 rounded-lg mb-4"},et={class:"bg-indigo-50 flex items-center justify-between rounded-lg space-x-4 py-2 px-4"},tt={class:"flex items-center space-x-2"},ot={key:4,class:"border border-indigo-200 rounded-lg mb-4"},it={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},rt={class:"flex items-center space-x-2"},st={class:"p-4"},nt={key:5,class:"border border-indigo-200 rounded-lg mb-4"},at={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},dt={class:"flex items-center space-x-2"},mt={class:"p-4"},lt={key:6,class:"border border-indigo-200 rounded-lg mb-4"},ut={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},ct={class:"flex items-center space-x-2"},_t={class:"p-4"},pt={key:7,class:"border border-indigo-200 rounded-lg mb-4"},gt={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},ft={class:"flex items-center space-x-2"},ht={class:"p-4"},vt={key:8,class:"border border-indigo-200 rounded-lg mb-4"},yt={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},bt={class:"flex items-center space-x-2"},xt={class:"p-4"},St={key:9,class:"border border-indigo-200 rounded-lg mb-4"},kt={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},Ft={class:"flex items-center space-x-2"},wt={class:"p-4"},Tt={key:10,class:"border border-indigo-200 rounded-lg mb-4"},Ct={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},Dt={class:"flex items-center space-x-2"},Pt={class:"p-4"},Mt={key:11,class:"border border-indigo-200 rounded-lg mb-4"},Vt={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},Et={class:"flex items-center space-x-2"},It={class:"p-4"},zt={key:12,class:"border border-indigo-200 rounded-lg mb-4"},qt={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},Ot={class:"flex items-center space-x-2"},Ht={class:"p-4"},Ut={key:13,class:"border border-indigo-200 rounded-lg mb-4"},Bt={class:"bg-indigo-50 border-b border-indigo-200 flex items-center justify-between rounded-t-lg space-x-4 py-2 px-4"},Lt={class:"flex items-center space-x-2"},At={class:"p-4"},jt={key:0,class:"bg-indigo-50 border border-indigo-200 text-indigo-600 p-4 rounded-lg text-sm"},Nt={class:"font-bold text-black"},Rt={class:"flex justify-end"},Jt={class:"mb-8"},Wt={class:"font-bold text-black"};function Zt(r,e,s,l,n,t){const p=_("Button"),w=_("Skeleton"),z=_("Popover"),x=_("BackdropLoader"),g=_("Input"),T=_("Select"),h=_("SelectTags"),C=_("Truck"),q=_("CirclePercent"),O=_("Asterisk"),H=_("UserRoundPlus"),U=_("UserRoundSearch"),B=_("Users"),L=_("Receipt"),A=_("Box"),j=_("Boxes"),N=_("Clock"),D=_("Datepicker"),R=_("Clock9"),J=_("Hourglass"),S=_("Calendar"),W=_("Modal");return m(),u("div",xe,[o("div",Se,[o("div",ke,[o("div",Fe,[o("div",we,[i(p,{size:"xs",type:"light",action:t.goBack,leftIcon:n.MoveLeft},{default:P(()=>e[36]||(e[36]=[o("span",null,"Back",-1)])),_:1,__:[36]},8,["action","leftIcon"]),t.isLoadingStore||t.isLoadingPromotion||t.isEditing&&!t.hasPromotion?(m(),u("div",Te,[i(w,{width:"w-40"}),i(w,{width:"w-4"})])):(m(),u("div",Ce,[o("h1",De,F(t.isCreating?"Add Promotion":t.promotionForm.name||"..."),1),i(z,{content:"Promotions are special offers that provide discounts or free delivery to customers based on specific conditions.",placement:"top"})]))])]),o("div",Pe,[t.isLoadingPromotion||t.isSubmitting?(m(),v(x,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):c("",!0),o("div",Me,[o("div",Ve,[i(g,{type:"text",label:"Name",placeholder:"10% Off",modelValue:t.promotionForm.name,"onUpdate:modelValue":e[0]||(e[0]=d=>t.promotionForm.name=d),errorText:t.formState.getFormError("name"),tooltipContent:"The name of the promotion, e.g., 10% Off",onInput:e[1]||(e[1]=d=>t.promotionState.saveStateDebounced("Name changed"))},null,8,["modelValue","errorText"]),i(T,{class:"w-full",label:"Status",search:!1,options:n.activeTypes,modelValue:t.promotionForm.active,"onUpdate:modelValue":e[2]||(e[2]=d=>t.promotionForm.active=d),errorText:t.formState.getFormError("active"),onChange:e[3]||(e[3]=d=>t.promotionState.saveStateDebounced("Active status changed")),tooltipContent:"Turn on if you want your promotion to be available on checkout"},null,8,["options","modelValue","errorText"])]),i(g,{rows:"2",type:"textarea",label:"Description",modelValue:t.promotionForm.description,"onUpdate:modelValue":e[4]||(e[4]=d=>t.promotionForm.description=d),placeholder:"Get 10% off your order",errorText:t.formState.getFormError("description"),tooltipContent:"A short description of the promotion",onInput:e[5]||(e[5]=d=>t.promotionState.saveStateDebounced("Description changed"))},null,8,["modelValue","errorText"])])]),o("div",Ee,[t.isLoadingPromotion||t.isSubmitting?(m(),v(x,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):c("",!0),o("div",Ie,[e[39]||(e[39]=o("p",{class:"text-lg text-gray-700 font-semibold"},"Offers",-1)),i(h,{placeholder:"Add offer",options:n.offerOptions,modelValue:n.selectedOffers,"onUpdate:modelValue":e[6]||(e[6]=d=>n.selectedOffers=d),onChange:t.handleOffersChange,tooltipContent:"Select the offers to include in the promotion"},null,8,["options","modelValue","onChange"]),(m(!0),u(y,null,M(n.selectedOffers,(d,k)=>(m(),u(y,{key:k},[d=="offer_free_delivery"&&t.promotionForm.offer_free_delivery?(m(),u("div",ze,[o("div",qe,[o("div",Oe,[i(C,{size:"20",class:"text-green-600"}),e[37]||(e[37]=o("span",{class:"text-green-600 text-sm font-semibold"},"Free delivery",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeOffer("offer_free_delivery")},null,8,["leftIcon","action"])])])):c("",!0),d=="offer_discount"&&t.promotionForm.offer_discount?(m(),u("div",He,[o("div",Ue,[o("div",Be,[i(q,{size:"20",class:"text-green-600"}),e[38]||(e[38]=o("span",{class:"text-green-600 text-sm font-semibold"},"Discount",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeOffer("offer_discount")},null,8,["leftIcon","action"])]),o("div",Le,[i(T,{class:"w-full",search:!1,label:"Discount Type",options:n.discountRateTypes,modelValue:t.promotionForm.discount_rate_type,"onUpdate:modelValue":e[7]||(e[7]=a=>t.promotionForm.discount_rate_type=a),errorText:t.formState.getFormError("discount_rate_type"),onChange:e[8]||(e[8]=a=>t.promotionState.saveStateDebounced("Discount rate type changed")),tooltipContent:"Choose whether the discount is a flat amount or percentage of the checkout total"},null,8,["options","modelValue","errorText"]),t.promotionForm.discount_rate_type==="flat"?(m(),v(g,{key:0,type:"money",class:"w-full",label:"Flat Rate",modelValue:t.promotionForm.discount_flat_rate,"onUpdate:modelValue":e[9]||(e[9]=a=>t.promotionForm.discount_flat_rate=a),tooltipContent:"Set the flat discount amount",errorText:t.formState.getFormError("discount_flat_rate"),onInput:e[10]||(e[10]=a=>t.promotionState.saveStateDebounced("Discount flat rate changed"))},null,8,["modelValue","errorText"])):c("",!0),t.promotionForm.discount_rate_type==="percentage"?(m(),v(g,{key:1,class:"w-full",type:"percentage",label:"Percentage Rate",modelValue:t.promotionForm.discount_percentage_rate,"onUpdate:modelValue":e[11]||(e[11]=a=>t.promotionForm.discount_percentage_rate=a),errorText:t.formState.getFormError("discount_percentage_rate"),tooltipContent:"Set the percentage discount (e.g., 10 for 10%)",onInput:e[12]||(e[12]=a=>t.promotionState.saveStateDebounced("Discount percentage rate changed"))},null,8,["modelValue","errorText"])):c("",!0)])])):c("",!0)],64))),128))])]),o("div",Ae,[t.isLoadingPromotion||t.isSubmitting?(m(),v(x,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):c("",!0),o("div",je,[e[55]||(e[55]=o("p",{class:"text-lg text-gray-700 font-semibold"},"Conditions",-1)),i(h,{placeholder:"Add condition",options:n.conditionOptions,modelValue:n.selectedConditions,"onUpdate:modelValue":e[13]||(e[13]=d=>n.selectedConditions=d),onChange:t.handleConditionsChange,tooltipContent:"Select the conditions to include in the promotion"},null,8,["options","modelValue","onChange"]),(m(!0),u(y,null,M(n.selectedConditions,(d,k)=>(m(),u(y,{key:k},[d=="offer_free_delivery"&&t.promotionForm.offer_free_delivery?(m(),u("div",Ne,[o("div",Re,[o("div",Je,[i(C,{size:"20",class:"text-green-600"}),e[40]||(e[40]=o("span",{class:"text-green-600 text-sm font-semibold"},"Free delivery",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeOffer("offer_free_delivery")},null,8,["leftIcon","action"])])])):c("",!0),d=="activate_using_code"&&t.promotionForm.activate_using_code?(m(),u("div",We,[o("div",Ze,[o("div",Ge,[i(O,{size:"20",class:"text-indigo-600"}),e[41]||(e[41]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Promo code",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_code")},null,8,["leftIcon","action"])]),o("div",Ke,[i(g,{type:"text",placeholder:"PROMO123",modelValue:t.promotionForm.code,"onUpdate:modelValue":e[14]||(e[14]=a=>t.promotionForm.code=a),errorText:t.formState.getFormError("code"),onInput:e[15]||(e[15]=a=>t.promotionState.saveStateDebounced("Code changed")),tooltipContent:"The code customers must enter to claim the promotion"},null,8,["modelValue","errorText"])])])):c("",!0),d=="activate_for_new_customer"&&t.promotionForm.activate_for_new_customer?(m(),u("div",Qe,[o("div",Ye,[o("div",Xe,[i(H,{size:"20",class:"text-indigo-600"}),e[42]||(e[42]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"New customers",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_for_new_customer")},null,8,["leftIcon","action"])])])):c("",!0),d=="activate_for_existing_customer"&&t.promotionForm.activate_for_existing_customer?(m(),u("div",$e,[o("div",et,[o("div",tt,[i(U,{size:"20",class:"text-indigo-600"}),e[43]||(e[43]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Existing customers",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_for_existing_customer")},null,8,["leftIcon","action"])])])):c("",!0),d=="activate_using_usage_limit"&&t.promotionForm.activate_using_usage_limit?(m(),u("div",ot,[o("div",it,[o("div",rt,[i(B,{size:"20",class:"text-indigo-600"}),e[44]||(e[44]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Usage limit",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_usage_limit")},null,8,["leftIcon","action"])]),o("div",st,[i(g,{min:"0",type:"number",placeholder:"100",modelValue:t.promotionForm.remaining_quantity,"onUpdate:modelValue":e[16]||(e[16]=a=>t.promotionForm.remaining_quantity=a),errorText:t.formState.getFormError("remaining_quantity"),onInput:e[17]||(e[17]=a=>t.promotionState.saveStateDebounced("Remaining quantity changed")),tooltipContent:"Set the number of times the promotion can still be used"},null,8,["modelValue","errorText"])])])):c("",!0),d=="activate_using_minimum_grand_total"&&t.promotionForm.activate_using_minimum_grand_total?(m(),u("div",nt,[o("div",at,[o("div",dt,[i(L,{size:"20",class:"text-indigo-600"}),e[45]||(e[45]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Minimum Grand Total",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_minimum_grand_total")},null,8,["leftIcon","action"])]),o("div",mt,[i(g,{type:"money",currency:t.store.currency,modelValue:t.promotionForm.minimum_grand_total,"onUpdate:modelValue":e[18]||(e[18]=a=>t.promotionForm.minimum_grand_total=a),errorText:t.formState.getFormError("minimum_grand_total"),onInput:e[19]||(e[19]=a=>t.promotionState.saveStateDebounced("Minimum grand total changed")),tooltipContent:"Set the minimum order total required to claim the promotion"},null,8,["currency","modelValue","errorText"])])])):c("",!0),d=="activate_using_minimum_total_products"&&t.promotionForm.activate_using_minimum_total_products?(m(),u("div",lt,[o("div",ut,[o("div",ct,[i(A,{size:"20",class:"text-indigo-600"}),e[46]||(e[46]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Minimum Total Products",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_minimum_total_products")},null,8,["leftIcon","action"])]),o("div",_t,[i(g,{min:"1",type:"number",placeholder:"3",modelValue:t.promotionForm.minimum_total_products,"onUpdate:modelValue":e[20]||(e[20]=a=>t.promotionForm.minimum_total_products=a),errorText:t.formState.getFormError("minimum_total_products"),tooltipContent:"Set the minimum number of different products required",onInput:e[21]||(e[21]=a=>t.promotionState.saveStateDebounced("Minimum total products changed"))},null,8,["modelValue","errorText"])])])):c("",!0),d=="activate_using_minimum_total_product_quantities"&&t.promotionForm.activate_using_minimum_total_product_quantities?(m(),u("div",pt,[o("div",gt,[o("div",ft,[i(j,{size:"20",class:"text-indigo-600"}),e[47]||(e[47]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Minimum Total Product Quantities",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_minimum_total_product_quantities")},null,8,["leftIcon","action"])]),o("div",ht,[i(g,{min:"1",type:"number",placeholder:"10",modelValue:t.promotionForm.minimum_total_product_quantities,"onUpdate:modelValue":e[22]||(e[22]=a=>t.promotionForm.minimum_total_product_quantities=a),tooltipContent:"Set the minimum total quantity of products required",errorText:t.formState.getFormError("minimum_total_product_quantities"),onInput:e[23]||(e[23]=a=>t.promotionState.saveStateDebounced("Minimum total product quantities changed"))},null,8,["modelValue","errorText"])])])):c("",!0),d=="activate_using_start_datetime"&&t.promotionForm.activate_using_start_datetime?(m(),u("div",vt,[o("div",yt,[o("div",bt,[i(N,{size:"20",class:"text-indigo-600"}),e[48]||(e[48]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Start Datetime",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_start_datetime")},null,8,["leftIcon","action"])]),o("div",xt,[i(D,{enableTimePicker:!0,placeholder:"Start date",format:"dd MMM yyyy HH:mm",modelType:"yyyy-MM-dd HH:mm",modelValue:t.promotionForm.start_datetime,"onUpdate:modelValue":e[24]||(e[24]=a=>t.promotionForm.start_datetime=a),errorText:t.formState.getFormError("start_datetime"),onChange:e[25]||(e[25]=a=>t.promotionState.saveStateDebounced("Start datetime changed"))},null,8,["modelValue","errorText"])])])):c("",!0),d=="activate_using_end_datetime"&&t.promotionForm.activate_using_end_datetime?(m(),u("div",St,[o("div",kt,[o("div",Ft,[i(R,{size:"20",class:"text-indigo-600"}),e[49]||(e[49]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"End Datetime",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_end_datetime")},null,8,["leftIcon","action"])]),o("div",wt,[i(D,{placeholder:"End date",enableTimePicker:!0,format:"dd MMM yyyy HH:mm",modelType:"yyyy-MM-dd HH:mm",modelValue:t.promotionForm.end_datetime,"onUpdate:modelValue":e[26]||(e[26]=a=>t.promotionForm.end_datetime=a),errorText:t.formState.getFormError("end_datetime"),onChange:e[27]||(e[27]=a=>t.promotionState.saveStateDebounced("End datetime changed"))},null,8,["modelValue","errorText"])])])):c("",!0),d=="activate_using_hours_of_day"&&t.promotionForm.activate_using_hours_of_day?(m(),u("div",Tt,[o("div",Ct,[o("div",Dt,[i(J,{size:"20",class:"text-indigo-600"}),e[50]||(e[50]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Hours of day",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_hours_of_day")},null,8,["leftIcon","action"])]),o("div",Pt,[i(h,{options:n.hourOptions,placeholder:"Add hour",modelValue:t.promotionForm.hours_of_day,"onUpdate:modelValue":e[28]||(e[28]=a=>t.promotionForm.hours_of_day=a),errorText:t.formState.getFormError("hours_of_day"),onChange:e[29]||(e[29]=a=>t.promotionState.saveStateDebounced("Hours of day changed")),tooltipContent:"Select the hours of the day when the promotion is active"},null,8,["options","modelValue","errorText"])])])):c("",!0),d=="activate_using_days_of_the_week"&&t.promotionForm.activate_using_days_of_the_week?(m(),u("div",Mt,[o("div",Vt,[o("div",Et,[i(S,{size:"20",class:"text-indigo-600"}),e[51]||(e[51]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Days of the week",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_days_of_the_week")},null,8,["leftIcon","action"])]),o("div",It,[i(h,{options:n.dayOptions,placeholder:"Add day",modelValue:t.promotionForm.days_of_the_week,"onUpdate:modelValue":e[30]||(e[30]=a=>t.promotionForm.days_of_the_week=a),errorText:t.formState.getFormError("days_of_the_week"),onChange:e[31]||(e[31]=a=>t.promotionState.saveStateDebounced("Days of the week changed")),tooltipContent:"Select the days of the week when the promotion is active"},null,8,["options","modelValue","errorText"])])])):c("",!0),d=="activate_using_days_of_the_month"&&t.promotionForm.activate_using_days_of_the_month?(m(),u("div",zt,[o("div",qt,[o("div",Ot,[i(S,{size:"20",class:"text-indigo-600"}),e[52]||(e[52]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Days of the month",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_days_of_the_month")},null,8,["leftIcon","action"])]),o("div",Ht,[i(h,{placeholder:"Add day",options:n.dayOfMonthOptions,modelValue:t.promotionForm.days_of_the_month,"onUpdate:modelValue":e[32]||(e[32]=a=>t.promotionForm.days_of_the_month=a),errorText:t.formState.getFormError("days_of_the_month"),onChange:e[33]||(e[33]=a=>t.promotionState.saveStateDebounced("Days of the month changed")),tooltipContent:"Select the days of the month when the promotion is active"},null,8,["options","modelValue","errorText"])])])):c("",!0),d=="activate_using_months_of_the_year"&&t.promotionForm.activate_using_months_of_the_year?(m(),u("div",Ut,[o("div",Bt,[o("div",Lt,[i(S,{size:"20",class:"text-indigo-600"}),e[53]||(e[53]=o("span",{class:"text-indigo-600 text-sm font-semibold"},"Months of the year",-1))]),i(p,{size:"xs",type:"bareDanger",leftIcon:n.Trash2,action:()=>t.removeCondition("activate_using_months_of_the_year")},null,8,["leftIcon","action"])]),o("div",At,[i(h,{options:n.monthOptions,placeholder:"Add month",modelValue:t.promotionForm.months_of_the_year,"onUpdate:modelValue":e[34]||(e[34]=a=>t.promotionForm.months_of_the_year=a),errorText:t.formState.getFormError("months_of_the_year"),onChange:e[35]||(e[35]=a=>t.promotionState.saveStateDebounced("Months of the year changed")),tooltipContent:"Select the months of the year when the promotion is active"},null,8,["options","modelValue","errorText"])])])):c("",!0)],64))),128)),t.hasSelectedConditions?c("",!0):(m(),u("div",jt,e[54]||(e[54]=[o("span",{class:"font-bold"},"No conditions",-1),o("span",null," 󠁯•󠁏󠁏 Just place an order to enjoy this offer!",-1)])))])]),t.promotion?(m(),u("div",{key:0,class:se(["overflow-hidden rounded-lg space-y-4 p-4 border mb-20",t.isLoadingPromotion?"border-gray-300 bg-gray-50":"border-red-300 bg-red-50"])},[o("p",null,[e[56]||(e[56]=b("Do you want to permanently delete ")),o("span",Nt,F(t.promotionForm.name),1),e[57]||(e[57]=b("? Once this promotion is deleted you will not be able to recover it."))]),o("div",Rt,[i(W,{triggerType:"danger",approveType:"danger",approveLeftIcon:n.Trash2,triggerText:"Delete Promotion",approveText:"Delete Promotion",approveAction:t.deletePromotion,triggerLoading:t.isDeletingPromotion,approveLoading:t.isDeletingPromotion},{content:P(()=>[e[60]||(e[60]=o("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),o("p",Jt,[e[58]||(e[58]=b("Are you sure you want to permanently delete ")),o("span",Wt,F(t.promotionForm.name),1),e[59]||(e[59]=b("?"))])]),_:1},8,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])],2)):c("",!0)])])])}const Do=ne(be,[["render",Zt]]);export{Do as default};
