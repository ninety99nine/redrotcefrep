import{c as h,b as o,a as n,d as p,e as g,w as v,F as k,f as E,t as u,g as f,h as F,r as a,o as m,i as b}from"./app-811fDb4C.js";import{P as V}from"./Pill-aGbs_XL2.js";import{L}from"./Logo-3HnfI_Nc.js";import{I as T}from"./Input-Ch5FVRoG.js";import{B}from"./Button-0Fhg4Aii.js";import{i as N}from"./stringUtils-Bvzw0-oW.js";import{S as I}from"./StoreLogo-CCMzoP_5.js";import{S as C}from"./SocialLinks-BPzfodLD.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{H as j}from"./house-DJhrT9DT.js";import"./Popover-DfwFh9bM.js";import"./Tooltip-5EEAR2_1.js";import"./Copy-XiSIbjW8.js";import"./ShineEffect-BW3gyXUb.js";import"./createLucideIcon-JVTSwxMK.js";import"./Skeleton-DGkj9lRL.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-fYK0zSuq.js";import"./circle-check-Ci8AvIUe.js";import"./circle-alert-DdTgr82K.js";import"./x-WVuudoOP.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-DjUD9LDC.js";import"./plus-BU4OPlaU.js";const z={name:"Login",components:{Pill:V,Logo:L,Input:T,Button:B,StoreLogo:I,SocialLinks:C},inject:["authState","formState","storeState","notificationState"],data(){return{House:j,form:{email:"",password:"",type:"email",mobile_number:""},loginTypes:[{label:"Email",value:"email"},{label:"Mobile Number",value:"mobile_number"}],loading:!1,currentYear:new Date().getFullYear(),appName:"Perfect Order"}},computed:{store(){return this.storeState.store}},methods:{isEmpty:N,navigateToStorefront(){this.$router.push({name:"show-storefront",params:{alias:this.store.alias}})},async submit(){var d,e;if(!this.loading&&(this.formState.hideFormErrors(),this.form.type=="email"&&this.isEmpty(this.form.email)?this.formState.setFormError("email","Enter your email"):this.form.type=="mobile_number"&&this.isEmpty(this.form.mobile_number)?this.formState.setFormError("mobile_number","Enter your mobile number"):this.isEmpty(this.form.password)&&this.formState.setFormError("password","Enter your password"),!this.formState.hasErrors)){this.loading=!0;try{const l=(await F.post("/api/auth/login",this.form)).data.token;this.authState.setTokenOnRequest(l),this.authState.setTokenOnLocalStorage(l);const t=this.$route.query.redirect;t?this.$router.push(t):this.$router.push({name:"show-store-home",params:{store_id:this.store.id}})}catch(s){const l=((e=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while signing in";this.notificationState.showWarningNotification(l),this.formState.setServerFormErrors(s),console.error("Failed to sign in:",s)}finally{this.loading=!1}}}}},H={class:"min-h-screen transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},O={class:"flex items-center justify-center py-6 bg-linear-to-b from-blue-100 to-white-100"},U={class:"w-full max-w-md"},Y={class:"flex justify-center mb-4"},q={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},D={class:"flex items-center justify-between mb-4"},M={class:"flex space-x-2"},A={key:2,class:"text-red-500 text-sm mb-3"},R={class:"ml-1"},W={class:"text-sm text-center mb-4"},G={class:"text-sm text-center text-gray-500 mb-16"};function J(d,e,s,l,t,i){const S=a("StoreLogo"),y=a("Button"),x=a("Pill"),c=a("Input"),_=a("router-link"),w=a("SocialLinks");return m(),h("div",H,[o("div",O,[o("div",U,[o("div",Y,[n(S,{size:"w-20 h-20",editable:!1,showButton:!1})]),o("div",q,[o("div",D,[e[4]||(e[4]=o("h1",{class:"text-2xl font-semibold leading-none tracking-tight"},"Sign in",-1)),i.store?(m(),p(y,{key:0,size:"md",type:"bare",leftIconSize:"24",leftIcon:t.House,action:i.navigateToStorefront},null,8,["leftIcon","action"])):g("",!0)]),e[8]||(e[8]=o("h1",{class:"text-sm text-gray-500 mb-4"},"Pick how you would like to sign in",-1)),o("form",{onSubmit:e[3]||(e[3]=v((...r)=>i.submit&&i.submit(...r),["prevent"])),class:"space-y-4 mb-4"},[o("div",M,[(m(!0),h(k,null,E(t.loginTypes,r=>(m(),p(x,{type:t.form.type===r.value?"primary":"light",action:()=>t.form.type=r.value,key:r.value},{default:f(()=>[b(u(r.label),1)]),_:2},1032,["type","action"]))),128))]),t.form.type=="email"?(m(),p(c,{key:0,type:"email",modelValue:t.form.email,"onUpdate:modelValue":e[0]||(e[0]=r=>t.form.email=r),placeholder:"john@gmail.com",errorText:i.formState.getFormError("email")},null,8,["modelValue","errorText"])):t.form.type=="mobile_number"?(m(),p(c,{key:1,type:"text",placeholder:"+26772000001",modelValue:t.form.mobile_number,"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.mobile_number=r),errorText:i.formState.getFormError("mobile_number")},null,8,["modelValue","errorText"])):g("",!0),n(c,{type:"password",modelValue:t.form.password,"onUpdate:modelValue":e[2]||(e[2]=r=>t.form.password=r),placeholder:"******",errorText:i.formState.getFormError("password")},null,8,["modelValue","errorText"]),i.formState.generalErrorText?(m(),h("div",A,u(i.formState.generalErrorText),1)):g("",!0),n(y,{size:"md",type:"primary",action:i.submit,buttonClass:"w-full"},{default:f(()=>[o("span",R,u(t.loading?"Signing in...":"Continue"),1)]),_:1},8,["action"]),o("div",W,[n(_,{to:{name:"register"},class:"text-blue-600 hover:underline"},{default:f(()=>[...e[5]||(e[5]=[b("Create account",-1)])]),_:1}),e[7]||(e[7]=o("span",{class:"text-gray-300 mx-4"},"|",-1)),n(_,{to:{name:"forgot-password"},class:"text-blue-600 hover:underline"},{default:f(()=>[...e[6]||(e[6]=[b("Forgot password?",-1)])]),_:1})])],32),n(w)]),o("p",G,"Â© "+u(t.currentYear)+" "+u(t.appName)+". All rights reserved.",1)])])])}const _e=P(z,[["render",J]]);export{_e as default};
