import{P as z}from"./Pill-26NEKJFK.js";import{I as j}from"./Input-5etQ1obE.js";import{S as W}from"./Select-mk4gS599.js";import{B}from"./Button-C-mSVtjr.js";import{L as Y}from"./Loader-DC71jh3F.js";import{a as ee}from"./stringUtils-Bvzw0-oW.js";import{C as P,H as U,c as n,a as u,g as C,r as c,o as l,b as i,e as m,F as I,f as A,t as E,d as x,i as O,w as V,Q as te,D as M,T as oe}from"./app-CfcRgAtV.js";import{P as se}from"./Paginator-BWxQ7moK.js";import{i as Q}from"./index-fkJHqJxv.js";import{D as $}from"./Drawer-DdW49D0C.js";import{S as le}from"./SelectCountry-C_Upu5vt.js";import{D as re}from"./Datepicker-kBZFTfit.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as ne,a as ie}from"./chevron-up-Cpv3OFuL.js";import{c as T}from"./createLucideIcon-6Wi-O4Lc.js";import{S as ae}from"./Switch-CqEacRY-.js";import{V as G}from"./vue-draggable-next.esm-bundler-CN4Uk9fX.js";import{M as J}from"./move-Bv4YCUZ1.js";import{R as ue}from"./rotate-ccw-CSfNxSjf.js";/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=T("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=T("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=T("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=T("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=T("logs",[["path",{d:"M3 5h1",key:"1mv5vm"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M3 19h1",key:"w6f3n9"}],["path",{d:"M8 5h1",key:"1nxr5w"}],["path",{d:"M8 12h1",key:"1con00"}],["path",{d:"M8 19h1",key:"k7p10e"}],["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}]]),ce={inject:["notificationState"],components:{Pill:z,Input:j,Button:B,Drawer:$,Datepicker:re,Loader:Y,Select:W,SelectCountry:le,Funnel:q,ChevronUp:ie,ChevronDown:ne},props:{filterExpressions:{type:Array,default:()=>[]},resource:{type:String}},emits:["updatedFilters"],data(){return{Funnel:q,ArrowUp:X,ArrowDown:K,showMore:!1,localFilters:null,filterDrawer:null,isLoadingFilters:!1,lastEmittedFilters:null}},watch:{localFilters:{handler(t){this.createFilterExpressions()},deep:!0}},computed:{hasFilterExpressions(){return this.filterExpressions.length>0},totalActiveFilters(){return this.localFilters==null?0:this.localFilters.filter(t=>t.options.some(e=>e.active)).length},hasPriorityFilters(){return this.localFilters==null?!1:this.localFilters.filter(t=>t.priority).length>0},hasNonPriorityFilters(){return this.localFilters==null?!1:this.localFilters.filter(t=>!t.priority).length>0}},methods:{countActiveOptions(t){return t.options.filter(e=>e.active).length},createFilterExpressions(){let t=[];for(let e=0;e<this.localFilters.length;e++){const o=this.localFilters[e];if(o.options.some(r=>r.active))if(o.type==="checkboxes"){const s=o.options.filter(p=>p.active).map(p=>p.value),h=`${o.label} = ${s.join(", ")}`,d=`${o.target}:in:${s.join(",")}`;t.push({label:h,expression:d,filterIndex:e})}else for(let r=0;r<o.options.length;r++){const s=o.options[r];if(s.active){let d=null,p=null,b=s.value,y=s.value2,v=s.operator;if(["bt","bt_ex"].includes(v)){if(!b||!y)continue;d=`${o.label} between ${s.value} - ${s.value2} ${v=="bt"?"(including)":"(excluding)"}`,p=`${o.target}:${v}:${b}:${y}`}else if(["in","not_in"].includes(v)){if(!b&&!y)continue;const D=(y?y.split(",").map(_=>_.trim()):[b]).join(",");d=`${o.label} ${v==="in"?"in":"not in"} ${D}`,p=`${o.target}:${v}:${D}`}else d=`${o.label} ${v??"="} ${s.value}`,p=`${o.target}:${v??"="}:${b}`;t.push({label:d,expression:p,filterIndex:e,optionIndex:r})}}}this.filtersHaveChanged(t,this.lastEmittedFilters)&&(this.$emit("updatedFilters",t),this.lastEmittedFilters=U(t))},applyFilterExpressions(t){for(let e=0;e<this.filterExpressions.length;e++){const f=this.filterExpressions[e].split(":"),r=f[0],s=f[1],h=f[2],d=f[3]??null;for(let p=0;p<t.length;p++){const b=t[p];if(b.target==r){t[p].active=!0;for(let y=0;y<b.options.length;y++)b.options[y].value===h&&(t[p].options[y].active=!0,b.type==="date"&&h&&P(h).isValid()?(t[p].options[y].value=P(h).format("DD MMM YYYY"),d&&P(d).isValid()&&(t[p].options[y].value2=P(d).format("DD MMM YYYY"))):["in","not_in"].includes(s)?(t[p].options[y].value=h.split(",")[0],t[p].options[y].value2=h):(t[p].options[y].value=h,t[p].options[y].value2=d))}}}return t},filtersHaveChanged(t,e){var o=U(t),f=U(e);return!Q(o,f)},openFilterDrawer(){this.localFilters==null&&this.getFilters(),this.filterDrawer.showDrawer()},closeFilterDrawer(){this.filterDrawer.hideDrawer()},toggleFilterVisibility(t){this.localFilters[t].active||this.localFilters.forEach((e,o)=>{this.localFilters[o].active=!1}),this.localFilters[t].active=!this.localFilters[t].active},showMoreOrLess(){this.showMore=!this.showMore},removeAppliedFilter(t){t.hasOwnProperty("filterIndex")&&t.hasOwnProperty("optionIndex")?this.localFilters[t.filterIndex].options[t.optionIndex].active=!1:this.localFilters[t.filterIndex].options.forEach(e=>{e.active=!1})},clearFilters(){this.localFilters=null},async getFilters(){var t,e;try{if(this.isLoadingFilters)return;this.isLoadingFilters=!0;const o={params:{type:this.resource}},r=(await axios.get("/api/filters",o)).data.map(s=>({...s,active:!1,options:s.options.map(h=>{let d={...h,active:!1};return s.type==="money"?(d.value="0.00",d.value2="0.00"):s.type==="date"?(d.value=P().subtract(7,"day").format("YYYY-MM-DD"),d.value2=P().add(7,"day").format("YYYY-MM-DD")):(["text","number","uuid"].includes(s.type)||s.target==="country"||s.type==="select")&&(d.value="",d.value2=""),d})}));this.localFilters=this.applyFilterExpressions(r)}catch(o){const f=((e=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while fetching the filter options";this.notificationState.showWarningNotification(f),console.error("Failed to fetch filter options:",o)}finally{this.isLoadingFilters=!1}}},mounted(){this.filterDrawer=this.$refs.filterDrawer,this.hasFilterExpressions&&this.getFilters()}},de={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},pe={key:0,class:"flex justify-center my-8"},he={key:1,class:"divide-y mb-4"},me={key:0},ge=["onClick"],fe={class:"flex items-center space-x-2"},ye={key:0,class:"text-sm p-4"},ve={key:0,class:"my-4"},we={key:0,class:"space-y-4"},xe={key:1,class:"space-y-4"},be={key:2,class:"space-y-4"},Se={key:3,class:"space-y-4"},_e={key:4,class:"space-y-4"},ke={key:5,class:"space-y-4"},Ve={key:6,class:"space-y-4"},De={key:2,class:"flex flex-col items-center px-4 space-y-8 mb-60"};function Ce(t,e,o,f,r,s){const h=c("Button"),d=c("Funnel"),p=c("Loader"),b=c("Pill"),y=c("ChevronUp"),v=c("ChevronDown"),S=c("Input"),D=c("Datepicker"),_=c("SelectCountry"),k=c("Select"),F=c("Drawer");return l(),n("div",null,[u(h,{size:"xs",type:"bare",leftIcon:r.Funnel,action:s.openFilterDrawer},null,8,["leftIcon","action"]),u(F,{position:"right",ref:"filterDrawer",showFooter:!1,scrollOnContent:!1},{content:C(()=>[i("div",de,[u(d,{size:"20"}),e[14]||(e[14]=i("h2",null,"Filters",-1))]),e[16]||(e[16]=i("p",{class:"p-4 text-sm bg-indigo-100"}," Find exactly what you need by applying filters to your data ",-1)),r.isLoadingFilters?(l(),n("div",pe,[u(p)])):(l(),n("div",he,[(l(!0),n(I,null,A(r.localFilters,(w,L)=>(l(),n(I,{key:L},[r.showMore||w.priority?(l(),n("div",me,[i("div",{onClick:a=>s.toggleFilterVisibility(L),class:"text-sm p-4 bg-gray-50 hover:bg-gray-100 cursor-pointer flex items-center justify-between"},[i("span",null,E(w.label),1),i("div",fe,[s.countActiveOptions(w)?(l(),x(b,{key:0,type:"primary",size:"xs",class:"flex-shrink-0"},{default:C(()=>[O(E(s.countActiveOptions(w)),1)]),_:2},1024)):m("",!0),w.active?(l(),x(y,{key:1,size:"16"})):(l(),x(v,{key:2,size:"16"}))])],8,ge),w.active?(l(),n("div",ye,[(l(!0),n(I,null,A(w.options,(a,Z)=>(l(),n("div",{key:Z},[u(S,{onClick:e[0]||(e[0]=V(()=>{},["stop"])),type:"checkbox",modelValue:a.active,"onUpdate:modelValue":g=>a.active=g,inputLabel:a.label},null,8,["modelValue","onUpdate:modelValue","inputLabel"]),a.active?(l(),n("div",ve,[w.type==="date"?(l(),n("div",we,[u(D,{onClick:e[1]||(e[1]=V(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":g=>a.value=g},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(a.operator)?(l(),x(D,{key:0,onClick:e[2]||(e[2]=V(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":g=>a.value2=g},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)])):w.type==="money"?(l(),n("div",xe,[u(S,{type:"money",onClick:e[3]||(e[3]=V(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":g=>a.value=g},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(a.operator)?(l(),x(S,{key:0,type:"money",onClick:e[4]||(e[4]=V(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":g=>a.value2=g},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)])):w.target==="country"?(l(),n("div",be,[u(_,{onClick:e[5]||(e[5]=V(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":g=>a.value=g,placeholder:"Select country"},null,8,["modelValue","onUpdate:modelValue"]),["in","not_in"].includes(a.operator)?(l(),x(S,{key:0,type:"text",onClick:e[6]||(e[6]=V(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":g=>a.value2=g,placeholder:"Enter comma-separated country codes"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)])):w.type==="text"?(l(),n("div",Se,[u(S,{type:"text",onClick:e[7]||(e[7]=V(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":g=>a.value=g,placeholder:"Enter value"},null,8,["modelValue","onUpdate:modelValue"])])):w.type==="number"?(l(),n("div",_e,[u(S,{type:"number",onClick:e[8]||(e[8]=V(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":g=>a.value=g,placeholder:"Enter number"},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(a.operator)?(l(),x(S,{key:0,type:"number",onClick:e[9]||(e[9]=V(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":g=>a.value2=g,placeholder:"Enter number"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)])):w.type==="uuid"?(l(),n("div",ke,[u(S,{type:"text",onClick:e[10]||(e[10]=V(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":g=>a.value=g,placeholder:"Enter UUID"},null,8,["modelValue","onUpdate:modelValue"]),["in","not_in"].includes(a.operator)?(l(),x(S,{key:0,type:"text",onClick:e[11]||(e[11]=V(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":g=>a.value2=g,placeholder:"Enter comma-separated UUIDs"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)])):w.type==="select"?(l(),n("div",Ve,[u(k,{onClick:e[12]||(e[12]=V(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":g=>a.value=g,options:w.options,placeholder:"Select value"},null,8,["modelValue","onUpdate:modelValue","options"]),["in","not_in"].includes(a.operator)?(l(),x(S,{key:0,type:"text",onClick:e[13]||(e[13]=V(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":g=>a.value2=g,placeholder:"Enter comma-separated values"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)])):m("",!0)])):m("",!0)]))),128))])):m("",!0)])):m("",!0)],64))),128))])),r.isLoadingFilters?m("",!0):(l(),n("div",De,[s.hasPriorityFilters&&s.hasNonPriorityFilters?(l(),x(h,{key:0,size:"xs",type:"outline",action:s.showMoreOrLess,leftIcon:r.showMore?r.ArrowUp:r.ArrowDown},{default:C(()=>[i("span",null,E(r.showMore?"show less options":"show more options"),1)]),_:1},8,["action","leftIcon"])):m("",!0),s.totalActiveFilters?(l(),x(h,{key:1,size:"sm",type:"light",buttonClass:"w-full",action:s.clearFilters},{default:C(()=>[...e[15]||(e[15]=[i("span",null,"Clear Filters",-1)])]),_:1},8,["action"])):m("",!0)]))]),_:1},512)])}const Fe=N(ce,[["render",Ce]]),Ee={inject:["formState"],components:{Move:J,Logs:R,draggable:G,Input:j,Pill:z,Button:B,Drawer:$,Switch:ae},props:{columns:{type:Array,default:()=>[]}},emits:["updatedColumns"],data(){return{Logs:R,showMore:!1,columnsDrawer:null,showEverything:!1,localColumns:U(this.columns),originalColumns:U(this.columns)}},watch:{localColumns:{handler(t){this.showEverything!=this.isShowingEverything&&(this.showEverything=this.isShowingEverything),this.$emit("updatedColumns",t)},deep:!0},showEverything(t){t?this.localColumns.map(e=>e.active=!0):this.isShowingEverything&&this.localColumns.map(e=>e.active=e.priority)}},computed:{isShowingEverything(){return this.localColumns.filter(t=>t.active==!0).length==this.localColumns.length}},methods:{openColumnsDrawer(){this.columnsDrawer.showDrawer()},closeColumnsDrawer(){this.columnsDrawer.hideDrawer()},resetColumns(){this.localColumns=U(this.originalColumns)}},mounted(){this.columnsDrawer=this.$refs.columnsDrawer}},Ue={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},Ie={class:"p-4 border-b shadow-sm"},Ae={class:"divide-y mb-4"},Me={class:"px-4 mb-60"};function Le(t,e,o,f,r,s){const h=c("Button"),d=c("Logs"),p=c("Switch"),b=c("Input"),y=c("Move"),v=c("draggable"),S=c("Drawer");return l(),n("div",null,[u(h,{size:"xs",type:"bare",leftIcon:r.Logs,action:s.openColumnsDrawer},null,8,["leftIcon","action"]),u(S,{position:"right",ref:"columnsDrawer",showFooter:!1,scrollOnContent:!1},{content:C(()=>[i("div",Ue,[u(d,{size:"20"}),e[4]||(e[4]=i("h2",null,"Columns",-1))]),e[6]||(e[6]=i("p",{class:"p-4 text-sm bg-indigo-100"}," Show, hide and move your data they way you want to see it ",-1)),i("div",Ie,[u(p,{size:"sm",modelValue:r.showEverything,"onUpdate:modelValue":e[0]||(e[0]=D=>r.showEverything=D),suffixText:"Show Everything"},null,8,["modelValue"])]),i("div",Ae,[u(v,{class:"divide-y mb-4",modelValue:r.localColumns,"onUpdate:modelValue":e[3]||(e[3]=D=>r.localColumns=D),handle:".draggable-handle","ghost-class":"bg-yellow-50"},{default:C(()=>[(l(!0),n(I,null,A(r.localColumns,(D,_)=>(l(),n("div",{key:_,class:"flex items-center justify-between p-4"},[u(b,{onClick:e[1]||(e[1]=V(()=>{},["stop"])),type:"checkbox",modelValue:D.active,"onUpdate:modelValue":k=>D.active=k,inputLabel:D.name},null,8,["modelValue","onUpdate:modelValue","inputLabel"]),u(y,{onClick:e[2]||(e[2]=V(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})]))),128))]),_:1},8,["modelValue"])]),i("div",Me,[u(h,{size:"sm",type:"light",buttonClass:"w-full",action:s.resetColumns},{default:C(()=>[...e[5]||(e[5]=[i("span",null,"Reset Columns",-1)])]),_:1},8,["action"])])]),_:1},512)])}const Pe=N(Ee,[["render",Le]]),Oe={inject:["notificationState"],components:{Move:J,draggable:G,Pill:z,Input:j,Button:B,Drawer:$,Loader:Y,ArrowDownWideNarrow:H},props:{sortingExpressions:{type:Array,default:()=>[]},resource:{type:String}},emits:["updatedSorting"],data(){return{ArrowUp:X,ArrowDown:K,showMore:!1,sortDrawer:null,localSorting:null,ArrowDownWideNarrow:H,originalSorting:null,isLoadingSorting:!1,lastEmittedSorting:null}},watch:{localSorting:{handler(t){this.createSortingExpressions()},deep:!0}},computed:{hasSortingExpressions(){return this.sortingExpressions.length>0},totalActiveSortOptions(){return this.localSorting==null?0:this.localSorting.filter(t=>t.options.some(e=>e.active)).length},hasPrioritySortOptions(){return this.localSorting==null?!1:this.localSorting.filter(t=>t.priority).length>0},hasNonPrioritySortOptions(){return this.localSorting==null?!1:this.localSorting.filter(t=>!t.priority).length>0}},methods:{toggleSortOption(t,e){this.localSorting[t].options.forEach((o,f)=>{f!==e&&(o.active=!1)})},countActiveOptions(t){return t.options.filter(e=>e.active).length},createSortingExpressions(){let t=[];for(let e=0;e<this.localSorting.length;e++){const o=this.localSorting[e];if(o.options.some(r=>r.active)){const s=o.options.filter(p=>p.active)[0],h=`${o.label} (${s.label})`,d=`${o.target}:${s.value}`;t.push({label:h,sortIndex:e,expression:d})}}this.sortingHasChanged(t,this.lastEmittedSorting)&&(this.$emit("updatedSorting",t),this.lastEmittedSorting=U(t))},applySortingExpressions(){this.sortingExpressions.forEach(t=>{const e=t.split(":"),o=e[0],f=e[1],r=this.localSorting.find(s=>s.target===o);r&&r.options.forEach(s=>{s.value==f&&(s.active=!0)})})},sortingHasChanged(t,e){var o=U(t),f=U(e);return!Q(o,f)},openSortDrawer(){this.localSorting==null&&this.getSorting(),this.sortDrawer.showDrawer()},closeSortDrawer(){this.sortDrawer.hideDrawer()},toggleSortingVisibility(t){this.localSorting[t].active||this.localSorting.forEach((e,o)=>{this.localSorting[o].active=!1}),this.localSorting[t].active=!this.localSorting[t].active},showMoreOrLess(){this.showMore=!this.showMore},removeAppliedSort(t){this.localSorting[t.sortIndex].options.forEach(e=>{e.active=!1})},clearSorting(){this.localSorting=U(this.originalSorting)},async getSorting(){var t,e;try{if(this.isLoadingSorting)return;this.isLoadingSorting=!0;const o={params:{type:this.resource}},f=await axios.get("/api/sorting",o);this.localSorting=f.data.map(r=>({...r,active:!1,options:r.options.map(s=>({...s,active:!1}))})),this.originalSorting=U(this.localSorting),this.applySortingExpressions()}catch(o){const f=((e=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while fetching the sorting options";this.notificationState.showWarningNotification(f),console.error("Failed to fetch sorting options:",o)}finally{this.isLoadingSorting=!1}}},mounted(){this.sortDrawer=this.$refs.sortDrawer,this.hasSortingExpressions&&this.getSorting()}},Te={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},ze={key:0,class:"flex justify-center my-8"},je={key:0},Be=["onClick"],Ne={class:"flex items-center space-x-2"},Ye={key:2,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},$e={key:3,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},He={key:0,class:"text-sm p-4"},qe={key:2,class:"flex flex-col items-center px-4 space-y-8 mb-60"};function Re(t,e,o,f,r,s){const h=c("Button"),d=c("ArrowDownWideNarrow"),p=c("Loader"),b=c("Pill"),y=c("Move"),v=c("Input"),S=c("draggable"),D=c("Drawer");return l(),n("div",null,[u(h,{size:"xs",type:"bare",action:s.openSortDrawer,leftIcon:r.ArrowDownWideNarrow},null,8,["action","leftIcon"]),u(D,{ref:"sortDrawer",position:"right",showFooter:!1,scrollOnContent:!1},{content:C(()=>[i("div",Te,[u(d,{size:"20"}),e[2]||(e[2]=i("h2",null,"Sorting",-1))]),e[6]||(e[6]=i("p",{class:"p-4 text-sm bg-indigo-100"}," When using two or more sorting options, you can rearrange their order to prioritize which criteria are applied first. ",-1)),r.isLoadingSorting?(l(),n("div",ze,[u(p)])):(l(),x(S,{key:1,modelValue:r.localSorting,"onUpdate:modelValue":e[1]||(e[1]=_=>r.localSorting=_),class:"divide-y mb-4",handle:".draggable-handle","ghost-class":"bg-yellow-50"},{default:C(()=>[(l(!0),n(I,null,A(r.localSorting,(_,k)=>(l(),n(I,{key:k},[r.showMore||_.priority?(l(),n("div",je,[i("div",{onClick:F=>s.toggleSortingVisibility(k),class:"text-sm p-4 bg-gray-50 hover:bg-gray-100 cursor-pointer flex items-center justify-between"},[i("span",null,E(_.label),1),i("div",Ne,[s.countActiveOptions(_)?(l(),x(b,{key:0,type:"primary",size:"xs",class:"flex-shrink-0"},{default:C(()=>[O(E(s.countActiveOptions(_)),1)]),_:2},1024)):m("",!0),s.countActiveOptions(_)?(l(),x(y,{key:1,onClick:e[0]||(e[0]=V(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})):m("",!0),_.active?(l(),n("svg",Ye,[...e[3]||(e[3]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"},null,-1)])])):(l(),n("svg",$e,[...e[4]||(e[4]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"},null,-1)])]))])],8,Be),_.active?(l(),n("div",He,[(l(!0),n(I,null,A(_.options,(F,w)=>(l(),n("div",{key:w},[u(v,{type:"checkbox",modelValue:F.active,"onUpdate:modelValue":L=>F.active=L,inputLabel:F.label,onClick:V(()=>s.toggleSortOption(k,w),["stop"])},null,8,["modelValue","onUpdate:modelValue","inputLabel","onClick"])]))),128))])):m("",!0)])):m("",!0)],64))),128))]),_:1},8,["modelValue"])),r.isLoadingSorting?m("",!0):(l(),n("div",qe,[s.hasPrioritySortOptions&&s.hasNonPrioritySortOptions?(l(),x(h,{key:0,size:"xs",type:"outline",action:s.showMoreOrLess,leftIcon:r.showMore?r.ArrowUp:r.ArrowDown},{default:C(()=>[i("span",null,E(r.showMore?"show less options":"show more options"),1)]),_:1},8,["action","leftIcon"])):m("",!0),s.totalActiveSortOptions?(l(),x(h,{key:1,size:"sm",type:"light",buttonClass:"w-full",action:s.clearSorting},{default:C(()=>[...e[5]||(e[5]=[i("span",null,"Clear Sorting",-1)])]),_:1},8,["action"])):m("",!0)]))]),_:1},512)])}const We=N(Oe,[["render",Re]]),Qe={components:{Pill:z,Button:B,Input:j,Select:W,Paginator:se,Loader:Y,FilterDrawer:Fe,ColumnsDrawer:Pe,SortingDrawer:We},props:{isLoading:{type:Boolean,default:!1},searchTerm:{type:String,default:null},searchPlaceholder:{type:String,default:null},pagination:{type:Object},perPage:{type:String,default:"15"},resource:{type:String},columns:{type:Array,default:()=>[]},filterExpressions:{type:Array,default:()=>[]},sortingExpressions:{type:Array,default:()=>[]}},emits:["search","refresh","paginate","updatedColumns","updatedFilters","updatedSorting","updatedPerPage"],data(){return{RotateCcw:ue,modal:null,filters:[],sorting:[],filterDrawer:null,isSearching:!1,sortingDrawer:null,totalTableHeaders:0,localPerPage:this.perPage,localIsLoading:this.isLoading,localSearchTerm:this.searchTerm,uniqueModalId:te("modal")}},watch:{isLoading(t){this.localIsLoading=t,this.isSearching=t&&this.hasSearchTerm},localSearchTerm(t){this.$emit("search",t)},localPerPage(t){this.$emit("updatedPerPage",t)},pagination(t){t&&this.$nextTick(()=>{this.filterDrawer=this.$refs.filterDrawer,this.sortingDrawer=this.$refs.sortingDrawer})},columns:{handler(){this.$nextTick(()=>{this.totalTableHeaders=this.$refs.tablehead.querySelectorAll("th").length})},deep:!0}},computed:{hasSearchTerm(){return this.isNotEmpty(this.localSearchTerm)},hasFilters(){return this.filters.length>0},hasSorting(){return this.sorting.length>0},hasFilterExpressions(){return this.filterExpressions.length>0},hasSortingExpressions(){return this.sortingExpressions.length>0},perPageOptions(){return["15","50","100","200"].map(t=>({label:`${t} per page`,value:t}))}},methods:{isNotEmpty:ee,refresh(){this.localIsLoading||this.$emit("refresh")},paginate(t){this.$emit("paginate",t)},updatedColumns(t){this.$emit("updatedColumns",t)},updatedFilters(t){this.filters=t,this.$emit("updatedFilters",t)},updatedSorting(t){this.sorting=t,this.$emit("updatedSorting",t)},removeAppliedFilter(t){this.filterDrawer.removeAppliedFilter(t)},removeAppliedSort(t){this.sortingDrawer.removeAppliedSort(t)},onInputSearchTerm(t){t.target.value.length?this.isSearching=!0:this.isSearching=!1,this.localIsLoading=!0}},mounted(){this.totalTableHeaders=this.$refs.tablehead.querySelectorAll("th").length}},Ge={class:"flex justify-between items-center space-x-4 mb-4"},Je={class:"flex justify-center items-center space-x-4"},Ke={key:0},Xe={key:1},Ze={key:0,class:"flex flex-col items-center mb-4"},et={class:"flex items-center space-x-2"},tt={key:1,class:"flex flex-col items-center mb-4"},ot={class:"flex items-center space-x-2"},st={key:2,class:"flex flex-wrap gap-2 mb-4"},lt={class:"relative w-full overflow-x-auto border border-blue-200 rounded-lg"},rt={key:0,class:"absolute top-0 bottom-0 left-0 right-0 bg-white/50 flex justify-center items-center"},nt={class:"w-full text-left rtl:text-right"},it={class:"text-sm bg-blue-50",ref:"tablehead"},at={key:0},ut={key:2},ct={key:2,class:"text-sm text-gray-700 text-center py-16 bg-blue-50 border-t border-blue-200"},dt={key:0,class:"flex items-center justify-center space-x-2"},pt={class:"text-sm text-gray-500"},ht={key:1},mt={key:0,class:"flex justify-between items-center mt-4"},gt={class:"text-sm font-normal text-gray-500 dark:text-gray-400"},ft={class:"font-semibold text-gray-900 dark:text-white"},yt={class:"font-semibold text-gray-900 dark:text-white"},vt={class:"flex items-center space-x-4"};function wt(t,e,o,f,r,s){const h=c("Input"),d=c("FilterDrawer"),p=c("SortingDrawer"),b=c("ColumnsDrawer"),y=c("Button"),v=c("Loader"),S=c("Pill"),D=c("Select"),_=c("Paginator");return l(),n("div",null,[M(t.$slots,"header"),i("div",Ge,[u(h,{type:"search",class:"w-full",debounced:!0,modelValue:r.localSearchTerm,"onUpdate:modelValue":e[0]||(e[0]=k=>r.localSearchTerm=k),onInput:s.onInputSearchTerm,placeholder:o.searchPlaceholder},null,8,["modelValue","onInput","placeholder"]),i("div",Je,[u(d,{ref:"filterDrawer",resource:o.resource,filterExpressions:o.filterExpressions,onUpdatedFilters:s.updatedFilters},null,8,["resource","filterExpressions","onUpdatedFilters"]),u(p,{ref:"sortingDrawer",resource:o.resource,sortingExpressions:o.sortingExpressions,onUpdatedSorting:s.updatedSorting},null,8,["resource","sortingExpressions","onUpdatedSorting"]),u(b,{ref:"columnsDrawer",columns:o.columns,onUpdatedColumns:s.updatedColumns},null,8,["columns","onUpdatedColumns"]),t.$slots.beforeRefreshButton?(l(),n("div",Ke,[M(t.$slots,"beforeRefreshButton")])):m("",!0),u(y,{action:s.refresh,type:"bare",size:"xs",leftIcon:r.RotateCcw},null,8,["action","leftIcon"]),t.$slots.afterRefreshButton?(l(),n("div",Xe,[M(t.$slots,"afterRefreshButton")])):m("",!0)])]),u(oe,{name:"fade-1",mode:"out-in"},{default:C(()=>[s.hasFilterExpressions&&!s.hasFilters?(l(),n("div",Ze,[i("div",et,[u(v),e[2]||(e[2]=i("span",{class:"text-sm text-gray-500"},"Preparing filters",-1))])])):s.hasSortingExpressions&&!s.hasSorting?(l(),n("div",tt,[i("div",ot,[u(v),e[3]||(e[3]=i("span",{class:"text-sm text-gray-500"},"Preparing sorting",-1))])])):s.hasFilters||s.hasSorting?(l(),n("div",st,[(l(!0),n(I,null,A(r.filters,(k,F)=>(l(),x(S,{key:F,type:"primary",size:"xs",closableAction:()=>s.removeAppliedFilter(k)},{default:C(()=>[O(E(k.label),1)]),_:2},1032,["closableAction"]))),128)),(l(!0),n(I,null,A(r.sorting,(k,F)=>(l(),x(S,{key:F,type:"success",size:"xs",closableAction:()=>s.removeAppliedSort(k)},{default:C(()=>[O(E(k.label),1)]),_:2},1032,["closableAction"]))),128))])):m("",!0)]),_:1}),M(t.$slots,"belowToolbar"),i("div",lt,[o.pagination&&o.pagination.meta.total>0&&(r.localIsLoading||r.isSearching)?(l(),n("div",rt,[u(v)])):m("",!0),i("table",nt,[i("thead",it,[M(t.$slots,"head")],512),!o.pagination&&r.localIsLoading&&r.totalTableHeaders>0?(l(),n("tbody",at,[(l(),n(I,null,A([1,2,3],(k,F)=>i("tr",{key:F,class:"animate-pulse"},[(l(!0),n(I,null,A(r.totalTableHeaders,(w,L)=>(l(),n("td",{key:L},[...e[4]||(e[4]=[i("div",{class:"h-2 bg-blue-200 rounded-full mx-4 my-4"},null,-1)])]))),128))])),64))])):t.$slots.tbody?M(t.$slots,"tbody",{key:1}):(l(),n("tbody",ut,[M(t.$slots,"body")]))]),t.$slots.noResults&&!r.localIsLoading&&o.pagination&&o.pagination.meta.total==0&&!s.hasSearchTerm?M(t.$slots,"noResults",{key:1}):o.pagination&&o.pagination.meta.total==0?(l(),n("div",ct,[r.localIsLoading||r.isSearching?(l(),n("div",dt,[u(v),i("span",pt,E(r.isSearching?"Searching":"Loading"),1)])):(l(),n("span",ht,"No results found"))])):m("",!0)]),o.pagination&&o.pagination.meta.total>0?(l(),n("div",mt,[i("span",gt,[e[5]||(e[5]=O("Showing ",-1)),i("span",ft,E(o.pagination.meta.from)+"-"+E(o.pagination.meta.to),1),e[6]||(e[6]=O(" of ",-1)),i("span",yt,E(o.pagination.meta.total),1)]),i("div",vt,[u(D,{class:"w-40",search:!1,modelValue:r.localPerPage,"onUpdate:modelValue":e[1]||(e[1]=k=>r.localPerPage=k),options:s.perPageOptions},null,8,["modelValue","options"]),o.pagination?(l(),x(_,{key:0,pagination:o.pagination,onPaginate:s.paginate},null,8,["pagination","onPaginate"])):m("",!0)])])):m("",!0)])}const jt=N(Qe,[["render",wt]]);export{jt as T};
