import{c,b as o,a as m,w as k,d as g,e as y,F as v,f as E,t as n,g as p,h as F,r as a,o as l,i as h}from"./app-9D_Cw4s4.js";import{P as V}from"./Pill-BFJX92pa.js";import{L}from"./Logo-CC6t2j6Y.js";import{I as T}from"./Input-CaqG3UNa.js";import{B}from"./Button-enl4NEGy.js";import{i as N}from"./stringUtils-Bvzw0-oW.js";import{S as C}from"./SocialLinks-B_luMDsA.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Popover-BYwxVx0y.js";import"./Tooltip-DBg9S1F5.js";import"./Copy-TLmCwI7a.js";import"./ShineEffect-CCEGWZwA.js";import"./createLucideIcon-BjPl0ua2.js";import"./Skeleton-ChnWfFmK.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-sY-Ia2Cp.js";import"./circle-check-gsRbbAn8.js";import"./circle-alert-BncYZhnp.js";import"./x-ByYxaui0.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-BJ_yFh5a.js";const j={name:"Login",components:{Pill:V,Logo:L,Input:T,Button:B,SocialLinks:C},inject:["authState","formState","notificationState"],data(){return{form:{email:"",password:"",type:"email",mobile_number:""},loginTypes:[{label:"Email",value:"email"},{label:"Mobile Number",value:"mobile_number"}],loading:!1,currentYear:new Date().getFullYear(),appName:"Perfect Order"}},methods:{isEmpty:N,async submit(){var d,e;if(!this.loading&&(this.formState.hideFormErrors(),this.form.type=="email"&&this.isEmpty(this.form.email)?this.formState.setFormError("email","Enter your email"):this.form.type=="mobile_number"&&this.isEmpty(this.form.mobile_number)?this.formState.setFormError("mobile_number","Enter your mobile number"):this.isEmpty(this.form.password)&&this.formState.setFormError("password","Enter your password"),!this.formState.hasErrors)){this.loading=!0;try{const r=await F.post("/api/auth/login",this.form),u=r.data.user,t=r.data.token;await this.authState.setUser(u),this.authState.setTokenOnRequest(t),this.authState.setTokenOnLocalStorage(t);const i=this.$route.query.redirect;i?this.$router.push(i):this.$router.push({name:"show-stores"})}catch(r){const u=((e=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:e.message)||(r==null?void 0:r.message)||"Something went wrong while signing in";this.notificationState.showWarningNotification(u),this.formState.setServerFormErrors(r),console.error("Failed to sign in:",r)}finally{this.loading=!1}}}}},I={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},U={class:"flex items-center justify-center p-6 bg-linear-to-b from-blue-100 to-white-100"},O={class:"w-full max-w-md"},Y={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},q={class:"flex space-x-2"},D={key:2,class:"text-red-500 text-sm mb-3"},M={class:"ml-1"},z={class:"text-sm text-center mb-4"},A={class:"text-sm text-center text-gray-500"};function R(d,e,r,u,t,i){const x=a("Logo"),_=a("Pill"),f=a("Input"),w=a("Button"),b=a("router-link"),S=a("SocialLinks");return l(),c("div",I,[o("div",U,[o("div",O,[m(x,{height:"h-20 mx-auto mb-4"}),o("div",Y,[e[7]||(e[7]=o("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Sign in",-1)),e[8]||(e[8]=o("h1",{class:"text-sm text-gray-500 mb-4"},"Pick how you would like to sign in",-1)),o("form",{onSubmit:e[3]||(e[3]=k((...s)=>i.submit&&i.submit(...s),["prevent"])),class:"space-y-4 mb-4"},[o("div",q,[(l(!0),c(v,null,E(t.loginTypes,s=>(l(),g(_,{type:t.form.type===s.value?"primary":"light",action:()=>t.form.type=s.value,key:s.value},{default:p(()=>[h(n(s.label),1)]),_:2},1032,["type","action"]))),128))]),t.form.type=="email"?(l(),g(f,{key:0,type:"email",modelValue:t.form.email,"onUpdate:modelValue":e[0]||(e[0]=s=>t.form.email=s),placeholder:"john@gmail.com",errorText:i.formState.getFormError("email")},null,8,["modelValue","errorText"])):t.form.type=="mobile_number"?(l(),g(f,{key:1,type:"text",placeholder:"+26772000001",modelValue:t.form.mobile_number,"onUpdate:modelValue":e[1]||(e[1]=s=>t.form.mobile_number=s),errorText:i.formState.getFormError("mobile_number")},null,8,["modelValue","errorText"])):y("",!0),m(f,{type:"password",modelValue:t.form.password,"onUpdate:modelValue":e[2]||(e[2]=s=>t.form.password=s),placeholder:"******",errorText:i.formState.getFormError("password")},null,8,["modelValue","errorText"]),i.formState.generalErrorText?(l(),c("div",D,n(i.formState.generalErrorText),1)):y("",!0),m(w,{size:"md",type:"primary",action:i.submit,buttonClass:"w-full"},{default:p(()=>[o("span",M,n(t.loading?"Signing in...":"Continue"),1)]),_:1},8,["action"]),o("div",z,[m(b,{to:{name:"register"},class:"text-blue-600 hover:underline"},{default:p(()=>[...e[4]||(e[4]=[h("Create account",-1)])]),_:1}),e[6]||(e[6]=o("span",{class:"text-gray-300 mx-4"},"|",-1)),m(b,{to:{name:"forgot-password"},class:"text-blue-600 hover:underline"},{default:p(()=>[...e[5]||(e[5]=[h("Forgot password?",-1)])]),_:1})])],32),m(S)]),o("p",A,"Â© "+n(t.currentYear)+" "+n(t.appName)+". All rights reserved.",1)])]),e[9]||(e[9]=o("div",{class:"hidden lg:block"},[o("img",{src:"/images/lady-holding-boxes.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const de=P(j,[["render",R]]);export{de as default};
