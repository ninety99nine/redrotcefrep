import{m as Ce,c as n,a as u,b as s,r as c,d as g,g as k,o,F as S,f as C,e as f,h as B,t as p,n as F,i as I,z as De,x as Pe,A as Oe,B as ae,T as ye,w as ge,C as Me}from"./app-BS747Cvj.js";import{r as Fe,a as Le,b as Te,d as pe}from"./cloneDeep-DTO5MgNn.js";import{B as V}from"./Button-DwrvLHoq.js";import{S as D}from"./Skeleton-CTU87mWK.js";import{I as M,a as de}from"./Input-ChopJmt9.js";import{S as q}from"./Select-oImkjFwu.js";import{S as $}from"./Switch-C7NpZjIx.js";import{c as R,O as Ie,a as Ve}from"./OrderPaymentStatusSelect-D1tM7zID.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as ee}from"./trash-2-sbHw9UGk.js";import{P as Z}from"./plus-BctgH_yG.js";import{M as te}from"./Modal-DFgbUQSx.js";import{R as je,a as Ae}from"./Popover-RWMt7bQF.js";import{c as Ee}from"./createLucideIcon-48nG323g.js";import{P as fe}from"./Pill-CDGvVlRG.js";import{A as Re}from"./arrow-left-Do7-NkX3.js";import{A as Be}from"./AddressInput-BbjNkHCh.js";import{A as Ne}from"./Alert-CmtAX-FS.js";import{D as Ue}from"./Datepicker-DaxBmykV.js";import{S as ve}from"./ShineEffect-BJBuBPSg.js";import{I as qe}from"./info-Yd9kB0GK.js";import"./Loader-DjOVE8lE.js";import"./Copy-CF04rHR8.js";import"./isEqual-D4F7LSaO.js";import"./GoogleMaps-C-l7csvz.js";import"./SelectCountry-DCiHCdqE.js";import"./move-left-BO-fqvmZ.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=Ee("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var Y,le;function ze(){if(le)return Y;le=1;var i=Fe(),t=function(){return i.Date.now()};return Y=t,Y}var G,ue;function We(){if(ue)return G;ue=1;var i=/\s/;function t(r){for(var m=r.length;m--&&i.test(r.charAt(m)););return m}return G=t,G}var Q,ce;function He(){if(ce)return Q;ce=1;var i=We(),t=/^\s+/;function r(m){return m&&m.slice(0,i(m)+1).replace(t,"")}return Q=r,Q}var X,me;function Ye(){if(me)return X;me=1;var i=Le(),t=Te(),r="[object Symbol]";function m(a){return typeof a=="symbol"||t(a)&&i(a)==r}return X=m,X}var J,he;function Ge(){if(he)return J;he=1;var i=He(),t=pe(),r=Ye(),m=NaN,a=/^[-+]0x[0-9a-f]+$/i,e=/^0b[01]+$/i,d=/^0o[0-7]+$/i,y=parseInt;function _(l){if(typeof l=="number")return l;if(r(l))return m;if(t(l)){var h=typeof l.valueOf=="function"?l.valueOf():l;l=t(h)?h+"":h}if(typeof l!="string")return l===0?l:+l;l=i(l);var v=e.test(l);return v||d.test(l)?y(l.slice(2),v?2:8):a.test(l)?m:+l}return J=_,J}var K,_e;function Qe(){if(_e)return K;_e=1;var i=pe(),t=ze(),r=Ge(),m="Expected a function",a=Math.max,e=Math.min;function d(y,_,l){var h,v,w,P,O,T,j=0,oe=!1,A=!1,z=!0;if(typeof y!="function")throw new TypeError(m);_=r(_)||0,i(l)&&(oe=!!l.leading,A="maxWait"in l,w=A?a(r(l.maxWait)||0,_):w,z="trailing"in l?!!l.trailing:z);function W(x){var L=h,E=v;return h=v=void 0,j=x,P=y.apply(E,L),P}function we(x){return j=x,O=setTimeout(N,_),oe?W(x):P}function be(x){var L=x-T,E=x-j,ie=_-L;return A?e(ie,w-E):ie}function se(x){var L=x-T,E=x-j;return T===void 0||L>=_||L<0||A&&E>=w}function N(){var x=t();if(se(x))return ne(x);O=setTimeout(N,be(x))}function ne(x){return O=void 0,z&&h?W(x):(h=v=void 0,P)}function xe(){O!==void 0&&clearTimeout(O),j=0,h=T=v=O=void 0}function ke(){return O===void 0?P:ne(t())}function H(){var x=t(),L=se(x);if(h=arguments,v=this,T=x,L){if(O===void 0)return we(T);if(A)return clearTimeout(O),O=setTimeout(N,_),W(T)}return O===void 0&&(O=setTimeout(N,_)),P}return H.cancel=xe,H.flush=ke,H}return K=d,K}var Xe=Qe();const re=Ce(Xe),U={FLAT:"flat",PERCENTAGE:"percentage"},Je={inject:["storeState","orderState"],components:{Input:M,Select:q,Switch:$,Button:V},props:{index:{type:Number},cartFee:{type:Object}},data(){return{Trash2:ee,RATE_TYPES:U,feeTypes:Object.entries(U).map(([i,t])=>({label:R(t),value:t}))}},computed:{store(){return this.storeState.store}}},Ke={class:"space-y-2 bg-gray-50 p-2 border border-gray-300 rounded-lg"},$e={class:"flex items-center space-x-2"},et={class:"w-full flex justify-end"};function tt(i,t,r,m,a,e){const d=c("Input"),y=c("Select"),_=c("Button"),l=c("Switch");return o(),n("div",Ke,[u(d,{type:"text",class:"w-full",modelValue:r.cartFee.name,"onUpdate:modelValue":t[0]||(t[0]=h=>r.cartFee.name=h),placeholder:"Packaging",onInput:t[1]||(t[1]=h=>e.orderState.saveStateDebounced("Fee name changed"))},null,8,["modelValue"]),s("div",$e,[u(y,{class:"w-60",search:!1,options:a.feeTypes,modelValue:r.cartFee.rate_type,"onUpdate:modelValue":t[2]||(t[2]=h=>r.cartFee.rate_type=h),placeholder:"Select fee type",onChange:t[3]||(t[3]=h=>e.orderState.saveStateDebounced("Fee type changed"))},null,8,["options","modelValue"]),r.cartFee.rate_type==a.RATE_TYPES.FLAT?(o(),g(d,{key:0,type:"money",class:"w-60",modelValue:r.cartFee.flat_rate,"onUpdate:modelValue":t[4]||(t[4]=h=>r.cartFee.flat_rate=h),currency:e.store.currency.code,onInput:t[5]||(t[5]=h=>e.orderState.saveStateDebounced("Fee amount changed"))},null,8,["modelValue","currency"])):(o(),g(d,{key:1,class:"w-60",type:"percentage",modelValue:r.cartFee.percentage_rate,"onUpdate:modelValue":t[6]||(t[6]=h=>r.cartFee.percentage_rate=h),onInput:t[7]||(t[7]=h=>e.orderState.saveStateDebounced("Fee amount changed"))},null,8,["modelValue"])),s("div",et,[r.cartFee.removable?(o(),g(_,{key:0,size:"xs",type:"danger",leftIcon:a.Trash2,action:()=>e.orderState.removeCartFee(r.index)},{default:k(()=>t[10]||(t[10]=[s("span",null,"Remove Fee",-1)])),_:1,__:[10]},8,["leftIcon","action"])):(o(),g(l,{key:1,size:"xs",prefixText:"Apply fee",modelValue:r.cartFee.active,"onUpdate:modelValue":t[8]||(t[8]=h=>r.cartFee.active=h),onChange:t[9]||(t[9]=h=>e.orderState.saveStateDebounced("Apply fee status changed"))},null,8,["modelValue"]))])])])}const rt=b(Je,[["render",tt]]),ot={inject:["storeState","orderState"],components:{Button:V,Skeleton:D,OrderFee:rt},data(){return{Plus:Z}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},cartFees(){return this.orderState.orderForm.cart_fees},isEditting(){return this.$route.name==="edit-order"},hasCartFees(){return this.cartFees.length>0}},methods:{addNew(){this.orderState.addCartFee()}}},st={class:"bg-white rounded-lg p-4 shadow-sm"},nt={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},it={class:"w-full space-y-4"},at={key:1,class:"space-y-2"},dt={class:"flex justify-center pt-2"},lt={key:1,class:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4 my-4"};function ut(i,t,r,m,a,e){const d=c("Skeleton"),y=c("OrderFee"),_=c("Button");return o(),n("div",st,[t[5]||(t[5]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Fees",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",nt,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])],-1)),s("div",it,[u(d,{width:"w-full",shine:!0}),u(d,{width:"w-1/3",shine:!0})])])):(o(),n("div",at,[e.hasCartFees?(o(),n(S,{key:0},[(o(!0),n(S,null,C(e.cartFees,(l,h)=>(o(),g(y,{key:h,index:h,cartFee:l},null,8,["index","cartFee"]))),128)),s("div",dt,[u(_,{size:"sm",type:"light",action:e.addNew,leftIcon:a.Plus},{default:k(()=>t[1]||(t[1]=[s("span",null,"Add Fee",-1)])),_:1,__:[1]},8,["action","leftIcon"])])],64)):(o(),n("div",lt,[e.hasCartFees?f("",!0):(o(),n(S,{key:0},[t[2]||(t[2]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1)),t[3]||(t[3]=s("span",{class:"text-sm text-gray-500"},"No fees",-1))],64)),u(_,{size:"xs",type:"light",action:e.addNew,leftIcon:a.Plus,buttonClass:"my-2"},{default:k(()=>t[4]||(t[4]=[s("span",null,"Add Fee",-1)])),_:1,__:[4]},8,["action","leftIcon"])]))]))])}const ct=b(ot,[["render",ut]]),mt={inject:["formState","storeState","orderState","notificationState"],components:{Input:M,Select:q,Skeleton:D,OrderStatusSelect:Ve,OrderPaymentStatusSelect:Ie},data(){return{couriers:[],isLoadingCouriers:!1}},computed:{hasOrder(){return this.orderState.hasOrder},orderForm(){return this.orderState.orderForm},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},statuses(){return["waiting","cancelled","completed","on its way","ready for pickup"].map(t=>({label:R(t),value:t}))},paymentStatuses(){return["paid","unpaid","pending payment","partially paid"].map(t=>({label:R(t),value:t}))}},methods:{async showCouriers(){var i,t;try{if(this.couriers.length)return;this.isLoadingCouriers=!0;let r={params:{per_page:100}};const m=await B.get("/api/couriers",r);this.couriers=m.data.data.map(a=>({label:R(a.name),value:a.id})),this.couriers.unshift({label:"None",value:null})}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching stores";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to fetch stores:",r)}finally{this.isLoadingCouriers=!1}}},created(){this.showCouriers()}},ht={class:"bg-white rounded-lg p-4 shadow-sm"},_t={key:0,class:"space-y-2"},yt={key:1,class:"space-y-2"};function gt(i,t,r,m,a,e){const d=c("Skeleton"),y=c("OrderStatusSelect"),_=c("OrderPaymentStatusSelect"),l=c("Select"),h=c("Input");return o(),n("div",ht,[e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",_t,[(o(),n(S,null,C([1,2,3],(v,w)=>s("div",{key:w,class:"border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},[u(d,{width:"w-full",shine:!0})])),64))])):(o(),n("div",yt,[u(y,{class:"w-full",showLabel:!0,onChange:t[0]||(t[0]=v=>e.orderState.saveStateDebounced(`Status changed to ${e.orderForm.status}`))}),u(_,{class:"w-full",showLabel:!0,onChange:t[1]||(t[1]=v=>e.orderState.saveStateDebounced(`Payment status changed to ${e.orderForm.payment_status}`))}),u(l,{search:!1,label:"Couriers",options:a.couriers,modelValue:e.orderForm.courier_id,"onUpdate:modelValue":t[2]||(t[2]=v=>e.orderForm.courier_id=v),errorText:e.formState.getFormError("courier_id"),onChange:t[3]||(t[3]=v=>e.orderState.saveStateDebounced("Courier changed"))},null,8,["options","modelValue","errorText"]),u(h,{type:"text",label:"Tracking Number",modelValue:e.orderForm.tracking_number,"onUpdate:modelValue":t[4]||(t[4]=v=>e.orderForm.tracking_number=v),errorText:e.formState.getFormError("tracking_number"),onInput:t[5]||(t[5]=v=>e.orderState.saveStateDebounced("Tracking number changed"))},null,8,["modelValue","errorText"]),u(h,{rows:"2",type:"textarea",label:"Internal Note",modelValue:e.orderForm.internal_note,"onUpdate:modelValue":t[6]||(t[6]=v=>e.orderForm.internal_note=v),errorText:e.formState.getFormError("internal_note"),onChange:t[7]||(t[7]=v=>e.orderState.saveStateDebounced("Internal note changed")),tooltipContent:"Internal information about this order only visible to you and other team members"},null,8,["modelValue","errorText"])]))])}const pt=b(mt,[["render",gt]]),ft={inject:["orderState","storeState"],components:{Skeleton:D},computed:{order(){return this.orderState.order},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},shoppingCart(){return this.orderState.shoppingCart},isInspectingShoppingCart(){return this.orderState.isInspectingShoppingCart},hasFees(){return Object.keys(this.shoppingCart?this.shoppingCart.totals.fees:this.order.order_fees).length>0},hasDiscounts(){return Object.keys(this.shoppingCart?this.shoppingCart.totals.discounts:this.order.order_discounts).length>0},hasTaxAmount(){return(this.shoppingCart?this.shoppingCart.totals.vat.amount.amount:this.order.vat_amount.amount)>0},hasAdjustmentTotal(){return this.shoppingCart?this.shoppingCart.totals.adjustment_total.amount!=0:this.order.adjustment_total.amount!=0},adjustmentTotalPositive(){return this.shoppingCart?this.shoppingCart.totals.adjustment_total.amount>0:this.order.adjustment_total.amount>0},isReady(){return!this.isLoadingStore&&!this.isLoadingOrder&&!this.isInspectingShoppingCart}}},vt={class:"bg-white rounded-lg p-4 shadow-sm"},St={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},wt={class:"w-full space-y-4"},bt={key:1,class:"bg-blue-50 border border-blue-400 rounded-lg p-4"},xt={key:0,class:"flex items-center justify-between text-sm border-b border-gray-300 border-dashed pb-2 mb-2"},kt={key:1},Ct={key:1,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Dt={key:1},Pt={key:3,class:"text-red-500"},Ot={key:2,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Mt={class:"flex items-center justify-between text-sm mb-1"},Ft={key:1,class:"w-full"},Lt={key:3},Tt={key:1,class:"text-xs text-gray-400"},It={key:3,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Vt={key:1},jt={key:3,class:"text-green-500"},At={key:4,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Et={class:"flex items-center justify-between text-sm text-gray-500"},Rt={key:1},Bt={class:"flex items-center justify-between text-lg"},Nt={key:1,class:"font-bold"},Ut={key:1,class:"text-sm"};function qt(i,t,r,m,a,e){const d=c("Skeleton");return o(),n("div",vt,[e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",St,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])],-1)),s("div",wt,[u(d,{width:"w-full",shine:!0}),u(d,{width:"w-1/3",shine:!0})])])):(o(),n("div",bt,[e.order||e.shoppingCart?(o(),n(S,{key:0},[!e.isReady||e.hasDiscounts||e.hasFees?(o(),n("div",xt,[t[1]||(t[1]=s("span",null,"Subtotal",-1)),e.isReady?(o(),n("span",kt,p(e.shoppingCart?e.shoppingCart.totals.subtotal.amount_with_currency:e.order.subtotal.amount_with_currency),1)):(o(),g(d,{key:0,width:"w-24",color:"bg-blue-200",shine:!0}))])):f("",!0),!e.isReady||e.hasDiscounts?(o(),n("div",Ct,[(o(!0),n(S,null,C(e.isReady?e.shoppingCart?e.shoppingCart.totals.discounts:e.order.order_discounts:[1],(y,_)=>(o(),n("div",{key:_,class:"flex items-center justify-between text-sm text-gray-500"},[e.isReady?(o(),n("span",Dt,p(y.name),1)):(o(),g(d,{key:0,width:"w-24",color:"bg-blue-200",shine:!0})),e.isReady?(o(),n("span",Pt,"- "+p(y.amount.amount_with_currency),1)):(o(),g(d,{key:2,width:"w-20",color:"bg-blue-200",shine:!0}))]))),128))])):f("",!0),!e.isReady||e.hasTaxAmount?(o(),n("div",Ot,[s("div",Mt,[e.isReady?(o(),n("div",Ft,"Tax ("+p(e.shoppingCart?e.shoppingCart.totals.vat.rate.value_symbol:`${e.order.vat_rate}%`)+" "+p(e.shoppingCart?e.shoppingCart.totals.vat.method:e.order.vat_method)+")",1)):(o(),g(d,{key:0,width:"w-16",color:"bg-blue-200",shine:!0})),e.isReady?(o(),n("span",Lt,p(e.shoppingCart?e.shoppingCart.totals.vat.amount.amount_with_currency:e.order.vat_amount.amount_with_currency),1)):(o(),g(d,{key:2,width:"w-16",color:"bg-blue-200",shine:!0}))]),e.isReady?(o(),n("p",Tt,"Tax calculated on the discounted subtotal of "+p(e.shoppingCart?e.shoppingCart.totals.subtotal_after_discount.amount_with_currency:e.order.subtotal_after_discount.amount_with_currency),1)):(o(),g(d,{key:0,width:"w-1/3",color:"bg-blue-200",shine:!0}))])):f("",!0),!e.isReady||e.hasFees?(o(),n("div",It,[(o(!0),n(S,null,C(e.isReady?e.shoppingCart?e.shoppingCart.totals.fees:e.order.order_fees:[1],(y,_)=>(o(),n("div",{key:_,class:"flex items-center justify-between text-sm text-gray-500"},[e.isReady?(o(),n("span",Vt,p(y.name),1)):(o(),g(d,{key:0,width:"w-20",color:"bg-blue-200",shine:!0})),e.isReady?(o(),n("span",jt,"+ "+p(y.amount.amount_with_currency),1)):(o(),g(d,{key:2,width:"w-16",color:"bg-blue-200",shine:!0}))]))),128))])):f("",!0),!e.isReady||e.hasAdjustmentTotal?(o(),n("div",At,[s("div",Et,[e.isReady?(o(),n("span",Rt,"Adjustment")):(o(),g(d,{key:0,width:"w-20",color:"bg-blue-200",shine:!0})),e.isReady?(o(),n("span",{key:3,class:F([e.adjustmentTotalPositive?"text-green-500":"text-red-500"])},p(e.adjustmentTotalPositive?"+":"-")+" "+p(`${e.shoppingCart?e.shoppingCart.totals.adjustment_total.amount_with_currency:e.order.adjustment_total.amount_with_currency}`.replace("-","")),3)):(o(),g(d,{key:2,width:"w-16",color:"bg-blue-200",shine:!0}))])])):f("",!0),s("div",Bt,[t[2]||(t[2]=s("div",{class:"w-full font-bold"},"Grand Total",-1)),e.isReady?(o(),n("span",Nt,p(e.shoppingCart?e.shoppingCart.totals.grand_total.amount_with_currency:e.order.grand_total.amount_with_currency),1)):(o(),g(d,{key:0,width:"w-24",color:"bg-blue-200",shine:!0}))])],64)):(o(),n("span",Ut,"Add products to show total"))]))])}const Zt=b(ft,[["render",qt]]),zt={props:{customer:{type:Object},onSelectCustomer:{type:Function}}},Wt={class:"text-sm font-semibold"},Ht={class:"text-xs text-gray-500"};function Yt(i,t,r,m,a,e){return o(),n("div",{onClick:t[0]||(t[0]=()=>r.onSelectCustomer(r.customer)),class:"flex items-center space-x-2 cursor-pointer p-3 border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100"},[t[1]||(t[1]=s("svg",{class:"w-6 h-6 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})],-1)),s("div",null,[s("p",Wt,p(r.customer.name),1),s("p",Ht,p(r.customer.email||r.customer.mobile_number.national),1)])])}const Gt=b(zt,[["render",Yt]]),Qt={components:{CustomerOption:Gt},props:{customers:{type:Array},onSelectCustomer:{type:Function}}},Xt={class:"max-h-80 overflow-y-auto space-y-2 mb-4"};function Jt(i,t,r,m,a,e){const d=c("CustomerOption");return o(),n("div",Xt,[(o(!0),n(S,null,C(r.customers,(y,_)=>(o(),g(d,{key:_,customer:y,onSelectCustomer:r.onSelectCustomer},null,8,["customer","onSelectCustomer"]))),128))])}const Kt=b(Qt,[["render",Jt]]),$t={inject:["formState","orderState","storeState","notificationState"],components:{Input:M,Modal:te,Button:V,Skeleton:D,CustomerOptions:Kt},props:{hasCustomer:{type:Boolean}},data(){return{Plus:Z,RefreshCcw:je,customers:[],searchTerm:null,lastSearchTerm:null,isLoadingCustomers:!1,hasLoadedInitialCustomers:!1}},watch:{searchTerm(){this.showCustomers()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},hasCustomers(){return this.customers.length>0}},methods:{onShow(){this.hasLoadedInitialCustomers=!1,this.lastSearchTerm=null,this.searchTerm=null,this.customers=[],this.showCustomers()},async showCustomers(){var i,t;try{this.isLoadingCustomers=!0;let r={params:{store_id:this.store.id}};this.hasSearchTerm&&(r.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const m=await B.get("/api/customers",r);if(this.searchTerm===this.lastSearchTerm){const a=m.data;this.customers=a.data,this.isLoadingCustomers=!1,this.hasLoadedInitialCustomers=!0}}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching customers";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to fetch customers:",r)}finally{this.isLoadingCustomers=!1}},onSelectCustomer(i){this.$refs.modal.hideModal(),this.orderState.addCartCustomer(i)},addNew(){this.$refs.modal.hideModal(),this.orderState.addCartCustomer()}}},er={class:"flex justify-center"},tr={key:0,class:"flex justify-center items-center space-x-4 my-2"},rr={key:1,class:"space-y-2 mb-4"},or={class:"w-full space-y-2"},sr={key:3,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function nr(i,t,r,m,a,e){const d=c("Input"),y=c("Button"),_=c("Skeleton"),l=c("CustomerOptions"),h=c("Modal");return o(),n("div",er,[u(h,{ref:"modal",onShow:e.onShow,triggerSize:"sm",contentClass:"px-4",triggerType:"light",scrollOnContent:!1,showApproveButton:!1,leftTriggerIcon:r.hasCustomer?a.RefreshCcw:a.Plus,header:`${r.hasCustomer?"Change":"Add"} Customer`,triggerText:`${r.hasCustomer?"Change":"Add"} Customer`,triggerLoading:e.isLoadingOrder||e.isEditting&&!e.hasOrder},{content:k(()=>[a.hasLoadedInitialCustomers?(o(),n("div",tr,[u(d,{type:"search",class:"w-full",debounced:!0,modelValue:a.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=v=>a.searchTerm=v),placeholder:"Search customers",onInput:t[1]||(t[1]=v=>a.isLoadingCustomers=!0),skeleton:e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),u(y,{size:"xs",type:"light",leftIcon:a.Plus,action:e.addNew,buttonClass:"my-2"},{default:k(()=>t[2]||(t[2]=[s("span",null,"Add New",-1)])),_:1,__:[2]},8,["leftIcon","action"])])):f("",!0),a.isLoadingCustomers?(o(),n("div",rr,[(o(),n(S,null,C([1,2,3],(v,w)=>s("div",{key:w,class:"flex items-center space-x-2 border-b border-gray-300 shadow-sm rounded-lg p-2 bg-gray-50 w-full"},[u(_,{width:"w-10",height:"h-10",rounded:"rounded-lg",shine:!0,class:"flex-shrink-0"}),s("div",or,[u(_,{width:"w-2/3",shine:!0}),u(_,{width:"w-1/3",shine:!0})])])),64))])):e.hasCustomers?(o(),g(l,{key:2,customers:a.customers,onSelectCustomer:e.onSelectCustomer},null,8,["customers","onSelectCustomer"])):(o(),n("p",sr," No customers found "))]),_:1},8,["onShow","leftTriggerIcon","header","triggerText","triggerLoading"])])}const ir=b($t,[["render",nr]]),ar={inject:["storeState","orderState"],components:{Input:M,Skeleton:D,AddCustomer:ir},data(){return{modified:!1,customer_email:null,customer_last_name:null,customer_first_name:null,customer_mobile_number:null}},watch:{orderForm:{handler(i,t){t==null?(this.customer_email=i.customer_email,this.customer_last_name=i.customer_last_name,this.customer_first_name=i.customer_first_name,this.customer_mobile_number=i.customer_mobile_number):this.modified=i.customer_email!==this.customer_email||i.customer_last_name!==this.customer_last_name||i.customer_first_name!==this.customer_first_name||i.customer_mobile_number!==this.customer_mobile_number},deep:!0}},computed:{hasOrder(){return this.orderState.hasOrder},orderForm(){return this.orderState.orderForm},isEditting(){return this.$route.name==="edit-order"},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},hasEmail(){var i;return(i=this.orderForm.customer_email)==null?void 0:i.trim()},hasMobileNumber(){var i;return(i=this.orderForm.customer_mobile_number)==null?void 0:i.trim()},hasCustomerDetails(){return this.orderState.hasCustomerDetails}}},dr={class:"bg-white rounded-lg p-4 shadow-sm"},lr={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},ur={class:"w-full space-y-4"},cr={key:0,class:"space-y-2"},mr={key:1,class:"border-t border-dashed border-gray-300 pt-4 mt-4"};function hr(i,t,r,m,a,e){const d=c("Skeleton"),y=c("Input"),_=c("AddCustomer");return o(),n("div",dr,[t[13]||(t[13]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Customer",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",lr,[t[10]||(t[10]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])],-1)),s("div",ur,[u(d,{width:"w-full",shine:!0}),u(d,{width:"w-1/3",shine:!0})])])):(o(),n(S,{key:1},[e.hasCustomerDetails||a.modified?(o(),n("div",cr,[u(y,{type:"text",placeholder:"First name",modelValue:e.orderForm.customer_first_name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.orderForm.customer_first_name=l),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,onInput:t[1]||(t[1]=l=>e.orderState.saveStateDebounced("Customer first name changed"))},null,8,["modelValue","skeleton"]),u(y,{type:"text",placeholder:"Last name",modelValue:e.orderForm.customer_last_name,"onUpdate:modelValue":t[2]||(t[2]=l=>e.orderForm.customer_last_name=l),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,onInput:t[3]||(t[3]=l=>e.orderState.saveStateDebounced("Customer last name changed"))},null,8,["modelValue","skeleton"]),u(y,{type:"email",placeholder:"Email",modelValue:e.orderForm.customer_email,"onUpdate:modelValue":t[4]||(t[4]=l=>e.orderForm.customer_email=l),onInput:t[5]||(t[5]=l=>e.orderState.saveStateDebounced("Customer email changed")),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?f("",!0):(o(),g(y,{key:0,type:"text",placeholder:"+26772000001",modelValue:e.orderForm.customer_mobile_number,"onUpdate:modelValue":t[6]||(t[6]=l=>e.orderForm.customer_mobile_number=l),onChange:t[7]||(t[7]=l=>e.orderState.saveStateDebounced("Customer mobile number changed"))},null,8,["modelValue"]))])):f("",!0),e.hasEmail||e.hasMobileNumber?(o(),n("div",mr,[u(y,{type:"checkbox",inputLabel:"Update customer profile",modelValue:e.orderForm.update_profile,"onUpdate:modelValue":t[8]||(t[8]=l=>e.orderForm.update_profile=l),inputDescription:"Make sure to update both the order customer details and the customer profile",onChange:t[9]||(t[9]=l=>e.orderState.saveStateDebounced(`Update customer profile (${e.orderForm.update_profile?"On":"Off"})`))},null,8,["modelValue"])])):f("",!0),s("div",{class:F([e.hasCustomerDetails||a.modified?"border-t border-dashed border-gray-300 pt-4 mt-4":"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4"])},[!e.hasCustomerDetails&&!a.modified?(o(),n(S,{key:0},[t[11]||(t[11]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})],-1)),t[12]||(t[12]=s("span",{class:"text-sm text-gray-500"},"No customer added",-1))],64)):f("",!0),u(_,{hasCustomerDetails:e.hasCustomerDetails},null,8,["hasCustomerDetails"])],2)],64))])}const _r=b(ar,[["render",hr]]),yr={inject:["storeState","orderState"],components:{Tag:Ze,Input:M,Button:V},props:{index:{type:Number},cartProduct:{type:Object}},data(){return{Trash2:ee}},computed:{store(){return this.storeState.store},hasPhotoPath(){return this.photoPath!=null},photoPath(){return this.cartProduct.photo_path},grandTotal(){const i=parseFloat(this.cartProduct.unit_regular_price),t=parseFloat(this.cartProduct.unit_sale_price),r=parseInt(this.cartProduct.quantity),m=this.store.currency.code;return t>0&&t<i?de(t*r,m):de(i*r,m)}}},gr={class:"rounded-lg overflow-hidden border border-gray-300 py-2 px-4 bg-gray-50"},pr={class:"w-full flex space-x-4"},fr=["src"],vr={key:1,class:"w-6 h-6 text-gray-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Sr={class:"w-full space-y-4"},wr={class:"w-full text-sm text-left"},br={class:"whitespace-nowrap align-top py-2 pr-2"},xr={class:"whitespace-nowrap align-top p-2"},kr={class:"whitespace-nowrap align-top py-2 pl-2"},Cr={class:"grid grid-cols-3 my-4"},Dr={class:"col-span-1 col-start-2 flex items-center justify-center space-x-2"},Pr={class:"text-gray-700 text-center"},Or={class:"col-span-1"},Mr={class:"flex justify-end"};function Fr(i,t,r,m,a,e){const d=c("Input"),y=c("Tag"),_=c("Button");return o(),n("div",gr,[s("div",pr,[s("div",{class:F(["flex items-center justify-center w-16 h-16 rounded-lg",{"border border-dashed border-gray-200":!e.hasPhotoPath}])},[e.hasPhotoPath?(o(),n("img",{key:0,class:"w-full object-contain rounded-lg bg-red-200 flex-shrink-0",src:e.photoPath},null,8,fr)):(o(),n("svg",vr,t[8]||(t[8]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"},null,-1)])))],2),s("div",Sr,[u(d,{type:"text",label:"Name",modelValue:r.cartProduct.name,"onUpdate:modelValue":t[0]||(t[0]=l=>r.cartProduct.name=l),placeholder:"Standard Ticket",onInput:t[1]||(t[1]=l=>e.orderState.saveStateDebounced("Product name changed"))},null,8,["modelValue"]),s("table",wr,[t[9]||(t[9]=s("thead",null,[s("tr",null,[s("th",{class:"whitespace-nowrap align-top px-2 pr-2"},[s("span",{class:"text-gray-700 text-xs font-normal uppercase"},"Regular Price")]),s("th",{class:"whitespace-nowrap align-top px-2"},[s("span",{class:"text-gray-700 text-xs font-normal uppercase"},"Sale Price")]),s("th",{class:"whitespace-nowrap align-top px-2 pl-2"},[s("span",{class:"text-gray-700 text-xs font-normal uppercase"},"Quantity")])])],-1)),s("tbody",null,[s("tr",null,[s("td",br,[u(d,{type:"money",currency:e.store.currency.code,modelValue:r.cartProduct.unit_regular_price,"onUpdate:modelValue":t[2]||(t[2]=l=>r.cartProduct.unit_regular_price=l),onInput:t[3]||(t[3]=l=>e.orderState.saveStateDebounced("Product regular price changed"))},null,8,["currency","modelValue"])]),s("td",xr,[u(d,{type:"money",currency:e.store.currency.code,modelValue:r.cartProduct.unit_sale_price,"onUpdate:modelValue":t[4]||(t[4]=l=>r.cartProduct.unit_sale_price=l),onInput:t[5]||(t[5]=l=>e.orderState.saveStateDebounced("Product sale price changed"))},null,8,["currency","modelValue"])]),s("td",kr,[u(d,{type:"number",modelValue:r.cartProduct.quantity,"onUpdate:modelValue":t[6]||(t[6]=l=>r.cartProduct.quantity=l),onInput:t[7]||(t[7]=l=>e.orderState.saveStateDebounced("Product quantity changed"))},null,8,["modelValue"])])])])])])]),s("div",Cr,[s("div",Dr,[u(y,{size:"16",class:"text-gray-500"}),s("span",Pr,p(e.store.currency.symbol)+p(e.grandTotal),1)]),s("div",Or,[s("div",Mr,[u(_,{size:"xs",type:"danger",leftIcon:a.Trash2,action:()=>e.orderState.removeCartProduct(r.index)},{default:k(()=>t[10]||(t[10]=[s("span",null,"Remove Product",-1)])),_:1,__:[10]},8,["leftIcon","action"])])])])])}const Lr=b(yr,[["render",Fr]]),Tr={components:{Pill:fe},props:{parentProduct:{type:Object,default:null},product:{type:Object},onSelectProduct:{type:Function}},computed:{photo(){return this.product.photo},hasPhoto(){return this.photo!=null}}},Ir=["src"],Vr={key:1,class:"w-6 h-6 text-gray-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},jr={class:"w-full flex items-center justify-between"},Ar={class:"text-sm font-semibold"},Er={class:"text-xs space-x-2"},Rr={key:0};function Br(i,t,r,m,a,e){const d=c("Pill");return o(),n("div",{onClick:t[0]||(t[0]=()=>r.onSelectProduct(r.product,r.parentProduct)),class:"flex justify-between items-center cursor-pointer p-2 space-x-4 rounded-lg bg-gray-50 hover:bg-gray-100"},[s("div",{class:F(["flex items-center justify-center w-10 h-10 rounded-lg",{"border border-dashed border-gray-200":!e.hasPhoto}])},[e.hasPhoto?(o(),n("img",{key:0,class:"w-full max-h-10 object-contain rounded-lg flex-shrink-0",src:e.photo.path},null,8,Ir)):(o(),n("svg",Vr,t[1]||(t[1]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"},null,-1)])))],2),s("div",jr,[s("div",null,[s("p",Ar,p(r.product.name),1),s("p",Er,[s("span",{class:F({"line-through text-gray-500":r.product.on_sale})},p(r.product.unit_regular_price.amount_with_currency),3),r.product.on_sale?(o(),n("span",Rr,p(r.product.unit_sale_price.amount_with_currency),1)):f("",!0)])]),r.product.variants&&r.product.variants.length?(o(),g(d,{key:0,type:"light",size:"xs"},{default:k(()=>[I(p(r.product.variants.length)+" "+p(r.product.variants.length==1?"option":"options"),1)]),_:1})):f("",!0)])])}const Nr=b(Tr,[["render",Br]]),Ur={components:{ProductOption:Nr},props:{parentProduct:{type:Object,default:null},products:{type:Array},onSelectProduct:{type:Function}}},qr={class:"max-h-80 overflow-y-auto space-y-2 mb-4"};function Zr(i,t,r,m,a,e){const d=c("ProductOption");return o(),n("div",qr,[(o(!0),n(S,null,C(r.products,(y,_)=>(o(),g(d,{key:_,product:y,parentProduct:r.parentProduct,onSelectProduct:r.onSelectProduct},null,8,["product","parentProduct","onSelectProduct"]))),128))])}const Se=b(Ur,[["render",Zr]]),zr={components:{ProductOptions:Se},props:{selectedProduct:{type:Object},onSelectProduct:{type:Function}}},Wr={class:"space-y-2 mb-4"};function Hr(i,t,r,m,a,e){const d=c("ProductOptions");return o(),n("div",Wr,[u(d,{parentProduct:r.selectedProduct,onSelectProduct:r.onSelectProduct,products:r.selectedProduct.variants},null,8,["parentProduct","onSelectProduct","products"])])}const Yr=b(zr,[["render",Hr]]),Gr={inject:["formState","orderState","storeState","notificationState"],components:{Input:M,Modal:te,Button:V,Skeleton:D,ProductOptions:Se,ProductVariationOptions:Yr},data(){return{Plus:Z,ArrowLeft:Re,products:[],searchTerm:null,lastSearchTerm:null,selectedProduct:null,isLoadingProducts:!1,hasLoadedInitialProducts:!1}},watch:{searchTerm(){this.showProducts()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},hasProducts(){return this.products.length>0}},methods:{onShow(){this.hasLoadedInitialProducts=!1,this.selectedProduct=null,this.lastSearchTerm=null,this.searchTerm=null,this.products=[],this.showProducts()},async showProducts(){var i,t;try{this.isLoadingProducts=!0;let r={params:{store_id:this.store.id,association:"team member",_relationships:"photo,variants"}};this.hasSearchTerm&&(r.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const m=await B.get("/api/products",r);if(this.searchTerm===this.lastSearchTerm){const a=m.data;this.products=a.data,this.isLoadingProducts=!1,this.hasLoadedInitialProducts=!0}}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to fetch products:",r)}finally{this.isLoadingProducts=!1}},onSelectProduct(i,t){i.variants&&i.variants.length>0?this.selectedProduct=i:(this.$refs.modal.hideModal(),this.orderState.addCartProductUsingProduct(i,t))},removeSelectedProduct(){this.selectedProduct=null},addNew(){this.$refs.modal.hideModal(),this.orderState.addCartProduct()}}},Qr={class:"flex justify-center"},Xr={key:0,class:"flex justify-center items-center space-x-4 my-2"},Jr={key:1,class:"space-y-2 mb-4"},Kr={class:"w-full space-y-2"},$r={class:"flex items-center space-x-4 border-b border-dashed border-gray-300 my-4 pb-4"},eo={class:"flex items-center space-x-2"},to={key:0,class:"flex items-center justify-center w-10 h-10 rounded-lg"},ro=["src"],oo={class:"text-lg font-bold"},so={key:4,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function no(i,t,r,m,a,e){const d=c("Input"),y=c("Button"),_=c("Skeleton"),l=c("ProductVariationOptions"),h=c("ProductOptions"),v=c("Modal");return o(),n("div",Qr,[u(v,{ref:"modal",onShow:e.onShow,triggerSize:"sm",contentClass:"px-4",triggerType:"light",header:"Add Product",leftTriggerIcon:a.Plus,scrollOnContent:!1,triggerText:"Add Product",showApproveButton:!1,triggerLoading:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},{content:k(()=>[a.hasLoadedInitialProducts&&!a.selectedProduct?(o(),n("div",Xr,[u(d,{type:"search",class:"w-full",debounced:!0,modelValue:a.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=w=>a.searchTerm=w),placeholder:"Search products",onInput:t[1]||(t[1]=w=>a.isLoadingProducts=!0),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),u(y,{size:"xs",type:"light",leftIcon:a.Plus,action:e.addNew,buttonClass:"my-2"},{default:k(()=>t[2]||(t[2]=[s("span",null,"Add New",-1)])),_:1,__:[2]},8,["leftIcon","action"])])):f("",!0),a.isLoadingProducts?(o(),n("div",Jr,[(o(),n(S,null,C([1,2,3],(w,P)=>s("div",{key:P,class:"flex items-center space-x-2 border-b border-gray-300 shadow-sm rounded-lg p-2 bg-gray-50 w-full"},[u(_,{width:"w-10",height:"h-10",rounded:"rounded-lg",shine:!0,class:"flex-shrink-0"}),s("div",Kr,[u(_,{width:"w-2/3",shine:!0}),u(_,{width:"w-1/3",shine:!0})])])),64))])):a.selectedProduct?(o(),n(S,{key:2},[s("div",$r,[u(y,{size:"xs",type:"light",leftIcon:a.ArrowLeft,action:e.removeSelectedProduct},{default:k(()=>t[3]||(t[3]=[s("span",null,"Back",-1)])),_:1,__:[3]},8,["leftIcon","action"]),s("div",eo,[a.selectedProduct.photo.path?(o(),n("div",to,[s("img",{class:"w-full max-h-10 object-contain rounded-lg flex-shrink-0",src:a.selectedProduct.photo.path},null,8,ro)])):f("",!0),s("p",oo,p(a.selectedProduct.name),1)])]),u(l,{onSelectProduct:e.onSelectProduct,selectedProduct:a.selectedProduct},null,8,["onSelectProduct","selectedProduct"])],64)):e.hasProducts?(o(),g(h,{key:3,products:a.products,onSelectProduct:e.onSelectProduct},null,8,["products","onSelectProduct"])):(o(),n("p",so," No products found "))]),_:1},8,["onShow","leftTriggerIcon","triggerLoading"])])}const io=b(Gr,[["render",no]]),ao={inject:["storeState","orderState"],components:{Skeleton:D,AddProduct:io,OrderProduct:Lr},computed:{hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},cartProducts(){return this.orderState.orderForm.cart_products},isEditting(){return this.$route.name==="edit-order"},hasCartProducts(){return this.cartProducts.length>0}}},lo={class:"bg-white rounded-lg p-4 shadow-sm"},uo={key:0,class:"space-y-2"},co={class:"w-full space-y-4"},mo={key:1,class:"space-y-4"};function ho(i,t,r,m,a,e){const d=c("Skeleton"),y=c("OrderProduct"),_=c("AddProduct");return o(),n("div",lo,[t[3]||(t[3]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Products",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",uo,[(o(),n(S,null,C([1,2,3],(l,h)=>s("div",{key:h,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])],-1)),s("div",co,[u(d,{width:"w-full",shine:!0}),u(d,{width:"w-1/3",shine:!0})])])),64))])):(o(),n("div",mo,[e.hasCartProducts?(o(!0),n(S,{key:0},C(e.cartProducts,(l,h)=>(o(),g(y,{key:h,index:h,cartProduct:l},null,8,["index","cartProduct"]))),128)):f("",!0),s("div",{class:F([{"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4 my-4":!e.hasCartProducts}])},[e.hasCartProducts?f("",!0):(o(),n(S,{key:0},[t[1]||(t[1]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"})],-1)),t[2]||(t[2]=s("span",{class:"text-sm text-gray-500"},"No products added",-1))],64)),u(_)],2)]))])}const _o=b(ao,[["render",ho]]),yo={inject:["storeState","orderState"],components:{Input:M,Button:V,Switch:$,Select:q},props:{index:{type:Number},cartPromotion:{type:Object}},data(){return{Trash2:ee,RATE_TYPES:U,discountRateTypes:Object.entries(U).map(([i,t])=>({label:R(t),value:t}))}},computed:{store(){return this.storeState.store}}},go={class:"rounded-lg border border-fuchsia-300 py-2 px-4 bg-fuchsia-50"},po={class:"w-full space-y-4"},fo={class:"grid grid-cols-3 gap-1"},vo={class:"flex justify-between my-4"};function So(i,t,r,m,a,e){const d=c("Input"),y=c("Switch"),_=c("Select"),l=c("Button");return o(),n("div",go,[s("div",po,[u(d,{type:"text",label:"Name",modelValue:r.cartPromotion.name,"onUpdate:modelValue":t[0]||(t[0]=h=>r.cartPromotion.name=h),placeholder:"Standard Ticket",onInput:t[1]||(t[1]=h=>e.orderState.saveStateDebounced("Promotion name changed"))},null,8,["modelValue"]),s("div",fo,[u(y,{size:"xs",suffixText:"Offer discount",modelValue:r.cartPromotion.offer_discount,"onUpdate:modelValue":t[2]||(t[2]=h=>r.cartPromotion.offer_discount=h),onInput:t[3]||(t[3]=h=>e.orderState.saveStateDebounced("Promotion discount offer changed"))},null,8,["modelValue"]),r.cartPromotion.offer_discount?(o(),n(S,{key:0},[u(_,{class:"w-full",search:!1,options:a.discountRateTypes,placeholder:"Select discount type",modelValue:r.cartPromotion.discount_rate_type,"onUpdate:modelValue":t[4]||(t[4]=h=>r.cartPromotion.discount_rate_type=h),onChange:t[5]||(t[5]=h=>e.orderState.saveStateDebounced("Promotion discount type changed"))},null,8,["options","modelValue"]),r.cartPromotion.discount_rate_type==a.RATE_TYPES.FLAT?(o(),g(d,{key:0,type:"money",currency:e.store.currency.code,modelValue:r.cartPromotion.discount_flat_rate,"onUpdate:modelValue":t[6]||(t[6]=h=>r.cartPromotion.discount_flat_rate=h),onInput:t[7]||(t[7]=h=>e.orderState.saveStateDebounced("Promotion discount amount changed"))},null,8,["currency","modelValue"])):(o(),g(d,{key:1,type:"percentage",modelValue:r.cartPromotion.discount_percentage_rate,"onUpdate:modelValue":t[8]||(t[8]=h=>r.cartPromotion.discount_percentage_rate=h),onInput:t[9]||(t[9]=h=>e.orderState.saveStateDebounced("Promotion discount amount changed"))},null,8,["modelValue"]))],64)):f("",!0)])]),s("div",vo,[u(y,{size:"xs",suffixText:"Offer free delivery",modelValue:r.cartPromotion.offer_free_delivery,"onUpdate:modelValue":t[10]||(t[10]=h=>r.cartPromotion.offer_free_delivery=h),onInput:t[11]||(t[11]=h=>e.orderState.saveStateDebounced("Promotion fee delivery offer changed"))},null,8,["modelValue"]),u(l,{size:"xs",type:"danger",leftIcon:a.Trash2,action:()=>e.orderState.removeCartPromotion(r.index)},{default:k(()=>t[12]||(t[12]=[s("span",null,"Remove Promotion",-1)])),_:1,__:[12]},8,["leftIcon","action"])])])}const wo=b(yo,[["render",So]]),bo={components:{Pill:fe},props:{promotion:{type:Object},onSelectPromotion:{type:Function}}},xo={class:"w-full flex items-center justify-between"},ko={class:"text-sm font-semibold"},Co={class:"flex items-center space-x-1"};function Do(i,t,r,m,a,e){const d=c("Pill");return o(),n("div",{onClick:t[0]||(t[0]=()=>r.onSelectPromotion(r.promotion)),class:"flex justify-between items-center cursor-pointer p-3 space-x-4 border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100"},[s("div",xo,[s("div",null,[s("p",ko,p(r.promotion.name),1)]),s("div",Co,[r.promotion.offer_discount?(o(),g(d,{key:0,type:"success",size:"xs"},{default:k(()=>t[1]||(t[1]=[I("discount")])),_:1,__:[1]})):f("",!0),r.promotion.offer_free_delivery?(o(),g(d,{key:1,type:"success",size:"xs"},{default:k(()=>t[2]||(t[2]=[I("free delivery")])),_:1,__:[2]})):f("",!0)])])])}const Po=b(bo,[["render",Do]]),Oo={components:{PromotionOption:Po},props:{promotions:{type:Array},onSelectPromotion:{type:Function}}},Mo={class:"max-h-80 overflow-y-auto space-y-2 mb-4"};function Fo(i,t,r,m,a,e){const d=c("PromotionOption");return o(),n("div",Mo,[(o(!0),n(S,null,C(r.promotions,(y,_)=>(o(),g(d,{key:_,promotion:y,onSelectPromotion:r.onSelectPromotion},null,8,["promotion","onSelectPromotion"]))),128))])}const Lo=b(Oo,[["render",Fo]]),To={inject:["formState","orderState","storeState","notificationState"],components:{Input:M,Modal:te,Button:V,Skeleton:D,PromotionOptions:Lo},data(){return{Plus:Z,promotions:[],searchTerm:null,lastSearchTerm:null,isLoadingPromotions:!1,hasLoadedInitialPromotions:!1}},watch:{searchTerm(){this.showPromotions()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},hasPromotions(){return this.promotions.length>0}},methods:{onShow(){this.hasLoadedInitialPromotions=!1,this.lastSearchTerm=null,this.searchTerm=null,this.promotions=[],this.showPromotions()},async showPromotions(){var i,t;try{this.isLoadingPromotions=!0;let r={params:{store_id:this.store.id}};this.hasSearchTerm&&(r.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const m=await B.get("/api/promotions",r);if(this.searchTerm===this.lastSearchTerm){const a=m.data;this.promotions=a.data,this.isLoadingPromotions=!1,this.hasLoadedInitialPromotions=!0}}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching promotions";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to fetch promotions:",r)}finally{this.isLoadingPromotions=!1}},onSelectPromotion(i){this.$refs.modal.hideModal(),this.orderState.addCartPromotionUsingPromotion(i)},addNew(){this.$refs.modal.hideModal(),this.orderState.addCartPromotion()}}},Io={class:"flex justify-center"},Vo={key:0,class:"flex justify-center items-center space-x-4 my-2"},jo={key:1,class:"space-y-2 mb-4"},Ao={class:"w-full space-y-2"},Eo={key:3,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function Ro(i,t,r,m,a,e){const d=c("Input"),y=c("Button"),_=c("Skeleton"),l=c("PromotionOptions"),h=c("Modal");return o(),n("div",Io,[u(h,{ref:"modal",onShow:e.onShow,triggerSize:"sm",leftTriggerIcon:a.Plus,contentClass:"px-4",triggerType:"light",header:"Add Promotion",scrollOnContent:!1,showApproveButton:!1,triggerText:"Add Promotion",triggerLoading:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},{content:k(()=>[a.hasLoadedInitialPromotions?(o(),n("div",Vo,[u(d,{type:"search",class:"w-full",debounced:!0,modelValue:a.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=v=>a.searchTerm=v),placeholder:"Search promotions",onInput:t[1]||(t[1]=v=>a.isLoadingPromotions=!0),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),u(y,{size:"xs",type:"light",action:e.addNew,leftIcon:a.Plus,buttonClass:"my-2"},{default:k(()=>t[2]||(t[2]=[s("span",null,"Add New",-1)])),_:1,__:[2]},8,["action","leftIcon"])])):f("",!0),a.isLoadingPromotions?(o(),n("div",jo,[(o(),n(S,null,C([1,2,3],(v,w)=>s("div",{key:w,class:"flex items-center space-x-2 border-b border-gray-300 shadow-sm rounded-lg p-2 bg-gray-50 w-full"},[u(_,{width:"w-10",height:"h-10",rounded:"rounded-lg",shine:!0,class:"flex-shrink-0"}),s("div",Ao,[u(_,{width:"w-2/3",shine:!0}),u(_,{width:"w-1/3",shine:!0})])])),64))])):e.hasPromotions?(o(),g(l,{key:2,promotions:a.promotions,onSelectPromotion:e.onSelectPromotion},null,8,["promotions","onSelectPromotion"])):(o(),n("p",Eo," No promotions found "))]),_:1},8,["onShow","leftTriggerIcon","triggerLoading"])])}const Bo=b(To,[["render",Ro]]),No={inject:["storeState","orderState"],components:{Skeleton:D,AddPromotion:Bo,OrderPromotion:wo},computed:{hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},cartPromotions(){return this.orderState.orderForm.cart_promotions},isEditting(){return this.$route.name==="edit-order"},hasCartPromotions(){return this.cartPromotions.length>0}}},Uo={class:"bg-white rounded-lg p-4 shadow-sm"},qo={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},Zo={class:"w-full space-y-4"},zo={key:1,class:"space-y-4"};function Wo(i,t,r,m,a,e){const d=c("Skeleton"),y=c("OrderPromotion"),_=c("AddPromotion");return o(),n("div",Uo,[t[3]||(t[3]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Promotions",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",qo,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.99 14.993 6-6m6 3.001c0 1.268-.63 2.39-1.593 3.069a3.746 3.746 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043 3.745 3.745 0 0 1-3.068 1.593c-1.268 0-2.39-.63-3.068-1.593a3.745 3.745 0 0 1-3.296-1.043 3.746 3.746 0 0 1-1.043-3.297 3.746 3.746 0 0 1-1.593-3.068c0-1.268.63-2.39 1.593-3.068a3.746 3.746 0 0 1 1.043-3.297 3.745 3.745 0 0 1 3.296-1.042 3.745 3.745 0 0 1 3.068-1.594c1.268 0 2.39.63 3.068 1.593a3.745 3.745 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.297 3.746 3.746 0 0 1 1.593 3.068ZM9.74 9.743h.008v.007H9.74v-.007Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm4.125 4.5h.008v.008h-.008v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])],-1)),s("div",Zo,[u(d,{width:"w-full",shine:!0}),u(d,{width:"w-1/3",shine:!0})])])):(o(),n("div",zo,[e.hasCartPromotions?(o(!0),n(S,{key:0},C(e.cartPromotions,(l,h)=>(o(),g(y,{key:h,index:h,cartPromotion:l},null,8,["index","cartPromotion"]))),128)):f("",!0),s("div",{class:F([{"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4":!e.hasCartPromotions}])},[e.hasCartPromotions?f("",!0):(o(),n(S,{key:0},[t[1]||(t[1]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.99 14.993 6-6m6 3.001c0 1.268-.63 2.39-1.593 3.069a3.746 3.746 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043 3.745 3.745 0 0 1-3.068 1.593c-1.268 0-2.39-.63-3.068-1.593a3.745 3.745 0 0 1-3.296-1.043 3.746 3.746 0 0 1-1.043-3.297 3.746 3.746 0 0 1-1.593-3.068c0-1.268.63-2.39 1.593-3.068a3.746 3.746 0 0 1 1.043-3.297 3.745 3.745 0 0 1 3.296-1.042 3.745 3.745 0 0 1 3.068-1.594c1.268 0 2.39.63 3.068 1.593a3.745 3.745 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.297 3.746 3.746 0 0 1 1.593 3.068ZM9.74 9.743h.008v.007H9.74v-.007Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm4.125 4.5h.008v.008h-.008v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})],-1)),t[2]||(t[2]=s("span",{class:"text-sm text-gray-500"},"No promotions added",-1))],64)),u(_)],2)]))])}const Ho=b(No,[["render",Wo]]),Yo={inject:["formState","storeState","orderState"],components:{Input:M,Skeleton:D},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isEditting(){return this.$route.name==="edit-order"},orderForm(){return this.orderState.orderForm},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder}}},Go={class:"bg-white rounded-lg p-4 shadow-sm"},Qo={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},Xo={class:"w-full space-y-4"},Jo={key:1,class:"space-y-2"};function Ko(i,t,r,m,a,e){const d=c("Skeleton"),y=c("Input");return o(),n("div",Go,[t[5]||(t[5]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Other",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",Qo,[t[4]||(t[4]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])],-1)),s("div",Xo,[u(d,{width:"w-full",shine:!0}),u(d,{width:"w-1/3",shine:!0})])])):(o(),n("div",Jo,[u(y,{rows:"2",label:"Remark",type:"textarea",placeholder:"Optional",modelValue:e.orderForm.remark,"onUpdate:modelValue":t[0]||(t[0]=_=>e.orderForm.remark=_),description:"Visible to customers",errorText:e.formState.getFormError("remark"),onChange:t[1]||(t[1]=_=>e.orderState.saveStateDebounced("Remark changed")),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,tooltipContent:"Use the Remark field to add a note that will be visible to the customer, such as special instructions, order details, or personalized messages."},null,8,["modelValue","errorText","skeleton"]),u(y,{type:"money",label:"Adjustment",allowNegativeAmounts:!0,currency:e.store.currency.code,modelValue:e.orderForm.adjustment,"onUpdate:modelValue":t[2]||(t[2]=_=>e.orderForm.adjustment=_),errorText:e.formState.getFormError("adjustment"),onChange:t[3]||(t[3]=_=>e.orderState.saveStateDebounced("Adjustment changed")),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,description:"Modify the order total by adding or subtracting an arbitrary amount",tooltipContent:"Use the Adjustment field to manually add or subtract an amount for discounts, extra charges, or price corrections."},null,8,["currency","modelValue","errorText","skeleton"])]))])}const $o=b(Yo,[["render",Ko]]),es={inject:["orderState"],components:{AddressInput:Be},computed:{orderForm(){return this.orderState.orderForm}},methods:{setAddress(i){this.orderState.orderForm.delivery_address=i,this.orderState.saveStateDebounced("Delivery address changed")},unsetAddress(){this.orderState.orderForm.delivery_address=null,this.orderState.saveStateDebounced("Delivery address removed")}}},ts={class:"space-y-4 p-4"};function rs(i,t,r,m,a,e){const d=c("AddressInput");return o(),n("div",ts,[u(d,{title:"Destination",onlyValidate:!0,pinLocationOnMap:!0,onOnDeleted:e.unsetAddress,onOnValidated:e.setAddress,address:e.orderForm.delivery_address,subtitle:"Add the address to deliver this order"},null,8,["onOnDeleted","onOnValidated","address"])])}const os=b(es,[["render",rs]]),ss={inject:["formState","storeState","notificationState"],components:{Skeleton:D,Datepicker:Ue,ShineEffect:ve},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object},showAllDates:{type:Boolean,default:!1}},emits:["update:modelValue","isLoading","change","scheduleOptions"],data(){return{minDate:null,maxDate:null,isLoading:!1,disabledDates:[],apiRequestCounter:0,disabledWeekDays:[],debounceInstance:null,localModelValue:this.modelValue}},watch:{modelValue(i){this.localModelValue=i},localModelValue(i){this.$emit("update:modelValue",i)},...["schedule_type","daily_order_limit","same_day_delivery","set_daily_order_limit","time_slot_interval_unit","auto_generate_time_slots","time_slot_interval_value","latest_delivery_time_value","earliest_delivery_time_unit","earliest_delivery_time_value","require_minimum_notice_for_orders","restrict_maximum_notice_for_orders"].reduce((i,t)=>(i[`form.${t}`]=function(){this.debouncedShowDeliveryMethodScheduleOptions()},i),{}),"form.operational_hours":{handler(){this.debouncedShowDeliveryMethodScheduleOptions()},deep:!0}},computed:{key(){return this.minDate+this.maxDate+this.showAllDates+this.disabledDates.length+this.disabledWeekDays.length},store(){return this.storeState.store}},methods:{formattedDate:De,setIsLoading(i){this.isLoading=i,this.$emit("isLoading",i)},parseForm(){return{store_id:this.store.id,schedule_type:this.form?this.form.schedule_type:this.deliveryMethod.schedule_type,daily_order_limit:this.form?this.form.daily_order_limit:this.deliveryMethod.daily_order_limit,same_day_delivery:this.form?this.form.same_day_delivery:this.deliveryMethod.same_day_delivery,operational_hours:this.form?this.form.operational_hours:this.deliveryMethod.operational_hours,set_daily_order_limit:this.form?this.form.set_daily_order_limit:this.deliveryMethod.set_daily_order_limit,time_slot_interval_unit:this.form?this.form.time_slot_interval_unit:this.deliveryMethod.time_slot_interval_unit,auto_generate_time_slots:this.form?this.form.auto_generate_time_slots:this.deliveryMethod.auto_generate_time_slots,time_slot_interval_value:this.form?this.form.time_slot_interval_value:this.deliveryMethod.time_slot_interval_value,latest_delivery_time_value:this.form?this.form.latest_delivery_time_value:this.deliveryMethod.latest_delivery_time_value,earliest_delivery_time_unit:this.form?this.form.earliest_delivery_time_unit:this.deliveryMethod.earliest_delivery_time_unit,earliest_delivery_time_value:this.form?this.form.earliest_delivery_time_value:this.deliveryMethod.earliest_delivery_time_value,require_minimum_notice_for_orders:this.form?this.form.require_minimum_notice_for_orders:this.deliveryMethod.require_minimum_notice_for_orders,restrict_maximum_notice_for_orders:this.form?this.form.restrict_maximum_notice_for_orders:this.deliveryMethod.restrict_maximum_notice_for_orders}},async showDeliveryMethodScheduleOptions(){var i,t;try{const r=this.parseForm(),m=++this.apiRequestCounter,a=await axios.post("/api/delivery-methods/schedule-options",r);if(m!==this.apiRequestCounter)return;const e=a.data;this.minDate=this.formattedDate(e.min_date),this.disabledWeekDays=e.days_of_week_disabled,this.disabledDates=e.dates_disabled.map(d=>this.formattedDate(d)),this.maxDate=e.max_date?this.formattedDate(e.max_date):null,this.$emit("scheduleOptions",e)}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching schedule options";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to fetch schedule options:",r)}finally{this.setIsLoading(!1)}},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.debounceInstance=re(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},ns={class:"flex items-center space-x-2"};function is(i,t,r,m,a,e){const d=c("Skeleton"),y=c("ShineEffect"),_=c("Datepicker");return o(),n("div",null,[a.isLoading?(o(),g(y,{key:0},{default:k(()=>[s("div",ns,[t[2]||(t[2]=s("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})],-1)),u(d,{width:"w-1/2"})])]),_:1})):(o(),g(_,{key:e.key,modelValue:a.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=l=>a.localModelValue=l),placeholder:"Select delivery date",minDate:r.showAllDates?null:a.minDate,maxDate:r.showAllDates?null:a.maxDate,onChange:t[1]||(t[1]=l=>i.$emit("change",l)),disabledDates:r.showAllDates?[]:a.disabledDates,disabledWeekDays:r.showAllDates?[]:a.disabledWeekDays},null,8,["modelValue","minDate","maxDate","disabledDates","disabledWeekDays"]))])}const as=b(ss,[["render",is]]),ds={inject:["formState","storeState","notificationState"],components:{Select:q,Skeleton:D,ShineEffect:ve},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object},deliveryDate:{type:String},showAllDates:{type:Boolean,default:!1},showAllTimeslots:{type:Boolean,default:!1},autoSelectFirstTimeslot:{type:Boolean,value:!0}},emits:["update:modelValue","isLoading","change","scheduleOptions"],data(){return{isLoading:!1,apiRequestCounter:0,debounceInstance:null,availableTimeSlotOptions:[],localModelValue:this.modelValue}},watch:{modelValue(i){this.localModelValue=i},localModelValue(i){this.$emit("update:modelValue",i),this.$emit("change",i)},deliveryDate(i){i&&this.debouncedShowDeliveryMethodScheduleOptions()}},computed:{store(){return this.storeState.store}},methods:{setIsLoading(i){this.isLoading=i,this.$emit("isLoading",i)},parseForm(){return{store_id:this.store.id,show_all_dates:this.showAllDates,show_all_timeslots:this.showAllTimeslots,delivery_date:Pe(this.deliveryDate).format("YYYY-MM-DD"),schedule_type:this.form?this.form.schedule_type:this.deliveryMethod.schedule_type,daily_order_limit:this.form?this.form.daily_order_limit:this.deliveryMethod.daily_order_limit,same_day_delivery:this.form?this.form.same_day_delivery:this.deliveryMethod.same_day_delivery,operational_hours:this.form?this.form.operational_hours:this.deliveryMethod.operational_hours,set_daily_order_limit:this.form?this.form.set_daily_order_limit:this.deliveryMethod.set_daily_order_limit,time_slot_interval_unit:this.form?this.form.time_slot_interval_unit:this.deliveryMethod.time_slot_interval_unit,auto_generate_time_slots:this.form?this.form.auto_generate_time_slots:this.deliveryMethod.auto_generate_time_slots,time_slot_interval_value:this.form?this.form.time_slot_interval_value:this.deliveryMethod.time_slot_interval_value,latest_delivery_time_value:this.form?this.form.latest_delivery_time_value:this.deliveryMethod.latest_delivery_time_value,earliest_delivery_time_unit:this.form?this.form.earliest_delivery_time_unit:this.deliveryMethod.earliest_delivery_time_unit,earliest_delivery_time_value:this.form?this.form.earliest_delivery_time_value:this.deliveryMethod.earliest_delivery_time_value,require_minimum_notice_for_orders:this.form?this.form.require_minimum_notice_for_orders:this.deliveryMethod.require_minimum_notice_for_orders,restrict_maximum_notice_for_orders:this.form?this.form.restrict_maximum_notice_for_orders:this.deliveryMethod.restrict_maximum_notice_for_orders}},async showDeliveryMethodScheduleOptions(){var i,t;try{const r=this.parseForm(),m=++this.apiRequestCounter,a=await axios.post("/api/delivery-methods/schedule-options",r);if(m!==this.apiRequestCounter)return;const e=a.data,d=e.available_time_slots;this.autoSelectFirstTimeslot&&d.length&&!d.includes(this.localModelValue)&&(this.localModelValue=d[0]),this.availableTimeSlotOptions=d.map(function(y){return{label:y,value:y}}),this.$emit("scheduleOptions",e)}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching schedule options";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to fetch schedule options:",r)}finally{this.setIsLoading(!1)}},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.availableTimeSlotOptions=[],this.debounceInstance=re(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},ls={class:"flex items-center space-x-2"};function us(i,t,r,m,a,e){const d=c("Skeleton"),y=c("ShineEffect"),_=c("Select");return o(),n("div",null,[a.isLoading?(o(),g(y,{key:0},{default:k(()=>[s("div",ls,[t[1]||(t[1]=s("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1)),u(d,{width:"w-1/2"})])]),_:1})):(o(),g(_,{key:1,class:"w-full",search:!1,modelValue:a.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=l=>a.localModelValue=l),noResultsText:"No timeslots found",placeholder:"Select delivery time",options:a.availableTimeSlotOptions},null,8,["modelValue","options"]))])}const cs=b(ds,[["render",us]]),ms={inject:["orderState"],components:{Alert:Ne,Input:M,Switch:$,Skeleton:D,DeliveryDatePicker:as,DeliveryTimePicker:cs},props:{index:{type:Number},deliveryMethod:{type:Object}},data(){return{originalDeliveryDate:null,isLoadingDateOptions:!1,originalDeliveryTimeslot:null,originalDeliveryDateIsPast:!1}},watch:{"orderForm.schedule.change_delivery_schedule"(i){i?this.originalDeliveryDateIsPast&&!this.orderForm.schedule.show_all_dates&&(this.orderForm.delivery_date=null,this.orderForm.delivery_timeslot=null):(this.orderForm.delivery_date=this.originalDeliveryDate,this.orderForm.delivery_timeslot=this.originalDeliveryTimeslot)},"orderForm.schedule.show_all_dates"(i){i?(this.orderForm.delivery_date=this.originalDeliveryDate,this.orderForm.delivery_timeslot=this.originalDeliveryTimeslot):this.originalDeliveryDateIsPast&&(this.orderForm.delivery_date=null,this.orderForm.delivery_timeslot=null),this.orderForm.schedule.show_all_timeslots=i}},computed:{isCreating(){return this.$route.name==="create-order"},shoppingCart(){return this.orderState.shoppingCart},orderForm(){return this.orderState.orderForm},isInspectingShoppingCart(){return this.orderState.isInspectingShoppingCart},deliveryDateIsPast(){return this.orderForm.delivery_date&&ae(this.orderForm.delivery_date)},shoppingCartDeliveryMethodOption(){return((this.shoppingCart||{}).delivery_method_options||[]).find(i=>i.id==this.deliveryMethod.id)},shoppingCartDeliveryMethodRequiresSchedule(){return(this.shoppingCartDeliveryMethodOption||{}).schedule_is_required||!1},shoppingCartDeliveryMethodScheduleIncompleteReasons(){return(this.shoppingCartDeliveryMethodOption||{}).schedule_incomplete_reasons||[]}},methods:{formattedShortWeekday:Oe,onIsLoadingDateOptions(i){this.isLoadingDateOptions=i}},created(){this.originalDeliveryDate=this.orderForm.delivery_date,this.originalDeliveryTimeslot=this.orderForm.delivery_timeslot,this.originalDeliveryDateIsPast=this.originalDeliveryDate&&ae(this.originalDeliveryDate)}},hs={key:0,class:"space-y-4 pt-4 px-4"},_s={class:"space-y-2"},ys={class:"text-sm text-gray-500"},gs={key:0,class:"space-y-2"},ps={class:"flex items-center space-x-4"},fs={key:1,class:"flex items-center space-x-1 md:space-x-2"},vs={class:"font-medium text-red-500 text-xs md:text-sm"},Ss={key:2,class:"space-y-2 border-t border-b border-dashed border-gray-300 py-4"},ws={key:0,class:"text-sm"},bs={class:"font-bold"},xs={key:1,class:"text-sm"},ks={class:"font-bold"};function Cs(i,t,r,m,a,e){const d=c("Switch"),y=c("Input"),_=c("Alert"),l=c("DeliveryDatePicker"),h=c("DeliveryTimePicker"),v=c("Skeleton");return e.shoppingCartDeliveryMethodRequiresSchedule?(o(),n("div",hs,[s("div",_s,[t[8]||(t[8]=s("p",{class:"font-bold text-md"},"Schedule",-1)),s("div",null,[s("p",ys,[r.deliveryMethod.schedule_type=="date"?(o(),n(S,{key:0},[e.isCreating?(o(),n(S,{key:0},[I("Specify the delivery date for this order")],64)):(o(),n(S,{key:1},[I("The delivery date for this order")],64))],64)):r.deliveryMethod.schedule_type=="date and time"?(o(),n(S,{key:1},[e.isCreating?(o(),n(S,{key:0},[I("Specify the delivery date and time for this order")],64)):(o(),n(S,{key:1},[I("The delivery date and time for this order")],64))],64)):f("",!0)])])]),a.originalDeliveryDate?(o(),n("div",gs,[s("div",ps,[u(d,{size:"xs",suffixText:"Change delivery schedule",modelValue:e.orderForm.schedule.change_delivery_schedule,"onUpdate:modelValue":t[0]||(t[0]=w=>e.orderForm.schedule.change_delivery_schedule=w),onChange:t[1]||(t[1]=w=>e.orderState.saveStateDebounced(`Change delivery schedule (${e.orderForm.schedule.change_delivery_schedule?"On":"Off"})`))},null,8,["modelValue"]),e.orderForm.schedule.change_delivery_schedule?(o(),g(y,{key:0,type:"checkbox",modelValue:e.orderForm.schedule.show_all_dates,"onUpdate:modelValue":t[2]||(t[2]=w=>e.orderForm.schedule.show_all_dates=w),inputLabel:r.deliveryMethod.schedule_type=="date"?"Show all dates":"Show all dates and timeslots",onChange:t[3]||(t[3]=w=>e.orderState.saveStateDebounced(`Show all ${r.deliveryMethod.schedule_type=="date"?"dates":"dates and timeslots"} (${e.orderForm.schedule.show_all_dates?"On":"Off"})`))},null,8,["modelValue","inputLabel"])):f("",!0)]),e.orderForm.schedule.change_delivery_schedule&&e.deliveryDateIsPast?(o(),g(_,{key:0,type:"warning",dismissable:!0,title:"Delivery date passed",description:"Update the delivery date to a future date if the order hasnt been delivered, otherwise ignore this message."})):f("",!0)])):f("",!0),!a.originalDeliveryDate||a.originalDeliveryDate&&e.orderForm.schedule.change_delivery_schedule?(o(),n(S,{key:1},[u(l,{deliveryMethod:r.deliveryMethod,onIsLoading:e.onIsLoadingDateOptions,modelValue:e.orderForm.delivery_date,"onUpdate:modelValue":t[4]||(t[4]=w=>e.orderForm.delivery_date=w),showAllDates:e.orderForm.schedule.show_all_dates,onChange:t[5]||(t[5]=w=>this.orderState.saveStateDebounced("Delivery date changed"))},null,8,["deliveryMethod","onIsLoading","modelValue","showAllDates"]),e.orderForm.delivery_date&&!a.isLoadingDateOptions&&r.deliveryMethod.schedule_type=="date and time"?(o(),g(h,{key:0,class:"w-full",deliveryMethod:r.deliveryMethod,autoSelectFirstTimeslot:e.isCreating,modelValue:e.orderForm.delivery_timeslot,"onUpdate:modelValue":t[6]||(t[6]=w=>e.orderForm.delivery_timeslot=w),deliveryDate:e.orderForm.delivery_date,showAllDates:e.orderForm.schedule.show_all_dates,showAllTimeslots:e.orderForm.schedule.show_all_timeslots,onChange:t[7]||(t[7]=w=>this.orderState.saveStateDebounced("Delivery time changed"))},null,8,["deliveryMethod","autoSelectFirstTimeslot","modelValue","deliveryDate","showAllDates","showAllTimeslots"])):f("",!0),(o(!0),n(S,null,C(e.shoppingCartDeliveryMethodScheduleIncompleteReasons,(w,P)=>(o(),n("div",{key:P},[e.isInspectingShoppingCart?(o(),g(v,{key:0,width:"w-1/3",shine:!0})):(o(),n("div",fs,[t[9]||(t[9]=s("svg",{class:"w-4 h-4 md:w-6 md:h-6 flex-shrink-0 text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})],-1)),s("span",vs,p(w),1)]))]))),128))],64)):f("",!0),e.orderForm.delivery_date||e.orderForm.delivery_timeslot?(o(),n("div",Ss,[e.orderForm.delivery_date?(o(),n("div",ws,[t[10]||(t[10]=s("span",null,"Delivery date: ",-1)),s("span",bs,p(e.orderForm.delivery_date)+" ("+p(e.formattedShortWeekday(e.orderForm.delivery_date))+") ",1)])):f("",!0),e.orderForm.delivery_timeslot?(o(),n("div",xs,[t[11]||(t[11]=s("span",null,"Delivery time: ",-1)),s("span",ks,p(e.orderForm.delivery_timeslot),1)])):f("",!0)])):f("",!0)])):f("",!0)}const Ds=b(ms,[["render",Cs]]),Ps={inject:["orderState"],components:{Info:qe,CircleAlert:Ae,Skeleton:D,OrderDeliveryMethodMap:os,OrderDeliveryMethodSchedule:Ds},props:{index:{type:Number},deliveryMethod:{type:Object}},computed:{shoppingCart(){return this.orderState.shoppingCart},orderForm(){return this.orderState.orderForm},isInspectingShoppingCart(){return this.orderState.isInspectingShoppingCart},usesFlatFee(){return this.deliveryMethod.fee_type=="flat fee"},usesPercentageFee(){return this.deliveryMethod.fee_type=="percentage fee"},usesFeeByWeight(){return this.deliveryMethod.fee_type=="fee by weight"},usesFeeByDistance(){return this.deliveryMethod.fee_type=="fee by distance"},usesFeeByPostalCode(){return this.deliveryMethod.fee_type=="fee by postal code"},isSelectedDeliveryMethod(){return this.orderForm.delivery_method_id===this.deliveryMethod.id},shoppingCartDeliveryMethodOption(){return((this.shoppingCart||{}).delivery_method_options||[]).find(i=>i.id==this.deliveryMethod.id)},shoppingCartDeliveryMethodAmount(){return(this.shoppingCartDeliveryMethodOption||{}).amount},shoppingCartDeliveryMethodOffersFreeDelivery(){return(this.shoppingCartDeliveryMethodOption||{}).free_delivery},shoppingCartDeliveryMethodTips(){return(this.shoppingCartDeliveryMethodOption||{}).tips||[]},hasShoppingCartDeliveryMethodTips(){return this.shoppingCartDeliveryMethodTips.length>0},shoppingCartDeliveryMethodUnavailabilityReasons(){return(this.shoppingCartDeliveryMethodOption||{}).unavailability_reasons||[]},hasShoppingCartDeliveryMethodUnavailabilityReasons(){return this.shoppingCartDeliveryMethodUnavailabilityReasons.length>0}},methods:{selectDeliveryMethod(){this.orderForm.delivery_method_id=this.deliveryMethod.id,this.orderState.saveStateDebounced("Delivery method changed")}}},Os={class:"flex items-center space-x-2"},Ms={key:0,class:"w-6 h-6 text-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},Fs={key:1,class:"w-6 h-6 flex justify-center items-center"},Ls={class:"w-full"},Ts={class:"font-bold text-sm transition-colors"},Is={class:"text-sm transition-colors"},Vs={key:0,class:"text-sm transition-colors text-green-500 font-bold"},js={key:1,class:"text-sm transition-colors"},As={key:2,class:"text-sm transition-colors"},Es={key:3,class:"text-sm transition-colors"},Rs={key:4,class:"text-sm transition-colors"},Bs={key:5,class:"text-sm transition-colors"},Ns={key:1,class:"bg-red-50 mt-2 p-4"},Us={key:1,class:"flex items-center space-x-1 md:space-x-2"},qs={key:2,class:"bg-blue-50 mt-2 p-4"},Zs={key:1,class:"flex items-center space-x-1 md:space-x-2"},zs={class:"font-medium italic text-xs md:text-sm text-blue-500"};function Ws(i,t,r,m,a,e){const d=c("Skeleton"),y=c("Info"),_=c("OrderDeliveryMethodSchedule"),l=c("OrderDeliveryMethodMap");return o(),n("div",{onClick:t[0]||(t[0]=ge((...h)=>e.selectDeliveryMethod&&e.selectDeliveryMethod(...h),["stop"])),class:"cursor-pointer p-4 bg-gray-50 border border-gray-300 rounded-lg transition-colors group"},[s("div",Os,[u(ye,{name:"fade-1",mode:"out-in"},{default:k(()=>[e.isSelectedDeliveryMethod?(o(),n("svg",Ms,t[1]||(t[1]=[s("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"},null,-1)]))):(o(),n("div",Fs,t[2]||(t[2]=[s("div",{class:"w-4 h-4 bg-gray-100 border border-gray-300 rounded-full"},null,-1)])))]),_:1}),s("div",Ls,[s("p",Ts,p(r.deliveryMethod.name),1),s("p",Is,p(r.deliveryMethod.description),1),r.deliveryMethod.charge_fee&&(e.shoppingCartDeliveryMethodOffersFreeDelivery||e.shoppingCartDeliveryMethodAmount)?(o(),n(S,{key:0},[e.shoppingCartDeliveryMethodOffersFreeDelivery?(o(),n("p",Vs," Free delivery ")):e.usesFlatFee?(o(),n("p",js," Flat fee of "+p(e.shoppingCartDeliveryMethodAmount.amount_with_currency),1)):e.usesPercentageFee?(o(),n("p",As," Percentage fee of "+p(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+p(r.deliveryMethod.percentage_fee_rate)+"%) ",1)):e.usesFeeByWeight?(o(),n("p",Es," Weight fee of "+p(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+p(e.shoppingCartDeliveryMethodOption.weight.text)+") ",1)):e.usesFeeByDistance?(o(),n("p",Rs," Distance fee of "+p(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+p(e.shoppingCartDeliveryMethodOption.distance.text)+") ",1)):e.usesFeeByPostalCode?(o(),n("p",Bs," Distance fee of "+p(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+p(e.shoppingCartDeliveryMethodOption.distance.text)+") ",1)):f("",!0)],64)):f("",!0),e.hasShoppingCartDeliveryMethodUnavailabilityReasons?(o(),n("div",Ns,[(o(!0),n(S,null,C(e.shoppingCartDeliveryMethodUnavailabilityReasons,(h,v)=>(o(),n("div",{key:v},[e.isInspectingShoppingCart?(o(),g(d,{key:0,width:"w-1/3",shine:!0})):(o(),n("div",Us,[u(y,{size:"16",class:F(["flex-shrink-0",e.isSelectedDeliveryMethod?"text-red-500":"text-blue-500"])},null,8,["class"]),s("span",{class:F(["font-medium italic text-xs md:text-sm",e.isSelectedDeliveryMethod?"text-red-500":"text-blue-500"])},p(h),3)]))]))),128))])):f("",!0),e.hasShoppingCartDeliveryMethodTips&&!e.hasShoppingCartDeliveryMethodUnavailabilityReasons?(o(),n("div",qs,[(o(!0),n(S,null,C(e.shoppingCartDeliveryMethodTips,(h,v)=>(o(),n("div",{key:v},[e.isInspectingShoppingCart?(o(),g(d,{key:0,width:"w-1/3",shine:!0})):(o(),n("div",Zs,[u(y,{size:"16",class:"flex-shrink-0 text-blue-500"}),s("span",zs,p(h),1)]))]))),128))])):f("",!0)])]),e.isSelectedDeliveryMethod?(o(),n(S,{key:0},[u(_,{deliveryMethod:r.deliveryMethod},null,8,["deliveryMethod"]),u(l)],64)):f("",!0)])}const Hs=b(Ps,[["render",Ws]]),Ys={inject:["orderState"],computed:{isSelectedDeliveryMethod(){return this.orderState.orderForm.delivery_method_id===null}},methods:{unselectDeliveryMethod(){this.orderState.orderForm.delivery_method_id=null,this.orderState.saveStateDebounced("Delivery method removed")}}},Gs={class:"flex items-center space-x-2"},Qs={key:0,class:"w-6 h-6 text-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},Xs={key:1,class:"w-6 h-6 flex justify-center items-center"};function Js(i,t,r,m,a,e){return o(),n("div",{onClick:t[0]||(t[0]=ge((...d)=>e.unselectDeliveryMethod&&e.unselectDeliveryMethod(...d),["stop"])),class:"flex justify-between items-center cursor-pointer p-4 bg-gray-50 border border-gray-300 rounded-lg transition-colors group"},[s("div",Gs,[u(ye,{name:"fade-1",mode:"out-in"},{default:k(()=>[e.isSelectedDeliveryMethod?(o(),n("svg",Qs,t[1]||(t[1]=[s("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"},null,-1)]))):(o(),n("div",Xs,t[2]||(t[2]=[s("div",{class:"w-4 h-4 bg-gray-100 border border-gray-300 rounded-full"},null,-1)])))]),_:1}),t[3]||(t[3]=s("div",null,[s("p",{class:"font-bold text-sm transition-colors"}," None "),s("p",{class:"text-sm transition-colors"}," No delivery method specified ")],-1))])])}const Ks=b(Ys,[["render",Js]]),$s={inject:["formState","storeState","orderState","notificationState"],components:{Skeleton:D,OrderDeliveryMethod:Hs,OrderNoneDeliveryMethod:Ks},data(){return{pagination:null,deliveryMethods:[],isLoadingDeliveryMethods:!1}},watch:{store(i,t){!t&&i&&this.showDeliveryMethods()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},orderForm(){return this.orderState.orderForm},isEditting(){return this.$route.name==="edit-order"},hasDeliveryMethods(){return this.deliveryMethods.length>0},deliveryMethod(){return this.deliveryMethods.find(i=>i.id==this.orderForm.delivery_method_id)}},methods:{async showDeliveryMethods(){var i,t;try{this.isLoadingDeliveryMethods=!0;let r={params:{store_id:this.store.id}};const m=await B.get("/api/delivery-methods",r);this.pagination=m.data,this.deliveryMethods=this.pagination.data}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching delivery methods";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to fetch delivery methods:",r)}finally{this.isLoadingDeliveryMethods=!1}}}},en={class:"bg-white rounded-lg p-4 shadow-sm"},tn={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},rn={class:"w-full space-y-4"},on={key:1,class:"space-y-2"},sn={key:1,class:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4 my-4"};function nn(i,t,r,m,a,e){const d=c("Skeleton"),y=c("OrderNoneDeliveryMethod"),_=c("OrderDeliveryMethod");return o(),n("div",en,[t[3]||(t[3]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Delivery Method",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),n("div",tn,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})])],-1)),s("div",rn,[u(d,{width:"w-full",shine:!0}),u(d,{width:"w-1/3",shine:!0})])])):(o(),n("div",on,[e.hasDeliveryMethods?(o(),n(S,{key:0},[u(y),(o(!0),n(S,null,C(a.deliveryMethods,(l,h)=>(o(),g(_,{key:h,index:h,deliveryMethod:l},null,8,["index","deliveryMethod"]))),128))],64)):(o(),n("div",sn,[e.hasDeliveryMethods?f("",!0):(o(),n(S,{key:0},[t[1]||(t[1]=s("svg",{class:"w-10 h-10 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"})],-1)),t[2]||(t[2]=s("span",{class:"text-sm text-gray-500"},"No delivery methods",-1))],64))]))]))])}const an=b($s,[["render",nn]]),dn={inject:["formState","orderState","storeState","changeHistoryState","notificationState"],components:{OrderFees:ct,OrderBasics:pt,OrderTotals:Zt,OrderCustomer:_r,OrderProducts:_o,OrderPromotions:Ho,OrderMiscellaneous:$o,OrderDeliveryMethods:an},data(){return{guestId:Me(),shoppingCartReady:!1}},watch:{orderForm:{handler(i){i&&(this.shoppingCartReady?(this.orderState.setIsInspectingShoppingCart(!0),this.inspectShoppingCartDelayed()):this.shoppingCartReady=!0)},deep:!0}},computed:{store(){return this.storeState.store},orderForm(){return this.orderState.orderForm},isEditing(){return this.$route.name==="edit-order"},isCreating(){return this.$route.name==="create-order"}},methods:{inspectShoppingCartDelayed:re(function(){this.changeHistoryState.hasChanges?this.inspectShoppingCart():(this.orderState.setShoppingCart(null),this.orderState.setIsInspectingShoppingCart(!1))},1e3),async inspectShoppingCart(){var i,t;try{this.orderState.setIsInspectingShoppingCart(!0);const r={inspect:!0,...this.orderForm,guest_id:this.guestId,store_id:this.store.id,association:"team member"},m=await axios.post("/api/orders",r);this.orderState.setShoppingCart(m.data)}catch(r){const m=((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while inspecting shopping cart";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(r),console.error("Failed to inspect shopping cart:",r)}finally{this.orderState.setIsInspectingShoppingCart(!1)}}}},ln={class:"select-none grid grid-cols-12 gap-4 mb-40"},un={class:"col-span-8 space-y-4"},cn={class:"col-span-4 space-y-4"};function mn(i,t,r,m,a,e){const d=c("OrderProducts"),y=c("OrderPromotions"),_=c("OrderFees"),l=c("OrderDeliveryMethods"),h=c("OrderMiscellaneous"),v=c("OrderTotals"),w=c("OrderCustomer"),P=c("OrderBasics");return o(),n("div",ln,[s("div",un,[u(d),u(y),u(_),u(l),u(h),u(v)]),s("div",cn,[u(w),u(P)])])}const Nn=b(dn,[["render",mn]]);export{Nn as default};
