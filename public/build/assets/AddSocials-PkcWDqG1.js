import{i as V}from"./isEqual-D_8aNiOR.js";import{I as E}from"./Input-CE4RPfme.js";import{c as S}from"./cloneDeep-CRZrXCcn.js";import{B as I}from"./Button-gD2nuYEJ.js";import{S as C}from"./Switch-Bn46wuTp.js";import{S as z}from"./Skeleton-caFmp0IF.js";import{S as F}from"./StoreLogo-Df2VlIwX.js";import{c as r,b as o,a as d,r as m,F as g,f as p,e as k,i as T,t as u,n as B,g as _,T as N,o as a,d as b}from"./app-DzEmJHii.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as R}from"./createLucideIcon-B1C9m8SV.js";import{I as U}from"./info-P1D1b4JP.js";import{M as H}from"./move-right-dsRLGEJ0.js";import"./Copy-BxvDy_-Q.js";import"./ShineEffect-7ISWLx82.js";import"./Popover-DanCA_pE.js";import"./Loader-BbY_PjoY.js";import"./plus-9ZeBx_gh.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=R("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),Z={inject:["formState","storeState","notificationState"],components:{Info:U,Input:E,AtSign:Y,Button:I,Switch:C,Skeleton:z,StoreLogo:F},data(){return{MoveRight:H,socialMediaLinks:[],isSubmittingStore:!1,storeSocialMediaLinks:[],isLoadingSocialMediaIcons:!1,originalStoreSocialMediaLinks:[]}},computed:{store(){return this.storeState.store},hasActiveStoreSocialMediaLinks(){return this.storeSocialMediaLinks.some(t=>t.active)},totalActiveStoreSocialMediaLinks(){return this.storeSocialMediaLinks.filter(t=>t.active).length},storeSocialMediaLinksHaveChanged(){var t=S(this.storeSocialMediaLinks),i=S(this.originalStoreSocialMediaLinks);return!V(t,i)},storeSocialMediaLinkValidationErrors(){return this.storeSocialMediaLinks.filter(t=>t.active).map(t=>{const i=new RegExp("^(https?:\\/\\/)?([a-zA-Z0-9-]+\\.)?[a-zA-Z0-9-]+\\.[a-zA-Z]{2,6}(:[0-9]{1,5})?(\\/[^\\s]*)?$");let e="";return t.url.trim()===""?e=`The ${t.name} link is required`:i.test(t.url.trim())||(e=`The ${t.name} link is incorrect`),e?{name:t.name,message:e}:null}).filter(t=>t!==null)},hasStoreSocialMediaLinkValidationErrors(){return this.storeSocialMediaLinkValidationErrors.length>0}},methods:{hasMatchingSocialMediaLinkError(t){return this.storeSocialMediaLinkValidationErrors.some(i=>i.name==t)},getMatchingSocialMediaLinkError(t){const i=this.storeSocialMediaLinkValidationErrors.find(e=>e.name==t);return i?i.message:null},getMatchingSocialMediaIcon(t){return this.socialMediaLinks.find(i=>i.name.toLowerCase()===t.toLowerCase())},async showSocialMediaLinks(){var t,i;try{this.isLoadingSocialMediaIcons=!0;const e=await axios.get("/api/social-media-links");this.socialMediaLinks=e.data,this.storeSocialMediaLinks=S(this.socialMediaLinks.map(l=>{const c=this.store.social_media_links.find(s=>s.name.toLowerCase()==l.name.toLowerCase());return c||{url:"",active:!1,name:l.name}})),this.originalStoreSocialMediaLinks=S(this.storeSocialMediaLinks)}catch(e){const l=((i=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:i.message)||(e==null?void 0:e.message)||"Something went wrong while fetching social media links";this.notificationState.showWarningNotification(l),this.formState.setServerFormErrors(e),console.error("Failed to fetch social media links:",e)}finally{this.isLoadingSocialMediaIcons=!1}},async updateStore(){var t,i;try{this.isSubmittingStore=!0;const e=this.storeSocialMediaLinks.filter(c=>{var s;return((s=c.url)==null?void 0:s.trim())!=""});let l={social_media_links:e};await axios.put(`/api/stores/${this.store.id}`,l),this.storeState.setStore({...this.store,social_media_links:e}),this.notificationState.showSuccessNotification("Social media links updated"),this.originalStoreSocialMediaLinks=S(this.storeSocialMediaLinks),this.navigateToAddAdvancedFeatures()}catch(e){const l=((i=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:i.message)||(e==null?void 0:e.message)||"Something went wrong while updating social media links";this.notificationState.showWarningNotification(l),this.formState.setServerFormErrors(e),console.error("Failed to update social media links:",e)}finally{this.isSubmittingStore=!1}},navigateToAddAdvancedFeatures(){this.$router.push({name:"advanced-features",params:{store_id:this.store.id}})}},beforeRouteLeave(t,i,e){if((this.isSubmittingStore||this.storeSocialMediaLinksHaveChanged)&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return e(!1);e()},created(){this.showSocialMediaLinks()}},q={class:"min-h-screen flex flex-col items-center pt-20 pb-40"},D={class:"w-full max-w-lg"},W={class:"w-full max-w-lg"},G={class:"mb-4"},J={key:0,class:"space-y-2"},K={class:"w-full flex items-center space-x-2"},O={key:1,class:"space-y-3 mb-4"},P={class:"flex justify-between items-center"},Q={class:"flex items-center space-x-2 font-bold"},X={class:"w-8 h-8 rounded-full overflow-hidden flex items-center justify-center"},$=["src"],ee={class:"text-sm"},te={key:0,class:"w-full mt-4"},ie={key:0,class:"flex space-x-1 text-xs text-yellow-600 font-semibold bg-yellow-100 border border-yellow-300 p-3 rounded-lg shadow-md mt-2"},se={key:0,class:"list-disc text-xs text-yellow-600 bg-yellow-100 border border-yellow-300 py-3 px-4 rounded-lg shadow-md mb-4"},oe={class:"space-y-1"},ae={key:1,class:"text-blue-600 bg-blue-100 border border-blue-300 p-3 rounded-lg shadow-md mb-4"},ne={class:"flex items-center space-x-2"},re={key:0,class:"text-sm font-semibold"},le={class:"font-bold"},ce={class:"flex justify-end"};function de(t,i,e,l,c,s){const L=m("StoreLogo"),v=m("Skeleton"),M=m("Switch"),x=m("Input"),y=m("Info"),A=m("AtSign"),w=m("Button");return a(),r("div",q,[o("div",D,[d(L,{showButton:!1,class:"flex justify-center mb-4"}),i[0]||(i[0]=o("h2",{class:"text-2xl font-semibold text-center mb-2"},"Connect Your Socials",-1)),i[1]||(i[1]=o("p",{class:"text-gray-500 text-center mb-6"},"Make it easy for customers to find and follow you",-1))]),o("div",W,[o("div",G,[c.isLoadingSocialMediaIcons?(a(),r("div",J,[(a(),r(g,null,p([1,2,3],(n,h)=>o("div",{key:h,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[o("div",K,[d(v,{width:"w-8",shine:!0}),d(v,{width:"w-40",shine:!0})])])),64))])):(a(),r("div",O,[(a(!0),r(g,null,p(c.storeSocialMediaLinks,(n,h)=>(a(),r("div",{key:h,class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},[o("div",P,[o("div",Q,[o("div",X,[o("img",{alt:"Social Media Logo",class:"h-full object-contain",src:s.getMatchingSocialMediaIcon(n.name).icon.toLowerCase()},null,8,$)]),o("span",ee,u(n.name),1)]),d(M,{size:"md",modelValue:n.active,"onUpdate:modelValue":f=>n.active=f},null,8,["modelValue","onUpdate:modelValue"])]),n.active?(a(),r("div",te,[d(x,{placeholder:"https://",modelValue:n.url,"onUpdate:modelValue":f=>n.url=f,label:`${n.name} link`,errorText:s.formState.getFormError("storeSocialMediaLinks"+h+"Link")},null,8,["modelValue","onUpdate:modelValue","label","errorText"]),s.hasMatchingSocialMediaLinkError(n.name)?(a(),r("p",ie,[d(y,{size:"14",class:"shrink-0"}),o("span",null,u(s.getMatchingSocialMediaLinkError(n.name)),1)])):k("",!0)])):k("",!0)]))),128))]))]),s.hasStoreSocialMediaLinkValidationErrors?(a(),r("div",se,[i[2]||(i[2]=o("p",{class:"text-lg font-semibold mb-2"},"Resolve these to continue",-1)),o("ul",oe,[(a(!0),r(g,null,p(s.storeSocialMediaLinkValidationErrors,(n,h)=>(a(),r("li",{key:h},u(n.message),1))),128))])])):(a(),r("div",ae,[o("div",ne,[d(A,{size:"28",class:"shrink-0"}),o("div",null,[s.hasActiveStoreSocialMediaLinks?(a(),r("p",re,[T(u(s.store.name)+" supports ",1),o("span",le,u(s.totalActiveStoreSocialMediaLinks)+" "+u(s.totalActiveStoreSocialMediaLinks==1?"social platform":"social platforms"),1)])):k("",!0),o("p",{class:B([s.hasActiveStoreSocialMediaLinks?"text-xs":"text-sm font-semibold"])},"You can always "+u(s.hasActiveStoreSocialMediaLinks?"add more":"add")+" social links later! ðŸ˜Š",3)])])])),o("div",ce,[d(N,{name:"fade-1",mode:"out-in"},{default:_(()=>[s.storeSocialMediaLinksHaveChanged||s.hasActiveStoreSocialMediaLinks?(a(),b(w,{key:0,size:"md",type:"primary",buttonClass:"w-full",action:s.updateStore,loading:c.isSubmittingStore,disabled:c.isSubmittingStore||s.hasStoreSocialMediaLinkValidationErrors},{default:_(()=>i[3]||(i[3]=[o("span",null,"Continue",-1)])),_:1,__:[3]},8,["action","loading","disabled"])):(a(),b(w,{key:1,size:"md",type:"light",buttonClass:"w-40",rightIconSize:"24",rightIcon:c.MoveRight,action:s.navigateToAddAdvancedFeatures},{default:_(()=>i[4]||(i[4]=[o("span",null,"Skip",-1)])),_:1,__:[4]},8,["rightIcon","action"]))]),_:1})])])])}const Ve=j(Z,[["render",de]]);export{Ve as default};
