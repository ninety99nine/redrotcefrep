import{c,b as o,a as m,r as n,w as E,d as g,e as y,F as k,f as v,t as u,g as p,h as F,o as l,i as h}from"./app-NqhLBX5U.js";import{P as V}from"./Pill-DpqrMa0r.js";import{L}from"./Logo-CKBx49v0.js";import{I as T}from"./Input-BtMsYEQC.js";import{B}from"./Button-DQZsVgv2.js";import{i as C}from"./stringUtils-Bvzw0-oW.js";import{S as N}from"./SocialLinks-Jc1UAKUU.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Popover-B8o2G8jc.js";import"./x-BAZkSzS9.js";import"./createLucideIcon-DnmJ9UE3.js";import"./Copy-Balf8fLz.js";import"./ShineEffect-D1afC5Ah.js";import"./Skeleton-CrFOPy1K.js";import"./refresh-ccw-D0BER8Gi.js";import"./circle-check-CR2oW9jw.js";import"./circle-alert-CK7NUARt.js";import"./parsePhoneNumber-DR0S47Bc.js";import"./Loader-Cx-EKtVY.js";const j={name:"Login",components:{Pill:V,Logo:L,Input:T,Button:B,SocialLinks:N},inject:["authState","formState","notificationState"],data(){return{form:{email:"",password:"",type:"email",mobile_number:""},loginTypes:[{label:"Email",value:"email"},{label:"Mobile Number",value:"mobile_number"}],loading:!1,currentYear:new Date().getFullYear()}},methods:{isEmpty:C,async submit(){var d,e;if(!this.loading&&(this.formState.hideFormErrors(),this.form.type=="email"&&this.isEmpty(this.form.email)?this.formState.setFormError("email","Enter your email"):this.form.type=="mobile_number"&&this.isEmpty(this.form.mobile_number)?this.formState.setFormError("mobile_number","Enter your mobile number"):this.isEmpty(this.form.password)&&this.formState.setFormError("password","Enter your password"),!this.formState.hasErrors)){this.loading=!0;try{const a=(await F.post("/api/auth/login",this.form)).data.token;this.authState.setTokenOnRequest(a),this.authState.setTokenOnLocalStorage(a);const t=this.$route.query.redirect;t?this.$router.push(t):this.$router.push({name:"show-stores"})}catch(s){const a=((e=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while signing in";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(s),console.error("Failed to sign in:",s)}finally{this.loading=!1}}}}},I={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},O={class:"flex items-center justify-center p-6 bg-gradient-to-b from-blue-100 to-white-100"},U={class:"w-full max-w-md"},Y={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},q={class:"flex space-x-2"},D={key:2,class:"text-red-500 text-sm mb-3"},M={class:"ml-1"},z={class:"text-sm text-center mb-4"},A={class:"text-sm text-center text-gray-500"};function R(d,e,s,a,t,i){const x=n("Logo"),_=n("Pill"),f=n("Input"),w=n("Button"),b=n("router-link"),S=n("SocialLinks");return l(),c("div",I,[o("div",O,[o("div",U,[m(x,{height:"h-20 mx-auto mb-4"}),o("div",Y,[e[7]||(e[7]=o("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Sign in",-1)),e[8]||(e[8]=o("h1",{class:"text-sm text-gray-500 mb-4"},"Pick how you would like to sign in",-1)),o("form",{onSubmit:e[3]||(e[3]=E((...r)=>i.submit&&i.submit(...r),["prevent"])),class:"space-y-4 mb-4"},[o("div",q,[(l(!0),c(k,null,v(t.loginTypes,r=>(l(),g(_,{type:t.form.type===r.value?"primary":"light",action:()=>t.form.type=r.value,key:r.value},{default:p(()=>[h(u(r.label),1)]),_:2},1032,["type","action"]))),128))]),t.form.type=="email"?(l(),g(f,{key:0,type:"email",modelValue:t.form.email,"onUpdate:modelValue":e[0]||(e[0]=r=>t.form.email=r),placeholder:"john@gmail.com",errorText:i.formState.getFormError("email")},null,8,["modelValue","errorText"])):t.form.type=="mobile_number"?(l(),g(f,{key:1,type:"text",placeholder:"+26772000001",modelValue:t.form.mobile_number,"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.mobile_number=r),errorText:i.formState.getFormError("mobile_number")},null,8,["modelValue","errorText"])):y("",!0),m(f,{type:"password",modelValue:t.form.password,"onUpdate:modelValue":e[2]||(e[2]=r=>t.form.password=r),placeholder:"******",errorText:i.formState.getFormError("password")},null,8,["modelValue","errorText"]),i.formState.generalErrorText?(l(),c("div",D,u(i.formState.generalErrorText),1)):y("",!0),m(w,{size:"md",type:"primary",action:i.submit,buttonClass:"w-full"},{default:p(()=>[o("span",M,u(t.loading?"Signing in...":"Continue"),1)]),_:1},8,["action"]),o("div",z,[m(b,{to:{name:"register"},class:"text-blue-600 hover:underline"},{default:p(()=>e[4]||(e[4]=[h("Create account")])),_:1,__:[4]}),e[6]||(e[6]=o("span",{class:"text-gray-300 mx-4"},"|",-1)),m(b,{to:{name:"forgot-password"},class:"text-blue-600 hover:underline"},{default:p(()=>e[5]||(e[5]=[h("Forgot password?")])),_:1,__:[5]})])],32),m(S)]),o("p",A,"Â© "+u(t.currentYear)+" Perfect Order. All rights reserved.",1)])]),e[9]||(e[9]=o("div",{class:"hidden lg:block"},[o("img",{src:"/images/lady-holding-boxes.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const ue=P(j,[["render",R]]);export{ue as default};
