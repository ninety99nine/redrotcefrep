import{T as E}from"./Tabs-VnUmKKK9.js";import{P as I}from"./Pill-CNroauuQ.js";import{A}from"./Alert-sYnn1QJY.js";import{M as B}from"./Modal-2gfRC5Dc.js";import{I as V}from"./Input-l_fu_pN6.js";import{B as H}from"./Button-D7saANb7.js";import{S as P}from"./Skeleton-DAfv9Rr0.js";import{a as U,i as W}from"./stringUtils-Bvzw0-oW.js";import{c as d,a as p,b as a,e as f,g as y,r as h,d as l,i as g,t as m,s as z,n as M,o as r}from"./app-DF0QnPU4.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as j}from"./external-link-DSJddmew.js";import{C as G}from"./circle-check-big-DRVF-mWJ.js";import{T as w}from"./trash-2-WYhYg-cK.js";import{M as v}from"./move-left-BoEc8pc2.js";import{G as x}from"./globe-Dxbm4mTx.js";import{c as q}from"./createLucideIcon-eN94IJz_.js";import{R}from"./refresh-ccw-BWvWNHcU.js";import{P as Y}from"./plus-DYnannGu.js";import"./Popover-DmuV9HMk.js";import"./x-DdzUJel4.js";import"./circle-check-B1WpMwJ7.js";import"./info-BrToMAYh.js";import"./Copy-DudZ5Uvs.js";import"./ShineEffect-BVNWGq73.js";import"./circle-alert-ByShgotJ.js";import"./parsePhoneNumber-DR0S47Bc.js";import"./Loader-CNeQD6e9.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=q("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),K={inject:["formState","storeState","domainState","changeHistoryState","notificationState"],components:{Tabs:E,Pill:I,Alert:A,Modal:B,Input:V,Button:H,Skeleton:P,User:J,Globe:x,MoveLeft:v,Trash2:w,CheckCircle:G,ExternalLink:j},data(){return{Plus:Y,Globe:x,Trash2:w,MoveLeft:v,RefreshCcw:R,serverIp:null,connected:!1,domainContacts:null,existingDomainNames:[],isLoadingDomains:!1,isLoadingServerIp:!1,originalDomainName:null,originalDomainStatus:null,tab:"registrant",tabs:[{label:"Domain Owner",value:"registrant",description:"The individual or entity that owns the domain. This information is used to register the domain and is publicly visible in WHOIS records unless privacy protection is enabled."},{label:"Technical Contact",value:"tech",description:"The person or team responsible for managing the domainâ€™s technical setup, such as DNS configurations. They handle technical issues related to the domain."},{label:"Administrative Contact",value:"admin",description:"The contact responsible for administrative tasks, such as managing domain renewals and updates. They may also handle billing and policy-related matters."},{label:"Billing Contact",value:"aux_billing",description:"The contact responsible for payment and billing details for the domain. This information is used for invoices and renewal notifications."}]}},watch:{store(o,t){!t&&o&&this.setup()},domainForm:{handler(o){o.name==this.originalDomainName&&this.originalDomainStatus=="connected"?this.connected=!0:this.connected=!1},deep:!0}},computed:{store(){return this.storeState.store},isCreating(){return this.domainId==null},isEditing(){return this.domainId!=null},isLoadingStore(){return this.storeState.isLoadingStore},domainId(){return this.$route.params.domain_id},domain(){return this.domainState.domain},domainForm(){return this.domainState.domainForm},isLoadingDomain(){return this.domainState.isLoadingDomain},isCreatingDomain(){return this.domainState.isCreatingDomain},isUpdatingDomain(){return this.domainState.isUpdatingDomain},isDeletingDomain(){return this.domainState.isDeletingDomain},isVerifyingDomain(){return this.domainState.isVerifyingDomain},isLoadingDomainContacts(){return this.domainState.isLoadingDomainContacts},domainStatus(){return this.connected===!0?{label:"connected",type:"success"}:{label:"pending",type:"warning"}},selectedTabIndex(){return this.tabs.findIndex(o=>o.value==this.tab)}},methods:{isEmpty:W,isNotEmpty:U,setup(){this.domainState.setDomainForm(null,!0),this.store&&this.showDomains(),this.store&&this.domainId&&this.showDomain(),this.store&&!this.serverIp&&this.showServerIp()},setActionButtons(){this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Add Domain",this.isEditing?this.updateDomain:this.createDomain,"primary",null)},async navigateToShowDomains(){await this.$router.push({name:"show-domains",query:{store_id:this.store.id}})},async navigateToEditDomain(){await this.$router.push({name:"edit-domain",query:{store_id:this.store.id},params:{domain_id:this.domain.id}})},async showServerIp(){var o,t;try{this.isLoadingServerIp=!0;let i={params:{store_id:this.store.id}};const n=await axios.get("/api/domains/server-ip",i);this.serverIp=n.data.server_ip}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching server IP";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch server IP:",i)}finally{this.isLoadingServerIp=!1}},async showDomains(){var o,t;try{this.isLoadingDomains=!0;let i={params:{per_page:100,store_id:this.store.id}};const e=(await axios.get("/api/domains",i)).data;this.existingDomainNames=e.data.map(s=>s.name)}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching domains";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch domains:",i)}finally{this.isLoadingDomains=!1}},async showDomain(){var o,t;try{this.domainState.isLoadingDomain=!0;let i={params:{store_id:this.store.id}};const e=(await axios.get(`/api/domains/${this.domainId}`,i)).data;this.domainState.setDomain(e),this.domainState.setDomainForm(e,!0),this.domain.type=="purchased"&&this.showDomainContacts(),this.$nextTick(()=>{this.connected=e.status==="connected",this.originalDomainStatus=this.domain.status,this.originalDomainName=this.domain.name})}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching domain";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch domain:",i)}finally{this.domainState.isLoadingDomain=!1}},async showDomainContacts(){var o,t;try{this.domainState.isLoadingDomainContacts=!0;let i={params:{store_id:this.store.id}};const n=await axios.get(`/api/domains/${this.domainId}/contacts`,i);this.domainContacts=n.data}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching domain contacts";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch domain contacts:",i)}finally{this.domainState.isLoadingDomainContacts=!1}},async createDomain(){var o,t;try{if(this.domainState.isCreatingDomain||(this.formState.hideFormErrors(),this.isEmpty(this.domainForm.name)?this.formState.setFormError("name","The domain name is required"):this.existingDomainNames.includes(this.domainForm.name)&&this.formState.setFormError("name","The domain name already exists"),this.formState.hasErrors))return;this.domainState.isCreatingDomain=!0,this.changeHistoryState.actionButtons[1].loading=!0;const i={name:this.domainForm.name,active:this.domainForm.active,store_id:this.store.id},e=(await axios.post("/api/domains",i)).data.domain;this.domainState.setDomain(e),this.domainState.setDomainForm(e,!0),this.connected=e.status==="connected",this.originalDomainName=e.name,this.originalDomainStatus=e.status,this.notificationState.showSuccessNotification("Domain created"),this.domainState.saveOriginalState("Original domain"),this.navigateToEditDomain()}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while creating domain";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to create domain:",i)}finally{this.domainState.isCreatingDomain=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async updateDomain(){var o,t;try{if(this.domainState.isUpdatingDomain||(this.formState.hideFormErrors(),this.isEmpty(this.domainForm.name)?this.formState.setFormError("name","The domain name is required"):this.domain.name!=this.domainForm.name&&this.existingDomainNames.includes(this.domainForm.name)&&this.formState.setFormError("name","The domain name already exists"),this.formState.hasErrors))return;this.domainState.isUpdatingDomain=!0,this.changeHistoryState.actionButtons[1].loading=!0;const i={name:this.domainForm.name,active:this.domainForm.active,store_id:this.store.id},e=(await axios.put(`/api/domains/${this.domainId}`,i)).data.domain;this.domainState.setDomain(e),this.domainState.setDomainForm(e,!0),this.connected=e.status==="connected",this.originalDomainName=e.name,this.originalDomainStatus=e.status,this.notificationState.showSuccessNotification("Domain updated"),this.domainState.saveOriginalState("Original domain")}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while updating domain";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to update domain:",i)}finally{this.domainState.isUpdatingDomain=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async deleteDomain(o){var t,i;try{if(this.domainState.isDeletingDomain)return;this.domainState.isDeletingDomain=!0;const n={data:{store_id:this.store.id}};await axios.delete(`/api/domains/${this.domainId}`,n),o(),await new Promise(e=>setTimeout(e,500)),this.notificationState.showSuccessNotification("Domain deleted"),await this.navigateToShowDomains()}catch(n){const e=((i=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:i.message)||(n==null?void 0:n.message)||"Something went wrong while deleting domain";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(n),console.error("Failed to delete domain:",n),o()}finally{this.domainState.isDeletingDomain=!1}},async verifyDomainConnection(){var o,t;try{if(this.domainState.isVerifyingDomain||(this.formState.hideFormErrors(),(this.isCreating||this.isEditing&&this.domain.name!=this.domainForm.name)&&this.existingDomainNames.includes(this.domainForm.name)&&this.formState.setFormError("name","The domain name already exists"),this.formState.hasErrors))return;this.domainState.isVerifyingDomain=!0;const i={store_id:this.store.id,name:this.domainForm.name},n=await axios.post("/api/domains/verify-connection",i);this.connected=n.data.connected,this.connected?this.isCreating?this.createDomain():this.updateDomain():this.notificationState.showWarningNotification(`${this.domainForm.name} is not connected`)}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while verifying domain connection";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to verify domain connection:",i)}finally{this.domainState.isVerifyingDomain=!1}},setDomainForm(o){this.domainState.domainForm=o}},beforeUnmount(){this.domainState.reset()},created(){this.setup(),this.setActionButtons();const o=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let t=0;t<o.length;t++){let i=o[t];this.changeHistoryState.listeners[i]=this.setDomainForm}}},Q={class:"max-w-2xl mx-auto pt-24 pb-40"},X={class:"bg-gray-50 border border-gray-300 rounded-lg p-4 mb-4"},Z={key:0,class:"flex justify-end"},$={key:0,class:"bg-gray-50 border border-gray-300 rounded-lg p-4 space-y-4 mb-4"},tt={class:"flex items-center space-x-2 mb-4"},it={class:"text-sm text-gray-600"},et={class:"font-bold"},st={class:"bg-white border border-gray-200 rounded-lg p-4"},at={class:"flex items-center space-x-4"},ot={class:"w-1/3"},nt={class:"text-sm"},rt={class:"flex justify-center mt-4"},mt={key:1,class:"bg-gray-50 border border-gray-300 rounded-lg p-4 space-y-4 mb-4"},dt={class:"flex items-center space-x-2 mb-4"},lt={class:"bg-blue-50 border border-blue-100 rounded-lg text-sm p-2"},ct={class:"bg-white border border-gray-200 rounded-lg p-4"},ht={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},gt={key:1,class:"text-sm"},pt={key:1,class:"text-sm"},ft={key:1,class:"text-sm"},ut={key:1,class:"text-sm"},yt={key:1,class:"text-sm"},St={key:1,class:"text-sm"},bt={key:1,class:"text-sm"},Dt={key:1,class:"text-sm"},wt={key:1,class:"text-sm"},vt={class:"text-sm"},xt={href:"https://www.namecheap.com",target:"_blank",class:"underline inline-flex items-center"},Ct={class:"space-y-2"},_t={class:"font-bold text-black"},Ft={class:"flex justify-end"},Lt={class:"mb-8"},Nt={class:"font-bold text-black"};function kt(o,t,i,n,e,s){var b,D;const S=h("Button"),C=h("Pill"),_=h("Input"),F=h("Globe"),L=h("User"),N=h("Tabs"),c=h("Skeleton"),k=h("ExternalLink"),T=h("Modal");return r(),d("div",Q,[p(S,{size:"xs",type:"light",class:"mb-4",leftIcon:e.MoveLeft,action:s.navigateToShowDomains},{default:y(()=>t[3]||(t[3]=[a("span",null,"Back",-1)])),_:1,__:[3]},8,["leftIcon","action"]),a("div",X,[!s.isLoadingStore&&!s.isLoadingDomain&&s.isNotEmpty(s.domainForm.name)?(r(),d("div",Z,[s.domainStatus?(r(),l(C,{key:0,type:s.domainStatus.type,size:"xs"},{default:y(()=>[g(m(s.domainStatus.label),1)]),_:1},8,["type"])):f("",!0)])):f("",!0),p(_,{type:"text",label:"Domain Name",placeholder:"example.com",modelValue:s.domainForm.name,"onUpdate:modelValue":t[0]||(t[0]=u=>s.domainForm.name=u),disabled:((b=s.domain)==null?void 0:b.type)=="purchased",errorText:s.formState.getFormError("name"),skeleton:s.isLoadingStore||s.isLoadingDomain,onInput:t[1]||(t[1]=u=>s.domainState.saveStateDebounced("Domain name changed")),tooltipContent:"The domain name for your store (e.g., example.com)",description:((D=s.domain)==null?void 0:D.type)=="purchased"?"This domain cannot be changed because its a purchased domain":null},null,8,["modelValue","disabled","errorText","skeleton","description"])]),!s.isLoadingStore&&!s.isLoadingDomain&&s.isNotEmpty(s.domainForm.name)&&!e.connected?(r(),d("div",$,[a("div",tt,[p(F,{size:"20"}),t[4]||(t[4]=a("h1",{class:"font-bold"},"Complete Connection",-1))]),a("p",it,[t[5]||(t[5]=g(" To connect ")),a("span",et,m(s.domainForm.name),1),t[6]||(t[6]=g(", update the DNS settings at your domain provider (e.g., Namecheap, GoDaddy, etc.) with the following ")),t[7]||(t[7]=a("span",{class:"font-bold"},"A record",-1)),t[8]||(t[8]=g(" to prove ownership "))]),a("div",st,[a("div",at,[t[10]||(t[10]=z('<div class="w-1/3"><p class="text-sm font-semibold mb-2">Type</p><p class="text-sm">A</p></div><div class="w-1/3"><p class="text-sm font-semibold mb-2">Host</p><p class="text-sm">@</p></div>',2)),a("div",ot,[t[9]||(t[9]=a("p",{class:"text-sm font-semibold mb-2"},"Value",-1)),a("p",nt,m(e.serverIp),1)])])]),a("div",rt,[p(S,{size:"md",type:"success",class:"w-full",buttonClass:"w-full",leftIcon:e.RefreshCcw,loading:s.isVerifyingDomain,action:s.verifyDomainConnection},{default:y(()=>t[11]||(t[11]=[a("span",{class:"ml-1"},"Check Connection",-1)])),_:1,__:[11]},8,["leftIcon","loading","action"])])])):f("",!0),!s.isLoadingStore&&!s.isLoadingDomain&&(s.isLoadingDomainContacts||e.domainContacts)?(r(),d("div",mt,[a("div",dt,[p(L,{size:"20"}),t[12]||(t[12]=a("h1",{class:"font-bold"},"Domain Contacts",-1))]),p(N,{tabs:e.tabs,modelValue:e.tab,"onUpdate:modelValue":t[2]||(t[2]=u=>e.tab=u)},null,8,["tabs","modelValue"]),a("p",lt,m(e.tabs[s.selectedTabIndex].description),1),a("div",ct,[a("div",ht,[a("div",null,[t[13]||(t[13]=a("p",{class:"text-sm font-semibold mb-1"},"First Name",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",gt,m(e.domainContacts[e.tab].first_name||"N/A"),1))]),a("div",null,[t[14]||(t[14]=a("p",{class:"text-sm font-semibold mb-1"},"Last Name",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",pt,m(e.domainContacts[e.tab].last_name||"N/A"),1))]),a("div",null,[t[15]||(t[15]=a("p",{class:"text-sm font-semibold mb-1"},"Email",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",ft,m(e.domainContacts[e.tab].email||"N/A"),1))]),a("div",null,[t[16]||(t[16]=a("p",{class:"text-sm font-semibold mb-1"},"Phone",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",ut,m(e.domainContacts[e.tab].phone||"N/A"),1))]),a("div",null,[t[17]||(t[17]=a("p",{class:"text-sm font-semibold mb-1"},"Address",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",yt,m(e.domainContacts[e.tab].address1||"N/A"),1))]),a("div",null,[t[18]||(t[18]=a("p",{class:"text-sm font-semibold mb-1"},"City",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",St,m(e.domainContacts[e.tab].city||"N/A"),1))]),a("div",null,[t[19]||(t[19]=a("p",{class:"text-sm font-semibold mb-1"},"State",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",bt,m(e.domainContacts[e.tab].state||"N/A"),1))]),a("div",null,[t[20]||(t[20]=a("p",{class:"text-sm font-semibold mb-1"},"Postal Code",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",Dt,m(e.domainContacts[e.tab].postal_code||"N/A"),1))]),a("div",null,[t[21]||(t[21]=a("p",{class:"text-sm font-semibold mb-1"},"Country",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",wt,m(e.domainContacts[e.tab].country||"N/A"),1))])])]),a("p",vt,[t[23]||(t[23]=g(" Your domain is provided by ")),a("a",xt,[t[22]||(t[22]=a("span",null,"Namecheap.com",-1)),p(k,{size:"14",class:"ml-1"})])])])):f("",!0),s.domain&&!s.isLoadingStore&&!s.isLoadingDomain&&s.isEditing?(r(),d("div",{key:2,class:M(["flex items-center justify-between space-x-4 overflow-hidden rounded-lg p-4 border mt-4",s.isLoadingStore||s.isLoadingDomain?"border-gray-300 bg-gray-50":"border-red-300 bg-red-50"])},[a("div",Ct,[a("p",null,[t[24]||(t[24]=g("Delete ")),a("span",_t,m(s.domain.name),1),t[25]||(t[25]=g("?"))])]),a("div",Ft,[p(T,{triggerType:"danger",approveType:"danger",approveLeftIcon:e.Trash2,triggerText:"Delete Domain",approveText:"Delete Domain",approveAction:s.deleteDomain,triggerLoading:s.isDeletingDomain,approveLoading:s.isDeletingDomain},{content:y(()=>[t[28]||(t[28]=a("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),a("p",Lt,[t[26]||(t[26]=g("Are you sure you want to delete ")),a("span",Nt,m(s.domain.name),1),t[27]||(t[27]=g("?"))])]),_:1},8,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])],2)):f("",!0)])}const si=O(K,[["render",kt]]);export{si as default};
