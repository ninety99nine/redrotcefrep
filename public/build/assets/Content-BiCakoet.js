import{m as Ce,c as i,a as u,b as s,r as m,d as p,g as x,o,F as f,f as k,e as S,h as j,t as v,n as F,i as I,z as De,v as Pe,A as Oe,B as ae,T as ye,w as ge,C as Me}from"./app-C9fKn4Wu.js";import{r as Fe,a as Le,b as Te,d as pe}from"./cloneDeep-B2NiHz93.js";import{B as V}from"./Button-B6uWpkNJ.js";import{S as D}from"./Skeleton-D3J4oatQ.js";import{I as M,b as de}from"./Input-BpvCbPzt.js";import{S as B}from"./Select-DoGUJKyZ.js";import{S as $}from"./Switch-CdqkF9-n.js";import{c as N,O as Ie,a as Ve}from"./OrderPaymentStatusSelect-BCgRcC_g.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as ee}from"./trash-2-BZgx4NPS.js";import{P as Z}from"./plus-B34lslhj.js";import{M as te}from"./Modal-Dpi9IkUQ.js";import{R as je,a as Ae}from"./Popover-DkgXtOm4.js";import{c as Ee}from"./createLucideIcon-aSWH95Ml.js";import{P as fe}from"./Pill-BjRwwTB0.js";import{A as Re}from"./arrow-left-C--zIKnO.js";import{A as Ne}from"./AddressInput-Dlgx8DqW.js";import{A as Be}from"./Alert-XyQlk9Xa.js";import{D as Ue}from"./Datepicker-dFdm0Po3.js";import{S as ve}from"./ShineEffect-CamUJCMA.js";import{I as qe}from"./info-DcMYHvks.js";import"./Loader-7AMjb3nm.js";import"./Copy-MnYDw6Fb.js";import"./isEqual-CS7N9nu5.js";import"./GoogleMaps-DTSduw5A.js";import"./SelectCountry-DxnYo4Xq.js";import"./move-left-Bl4v6ya3.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=Ee("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var Y,le;function ze(){if(le)return Y;le=1;var n=Fe(),t=function(){return n.Date.now()};return Y=t,Y}var G,ue;function We(){if(ue)return G;ue=1;var n=/\s/;function t(r){for(var c=r.length;c--&&n.test(r.charAt(c)););return c}return G=t,G}var Q,ce;function He(){if(ce)return Q;ce=1;var n=We(),t=/^\s+/;function r(c){return c&&c.slice(0,n(c)+1).replace(t,"")}return Q=r,Q}var X,me;function Ye(){if(me)return X;me=1;var n=Le(),t=Te(),r="[object Symbol]";function c(a){return typeof a=="symbol"||t(a)&&n(a)==r}return X=c,X}var J,he;function Ge(){if(he)return J;he=1;var n=He(),t=pe(),r=Ye(),c=NaN,a=/^[-+]0x[0-9a-f]+$/i,e=/^0b[01]+$/i,l=/^0o[0-7]+$/i,y=parseInt;function _(d){if(typeof d=="number")return d;if(r(d))return c;if(t(d)){var h=typeof d.valueOf=="function"?d.valueOf():d;d=t(h)?h+"":h}if(typeof d!="string")return d===0?d:+d;d=n(d);var g=e.test(d);return g||l.test(d)?y(d.slice(2),g?2:8):a.test(d)?c:+d}return J=_,J}var K,_e;function Qe(){if(_e)return K;_e=1;var n=pe(),t=ze(),r=Ge(),c="Expected a function",a=Math.max,e=Math.min;function l(y,_,d){var h,g,w,P,O,T,A=0,oe=!1,E=!1,z=!0;if(typeof y!="function")throw new TypeError(c);_=r(_)||0,n(d)&&(oe=!!d.leading,E="maxWait"in d,w=E?a(r(d.maxWait)||0,_):w,z="trailing"in d?!!d.trailing:z);function W(C){var L=h,R=g;return h=g=void 0,A=C,P=y.apply(R,L),P}function we(C){return A=C,O=setTimeout(U,_),oe?W(C):P}function be(C){var L=C-T,R=C-A,ne=_-L;return E?e(ne,w-R):ne}function se(C){var L=C-T,R=C-A;return T===void 0||L>=_||L<0||E&&R>=w}function U(){var C=t();if(se(C))return ie(C);O=setTimeout(U,be(C))}function ie(C){return O=void 0,z&&h?W(C):(h=g=void 0,P)}function xe(){O!==void 0&&clearTimeout(O),A=0,h=T=g=O=void 0}function ke(){return O===void 0?P:ie(t())}function H(){var C=t(),L=se(C);if(h=arguments,g=this,T=C,L){if(O===void 0)return we(T);if(E)return clearTimeout(O),O=setTimeout(U,_),W(T)}return O===void 0&&(O=setTimeout(U,_)),P}return H.cancel=xe,H.flush=ke,H}return K=l,K}var Xe=Qe();const re=Ce(Xe),q={FLAT:"flat",PERCENTAGE:"percentage"},Je={inject:["storeState","orderState"],components:{Input:M,Select:B,Switch:$,Button:V},props:{index:{type:Number},cartFee:{type:Object}},data(){return{Trash2:ee,RATE_TYPES:q,feeTypes:Object.entries(q).map(([n,t])=>({label:N(t),value:t}))}},computed:{store(){return this.storeState.store}}},Ke={class:"space-y-2 bg-gray-50 p-2 border border-gray-300 rounded-lg"},$e={class:"flex items-center space-x-2"},et={class:"w-full flex justify-end"};function tt(n,t,r,c,a,e){const l=m("Input"),y=m("Select"),_=m("Button"),d=m("Switch");return o(),i("div",Ke,[u(l,{type:"text",class:"w-full",modelValue:r.cartFee.name,"onUpdate:modelValue":t[0]||(t[0]=h=>r.cartFee.name=h),placeholder:"Packaging",onInput:t[1]||(t[1]=h=>e.orderState.saveStateDebounced("Fee name changed"))},null,8,["modelValue"]),s("div",$e,[u(y,{class:"w-60",search:!1,options:a.feeTypes,modelValue:r.cartFee.rate_type,"onUpdate:modelValue":t[2]||(t[2]=h=>r.cartFee.rate_type=h),placeholder:"Select fee type",onChange:t[3]||(t[3]=h=>e.orderState.saveStateDebounced("Fee type changed"))},null,8,["options","modelValue"]),r.cartFee.rate_type==a.RATE_TYPES.FLAT?(o(),p(l,{key:0,type:"money",class:"w-60",modelValue:r.cartFee.flat_rate,"onUpdate:modelValue":t[4]||(t[4]=h=>r.cartFee.flat_rate=h),currency:e.store.currency.code,onInput:t[5]||(t[5]=h=>e.orderState.saveStateDebounced("Fee amount changed"))},null,8,["modelValue","currency"])):(o(),p(l,{key:1,class:"w-60",type:"percentage",modelValue:r.cartFee.percentage_rate,"onUpdate:modelValue":t[6]||(t[6]=h=>r.cartFee.percentage_rate=h),onInput:t[7]||(t[7]=h=>e.orderState.saveStateDebounced("Fee amount changed"))},null,8,["modelValue"])),s("div",et,[r.cartFee.removable?(o(),p(_,{key:0,size:"xs",type:"danger",leftIcon:a.Trash2,action:()=>e.orderState.removeCartFee(r.index)},{default:x(()=>t[10]||(t[10]=[s("span",null,"Remove Fee",-1)])),_:1,__:[10]},8,["leftIcon","action"])):(o(),p(d,{key:1,size:"xs",prefixText:"Apply fee",modelValue:r.cartFee.active,"onUpdate:modelValue":t[8]||(t[8]=h=>r.cartFee.active=h),onChange:t[9]||(t[9]=h=>e.orderState.saveStateDebounced("Apply fee status changed"))},null,8,["modelValue"]))])])])}const rt=b(Je,[["render",tt]]),ot={inject:["storeState","orderState"],components:{Button:V,Skeleton:D,OrderFee:rt},data(){return{Plus:Z}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},cartFees(){return this.orderState.orderForm.cart_fees},isEditting(){return this.$route.name==="edit-order"},hasCartFees(){return this.cartFees.length>0}},methods:{addNew(){this.orderState.addCartFee()}}},st={class:"bg-white rounded-lg p-4 shadow-sm"},it={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},nt={class:"w-full space-y-4"},at={key:1,class:"space-y-2"},dt={class:"flex justify-center pt-2"},lt={key:1,class:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4 my-4"};function ut(n,t,r,c,a,e){const l=m("Skeleton"),y=m("OrderFee"),_=m("Button");return o(),i("div",st,[t[5]||(t[5]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Fees",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",it,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])],-1)),s("div",nt,[u(l,{width:"w-full",shine:!0}),u(l,{width:"w-1/3",shine:!0})])])):(o(),i("div",at,[e.hasCartFees?(o(),i(f,{key:0},[(o(!0),i(f,null,k(e.cartFees,(d,h)=>(o(),p(y,{key:h,index:h,cartFee:d},null,8,["index","cartFee"]))),128)),s("div",dt,[u(_,{size:"sm",type:"light",action:e.addNew,leftIcon:a.Plus},{default:x(()=>t[1]||(t[1]=[s("span",null,"Add Fee",-1)])),_:1,__:[1]},8,["action","leftIcon"])])],64)):(o(),i("div",lt,[e.hasCartFees?S("",!0):(o(),i(f,{key:0},[t[2]||(t[2]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1)),t[3]||(t[3]=s("span",{class:"text-sm text-gray-500"},"No fees",-1))],64)),u(_,{size:"xs",type:"light",action:e.addNew,leftIcon:a.Plus,buttonClass:"my-2"},{default:x(()=>t[4]||(t[4]=[s("span",null,"Add Fee",-1)])),_:1,__:[4]},8,["action","leftIcon"])]))]))])}const ct=b(ot,[["render",ut]]),mt={inject:["formState","storeState","orderState","notificationState"],components:{Input:M,Select:B,Skeleton:D,OrderStatusSelect:Ve,OrderPaymentStatusSelect:Ie},data(){return{couriers:[],isLoadingCouriers:!1}},computed:{hasOrder(){return this.orderState.hasOrder},orderForm(){return this.orderState.orderForm},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},statuses(){return["waiting","cancelled","completed","on its way","ready for pickup"].map(t=>({label:N(t),value:t}))},paymentStatuses(){return["paid","unpaid","pending payment","partially paid"].map(t=>({label:N(t),value:t}))}},methods:{async showCouriers(){var n,t;try{if(this.couriers.length)return;this.isLoadingCouriers=!0;let r={params:{per_page:100}};const c=await j.get("/api/couriers",r);this.couriers=c.data.data.map(a=>({label:N(a.name),value:a.id})),this.couriers.unshift({label:"None",value:null})}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching stores";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch stores:",r)}finally{this.isLoadingCouriers=!1}}},created(){this.showCouriers()}},ht={class:"bg-white rounded-lg p-4 shadow-sm"},_t={key:0,class:"space-y-2"},yt={key:1,class:"space-y-2"};function gt(n,t,r,c,a,e){const l=m("Skeleton"),y=m("OrderStatusSelect"),_=m("OrderPaymentStatusSelect"),d=m("Select"),h=m("Input");return o(),i("div",ht,[e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",_t,[(o(),i(f,null,k([1,2,3],(g,w)=>s("div",{key:w,class:"border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},[u(l,{width:"w-full",shine:!0})])),64))])):(o(),i("div",yt,[u(y,{class:"w-full",showLabel:!0,onChange:t[0]||(t[0]=g=>e.orderState.saveStateDebounced(`Status changed to ${e.orderForm.status}`))}),u(_,{class:"w-full",showLabel:!0,onChange:t[1]||(t[1]=g=>e.orderState.saveStateDebounced(`Payment status changed to ${e.orderForm.payment_status}`))}),u(d,{search:!1,label:"Couriers",options:a.couriers,modelValue:e.orderForm.courier_id,"onUpdate:modelValue":t[2]||(t[2]=g=>e.orderForm.courier_id=g),errorText:e.formState.getFormError("courier_id"),onChange:t[3]||(t[3]=g=>e.orderState.saveStateDebounced("Courier changed"))},null,8,["options","modelValue","errorText"]),u(h,{type:"text",label:"Tracking Number",modelValue:e.orderForm.tracking_number,"onUpdate:modelValue":t[4]||(t[4]=g=>e.orderForm.tracking_number=g),errorText:e.formState.getFormError("tracking_number"),onInput:t[5]||(t[5]=g=>e.orderState.saveStateDebounced("Tracking number changed"))},null,8,["modelValue","errorText"]),u(h,{rows:"2",type:"textarea",label:"Internal Note",modelValue:e.orderForm.internal_note,"onUpdate:modelValue":t[6]||(t[6]=g=>e.orderForm.internal_note=g),errorText:e.formState.getFormError("internal_note"),onChange:t[7]||(t[7]=g=>e.orderState.saveStateDebounced("Internal note changed")),tooltipContent:"Internal information about this order only visible to you and other team members"},null,8,["modelValue","errorText"])]))])}const pt=b(mt,[["render",gt]]),ft={inject:["orderState","storeState"],components:{Skeleton:D},computed:{order(){return this.orderState.order},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},shoppingCart(){return this.orderState.shoppingCart},isInspectingShoppingCart(){return this.orderState.isInspectingShoppingCart},hasFees(){return Object.keys(this.shoppingCart?this.shoppingCart.totals.fees:this.order.order_fees).length>0},hasDiscounts(){return Object.keys(this.shoppingCart?this.shoppingCart.totals.discounts:this.order.order_discounts).length>0},hasTaxAmount(){return(this.shoppingCart?this.shoppingCart.totals.vat.amount.amount:this.order.vat_amount.amount)>0},hasAdjustmentTotal(){return this.shoppingCart?this.shoppingCart.totals.adjustment_total.amount!=0:this.order.adjustment_total.amount!=0},adjustmentTotalPositive(){return this.shoppingCart?this.shoppingCart.totals.adjustment_total.amount>0:this.order.adjustment_total.amount>0},isReady(){return!this.isLoadingStore&&!this.isLoadingOrder&&!this.isInspectingShoppingCart}}},vt={class:"bg-white rounded-lg p-4 shadow-sm"},St={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},wt={class:"w-full space-y-4"},bt={key:1,class:"bg-blue-50 border border-blue-400 rounded-lg p-4"},xt={key:0,class:"flex items-center justify-between text-sm border-b border-gray-300 border-dashed pb-2 mb-2"},kt={key:1},Ct={key:1,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Dt={key:1},Pt={key:3,class:"text-red-500"},Ot={key:2,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Mt={class:"flex items-center justify-between text-sm mb-1"},Ft={key:1,class:"w-full"},Lt={key:3},Tt={key:1,class:"text-xs text-gray-400"},It={key:3,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Vt={key:1},jt={key:3,class:"text-green-500"},At={key:4,class:"border-b border-gray-300 border-dashed pb-2 mb-2"},Et={class:"flex items-center justify-between text-sm text-gray-500"},Rt={key:1},Nt={class:"flex items-center justify-between text-lg"},Bt={key:1,class:"font-bold"},Ut={key:1,class:"text-sm"};function qt(n,t,r,c,a,e){const l=m("Skeleton");return o(),i("div",vt,[e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",St,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])],-1)),s("div",wt,[u(l,{width:"w-full",shine:!0}),u(l,{width:"w-1/3",shine:!0})])])):(o(),i("div",bt,[e.order||e.shoppingCart?(o(),i(f,{key:0},[!e.isReady||e.hasDiscounts||e.hasFees?(o(),i("div",xt,[t[1]||(t[1]=s("span",null,"Subtotal",-1)),e.isReady?(o(),i("span",kt,v(e.shoppingCart?e.shoppingCart.totals.subtotal.amount_with_currency:e.order.subtotal.amount_with_currency),1)):(o(),p(l,{key:0,width:"w-24",color:"bg-blue-200",shine:!0}))])):S("",!0),!e.isReady||e.hasDiscounts?(o(),i("div",Ct,[(o(!0),i(f,null,k(e.isReady?e.shoppingCart?e.shoppingCart.totals.discounts:e.order.order_discounts:[1],(y,_)=>(o(),i("div",{key:_,class:"flex items-center justify-between text-sm text-gray-500"},[e.isReady?(o(),i("span",Dt,v(y.name),1)):(o(),p(l,{key:0,width:"w-24",color:"bg-blue-200",shine:!0})),e.isReady?(o(),i("span",Pt,"- "+v(y.amount.amount_with_currency),1)):(o(),p(l,{key:2,width:"w-20",color:"bg-blue-200",shine:!0}))]))),128))])):S("",!0),!e.isReady||e.hasTaxAmount?(o(),i("div",Ot,[s("div",Mt,[e.isReady?(o(),i("div",Ft,"Tax ("+v(e.shoppingCart?e.shoppingCart.totals.vat.rate.value_symbol:`${e.order.vat_rate}%`)+" "+v(e.shoppingCart?e.shoppingCart.totals.vat.method:e.order.vat_method)+")",1)):(o(),p(l,{key:0,width:"w-16",color:"bg-blue-200",shine:!0})),e.isReady?(o(),i("span",Lt,v(e.shoppingCart?e.shoppingCart.totals.vat.amount.amount_with_currency:e.order.vat_amount.amount_with_currency),1)):(o(),p(l,{key:2,width:"w-16",color:"bg-blue-200",shine:!0}))]),e.isReady?(o(),i("p",Tt,"Tax calculated on the discounted subtotal of "+v(e.shoppingCart?e.shoppingCart.totals.subtotal_after_discount.amount_with_currency:e.order.subtotal_after_discount.amount_with_currency),1)):(o(),p(l,{key:0,width:"w-1/3",color:"bg-blue-200",shine:!0}))])):S("",!0),!e.isReady||e.hasFees?(o(),i("div",It,[(o(!0),i(f,null,k(e.isReady?e.shoppingCart?e.shoppingCart.totals.fees:e.order.order_fees:[1],(y,_)=>(o(),i("div",{key:_,class:"flex items-center justify-between text-sm text-gray-500"},[e.isReady?(o(),i("span",Vt,v(y.name),1)):(o(),p(l,{key:0,width:"w-20",color:"bg-blue-200",shine:!0})),e.isReady?(o(),i("span",jt,"+ "+v(y.amount.amount_with_currency),1)):(o(),p(l,{key:2,width:"w-16",color:"bg-blue-200",shine:!0}))]))),128))])):S("",!0),!e.isReady||e.hasAdjustmentTotal?(o(),i("div",At,[s("div",Et,[e.isReady?(o(),i("span",Rt,"Adjustment")):(o(),p(l,{key:0,width:"w-20",color:"bg-blue-200",shine:!0})),e.isReady?(o(),i("span",{key:3,class:F([e.adjustmentTotalPositive?"text-green-500":"text-red-500"])},v(e.adjustmentTotalPositive?"+":"-")+" "+v(`${e.shoppingCart?e.shoppingCart.totals.adjustment_total.amount_with_currency:e.order.adjustment_total.amount_with_currency}`.replace("-","")),3)):(o(),p(l,{key:2,width:"w-16",color:"bg-blue-200",shine:!0}))])])):S("",!0),s("div",Nt,[t[2]||(t[2]=s("div",{class:"w-full font-bold"},"Grand Total",-1)),e.isReady?(o(),i("span",Bt,v(e.shoppingCart?e.shoppingCart.totals.grand_total.amount_with_currency:e.order.grand_total.amount_with_currency),1)):(o(),p(l,{key:0,width:"w-24",color:"bg-blue-200",shine:!0}))])],64)):(o(),i("span",Ut,"Add products to show total"))]))])}const Zt=b(ft,[["render",qt]]),zt={props:{customer:{type:Object},onSelectCustomer:{type:Function}}},Wt={class:"text-sm font-semibold"},Ht={class:"text-xs text-gray-500"};function Yt(n,t,r,c,a,e){return o(),i("div",{onClick:t[0]||(t[0]=()=>r.onSelectCustomer(r.customer)),class:"flex items-center space-x-2 cursor-pointer p-3 border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100"},[t[1]||(t[1]=s("svg",{class:"w-6 h-6 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})],-1)),s("div",null,[s("p",Wt,v(r.customer.name),1),s("p",Ht,v(r.customer.email||r.customer.mobile_number.national),1)])])}const Gt=b(zt,[["render",Yt]]),Qt={components:{CustomerOption:Gt},props:{customers:{type:Array},onSelectCustomer:{type:Function}}},Xt={class:"max-h-80 overflow-y-auto space-y-2 mb-4"};function Jt(n,t,r,c,a,e){const l=m("CustomerOption");return o(),i("div",Xt,[(o(!0),i(f,null,k(r.customers,(y,_)=>(o(),p(l,{key:_,customer:y,onSelectCustomer:r.onSelectCustomer},null,8,["customer","onSelectCustomer"]))),128))])}const Kt=b(Qt,[["render",Jt]]),$t={inject:["formState","orderState","storeState","notificationState"],components:{Input:M,Modal:te,Button:V,Skeleton:D,CustomerOptions:Kt},props:{hasCustomer:{type:Boolean}},data(){return{Plus:Z,RefreshCcw:je,customers:[],searchTerm:null,lastSearchTerm:null,isLoadingCustomers:!1,hasLoadedInitialCustomers:!1}},watch:{searchTerm(){this.showCustomers()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},hasCustomers(){return this.customers.length>0}},methods:{onShow(){this.hasLoadedInitialCustomers=!1,this.lastSearchTerm=null,this.searchTerm=null,this.customers=[],this.showCustomers()},async showCustomers(){var n,t;try{this.isLoadingCustomers=!0;let r={params:{store_id:this.store.id}};this.hasSearchTerm&&(r.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const c=await j.get("/api/customers",r);if(this.searchTerm===this.lastSearchTerm){const a=c.data;this.customers=a.data,this.isLoadingCustomers=!1,this.hasLoadedInitialCustomers=!0}}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching customers";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch customers:",r)}finally{this.isLoadingCustomers=!1}},onSelectCustomer(n){this.$refs.modal.hideModal(),this.orderState.addCartCustomer(n)},addNew(){this.$refs.modal.hideModal(),this.orderState.addCartCustomer()}}},er={class:"flex justify-center"},tr={key:0,class:"flex justify-center items-center space-x-4 my-2"},rr={key:1,class:"space-y-2 mb-4"},or={class:"w-full space-y-2"},sr={key:3,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function ir(n,t,r,c,a,e){const l=m("Input"),y=m("Button"),_=m("Skeleton"),d=m("CustomerOptions"),h=m("Modal");return o(),i("div",er,[u(h,{ref:"modal",onShow:e.onShow,triggerSize:"sm",contentClass:"px-4",triggerType:"light",scrollOnContent:!1,showApproveButton:!1,leftTriggerIcon:r.hasCustomer?a.RefreshCcw:a.Plus,header:`${r.hasCustomer?"Change":"Add"} Customer`,triggerText:`${r.hasCustomer?"Change":"Add"} Customer`,triggerLoading:e.isLoadingOrder||e.isEditting&&!e.hasOrder},{content:x(()=>[a.hasLoadedInitialCustomers?(o(),i("div",tr,[u(l,{type:"search",class:"w-full",debounced:!0,modelValue:a.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=g=>a.searchTerm=g),placeholder:"Search customers",onInput:t[1]||(t[1]=g=>a.isLoadingCustomers=!0),skeleton:e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),u(y,{size:"xs",type:"light",leftIcon:a.Plus,action:e.addNew,buttonClass:"my-2"},{default:x(()=>t[2]||(t[2]=[s("span",null,"Add New",-1)])),_:1,__:[2]},8,["leftIcon","action"])])):S("",!0),a.isLoadingCustomers?(o(),i("div",rr,[(o(),i(f,null,k([1,2,3],(g,w)=>s("div",{key:w,class:"flex items-center space-x-2 border-b border-gray-300 shadow-sm rounded-lg p-2 bg-gray-50 w-full"},[u(_,{width:"w-10",height:"h-10",rounded:"rounded-lg",shine:!0,class:"flex-shrink-0"}),s("div",or,[u(_,{width:"w-2/3",shine:!0}),u(_,{width:"w-1/3",shine:!0})])])),64))])):e.hasCustomers?(o(),p(d,{key:2,customers:a.customers,onSelectCustomer:e.onSelectCustomer},null,8,["customers","onSelectCustomer"])):(o(),i("p",sr," No customers found "))]),_:1},8,["onShow","leftTriggerIcon","header","triggerText","triggerLoading"])])}const nr=b($t,[["render",ir]]),ar={inject:["storeState","orderState"],components:{Input:M,Skeleton:D,AddCustomer:nr},data(){return{modified:!1,customer_email:null,customer_last_name:null,customer_first_name:null,customer_mobile_number:null}},watch:{orderForm:{handler(n,t){t==null?(this.customer_email=n.customer_email,this.customer_last_name=n.customer_last_name,this.customer_first_name=n.customer_first_name,this.customer_mobile_number=n.customer_mobile_number):this.modified=n.customer_email!==this.customer_email||n.customer_last_name!==this.customer_last_name||n.customer_first_name!==this.customer_first_name||n.customer_mobile_number!==this.customer_mobile_number},deep:!0}},computed:{hasOrder(){return this.orderState.hasOrder},orderForm(){return this.orderState.orderForm},isEditting(){return this.$route.name==="edit-order"},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},hasEmail(){var n;return(n=this.orderForm.customer_email)==null?void 0:n.trim()},hasMobileNumber(){var n;return(n=this.orderForm.customer_mobile_number)==null?void 0:n.trim()},hasCustomerDetails(){return this.orderState.hasCustomerDetails}}},dr={class:"bg-white rounded-lg p-4 shadow-sm"},lr={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},ur={class:"w-full space-y-4"},cr={key:0,class:"space-y-2"},mr={key:1,class:"border-t border-dashed border-gray-300 pt-4 mt-4"};function hr(n,t,r,c,a,e){const l=m("Skeleton"),y=m("Input"),_=m("AddCustomer");return o(),i("div",dr,[t[13]||(t[13]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Customer",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",lr,[t[10]||(t[10]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])],-1)),s("div",ur,[u(l,{width:"w-full",shine:!0}),u(l,{width:"w-1/3",shine:!0})])])):(o(),i(f,{key:1},[e.hasCustomerDetails||a.modified?(o(),i("div",cr,[u(y,{type:"text",placeholder:"First name",modelValue:e.orderForm.customer_first_name,"onUpdate:modelValue":t[0]||(t[0]=d=>e.orderForm.customer_first_name=d),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,onInput:t[1]||(t[1]=d=>e.orderState.saveStateDebounced("Customer first name changed"))},null,8,["modelValue","skeleton"]),u(y,{type:"text",placeholder:"Last name",modelValue:e.orderForm.customer_last_name,"onUpdate:modelValue":t[2]||(t[2]=d=>e.orderForm.customer_last_name=d),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,onInput:t[3]||(t[3]=d=>e.orderState.saveStateDebounced("Customer last name changed"))},null,8,["modelValue","skeleton"]),u(y,{type:"email",placeholder:"Email",modelValue:e.orderForm.customer_email,"onUpdate:modelValue":t[4]||(t[4]=d=>e.orderForm.customer_email=d),onInput:t[5]||(t[5]=d=>e.orderState.saveStateDebounced("Customer email changed")),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?S("",!0):(o(),p(y,{key:0,type:"text",placeholder:"+26772000001",modelValue:e.orderForm.customer_mobile_number,"onUpdate:modelValue":t[6]||(t[6]=d=>e.orderForm.customer_mobile_number=d),onChange:t[7]||(t[7]=d=>e.orderState.saveStateDebounced("Customer mobile number changed"))},null,8,["modelValue"]))])):S("",!0),e.hasEmail||e.hasMobileNumber?(o(),i("div",mr,[u(y,{type:"checkbox",inputLabel:"Update customer profile",modelValue:e.orderForm.update_profile,"onUpdate:modelValue":t[8]||(t[8]=d=>e.orderForm.update_profile=d),inputDescription:"Make sure to update both the order customer details and the customer profile",onChange:t[9]||(t[9]=d=>e.orderState.saveStateDebounced(`Update customer profile (${e.orderForm.update_profile?"On":"Off"})`))},null,8,["modelValue"])])):S("",!0),s("div",{class:F([e.hasCustomerDetails||a.modified?"border-t border-dashed border-gray-300 pt-4 mt-4":"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4"])},[!e.hasCustomerDetails&&!a.modified?(o(),i(f,{key:0},[t[11]||(t[11]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})],-1)),t[12]||(t[12]=s("span",{class:"text-sm text-gray-500"},"No customer added",-1))],64)):S("",!0),u(_,{hasCustomerDetails:e.hasCustomerDetails},null,8,["hasCustomerDetails"])],2)],64))])}const _r=b(ar,[["render",hr]]),yr={inject:["storeState","orderState"],components:{Tag:Ze,Input:M,Button:V},props:{index:{type:Number},cartProduct:{type:Object}},data(){return{Trash2:ee}},computed:{store(){return this.storeState.store},hasPhotoPath(){return this.photoPath!=null},photoPath(){return this.cartProduct.photo_path},grandTotal(){const n=parseFloat(this.cartProduct.unit_regular_price),t=parseFloat(this.cartProduct.unit_sale_price),r=parseInt(this.cartProduct.quantity),c=this.store.currency.code;return t>0&&t<n?de(t*r,c):de(n*r,c)}}},gr={class:"rounded-lg overflow-hidden border border-gray-300 py-2 px-4 bg-gray-50"},pr={class:"w-full flex space-x-4"},fr=["src"],vr={key:1,class:"w-6 h-6 text-gray-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Sr={class:"w-full space-y-4"},wr={class:"w-full text-sm text-left"},br={class:"whitespace-nowrap align-top py-2 pr-2"},xr={class:"whitespace-nowrap align-top p-2"},kr={class:"whitespace-nowrap align-top py-2 pl-2"},Cr={class:"grid grid-cols-3 my-4"},Dr={class:"col-span-1 col-start-2 flex items-center justify-center space-x-2"},Pr={class:"text-gray-700 text-center"},Or={class:"col-span-1"},Mr={class:"flex justify-end"};function Fr(n,t,r,c,a,e){const l=m("Input"),y=m("Tag"),_=m("Button");return o(),i("div",gr,[s("div",pr,[s("div",{class:F(["flex items-center justify-center w-16 h-16 rounded-lg",{"border border-dashed border-gray-200":!e.hasPhotoPath}])},[e.hasPhotoPath?(o(),i("img",{key:0,class:"w-full object-contain rounded-lg bg-red-200 flex-shrink-0",src:e.photoPath},null,8,fr)):(o(),i("svg",vr,t[8]||(t[8]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"},null,-1)])))],2),s("div",Sr,[u(l,{type:"text",label:"Name",modelValue:r.cartProduct.name,"onUpdate:modelValue":t[0]||(t[0]=d=>r.cartProduct.name=d),placeholder:"Standard Ticket",onInput:t[1]||(t[1]=d=>e.orderState.saveStateDebounced("Product name changed"))},null,8,["modelValue"]),s("table",wr,[t[9]||(t[9]=s("thead",null,[s("tr",null,[s("th",{class:"whitespace-nowrap align-top px-2 pr-2"},[s("span",{class:"text-gray-700 text-xs font-normal uppercase"},"Regular Price")]),s("th",{class:"whitespace-nowrap align-top px-2"},[s("span",{class:"text-gray-700 text-xs font-normal uppercase"},"Sale Price")]),s("th",{class:"whitespace-nowrap align-top px-2 pl-2"},[s("span",{class:"text-gray-700 text-xs font-normal uppercase"},"Quantity")])])],-1)),s("tbody",null,[s("tr",null,[s("td",br,[u(l,{type:"money",currency:e.store.currency.code,modelValue:r.cartProduct.unit_regular_price,"onUpdate:modelValue":t[2]||(t[2]=d=>r.cartProduct.unit_regular_price=d),onInput:t[3]||(t[3]=d=>e.orderState.saveStateDebounced("Product regular price changed"))},null,8,["currency","modelValue"])]),s("td",xr,[u(l,{type:"money",currency:e.store.currency.code,modelValue:r.cartProduct.unit_sale_price,"onUpdate:modelValue":t[4]||(t[4]=d=>r.cartProduct.unit_sale_price=d),onInput:t[5]||(t[5]=d=>e.orderState.saveStateDebounced("Product sale price changed"))},null,8,["currency","modelValue"])]),s("td",kr,[u(l,{type:"number",modelValue:r.cartProduct.quantity,"onUpdate:modelValue":t[6]||(t[6]=d=>r.cartProduct.quantity=d),onInput:t[7]||(t[7]=d=>e.orderState.saveStateDebounced("Product quantity changed"))},null,8,["modelValue"])])])])])])]),s("div",Cr,[s("div",Dr,[u(y,{size:"16",class:"text-gray-500"}),s("span",Pr,v(e.store.currency.symbol)+v(e.grandTotal),1)]),s("div",Or,[s("div",Mr,[u(_,{size:"xs",type:"danger",leftIcon:a.Trash2,action:()=>e.orderState.removeCartProduct(r.index)},{default:x(()=>t[10]||(t[10]=[s("span",null,"Remove Product",-1)])),_:1,__:[10]},8,["leftIcon","action"])])])])])}const Lr=b(yr,[["render",Fr]]),Tr={components:{Pill:fe},props:{product:{type:Object},onSelectProduct:{type:Function}},computed:{photo(){return this.product.photo},hasPhoto(){return this.photo!=null}}},Ir=["src"],Vr={key:1,class:"w-6 h-6 text-gray-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},jr={class:"w-full flex items-center justify-between"},Ar={class:"text-sm font-semibold"},Er={class:"text-xs space-x-2"},Rr={key:0};function Nr(n,t,r,c,a,e){const l=m("Pill");return o(),i("div",{onClick:t[0]||(t[0]=()=>r.onSelectProduct(r.product)),class:"flex justify-between items-center cursor-pointer p-2 space-x-4 rounded-lg bg-gray-50 hover:bg-gray-100"},[s("div",{class:F(["flex items-center justify-center w-10 h-10 rounded-lg",{"border border-dashed border-gray-200":!e.hasPhoto}])},[e.hasPhoto?(o(),i("img",{key:0,class:"w-full max-h-10 object-contain rounded-lg flex-shrink-0",src:e.photo.path},null,8,Ir)):(o(),i("svg",Vr,t[1]||(t[1]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"},null,-1)])))],2),s("div",jr,[s("div",null,[s("p",Ar,v(r.product.name),1),s("p",Er,[s("span",{class:F({"line-through text-gray-500":r.product.on_sale})},v(r.product.unit_regular_price.amount_with_currency),3),r.product.on_sale?(o(),i("span",Rr,v(r.product.unit_sale_price.amount_with_currency),1)):S("",!0)])]),r.product.allow_variations.status?(o(),p(l,{key:0,type:"light",size:"xs"},{default:x(()=>[I(v(r.product.total_visible_variations)+" options",1)]),_:1})):S("",!0)])])}const Se=b(Tr,[["render",Nr]]),Br={components:{ProductOption:Se},props:{products:{type:Array},onSelectProduct:{type:Function}}},Ur={class:"max-h-80 overflow-y-auto space-y-2 mb-4"};function qr(n,t,r,c,a,e){const l=m("ProductOption");return o(),i("div",Ur,[(o(!0),i(f,null,k(r.products,(y,_)=>(o(),p(l,{key:_,product:y,onSelectProduct:r.onSelectProduct},null,8,["product","onSelectProduct"]))),128))])}const Zr=b(Br,[["render",qr]]),zr={inject:["formState","notificationState"],components:{Select:B,Skeleton:D,ProductOption:Se},props:{selectedProduct:{type:Object},onSelectProduct:{type:Function}},data(){return{variations:[],variantAttributeValues:{},isLoadingProductVariations:!1}},computed:{matchingVariations(){return this.variations.filter(n=>Object.entries(this.variantAttributeValues).every(([t,r])=>n.variables.some(c=>c.value===r)))}},methods:{initializeVariantDefaults(){this.variantAttributeValues={},this.selectedProduct.variant_attributes.forEach(n=>{n.values.length>0&&(this.variantAttributeValues[n.name]=n.values[0])})},async showProductVariations(){var n,t;try{this.isLoadingProductVariations=!0;let r={params:{per_page:100,_relationships:["photo"].join(",")}};const a=(await j.get(`/api/products/${this.selectedProduct.id}/variations`,r)).data;this.variations=a.data,this.initializeVariantDefaults()}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching product variations";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch product variations:",r)}finally{this.isLoadingProductVariations=!1,this.hasLoadedInitialProducts=!0}}},created(){this.showProductVariations()}},Wr={class:"space-y-2 mb-4"},Hr={class:"space-y-3 mb-4"},Yr=["value"];function Gr(n,t,r,c,a,e){const l=m("Skeleton"),y=m("Select"),_=m("ProductOption");return o(),i("div",Wr,[a.isLoadingProductVariations?(o(),i(f,{key:0},k([1,2,3],(d,h)=>s("div",{key:h,class:"border-b border-gray-300 shadow-sm rounded-lg p-2 bg-gray-50 w-full"},[u(l,{width:"w-1/3",shine:!0})])),64)):(o(),i(f,{key:1},[s("div",Hr,[(o(!0),i(f,null,k(r.selectedProduct.variant_attributes,(d,h)=>(o(),p(y,{key:h,width:"w-full",label:d.name,description:d.instruction,modelValue:a.variantAttributeValues[d.name],"onUpdate:modelValue":g=>a.variantAttributeValues[d.name]=g},{default:x(()=>[(o(!0),i(f,null,k(d.values,(g,w)=>(o(),i("option",{value:g,key:w},v(g),9,Yr))),128))]),_:2},1032,["label","description","modelValue","onUpdate:modelValue"]))),128))]),e.matchingVariations.length===1?(o(),p(_,{key:0,product:e.matchingVariations[0],onSelectProduct:r.onSelectProduct},null,8,["product","onSelectProduct"])):S("",!0)],64))])}const Qr=b(zr,[["render",Gr]]),Xr={inject:["formState","orderState","storeState","notificationState"],components:{Input:M,Modal:te,Button:V,Skeleton:D,ProductOptions:Zr,ProductVariationOptions:Qr},data(){return{Plus:Z,ArrowLeft:Re,products:[],searchTerm:null,lastSearchTerm:null,selectedProduct:null,isLoadingProducts:!1,hasLoadedInitialProducts:!1}},watch:{searchTerm(){this.showProducts()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},hasProducts(){return this.products.length>0}},methods:{onShow(){this.hasLoadedInitialProducts=!1,this.selectedProduct=null,this.lastSearchTerm=null,this.searchTerm=null,this.products=[],this.showProducts()},async showProducts(){var n,t;try{this.isLoadingProducts=!0;let r={params:{_relationships:"photo",store_id:this.store.id,association:"team member"}};this.hasSearchTerm&&(r.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const c=await j.get("/api/products",r);if(this.searchTerm===this.lastSearchTerm){const a=c.data;this.products=a.data,this.isLoadingProducts=!1,this.hasLoadedInitialProducts=!0}}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch products:",r)}finally{this.isLoadingProducts=!1}},onSelectProduct(n){n.allow_variations.status?this.selectedProduct=n:(this.$refs.modal.hideModal(),this.orderState.addCartProductUsingProduct(n))},removeSelectedProduct(){this.selectedProduct=null},addNew(){this.$refs.modal.hideModal(),this.orderState.addCartProduct()}}},Jr={class:"flex justify-center"},Kr={key:0,class:"flex justify-center items-center space-x-4 my-2"},$r={key:1,class:"space-y-2 mb-4"},eo={class:"w-full space-y-2"},to={class:"text-lg font-bold border-b border-dashed my-4 pb-4"},ro={key:4,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function oo(n,t,r,c,a,e){const l=m("Input"),y=m("Button"),_=m("Skeleton"),d=m("ProductVariationOptions"),h=m("ProductOptions"),g=m("Modal");return o(),i("div",Jr,[u(g,{ref:"modal",onShow:e.onShow,triggerSize:"sm",leftTriggerIcon:a.Plus,contentClass:"px-4",triggerType:"light",header:"Add Product",scrollOnContent:!1,triggerText:"Add Product",showApproveButton:!1,triggerLoading:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},{content:x(()=>[a.hasLoadedInitialProducts&&!a.selectedProduct?(o(),i("div",Kr,[u(l,{type:"search",class:"w-full",debounced:!0,modelValue:a.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=w=>a.searchTerm=w),placeholder:"Search products",onInput:t[1]||(t[1]=w=>a.isLoadingProducts=!0),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),u(y,{size:"xs",type:"light",leftIcon:a.Plus,action:e.addNew,buttonClass:"my-2"},{default:x(()=>t[2]||(t[2]=[s("span",null,"Add New",-1)])),_:1,__:[2]},8,["leftIcon","action"])])):S("",!0),a.isLoadingProducts?(o(),i("div",$r,[(o(),i(f,null,k([1,2,3],(w,P)=>s("div",{key:P,class:"flex items-center space-x-2 border-b border-gray-300 shadow-sm rounded-lg p-2 bg-gray-50 w-full"},[u(_,{width:"w-10",height:"h-10",rounded:"rounded-lg",shine:!0,class:"flex-shrink-0"}),s("div",eo,[u(_,{width:"w-2/3",shine:!0}),u(_,{width:"w-1/3",shine:!0})])])),64))])):a.selectedProduct?(o(),i(f,{key:2},[u(y,{size:"xs",type:"light",buttonClass:"mt-4",leftIcon:a.ArrowLeft,action:e.removeSelectedProduct},{default:x(()=>t[3]||(t[3]=[s("span",null,"Back",-1)])),_:1,__:[3]},8,["leftIcon","action"]),s("p",to,v(a.selectedProduct.name),1),u(d,{onSelectProduct:e.onSelectProduct,selectedProduct:a.selectedProduct},null,8,["onSelectProduct","selectedProduct"])],64)):e.hasProducts?(o(),p(h,{key:3,products:a.products,onSelectProduct:e.onSelectProduct},null,8,["products","onSelectProduct"])):(o(),i("p",ro," No products found "))]),_:1},8,["onShow","leftTriggerIcon","triggerLoading"])])}const so=b(Xr,[["render",oo]]),io={inject:["storeState","orderState"],components:{Skeleton:D,AddProduct:so,OrderProduct:Lr},computed:{hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},cartProducts(){return this.orderState.orderForm.cart_products},isEditting(){return this.$route.name==="edit-order"},hasCartProducts(){return this.cartProducts.length>0}}},no={class:"bg-white rounded-lg p-4 shadow-sm"},ao={key:0,class:"space-y-2"},lo={class:"w-full space-y-4"},uo={key:1,class:"space-y-4"};function co(n,t,r,c,a,e){const l=m("Skeleton"),y=m("OrderProduct"),_=m("AddProduct");return o(),i("div",no,[t[3]||(t[3]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Products",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",ao,[(o(),i(f,null,k([1,2,3],(d,h)=>s("div",{key:h,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])],-1)),s("div",lo,[u(l,{width:"w-full",shine:!0}),u(l,{width:"w-1/3",shine:!0})])])),64))])):(o(),i("div",uo,[e.hasCartProducts?(o(!0),i(f,{key:0},k(e.cartProducts,(d,h)=>(o(),p(y,{key:h,index:h,cartProduct:d},null,8,["index","cartProduct"]))),128)):S("",!0),s("div",{class:F([{"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4 my-4":!e.hasCartProducts}])},[e.hasCartProducts?S("",!0):(o(),i(f,{key:0},[t[1]||(t[1]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"})],-1)),t[2]||(t[2]=s("span",{class:"text-sm text-gray-500"},"No products added",-1))],64)),u(_)],2)]))])}const mo=b(io,[["render",co]]),ho={inject:["storeState","orderState"],components:{Input:M,Button:V,Switch:$,Select:B},props:{index:{type:Number},cartPromotion:{type:Object}},data(){return{Trash2:ee,RATE_TYPES:q,discountRateTypes:Object.entries(q).map(([n,t])=>({label:N(t),value:t}))}},computed:{store(){return this.storeState.store}}},_o={class:"rounded-lg border border-fuchsia-300 py-2 px-4 bg-fuchsia-50"},yo={class:"w-full space-y-4"},go={class:"grid grid-cols-3 gap-1"},po={class:"flex justify-between my-4"};function fo(n,t,r,c,a,e){const l=m("Input"),y=m("Switch"),_=m("Select"),d=m("Button");return o(),i("div",_o,[s("div",yo,[u(l,{type:"text",label:"Name",modelValue:r.cartPromotion.name,"onUpdate:modelValue":t[0]||(t[0]=h=>r.cartPromotion.name=h),placeholder:"Standard Ticket",onInput:t[1]||(t[1]=h=>e.orderState.saveStateDebounced("Promotion name changed"))},null,8,["modelValue"]),s("div",go,[u(y,{size:"xs",suffixText:"Offer discount",modelValue:r.cartPromotion.offer_discount,"onUpdate:modelValue":t[2]||(t[2]=h=>r.cartPromotion.offer_discount=h),onInput:t[3]||(t[3]=h=>e.orderState.saveStateDebounced("Promotion discount offer changed"))},null,8,["modelValue"]),r.cartPromotion.offer_discount?(o(),i(f,{key:0},[u(_,{class:"w-full",search:!1,options:a.discountRateTypes,placeholder:"Select discount type",modelValue:r.cartPromotion.discount_rate_type,"onUpdate:modelValue":t[4]||(t[4]=h=>r.cartPromotion.discount_rate_type=h),onChange:t[5]||(t[5]=h=>e.orderState.saveStateDebounced("Promotion discount type changed"))},null,8,["options","modelValue"]),r.cartPromotion.discount_rate_type==a.RATE_TYPES.FLAT?(o(),p(l,{key:0,type:"money",currency:e.store.currency.code,modelValue:r.cartPromotion.discount_flat_rate,"onUpdate:modelValue":t[6]||(t[6]=h=>r.cartPromotion.discount_flat_rate=h),onInput:t[7]||(t[7]=h=>e.orderState.saveStateDebounced("Promotion discount amount changed"))},null,8,["currency","modelValue"])):(o(),p(l,{key:1,type:"percentage",modelValue:r.cartPromotion.discount_percentage_rate,"onUpdate:modelValue":t[8]||(t[8]=h=>r.cartPromotion.discount_percentage_rate=h),onInput:t[9]||(t[9]=h=>e.orderState.saveStateDebounced("Promotion discount amount changed"))},null,8,["modelValue"]))],64)):S("",!0)])]),s("div",po,[u(y,{size:"xs",suffixText:"Offer free delivery",modelValue:r.cartPromotion.offer_free_delivery,"onUpdate:modelValue":t[10]||(t[10]=h=>r.cartPromotion.offer_free_delivery=h),onInput:t[11]||(t[11]=h=>e.orderState.saveStateDebounced("Promotion fee delivery offer changed"))},null,8,["modelValue"]),u(d,{size:"xs",type:"danger",leftIcon:a.Trash2,action:()=>e.orderState.removeCartPromotion(r.index)},{default:x(()=>t[12]||(t[12]=[s("span",null,"Remove Promotion",-1)])),_:1,__:[12]},8,["leftIcon","action"])])])}const vo=b(ho,[["render",fo]]),So={components:{Pill:fe},props:{promotion:{type:Object},onSelectPromotion:{type:Function}}},wo={class:"w-full flex items-center justify-between"},bo={class:"text-sm font-semibold"},xo={class:"flex items-center space-x-1"};function ko(n,t,r,c,a,e){const l=m("Pill");return o(),i("div",{onClick:t[0]||(t[0]=()=>r.onSelectPromotion(r.promotion)),class:"flex justify-between items-center cursor-pointer p-3 space-x-4 border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100"},[s("div",wo,[s("div",null,[s("p",bo,v(r.promotion.name),1)]),s("div",xo,[r.promotion.offer_discount?(o(),p(l,{key:0,type:"success",size:"xs"},{default:x(()=>t[1]||(t[1]=[I("discount")])),_:1,__:[1]})):S("",!0),r.promotion.offer_free_delivery?(o(),p(l,{key:1,type:"success",size:"xs"},{default:x(()=>t[2]||(t[2]=[I("free delivery")])),_:1,__:[2]})):S("",!0)])])])}const Co=b(So,[["render",ko]]),Do={components:{PromotionOption:Co},props:{promotions:{type:Array},onSelectPromotion:{type:Function}}},Po={class:"max-h-80 overflow-y-auto space-y-2 mb-4"};function Oo(n,t,r,c,a,e){const l=m("PromotionOption");return o(),i("div",Po,[(o(!0),i(f,null,k(r.promotions,(y,_)=>(o(),p(l,{key:_,promotion:y,onSelectPromotion:r.onSelectPromotion},null,8,["promotion","onSelectPromotion"]))),128))])}const Mo=b(Do,[["render",Oo]]),Fo={inject:["formState","orderState","storeState","notificationState"],components:{Input:M,Modal:te,Button:V,Skeleton:D,PromotionOptions:Mo},data(){return{Plus:Z,promotions:[],searchTerm:null,lastSearchTerm:null,isLoadingPromotions:!1,hasLoadedInitialPromotions:!1}},watch:{searchTerm(){this.showPromotions()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},isEditting(){return this.$route.name==="edit-order"},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""},hasPromotions(){return this.promotions.length>0}},methods:{onShow(){this.hasLoadedInitialPromotions=!1,this.lastSearchTerm=null,this.searchTerm=null,this.promotions=[],this.showPromotions()},async showPromotions(){var n,t;try{this.isLoadingPromotions=!0;let r={params:{store_id:this.store.id}};this.hasSearchTerm&&(r.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const c=await j.get("/api/promotions",r);if(this.searchTerm===this.lastSearchTerm){const a=c.data;this.promotions=a.data,this.isLoadingPromotions=!1,this.hasLoadedInitialPromotions=!0}}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching promotions";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch promotions:",r)}finally{this.isLoadingPromotions=!1}},onSelectPromotion(n){this.$refs.modal.hideModal(),this.orderState.addCartPromotionUsingPromotion(n)},addNew(){this.$refs.modal.hideModal(),this.orderState.addCartPromotion()}}},Lo={class:"flex justify-center"},To={key:0,class:"flex justify-center items-center space-x-4 my-2"},Io={key:1,class:"space-y-2 mb-4"},Vo={class:"w-full space-y-2"},jo={key:3,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function Ao(n,t,r,c,a,e){const l=m("Input"),y=m("Button"),_=m("Skeleton"),d=m("PromotionOptions"),h=m("Modal");return o(),i("div",Lo,[u(h,{ref:"modal",onShow:e.onShow,triggerSize:"sm",leftTriggerIcon:a.Plus,contentClass:"px-4",triggerType:"light",header:"Add Promotion",scrollOnContent:!1,showApproveButton:!1,triggerText:"Add Promotion",triggerLoading:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},{content:x(()=>[a.hasLoadedInitialPromotions?(o(),i("div",To,[u(l,{type:"search",class:"w-full",debounced:!0,modelValue:a.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=g=>a.searchTerm=g),placeholder:"Search promotions",onInput:t[1]||(t[1]=g=>a.isLoadingPromotions=!0),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder},null,8,["modelValue","skeleton"]),u(y,{size:"xs",type:"light",action:e.addNew,leftIcon:a.Plus,buttonClass:"my-2"},{default:x(()=>t[2]||(t[2]=[s("span",null,"Add New",-1)])),_:1,__:[2]},8,["action","leftIcon"])])):S("",!0),a.isLoadingPromotions?(o(),i("div",Io,[(o(),i(f,null,k([1,2,3],(g,w)=>s("div",{key:w,class:"flex items-center space-x-2 border-b border-gray-300 shadow-sm rounded-lg p-2 bg-gray-50 w-full"},[u(_,{width:"w-10",height:"h-10",rounded:"rounded-lg",shine:!0,class:"flex-shrink-0"}),s("div",Vo,[u(_,{width:"w-2/3",shine:!0}),u(_,{width:"w-1/3",shine:!0})])])),64))])):e.hasPromotions?(o(),p(d,{key:2,promotions:a.promotions,onSelectPromotion:e.onSelectPromotion},null,8,["promotions","onSelectPromotion"])):(o(),i("p",jo," No promotions found "))]),_:1},8,["onShow","leftTriggerIcon","triggerLoading"])])}const Eo=b(Fo,[["render",Ao]]),Ro={inject:["storeState","orderState"],components:{Skeleton:D,AddPromotion:Eo,OrderPromotion:vo},computed:{hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},cartPromotions(){return this.orderState.orderForm.cart_promotions},isEditting(){return this.$route.name==="edit-order"},hasCartPromotions(){return this.cartPromotions.length>0}}},No={class:"bg-white rounded-lg p-4 shadow-sm"},Bo={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},Uo={class:"w-full space-y-4"},qo={key:1,class:"space-y-4"};function Zo(n,t,r,c,a,e){const l=m("Skeleton"),y=m("OrderPromotion"),_=m("AddPromotion");return o(),i("div",No,[t[3]||(t[3]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Promotions",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",Bo,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.99 14.993 6-6m6 3.001c0 1.268-.63 2.39-1.593 3.069a3.746 3.746 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043 3.745 3.745 0 0 1-3.068 1.593c-1.268 0-2.39-.63-3.068-1.593a3.745 3.745 0 0 1-3.296-1.043 3.746 3.746 0 0 1-1.043-3.297 3.746 3.746 0 0 1-1.593-3.068c0-1.268.63-2.39 1.593-3.068a3.746 3.746 0 0 1 1.043-3.297 3.745 3.745 0 0 1 3.296-1.042 3.745 3.745 0 0 1 3.068-1.594c1.268 0 2.39.63 3.068 1.593a3.745 3.745 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.297 3.746 3.746 0 0 1 1.593 3.068ZM9.74 9.743h.008v.007H9.74v-.007Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm4.125 4.5h.008v.008h-.008v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])],-1)),s("div",Uo,[u(l,{width:"w-full",shine:!0}),u(l,{width:"w-1/3",shine:!0})])])):(o(),i("div",qo,[e.hasCartPromotions?(o(!0),i(f,{key:0},k(e.cartPromotions,(d,h)=>(o(),p(y,{key:h,index:h,cartPromotion:d},null,8,["index","cartPromotion"]))),128)):S("",!0),s("div",{class:F([{"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4":!e.hasCartPromotions}])},[e.hasCartPromotions?S("",!0):(o(),i(f,{key:0},[t[1]||(t[1]=s("svg",{class:"w-10 h-10 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.99 14.993 6-6m6 3.001c0 1.268-.63 2.39-1.593 3.069a3.746 3.746 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043 3.745 3.745 0 0 1-3.068 1.593c-1.268 0-2.39-.63-3.068-1.593a3.745 3.745 0 0 1-3.296-1.043 3.746 3.746 0 0 1-1.043-3.297 3.746 3.746 0 0 1-1.593-3.068c0-1.268.63-2.39 1.593-3.068a3.746 3.746 0 0 1 1.043-3.297 3.745 3.745 0 0 1 3.296-1.042 3.745 3.745 0 0 1 3.068-1.594c1.268 0 2.39.63 3.068 1.593a3.745 3.745 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.297 3.746 3.746 0 0 1 1.593 3.068ZM9.74 9.743h.008v.007H9.74v-.007Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm4.125 4.5h.008v.008h-.008v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})],-1)),t[2]||(t[2]=s("span",{class:"text-sm text-gray-500"},"No promotions added",-1))],64)),u(_)],2)]))])}const zo=b(Ro,[["render",Zo]]),Wo={inject:["formState","storeState","orderState"],components:{Input:M,Skeleton:D},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isEditting(){return this.$route.name==="edit-order"},orderForm(){return this.orderState.orderForm},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder}}},Ho={class:"bg-white rounded-lg p-4 shadow-sm"},Yo={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},Go={class:"w-full space-y-4"},Qo={key:1,class:"space-y-2"};function Xo(n,t,r,c,a,e){const l=m("Skeleton"),y=m("Input");return o(),i("div",Ho,[t[5]||(t[5]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Other",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",Yo,[t[4]||(t[4]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])],-1)),s("div",Go,[u(l,{width:"w-full",shine:!0}),u(l,{width:"w-1/3",shine:!0})])])):(o(),i("div",Qo,[u(y,{rows:"2",label:"Remark",type:"textarea",placeholder:"Optional",modelValue:e.orderForm.remark,"onUpdate:modelValue":t[0]||(t[0]=_=>e.orderForm.remark=_),description:"Visible to customers",errorText:e.formState.getFormError("remark"),onChange:t[1]||(t[1]=_=>e.orderState.saveStateDebounced("Remark changed")),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,tooltipContent:"Use the Remark field to add a note that will be visible to the customer, such as special instructions, order details, or personalized messages."},null,8,["modelValue","errorText","skeleton"]),u(y,{type:"money",label:"Adjustment",allowNegativeAmounts:!0,currency:e.store.currency.code,modelValue:e.orderForm.adjustment,"onUpdate:modelValue":t[2]||(t[2]=_=>e.orderForm.adjustment=_),errorText:e.formState.getFormError("adjustment"),onChange:t[3]||(t[3]=_=>e.orderState.saveStateDebounced("Adjustment changed")),skeleton:e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder,description:"Modify the order total by adding or subtracting an arbitrary amount",tooltipContent:"Use the Adjustment field to manually add or subtract an amount for discounts, extra charges, or price corrections."},null,8,["currency","modelValue","errorText","skeleton"])]))])}const Jo=b(Wo,[["render",Xo]]),Ko={inject:["orderState"],components:{AddressInput:Ne},computed:{orderForm(){return this.orderState.orderForm}},methods:{setAddress(n){this.orderState.orderForm.delivery_address=n,this.orderState.saveStateDebounced("Delivery address changed")},unsetAddress(){this.orderState.orderForm.delivery_address=null,this.orderState.saveStateDebounced("Delivery address removed")}}},$o={class:"space-y-4 p-4"};function es(n,t,r,c,a,e){const l=m("AddressInput");return o(),i("div",$o,[u(l,{title:"Destination",onlyValidate:!0,pinLocationOnMap:!0,onOnDeleted:e.unsetAddress,onOnValidated:e.setAddress,address:e.orderForm.delivery_address,subtitle:"Add the address to deliver this order"},null,8,["onOnDeleted","onOnValidated","address"])])}const ts=b(Ko,[["render",es]]),rs={inject:["formState","storeState","notificationState"],components:{Skeleton:D,Datepicker:Ue,ShineEffect:ve},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object},showAllDates:{type:Boolean,default:!1}},emits:["update:modelValue","isLoading","change","scheduleOptions"],data(){return{minDate:null,maxDate:null,isLoading:!1,disabledDates:[],apiRequestCounter:0,disabledWeekDays:[],debounceInstance:null,localModelValue:this.modelValue}},watch:{modelValue(n){this.localModelValue=n},localModelValue(n){this.$emit("update:modelValue",n)},...["schedule_type","daily_order_limit","same_day_delivery","set_daily_order_limit","time_slot_interval_unit","auto_generate_time_slots","time_slot_interval_value","latest_delivery_time_value","earliest_delivery_time_unit","earliest_delivery_time_value","require_minimum_notice_for_orders","restrict_maximum_notice_for_orders"].reduce((n,t)=>(n[`form.${t}`]=function(){this.debouncedShowDeliveryMethodScheduleOptions()},n),{}),"form.operational_hours":{handler(){this.debouncedShowDeliveryMethodScheduleOptions()},deep:!0}},computed:{key(){return this.minDate+this.maxDate+this.showAllDates+this.disabledDates.length+this.disabledWeekDays.length},store(){return this.storeState.store}},methods:{formattedDate:De,setIsLoading(n){this.isLoading=n,this.$emit("isLoading",n)},parseForm(){return{store_id:this.store.id,schedule_type:this.form?this.form.schedule_type:this.deliveryMethod.schedule_type,daily_order_limit:this.form?this.form.daily_order_limit:this.deliveryMethod.daily_order_limit,same_day_delivery:this.form?this.form.same_day_delivery:this.deliveryMethod.same_day_delivery,operational_hours:this.form?this.form.operational_hours:this.deliveryMethod.operational_hours,set_daily_order_limit:this.form?this.form.set_daily_order_limit:this.deliveryMethod.set_daily_order_limit,time_slot_interval_unit:this.form?this.form.time_slot_interval_unit:this.deliveryMethod.time_slot_interval_unit,auto_generate_time_slots:this.form?this.form.auto_generate_time_slots:this.deliveryMethod.auto_generate_time_slots,time_slot_interval_value:this.form?this.form.time_slot_interval_value:this.deliveryMethod.time_slot_interval_value,latest_delivery_time_value:this.form?this.form.latest_delivery_time_value:this.deliveryMethod.latest_delivery_time_value,earliest_delivery_time_unit:this.form?this.form.earliest_delivery_time_unit:this.deliveryMethod.earliest_delivery_time_unit,earliest_delivery_time_value:this.form?this.form.earliest_delivery_time_value:this.deliveryMethod.earliest_delivery_time_value,require_minimum_notice_for_orders:this.form?this.form.require_minimum_notice_for_orders:this.deliveryMethod.require_minimum_notice_for_orders,restrict_maximum_notice_for_orders:this.form?this.form.restrict_maximum_notice_for_orders:this.deliveryMethod.restrict_maximum_notice_for_orders}},async showDeliveryMethodScheduleOptions(){var n,t;try{const r=this.parseForm(),c=++this.apiRequestCounter,a=await axios.post("/api/delivery-methods/schedule-options",r);if(c!==this.apiRequestCounter)return;const e=a.data;this.minDate=this.formattedDate(e.min_date),this.disabledWeekDays=e.days_of_week_disabled,this.disabledDates=e.dates_disabled.map(l=>this.formattedDate(l)),this.maxDate=e.max_date?this.formattedDate(e.max_date):null,this.$emit("scheduleOptions",e)}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching schedule options";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch schedule options:",r)}finally{this.setIsLoading(!1)}},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.debounceInstance=re(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},os={class:"flex items-center space-x-2"};function ss(n,t,r,c,a,e){const l=m("Skeleton"),y=m("ShineEffect"),_=m("Datepicker");return o(),i("div",null,[a.isLoading?(o(),p(y,{key:0},{default:x(()=>[s("div",os,[t[2]||(t[2]=s("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})],-1)),u(l,{width:"w-1/2"})])]),_:1})):(o(),p(_,{key:e.key,modelValue:a.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=d=>a.localModelValue=d),placeholder:"Select delivery date",minDate:r.showAllDates?null:a.minDate,maxDate:r.showAllDates?null:a.maxDate,onChange:t[1]||(t[1]=d=>n.$emit("change",d)),disabledDates:r.showAllDates?[]:a.disabledDates,disabledWeekDays:r.showAllDates?[]:a.disabledWeekDays},null,8,["modelValue","minDate","maxDate","disabledDates","disabledWeekDays"]))])}const is=b(rs,[["render",ss]]),ns={inject:["formState","storeState","notificationState"],components:{Select:B,Skeleton:D,ShineEffect:ve},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object},deliveryDate:{type:String},showAllDates:{type:Boolean,default:!1},showAllTimeslots:{type:Boolean,default:!1},autoSelectFirstTimeslot:{type:Boolean,value:!0}},emits:["update:modelValue","isLoading","change","scheduleOptions"],data(){return{isLoading:!1,apiRequestCounter:0,debounceInstance:null,availableTimeSlotOptions:[],localModelValue:this.modelValue}},watch:{modelValue(n){this.localModelValue=n},localModelValue(n){this.$emit("update:modelValue",n),this.$emit("change",n)},deliveryDate(n){n&&this.debouncedShowDeliveryMethodScheduleOptions()}},computed:{store(){return this.storeState.store}},methods:{setIsLoading(n){this.isLoading=n,this.$emit("isLoading",n)},parseForm(){return{store_id:this.store.id,show_all_dates:this.showAllDates,show_all_timeslots:this.showAllTimeslots,delivery_date:Pe(this.deliveryDate).format("YYYY-MM-DD"),schedule_type:this.form?this.form.schedule_type:this.deliveryMethod.schedule_type,daily_order_limit:this.form?this.form.daily_order_limit:this.deliveryMethod.daily_order_limit,same_day_delivery:this.form?this.form.same_day_delivery:this.deliveryMethod.same_day_delivery,operational_hours:this.form?this.form.operational_hours:this.deliveryMethod.operational_hours,set_daily_order_limit:this.form?this.form.set_daily_order_limit:this.deliveryMethod.set_daily_order_limit,time_slot_interval_unit:this.form?this.form.time_slot_interval_unit:this.deliveryMethod.time_slot_interval_unit,auto_generate_time_slots:this.form?this.form.auto_generate_time_slots:this.deliveryMethod.auto_generate_time_slots,time_slot_interval_value:this.form?this.form.time_slot_interval_value:this.deliveryMethod.time_slot_interval_value,latest_delivery_time_value:this.form?this.form.latest_delivery_time_value:this.deliveryMethod.latest_delivery_time_value,earliest_delivery_time_unit:this.form?this.form.earliest_delivery_time_unit:this.deliveryMethod.earliest_delivery_time_unit,earliest_delivery_time_value:this.form?this.form.earliest_delivery_time_value:this.deliveryMethod.earliest_delivery_time_value,require_minimum_notice_for_orders:this.form?this.form.require_minimum_notice_for_orders:this.deliveryMethod.require_minimum_notice_for_orders,restrict_maximum_notice_for_orders:this.form?this.form.restrict_maximum_notice_for_orders:this.deliveryMethod.restrict_maximum_notice_for_orders}},async showDeliveryMethodScheduleOptions(){var n,t;try{const r=this.parseForm(),c=++this.apiRequestCounter,a=await axios.post("/api/delivery-methods/schedule-options",r);if(c!==this.apiRequestCounter)return;const e=a.data,l=e.available_time_slots;this.autoSelectFirstTimeslot&&l.length&&!l.includes(this.localModelValue)&&(this.localModelValue=l[0]),this.availableTimeSlotOptions=l.map(function(y){return{label:y,value:y}}),this.$emit("scheduleOptions",e)}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching schedule options";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch schedule options:",r)}finally{this.setIsLoading(!1)}},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.availableTimeSlotOptions=[],this.debounceInstance=re(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},as={class:"flex items-center space-x-2"};function ds(n,t,r,c,a,e){const l=m("Skeleton"),y=m("ShineEffect"),_=m("Select");return o(),i("div",null,[a.isLoading?(o(),p(y,{key:0},{default:x(()=>[s("div",as,[t[1]||(t[1]=s("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1)),u(l,{width:"w-1/2"})])]),_:1})):(o(),p(_,{key:1,class:"w-full",search:!1,modelValue:a.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=d=>a.localModelValue=d),noResultsText:"No timeslots found",placeholder:"Select delivery time",options:a.availableTimeSlotOptions},null,8,["modelValue","options"]))])}const ls=b(ns,[["render",ds]]),us={inject:["orderState"],components:{Alert:Be,Input:M,Switch:$,Skeleton:D,DeliveryDatePicker:is,DeliveryTimePicker:ls},props:{index:{type:Number},deliveryMethod:{type:Object}},data(){return{originalDeliveryDate:null,isLoadingDateOptions:!1,originalDeliveryTimeslot:null,originalDeliveryDateIsPast:!1}},watch:{"orderForm.schedule.change_delivery_schedule"(n){n?this.originalDeliveryDateIsPast&&!this.orderForm.schedule.show_all_dates&&(this.orderForm.delivery_date=null,this.orderForm.delivery_timeslot=null):(this.orderForm.delivery_date=this.originalDeliveryDate,this.orderForm.delivery_timeslot=this.originalDeliveryTimeslot)},"orderForm.schedule.show_all_dates"(n){n?(this.orderForm.delivery_date=this.originalDeliveryDate,this.orderForm.delivery_timeslot=this.originalDeliveryTimeslot):this.originalDeliveryDateIsPast&&(this.orderForm.delivery_date=null,this.orderForm.delivery_timeslot=null),this.orderForm.schedule.show_all_timeslots=n}},computed:{isCreating(){return this.$route.name==="create-order"},shoppingCart(){return this.orderState.shoppingCart},orderForm(){return this.orderState.orderForm},isInspectingShoppingCart(){return this.orderState.isInspectingShoppingCart},deliveryDateIsPast(){return this.orderForm.delivery_date&&ae(this.orderForm.delivery_date)},shoppingCartDeliveryMethodOption(){return((this.shoppingCart||{}).delivery_method_options||[]).find(n=>n.id==this.deliveryMethod.id)},shoppingCartDeliveryMethodRequiresSchedule(){return(this.shoppingCartDeliveryMethodOption||{}).schedule_is_required||!1},shoppingCartDeliveryMethodScheduleIncompleteReasons(){return(this.shoppingCartDeliveryMethodOption||{}).schedule_incomplete_reasons||[]}},methods:{formattedShortWeekday:Oe,onIsLoadingDateOptions(n){this.isLoadingDateOptions=n}},created(){this.originalDeliveryDate=this.orderForm.delivery_date,this.originalDeliveryTimeslot=this.orderForm.delivery_timeslot,this.originalDeliveryDateIsPast=this.originalDeliveryDate&&ae(this.originalDeliveryDate)}},cs={key:0,class:"space-y-4 pt-4 px-4"},ms={class:"space-y-2"},hs={class:"text-sm text-gray-500"},_s={key:0,class:"space-y-2"},ys={class:"flex items-center space-x-4"},gs={key:1,class:"flex items-center space-x-1 md:space-x-2"},ps={class:"font-medium text-red-500 text-xs md:text-sm"},fs={key:2,class:"space-y-2 border-t border-b border-dashed border-gray-300 py-4"},vs={key:0,class:"text-sm"},Ss={class:"font-bold"},ws={key:1,class:"text-sm"},bs={class:"font-bold"};function xs(n,t,r,c,a,e){const l=m("Switch"),y=m("Input"),_=m("Alert"),d=m("DeliveryDatePicker"),h=m("DeliveryTimePicker"),g=m("Skeleton");return e.shoppingCartDeliveryMethodRequiresSchedule?(o(),i("div",cs,[s("div",ms,[t[8]||(t[8]=s("p",{class:"font-bold text-md"},"Schedule",-1)),s("div",null,[s("p",hs,[r.deliveryMethod.schedule_type=="date"?(o(),i(f,{key:0},[e.isCreating?(o(),i(f,{key:0},[I("Specify the delivery date for this order")],64)):(o(),i(f,{key:1},[I("The delivery date for this order")],64))],64)):r.deliveryMethod.schedule_type=="date and time"?(o(),i(f,{key:1},[e.isCreating?(o(),i(f,{key:0},[I("Specify the delivery date and time for this order")],64)):(o(),i(f,{key:1},[I("The delivery date and time for this order")],64))],64)):S("",!0)])])]),a.originalDeliveryDate?(o(),i("div",_s,[s("div",ys,[u(l,{size:"xs",suffixText:"Change delivery schedule",modelValue:e.orderForm.schedule.change_delivery_schedule,"onUpdate:modelValue":t[0]||(t[0]=w=>e.orderForm.schedule.change_delivery_schedule=w),onChange:t[1]||(t[1]=w=>e.orderState.saveStateDebounced(`Change delivery schedule (${e.orderForm.schedule.change_delivery_schedule?"On":"Off"})`))},null,8,["modelValue"]),e.orderForm.schedule.change_delivery_schedule?(o(),p(y,{key:0,type:"checkbox",modelValue:e.orderForm.schedule.show_all_dates,"onUpdate:modelValue":t[2]||(t[2]=w=>e.orderForm.schedule.show_all_dates=w),inputLabel:r.deliveryMethod.schedule_type=="date"?"Show all dates":"Show all dates and timeslots",onChange:t[3]||(t[3]=w=>e.orderState.saveStateDebounced(`Show all ${r.deliveryMethod.schedule_type=="date"?"dates":"dates and timeslots"} (${e.orderForm.schedule.show_all_dates?"On":"Off"})`))},null,8,["modelValue","inputLabel"])):S("",!0)]),e.orderForm.schedule.change_delivery_schedule&&e.deliveryDateIsPast?(o(),p(_,{key:0,type:"warning",dismissable:!0,title:"Delivery date passed",description:"Update the delivery date to a future date if the order hasn’t been delivered, otherwise ignore this message."})):S("",!0)])):S("",!0),!a.originalDeliveryDate||a.originalDeliveryDate&&e.orderForm.schedule.change_delivery_schedule?(o(),i(f,{key:1},[u(d,{deliveryMethod:r.deliveryMethod,onIsLoading:e.onIsLoadingDateOptions,modelValue:e.orderForm.delivery_date,"onUpdate:modelValue":t[4]||(t[4]=w=>e.orderForm.delivery_date=w),showAllDates:e.orderForm.schedule.show_all_dates,onChange:t[5]||(t[5]=w=>this.orderState.saveStateDebounced("Delivery date changed"))},null,8,["deliveryMethod","onIsLoading","modelValue","showAllDates"]),e.orderForm.delivery_date&&!a.isLoadingDateOptions&&r.deliveryMethod.schedule_type=="date and time"?(o(),p(h,{key:0,class:"w-full",deliveryMethod:r.deliveryMethod,autoSelectFirstTimeslot:e.isCreating,modelValue:e.orderForm.delivery_timeslot,"onUpdate:modelValue":t[6]||(t[6]=w=>e.orderForm.delivery_timeslot=w),deliveryDate:e.orderForm.delivery_date,showAllDates:e.orderForm.schedule.show_all_dates,showAllTimeslots:e.orderForm.schedule.show_all_timeslots,onChange:t[7]||(t[7]=w=>this.orderState.saveStateDebounced("Delivery time changed"))},null,8,["deliveryMethod","autoSelectFirstTimeslot","modelValue","deliveryDate","showAllDates","showAllTimeslots"])):S("",!0),(o(!0),i(f,null,k(e.shoppingCartDeliveryMethodScheduleIncompleteReasons,(w,P)=>(o(),i("div",{key:P},[e.isInspectingShoppingCart?(o(),p(g,{key:0,width:"w-1/3",shine:!0})):(o(),i("div",gs,[t[9]||(t[9]=s("svg",{class:"w-4 h-4 md:w-6 md:h-6 flex-shrink-0 text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})],-1)),s("span",ps,v(w),1)]))]))),128))],64)):S("",!0),e.orderForm.delivery_date||e.orderForm.delivery_timeslot?(o(),i("div",fs,[e.orderForm.delivery_date?(o(),i("div",vs,[t[10]||(t[10]=s("span",null,"Delivery date: ",-1)),s("span",Ss,v(e.orderForm.delivery_date)+" ("+v(e.formattedShortWeekday(e.orderForm.delivery_date))+") ",1)])):S("",!0),e.orderForm.delivery_timeslot?(o(),i("div",ws,[t[11]||(t[11]=s("span",null,"Delivery time: ",-1)),s("span",bs,v(e.orderForm.delivery_timeslot),1)])):S("",!0)])):S("",!0)])):S("",!0)}const ks=b(us,[["render",xs]]),Cs={inject:["orderState"],components:{Info:qe,CircleAlert:Ae,Skeleton:D,OrderDeliveryMethodMap:ts,OrderDeliveryMethodSchedule:ks},props:{index:{type:Number},deliveryMethod:{type:Object}},computed:{shoppingCart(){return this.orderState.shoppingCart},orderForm(){return this.orderState.orderForm},isInspectingShoppingCart(){return this.orderState.isInspectingShoppingCart},usesFlatFee(){return this.deliveryMethod.fee_type=="flat fee"},usesPercentageFee(){return this.deliveryMethod.fee_type=="percentage fee"},usesFeeByWeight(){return this.deliveryMethod.fee_type=="fee by weight"},usesFeeByDistance(){return this.deliveryMethod.fee_type=="fee by distance"},usesFeeByPostalCode(){return this.deliveryMethod.fee_type=="fee by postal code"},isSelectedDeliveryMethod(){return this.orderForm.delivery_method_id===this.deliveryMethod.id},shoppingCartDeliveryMethodOption(){return((this.shoppingCart||{}).delivery_method_options||[]).find(n=>n.id==this.deliveryMethod.id)},shoppingCartDeliveryMethodAmount(){return(this.shoppingCartDeliveryMethodOption||{}).amount},shoppingCartDeliveryMethodOffersFreeDelivery(){return(this.shoppingCartDeliveryMethodOption||{}).free_delivery},shoppingCartDeliveryMethodTips(){return(this.shoppingCartDeliveryMethodOption||{}).tips||[]},hasShoppingCartDeliveryMethodTips(){return this.shoppingCartDeliveryMethodTips.length>0},shoppingCartDeliveryMethodUnavailabilityReasons(){return(this.shoppingCartDeliveryMethodOption||{}).unavailability_reasons||[]},hasShoppingCartDeliveryMethodUnavailabilityReasons(){return this.shoppingCartDeliveryMethodUnavailabilityReasons.length>0}},methods:{selectDeliveryMethod(){this.orderForm.delivery_method_id=this.deliveryMethod.id,this.orderState.saveStateDebounced("Delivery method changed")}}},Ds={class:"flex items-center space-x-2"},Ps={key:0,class:"w-6 h-6 text-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},Os={key:1,class:"w-6 h-6 flex justify-center items-center"},Ms={class:"w-full"},Fs={class:"font-bold text-sm transition-colors"},Ls={class:"text-sm transition-colors"},Ts={key:0,class:"text-sm transition-colors text-green-500 font-bold"},Is={key:1,class:"text-sm transition-colors"},Vs={key:2,class:"text-sm transition-colors"},js={key:3,class:"text-sm transition-colors"},As={key:4,class:"text-sm transition-colors"},Es={key:5,class:"text-sm transition-colors"},Rs={key:1,class:"bg-red-50 mt-2 p-4"},Ns={key:1,class:"flex items-center space-x-1 md:space-x-2"},Bs={key:2,class:"bg-blue-50 mt-2 p-4"},Us={key:1,class:"flex items-center space-x-1 md:space-x-2"},qs={class:"font-medium italic text-xs md:text-sm text-blue-500"};function Zs(n,t,r,c,a,e){const l=m("Skeleton"),y=m("Info"),_=m("OrderDeliveryMethodSchedule"),d=m("OrderDeliveryMethodMap");return o(),i("div",{onClick:t[0]||(t[0]=ge((...h)=>e.selectDeliveryMethod&&e.selectDeliveryMethod(...h),["stop"])),class:"cursor-pointer p-4 bg-gray-50 border border-gray-300 rounded-lg transition-colors group"},[s("div",Ds,[u(ye,{name:"fade-1",mode:"out-in"},{default:x(()=>[e.isSelectedDeliveryMethod?(o(),i("svg",Ps,t[1]||(t[1]=[s("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"},null,-1)]))):(o(),i("div",Os,t[2]||(t[2]=[s("div",{class:"w-4 h-4 bg-gray-100 border border-gray-300 rounded-full"},null,-1)])))]),_:1}),s("div",Ms,[s("p",Fs,v(r.deliveryMethod.name),1),s("p",Ls,v(r.deliveryMethod.description),1),r.deliveryMethod.charge_fee&&(e.shoppingCartDeliveryMethodOffersFreeDelivery||e.shoppingCartDeliveryMethodAmount)?(o(),i(f,{key:0},[e.shoppingCartDeliveryMethodOffersFreeDelivery?(o(),i("p",Ts," Free delivery ")):e.usesFlatFee?(o(),i("p",Is," Flat fee of "+v(e.shoppingCartDeliveryMethodAmount.amount_with_currency),1)):e.usesPercentageFee?(o(),i("p",Vs," Percentage fee of "+v(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+v(r.deliveryMethod.percentage_fee_rate)+"%) ",1)):e.usesFeeByWeight?(o(),i("p",js," Weight fee of "+v(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+v(e.shoppingCartDeliveryMethodOption.weight.text)+") ",1)):e.usesFeeByDistance?(o(),i("p",As," Distance fee of "+v(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+v(e.shoppingCartDeliveryMethodOption.distance.text)+") ",1)):e.usesFeeByPostalCode?(o(),i("p",Es," Distance fee of "+v(e.shoppingCartDeliveryMethodAmount.amount_with_currency)+" ("+v(e.shoppingCartDeliveryMethodOption.distance.text)+") ",1)):S("",!0)],64)):S("",!0),e.hasShoppingCartDeliveryMethodUnavailabilityReasons?(o(),i("div",Rs,[(o(!0),i(f,null,k(e.shoppingCartDeliveryMethodUnavailabilityReasons,(h,g)=>(o(),i("div",{key:g},[e.isInspectingShoppingCart?(o(),p(l,{key:0,width:"w-1/3",shine:!0})):(o(),i("div",Ns,[u(y,{size:"16",class:F(["flex-shrink-0",e.isSelectedDeliveryMethod?"text-red-500":"text-blue-500"])},null,8,["class"]),s("span",{class:F(["font-medium italic text-xs md:text-sm",e.isSelectedDeliveryMethod?"text-red-500":"text-blue-500"])},v(h),3)]))]))),128))])):S("",!0),e.hasShoppingCartDeliveryMethodTips&&!e.hasShoppingCartDeliveryMethodUnavailabilityReasons?(o(),i("div",Bs,[(o(!0),i(f,null,k(e.shoppingCartDeliveryMethodTips,(h,g)=>(o(),i("div",{key:g},[e.isInspectingShoppingCart?(o(),p(l,{key:0,width:"w-1/3",shine:!0})):(o(),i("div",Us,[u(y,{size:"16",class:"flex-shrink-0 text-blue-500"}),s("span",qs,v(h),1)]))]))),128))])):S("",!0)])]),e.isSelectedDeliveryMethod?(o(),i(f,{key:0},[u(_,{deliveryMethod:r.deliveryMethod},null,8,["deliveryMethod"]),u(d)],64)):S("",!0)])}const zs=b(Cs,[["render",Zs]]),Ws={inject:["orderState"],computed:{isSelectedDeliveryMethod(){return this.orderState.orderForm.delivery_method_id===null}},methods:{unselectDeliveryMethod(){this.orderState.orderForm.delivery_method_id=null,this.orderState.saveStateDebounced("Delivery method removed")}}},Hs={class:"flex items-center space-x-2"},Ys={key:0,class:"w-6 h-6 text-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},Gs={key:1,class:"w-6 h-6 flex justify-center items-center"};function Qs(n,t,r,c,a,e){return o(),i("div",{onClick:t[0]||(t[0]=ge((...l)=>e.unselectDeliveryMethod&&e.unselectDeliveryMethod(...l),["stop"])),class:"flex justify-between items-center cursor-pointer p-4 bg-gray-50 border border-gray-300 rounded-lg transition-colors group"},[s("div",Hs,[u(ye,{name:"fade-1",mode:"out-in"},{default:x(()=>[e.isSelectedDeliveryMethod?(o(),i("svg",Ys,t[1]||(t[1]=[s("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"},null,-1)]))):(o(),i("div",Gs,t[2]||(t[2]=[s("div",{class:"w-4 h-4 bg-gray-100 border border-gray-300 rounded-full"},null,-1)])))]),_:1}),t[3]||(t[3]=s("div",null,[s("p",{class:"font-bold text-sm transition-colors"}," None "),s("p",{class:"text-sm transition-colors"}," No delivery method specified ")],-1))])])}const Xs=b(Ws,[["render",Qs]]),Js={inject:["formState","storeState","orderState","notificationState"],components:{Skeleton:D,OrderDeliveryMethod:zs,OrderNoneDeliveryMethod:Xs},data(){return{pagination:null,deliveryMethods:[],isLoadingDeliveryMethods:!1}},watch:{store(n){n&&this.showDeliveryMethods()}},computed:{store(){return this.storeState.store},hasOrder(){return this.orderState.hasOrder},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingOrder(){return this.orderState.isLoadingOrder},orderForm(){return this.orderState.orderForm},isEditting(){return this.$route.name==="edit-order"},hasDeliveryMethods(){return this.deliveryMethods.length>0},deliveryMethod(){return this.deliveryMethods.find(n=>n.id==this.orderForm.delivery_method_id)}},methods:{async showDeliveryMethods(){var n,t;try{this.isLoadingDeliveryMethods=!0;let r={params:{store_id:this.store.id}};const c=await j.get("/api/delivery-methods",r);this.pagination=c.data,this.deliveryMethods=this.pagination.data}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while fetching delivery methods";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to fetch delivery methods:",r)}finally{this.isLoadingDeliveryMethods=!1}}}},Ks={class:"bg-white rounded-lg p-4 shadow-sm"},$s={key:0,class:"flex items-center space-x-4 border-b border-gray-300 shadow-sm rounded-lg py-6 px-4 bg-gray-50"},ei={class:"w-full space-y-4"},ti={key:1,class:"space-y-2"},ri={key:1,class:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg space-y-4 my-4"};function oi(n,t,r,c,a,e){const l=m("Skeleton"),y=m("OrderNoneDeliveryMethod"),_=m("OrderDeliveryMethod");return o(),i("div",Ks,[t[3]||(t[3]=s("h1",{class:"text-lg text-gray-700 font-semibold mb-4"},"Delivery Method",-1)),e.isLoadingStore||e.isLoadingOrder||e.isEditting&&!e.hasOrder?(o(),i("div",$s,[t[0]||(t[0]=s("div",{class:"flex items-center justify-center w-16 h-16 border border-dashed border-gray-200 rounded-lg flex-shrink-0"},[s("svg",{class:"w-6 h-6 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})])],-1)),s("div",ei,[u(l,{width:"w-full",shine:!0}),u(l,{width:"w-1/3",shine:!0})])])):(o(),i("div",ti,[e.hasDeliveryMethods?(o(),i(f,{key:0},[u(y),(o(!0),i(f,null,k(a.deliveryMethods,(d,h)=>(o(),p(_,{key:h,index:h,deliveryMethod:d},null,8,["index","deliveryMethod"]))),128))],64)):(o(),i("div",ri,[e.hasDeliveryMethods?S("",!0):(o(),i(f,{key:0},[t[1]||(t[1]=s("svg",{class:"w-10 h-10 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"})],-1)),t[2]||(t[2]=s("span",{class:"text-sm text-gray-500"},"No delivery methods",-1))],64))]))]))])}const si=b(Js,[["render",oi]]),ii={inject:["formState","orderState","storeState","changeHistoryState","notificationState"],components:{OrderFees:ct,OrderBasics:pt,OrderTotals:Zt,OrderCustomer:_r,OrderProducts:mo,OrderPromotions:zo,OrderMiscellaneous:Jo,OrderDeliveryMethods:si},data(){return{guestId:Me(),shoppingCartReady:!1}},watch:{orderForm:{handler(n){n&&(this.shoppingCartReady?(this.orderState.setIsInspectingShoppingCart(!0),this.inspectShoppingCartDelayed()):this.shoppingCartReady=!0)},deep:!0}},computed:{store(){return this.storeState.store},orderForm(){return this.orderState.orderForm},isEditing(){return this.$route.name==="edit-order"},isCreating(){return this.$route.name==="create-order"}},methods:{inspectShoppingCartDelayed:re(function(){this.changeHistoryState.hasChanges?this.inspectShoppingCart():(this.orderState.setShoppingCart(null),this.orderState.setIsInspectingShoppingCart(!1))},1e3),async inspectShoppingCart(){var n,t;try{this.orderState.setIsInspectingShoppingCart(!0);const r={inspect:!0,...this.orderForm,guest_id:this.guestId,store_id:this.store.id,association:"team member"},c=await axios.post("/api/orders",r);this.orderState.setShoppingCart(c.data)}catch(r){const c=((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while inspecting shopping cart";this.notificationState.showWarningNotification(c),this.formState.setServerFormErrors(r),console.error("Failed to inspect shopping cart:",r)}finally{this.orderState.setIsInspectingShoppingCart(!1)}}}},ni={class:"select-none grid grid-cols-12 gap-4 mb-40"},ai={class:"col-span-8 space-y-4"},di={class:"col-span-4 space-y-4"};function li(n,t,r,c,a,e){const l=m("OrderProducts"),y=m("OrderPromotions"),_=m("OrderFees"),d=m("OrderDeliveryMethods"),h=m("OrderMiscellaneous"),g=m("OrderTotals"),w=m("OrderCustomer"),P=m("OrderBasics");return o(),i("div",ni,[s("div",ai,[u(l),u(y),u(_),u(d),u(h),u(g)]),s("div",di,[u(w),u(P)])])}const Ei=b(ii,[["render",li]]);export{Ei as default};
