import{I as w}from"./Input-CS_IpxN-.js";import{B as x}from"./Button-CbwcBUhP.js";import{S as C}from"./StoreLogo-74QR5EDg.js";import{c as f,b as r,o as d,a,r as l,g as u}from"./app-Cn46GS3I.js";import{_ as h}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as V}from"./SelectCountry-COoNs6MA.js";import{S as v}from"./SelectCurrency-B6tTuBRq.js";import{E}from"./earth-Bmx1Q7j0.js";import"./Copy-BjK3wMF-.js";import"./ShineEffect-BLGg8IQO.js";import"./createLucideIcon-BlsGDRHQ.js";import"./Popover-CYo5yYtG.js";import"./Skeleton-ConmgPQ-.js";import"./Loader-9AWAUH8r.js";import"./plus-DXXu9REn.js";import"./Select-BwhuZWSS.js";const F={},I={class:"w-6 h-6 ml-2",fill:"#44c152",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 308 308","xml:space":"preserve"};function T(i,e){return d(),f("svg",I,e[0]||(e[0]=[r("g",{id:"XMLID_468_"},[r("path",{id:"XMLID_469_",d:"M227.904,176.981c-0.6-0.288-23.054-11.345-27.044-12.781c-1.629-0.585-3.374-1.156-5.23-1.156c-3.032,0-5.579,1.511-7.563,4.479c-2.243,3.334-9.033,11.271-11.131,13.642c-0.274,0.313-0.648,0.687-0.872,0.687c-0.201,0-3.676-1.431-4.728-1.888c-24.087-10.463-42.37-35.624-44.877-39.867c-0.358-0.61-0.373-0.887-0.376-0.887c0.088-0.323,0.898-1.135,1.316-1.554c1.223-1.21,2.548-2.805,3.83-4.348c0.607-0.731,1.215-1.463,1.812-2.153c1.86-2.164,2.688-3.844,3.648-5.79l0.503-1.011c2.344-4.657,0.342-8.587-0.305-9.856c-0.531-1.062-10.012-23.944-11.02-26.348c-2.424-5.801-5.627-8.502-10.078-8.502c-0.413,0,0,0-1.732,0.073c-2.109,0.089-13.594,1.601-18.672,4.802c-5.385,3.395-14.495,14.217-14.495,33.249c0,17.129,10.87,33.302,15.537,39.453c0.116,0.155,0.329,0.47,0.638,0.922c17.873,26.102,40.154,45.446,62.741,54.469c21.745,8.686,32.042,9.69,37.896,9.69c0.001,0,0.001,0,0.001,0c2.46,0,4.429-0.193,6.166-0.364l1.102-0.105c7.512-0.666,24.02-9.22,27.775-19.655c2.958-8.219,3.738-17.199,1.77-20.458C233.168,179.508,230.845,178.393,227.904,176.981z"}),r("path",{id:"XMLID_470_",d:"M156.734,0C73.318,0,5.454,67.354,5.454,150.143c0,26.777,7.166,52.988,20.741,75.928L0.212,302.716c-0.484,1.429-0.124,3.009,0.933,4.085C1.908,307.58,2.943,308,4,308c0.405,0,0.813-0.061,1.211-0.188l79.92-25.396c21.87,11.685,46.588,17.853,71.604,17.853C240.143,300.27,308,232.923,308,150.143C308,67.354,240.143,0,156.734,0zM156.734,268.994c-23.539,0-46.338-6.797-65.936-19.657c-0.659-0.433-1.424-0.655-2.194-0.655c-0.407,0-0.815,0.062-1.212,0.188l-40.035,12.726l12.924-38.129c0.418-1.234,0.209-2.595-0.561-3.647c-14.924-20.392-22.813-44.485-22.813-69.677c0-65.543,53.754-118.867,119.826-118.867c66.064,0,119.812,53.324,119.812,118.867C276.546,215.678,222.799,268.994,156.734,268.994z"})],-1)]))}const B=h(F,[["render",T]]),W={inject:["authState","storeState","formState","notificationState"],components:{Earth:E,Input:w,Button:x,StoreLogo:C,WhatsappIcon:B,SelectCountry:V,SelectCurrency:v},data(){return{form:{name:"",alias:"",country:"BW",currency:"BWP",whatsapp_mobile_number:""},logo:null,aliasModified:!1,isCreatingStore:!1}},methods:{syncWithAlias(){this.aliasModified==!1&&(this.form.alias=this.form.name,this.formatAlias())},formatAlias(i=!1){this.form.alias.length?(this.form.alias=this.form.alias.replace(/[^a-zA-Z0-9\s-]/g,"").replace(/\s+/g,"-").trim().toLowerCase(),this.aliasModified=i):this.aliasModified=!1},handleSelectedFile(i){this.logo=i},async createStore(){var i,e,c,p,o;try{if(this.isCreatingStore||(this.formState.hideFormErrors(),(this.form.name==null||((i=this.form.name)==null?void 0:i.trim())==="")&&this.formState.setFormError("name","Enter store name"),this.formState.hasErrors))return;this.isCreatingStore=!0;let t=new FormData;t.append("return",1),t.append("name",this.form.name),t.append("country",this.form.country),t.append("currency",this.form.currency),(e=this.form.alias)!=null&&e.trim()&&t.append("alias",this.form.alias.trim()),(c=this.form.whatsapp_mobile_number)!=null&&c.trim()&&t.append("whatsapp_mobile_number",this.form.whatsapp_mobile_number.trim()),this.logo&&t.append("logo",this.logo);const n={headers:{"Content-Type":"multipart/form-data"}},m=await axios.post("/api/stores",t,n);this.notificationState.showSuccessNotification("Store created!"),this.$router.push({name:"add-products",params:{store_id:m.data.store.id}})}catch(t){const n=((o=(p=t==null?void 0:t.response)==null?void 0:p.data)==null?void 0:o.message)||(t==null?void 0:t.message)||"Something went wrong while creating store";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(t),console.error("Failed to create store:",t)}finally{this.isCreatingStore=!1}}},created(){this.storeState.setStore(null),this.authState.user.mobile_number&&(this.form.whatsapp_mobile_number=this.authState.user.mobile_number.international)}},L={class:"min-h-screen flex flex-col items-center justify-center py-20"},M={class:"w-full max-w-lg bg-white p-8 rounded-2xl shadow-lg"},k={class:"space-y-4 mb-4"},A={class:"flex items-center space-x-1 pl-2 rounded-l-md bg-gray-50 text-gray-500 whitespace-nowrap"};function z(i,e,c,p,o,t){const n=l("StoreLogo"),m=l("Input"),g=l("WhatsappIcon"),S=l("Earth"),_=l("SelectCountry"),b=l("SelectCurrency"),y=l("Button");return d(),f("div",L,[e[9]||(e[9]=r("div",{class:"w-full max-w-lg"},[r("h2",{class:"text-2xl font-semibold text-center"},"Start Your Store"),r("p",{class:"text-gray-500 text-center mb-6"},"Tell us a little about your store to get started")],-1)),r("div",M,[a(n,{onSelectedFile:t.handleSelectedFile,uploading:o.logo&&o.isCreatingStore,class:"flex justify-center mb-4"},null,8,["onSelectedFile","uploading"]),r("div",k,[a(m,{type:"text",label:"Name",modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.name=s),showAsterisk:!0,onKeyup:t.syncWithAlias,placeholder:"Baby Cakes 🧁",autocomplete:"organization",errorText:t.formState.getFormError("name")},null,8,["modelValue","onKeyup","errorText"]),a(m,{type:"text",label:"WhatsApp Number",placeholder:"+26772000001",modelValue:o.form.whatsapp_mobile_number,"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.whatsapp_mobile_number=s),errorText:t.formState.getFormError("whatsapp_mobile_number"),description:"Customers can send orders to this number after shopping"},{prefix:u(()=>[a(g,{class:"mr-2"})]),_:1},8,["modelValue","errorText"]),a(m,{type:"text",label:"Store Link",modelValue:o.form.alias,"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.alias=s),placeholder:"baby-cakes",onKeyup:e[3]||(e[3]=()=>t.formatAlias(!0)),errorText:t.formState.getFormError("alias"),description:"Your store’s shopping link. Custom domains can be set later."},{prefix:u(()=>[r("div",A,[a(S,{size:"18",class:"mt-0.5"}),e[6]||(e[6]=r("span",{class:"text-sm"},"perfectorder.shop",-1)),e[7]||(e[7]=r("span",{class:"text-gray-400 text-sm"},"/",-1))])]),_:1},8,["modelValue","errorText"]),a(_,{width:"w-full",label:"Country",modelValue:o.form.country,"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.country=s),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your store’s country of operation"},null,8,["modelValue"]),a(b,{width:"w-full",label:"Currency",modelValue:o.form.currency,"onUpdate:modelValue":e[5]||(e[5]=s=>o.form.currency=s),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your store’s currency"},null,8,["modelValue"])]),a(y,{size:"lg",type:"primary",buttonClass:"w-full",action:t.createStore,loading:o.isCreatingStore,disabled:o.isCreatingStore},{default:u(()=>e[8]||(e[8]=[r("span",null,"Create Store",-1)])),_:1,__:[8]},8,["action","loading","disabled"])])])}const $=h(W,[["render",z]]);export{$ as default};
