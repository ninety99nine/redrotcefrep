import{I as j}from"./Input-IgyxXd0Z.js";import{M as A}from"./Modal-CrlOZDZU.js";import{c as N}from"./cloneDeep-Cv64Qkv5.js";import{B as b}from"./Button-Bf8PGHdu.js";import{L}from"./Loader-ChKcfiit.js";import{P as D}from"./Popover-CUukG3Vi.js";import{S as H}from"./Skeleton-B1ZqWcQs.js";import{B as k}from"./BackdropLoader-Cz8CMJxD.js";import{P as R}from"./Pill-D63hqQrU.js";import{S as B}from"./Search-Bcyoj7C3.js";import{P as I}from"./Paginator-DOiGk8zF.js";import{c as g,b as r,a as u,d as T,e as h,g as f,r as c,F as x,f as q,o as n,i as S,t as l,n as O}from"./app-CLfu_pic.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as F}from"./trash-2-CpCedVzS.js";import{M as U}from"./move-left-DEA1DwDU.js";import"./Copy-DHRqWJPr.js";import"./ShineEffect-Cz7fIyrn.js";import"./createLucideIcon-FkRKWxCW.js";const z={inject:["formState","tagState","storeState","notificationState"],components:{Pill:R,Button:b,Loader:L,Search:B,Paginator:I,BackdropLoader:k},data(){return{Trash2:F,page:1,tagProducts:[],pagination:null,productOptions:[],latestRequestId:null,cancelTokenSource:null,isLoadingProducts:!1,isLoadingTagProducts:!1}},watch:{store(s,e){!e&&s&&!this.isLoadingProducts&&this.productOptions.length==0&&this.showProducts()},tag(s){s&&(!this.isLoadingProducts&&this.productOptions.length==0&&this.showProducts(),this.showTagProducts())},isUpdatingTag(s,e){e&&!s&&this.showTagProducts()},productsReady(s){s&&this.$emit("tagProductsReady")}},computed:{tag(){return this.tagState.tag},store(){return this.storeState.store},isUpdatingTag(){return this.tagState.isUpdatingTag},isEditingProductTag(){return this.$route.name=="edit-product-tag"},isCreatingProductTag(){return this.$route.name=="create-product-tag"},tagForm(){return this.tagState.tagForm},totalTagProducts(){return this.tagProducts.length},hasTagProducts(){return this.totalTagProducts>0},productsReady(){return this.isCreatingProductTag?!this.isLoadingProducts:!this.isLoadingProducts&&!this.isLoadingTagProducts},productsToAdd(){return this.tagState.tagForm.products_to_add},productsToRemove(){return this.tagState.tagForm.products_to_remove},preparedProducts(){if(!this.productsReady)return[];const s=new Set(this.productsToAdd.map(t=>String(t.id))),e=new Set(this.productsToRemove.map(t=>String(t.id))),i=this.page==1?[...this.productsToAdd,...this.tagProducts]:this.tagProducts.filter(t=>!s.has(String(t.id))&&!e.has(String(t.id))),o=new Set;return i.filter(t=>e.has(String(t.id))||o.has(String(t.id))?!1:(o.add(String(t.id)),!0))}},methods:{paginate(s){this.showTagProducts(s)},async showProducts(s=null){var i,o;const e=++this.latestRequestId;try{this.isLoadingProducts=!0,this.cancelTokenSource&&this.cancelTokenSource.cancel("Request superseded by a newer one"),this.cancelTokenSource=axios.CancelToken.source();let t={params:{store_id:this.store.id,association:"team member",_relationships:["photo"].join(",")},cancelToken:this.cancelTokenSource.token};s&&(t.params.search=s);const a=await axios.get("/api/products",t);if(e!==this.latestRequestId)return;const p=a.data.data;this.productOptions=p.map(m=>({label:m.name,product:m}))}catch(t){if(axios.isCancel(t)||e!==this.latestRequestId)return;const a=((o=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:o.message)||(t==null?void 0:t.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(t),console.error("Failed to fetch products:",t)}finally{if(e!==this.latestRequestId)return;this.isLoadingProducts=!1,this.cancelTokenSource=null}},async showTagProducts(s=1){var e,i;try{this.page=s,this.isLoadingTagProducts=!0;let o={params:{per_page:15,page:this.page,tag_id:this.tag.id,store_id:this.store.id,_relationships:["photo"].join(",")}};const t=await axios.get("/api/products",o);this.pagination=t.data,this.tagProducts=this.pagination.data}catch(o){const t=((i=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:i.message)||(o==null?void 0:o.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(o),console.error("Failed to fetch products:",o)}finally{this.isLoadingTagProducts=!1}},addProduct(s){this.page>1&&this.showTagProducts(),this.tagState.addProduct(s.product)},removeProduct(s){this.tagState.removeProduct(s)}},created(){this.store&&this.showProducts()}},V={class:"bg-white rounded-lg p-4 shadow-sm"},W={class:"flex items-center space-x-2 mb-4"},M={class:"w-full flex justify-between items-center"},Y={class:"flex space-x-4 items-center"},G={key:0,class:"flex items-center justify-center w-10 h-10"},J=["src"],K={class:"truncate"},Q={class:"relative"},X={class:"divide-y divide-gray-200"},Z={class:"flex space-x-4 items-center"},$={key:0,class:"flex items-center justify-center w-10 h-10"},tt=["src"],et={class:"text-sm truncate"},st={key:0,class:"flex justify-end mt-4"},at={key:1,class:"flex justify-center bg-gray-50 rounded-lg p-4"},it={key:0,class:"text-sm"},ot={key:1,class:"flex items-center justify-center"};function rt(s,e,i,o,t,a){const _=c("Pill"),p=c("Search"),m=c("BackdropLoader"),y=c("Button"),w=c("Paginator"),v=c("Loader");return n(),g("div",V,[r("div",W,[e[0]||(e[0]=r("p",{class:"text-lg text-gray-700 font-semibold"},"Products",-1)),t.pagination?(n(),T(_,{key:0,type:"light",size:"xs"},{default:f(()=>[S(l(`${t.pagination.meta.total} total`),1)]),_:1})):h("",!0)]),u(p,{class:"mb-4",onSelected:a.addProduct,options:t.productOptions,isLoading:t.isLoadingProducts,placeholder:"Search products to add",search:d=>a.showProducts(d)},{option:f(d=>[r("div",M,[r("div",Y,[d.option.product.photo?(n(),g("div",G,[r("img",{class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:d.option.product.photo.path},null,8,J)])):h("",!0),r("span",K,l(d.option.label),1)]),u(_,{type:d.option.product.visible?"success":"warning",size:"xs"},{default:f(()=>[S(l(d.option.product.visible?"visible":"hidden"),1)]),_:2},1032,["type"])])]),_:1},8,["onSelected","options","isLoading","search"]),a.preparedProducts.length||a.productsToAdd.length||a.productsToRemove.length?(n(),g(x,{key:0},[r("div",Q,[t.isLoadingTagProducts?(n(),T(m,{key:0,showBorder:!1,showSpinningLoader:!0})):h("",!0),r("div",X,[(n(!0),g(x,null,q(a.preparedProducts,(d,C)=>(n(),g("div",{key:C,class:"flex items-center justify-between hover:bg-gray-100 min-h-16 px-4"},[r("div",Z,[d.photo?(n(),g("div",$,[r("img",{class:"w-full max-h-full object-contain rounded-lg flex-shrink-0",src:d.photo.path},null,8,tt)])):h("",!0),r("span",et,l(d.name),1),u(_,{type:d.visible?"success":"warning",size:"xs"},{default:f(()=>[S(l(d.visible?"visible":"hidden"),1)]),_:2},1032,["type"])]),u(y,{size:"xs",type:"bareDanger",leftIcon:t.Trash2,action:()=>a.removeProduct(d)},null,8,["leftIcon","action"])]))),128))])]),t.pagination?(n(),g("div",st,[u(w,{pagination:t.pagination,onPaginate:a.paginate},null,8,["pagination","onPaginate"])])):h("",!0)],64)):(n(),g("div",at,[a.isCreatingProductTag||a.isEditingProductTag&&t.pagination&&a.preparedProducts.length==0&&a.productsToAdd.length==0?(n(),g("p",it,"No products added")):(n(),g("div",ot,[u(v,null,{default:f(()=>e[1]||(e[1]=[r("span",{class:"text-sm ml-2"},"Loading products",-1)])),_:1,__:[1]})]))]))])}const nt=E(z,[["render",rt]]),dt={inject:["formState","tagState","storeState","notificationState"],components:{Pill:R,Button:b,Loader:L,Search:B,Paginator:I,BackdropLoader:k},data(){return{Trash2:F,page:1,tagCustomers:[],pagination:null,customerOptions:[],latestRequestId:null,cancelTokenSource:null,isLoadingCustomers:!1,isLoadingTagCustomers:!1}},watch:{store(s,e){!e&&s&&!this.isLoadingCustomers&&this.customerOptions.length==0&&this.showCustomers()},tag(s){s&&(!this.isLoadingCustomers&&this.customerOptions.length==0&&this.showCustomers(),this.showTagCustomers())},isUpdatingTag(s,e){e&&!s&&this.showTagCustomers()},customersReady(s){s&&this.$emit("tagCustomersReady")}},computed:{tag(){return this.tagState.tag},store(){return this.storeState.store},isUpdatingTag(){return this.tagState.isUpdatingTag},isEditingCustomerTag(){return this.$route.name=="edit-customer-tag"},isCreatingCustomerTag(){return this.$route.name=="create-customer-tag"},tagForm(){return this.tagState.tagForm},totalTagCustomers(){return this.tagCustomers.length},hasTagCustomers(){return this.totalTagCustomers>0},customersReady(){return this.isCreatingCustomerTag?!this.isLoadingCustomers:!this.isLoadingCustomers&&!this.isLoadingTagCustomers},customersToAdd(){return this.tagState.tagForm.customers_to_add},customersToRemove(){return this.tagState.tagForm.customers_to_remove},preparedCustomers(){if(!this.customersReady)return[];const s=new Set(this.customersToAdd.map(t=>String(t.id))),e=new Set(this.customersToRemove.map(t=>String(t.id))),i=this.page==1?[...this.customersToAdd,...this.tagCustomers]:this.tagCustomers.filter(t=>!s.has(String(t.id))&&!e.has(String(t.id))),o=new Set;return i.filter(t=>e.has(String(t.id))||o.has(String(t.id))?!1:(o.add(String(t.id)),!0))}},methods:{paginate(s){this.showTagCustomers(s)},async showCustomers(s=null){var i,o;const e=++this.latestRequestId;try{this.isLoadingCustomers=!0,this.cancelTokenSource&&this.cancelTokenSource.cancel("Request superseded by a newer one"),this.cancelTokenSource=axios.CancelToken.source();let t={params:{store_id:this.store.id},cancelToken:this.cancelTokenSource.token};s&&(t.params.search=s);const a=await axios.get("/api/customers",t);if(e!==this.latestRequestId)return;const p=a.data.data;this.customerOptions=p.map(m=>({label:m.name,customer:m}))}catch(t){if(axios.isCancel(t)||e!==this.latestRequestId)return;const a=((o=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:o.message)||(t==null?void 0:t.message)||"Something went wrong while fetching customers";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(t),console.error("Failed to fetch customers:",t)}finally{if(e!==this.latestRequestId)return;this.isLoadingCustomers=!1,this.cancelTokenSource=null}},async showTagCustomers(s=1){var e,i;try{this.page=s,this.isLoadingTagCustomers=!0;let o={params:{per_page:15,page:this.page,tag_id:this.tag.id,store_id:this.store.id}};const t=await axios.get("/api/customers",o);this.pagination=t.data,this.tagCustomers=this.pagination.data}catch(o){const t=((i=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:i.message)||(o==null?void 0:o.message)||"Something went wrong while fetching customers";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(o),console.error("Failed to fetch customers:",o)}finally{this.isLoadingTagCustomers=!1}},addCustomer(s){this.page>1&&this.showTagCustomers(),this.tagState.addCustomer(s.customer)},removeCustomer(s){this.tagState.removeCustomer(s)}},created(){this.store&&this.showCustomers()}},gt={class:"bg-white rounded-lg p-4 shadow-sm"},ct={class:"flex items-center space-x-2 mb-4"},ut={class:"truncate"},ht={class:"relative"},lt={class:"divide-y divide-gray-200"},mt={class:"text-sm truncate"},pt={class:"flex items-center space-x-2 text-xs"},ft={key:0},_t={key:1},Tt={key:0,class:"flex justify-end mt-4"},St={key:1,class:"flex justify-center bg-gray-50 rounded-lg p-4"},yt={key:0,class:"text-sm"},wt={key:1,class:"flex items-center justify-center"};function vt(s,e,i,o,t,a){const _=c("Pill"),p=c("Search"),m=c("BackdropLoader"),y=c("Button"),w=c("Paginator"),v=c("Loader");return n(),g("div",gt,[r("div",ct,[e[0]||(e[0]=r("p",{class:"text-lg text-gray-700 font-semibold"},"Customers",-1)),t.pagination?(n(),T(_,{key:0,type:"light",size:"xs"},{default:f(()=>[S(l(`${t.pagination.meta.total} total`),1)]),_:1})):h("",!0)]),u(p,{class:"mb-4",onSelected:a.addCustomer,options:t.customerOptions,isLoading:t.isLoadingCustomers,placeholder:"Search customers to add",search:d=>a.showCustomers(d)},{option:f(d=>[r("span",ut,l(d.option.label),1)]),_:1},8,["onSelected","options","isLoading","search"]),a.preparedCustomers.length||a.customersToAdd.length||a.customersToRemove.length?(n(),g(x,{key:0},[r("div",ht,[t.isLoadingTagCustomers?(n(),T(m,{key:0,showBorder:!1,showSpinningLoader:!0})):h("",!0),r("div",lt,[(n(!0),g(x,null,q(a.preparedCustomers,(d,C)=>(n(),g("div",{key:C,class:"flex items-center justify-between hover:bg-gray-100 min-h-16 px-4"},[r("div",null,[r("p",mt,l(d.name),1),r("div",pt,[d.mobile_number?(n(),g("span",ft,l(d.mobile_number.national),1)):h("",!0),d.email?(n(),g("span",_t,l(d.email),1)):h("",!0)])]),u(y,{size:"xs",type:"bareDanger",leftIcon:t.Trash2,action:()=>a.removeCustomer(d)},null,8,["leftIcon","action"])]))),128))])]),t.pagination?(n(),g("div",Tt,[u(w,{pagination:t.pagination,onPaginate:a.paginate},null,8,["pagination","onPaginate"])])):h("",!0)],64)):(n(),g("div",St,[a.isCreatingCustomerTag||a.isEditingCustomerTag&&t.pagination&&a.totalTagCustomers==0?(n(),g("p",yt,"No customers added")):(n(),g("div",wt,[u(v,null,{default:f(()=>e[1]||(e[1]=[r("span",{class:"text-sm ml-2"},"Loading customers",-1)])),_:1,__:[1]})]))]))])}const Ct=E(dt,[["render",vt]]),Pt={inject:["formState","storeState","tagState","changeHistoryState","notificationState"],components:{Input:j,Modal:A,Button:b,Loader:L,Popover:D,Skeleton:H,BackdropLoader:k,TagProducts:nt,TagCustomers:Ct},data(){return{Trash2:F,MoveLeft:U,products:[],tagProductsReady:!1,tagCustomersReady:!1}},watch:{store(s,e){!e&&s&&this.setup()},tagId(s){s&&(this.setup(),this.setActionButtons())},isReady(s){s&&this.changeHistoryState.data==null&&this.tagState.saveOriginalState("Original tag")}},computed:{store(){return this.storeState.store},tag(){return this.tagState.tag},hasTag(){return this.tagState.hasTag},tagId(){return this.$route.params.tag_id},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingTag(){return this.tagState.isLoadingTag},isEditing(){return this.isEditingProductTag||this.isEditingCustomerTag},isCreating(){return this.isCreatingProductTag||this.isCreatingCustomerTag},isEditingProductTag(){return this.$route.name=="edit-product-tag"},isCreatingProductTag(){return this.$route.name=="create-product-tag"},isEditingCustomerTag(){return this.$route.name=="edit-customer-tag"},isCreatingCustomerTag(){return this.$route.name=="create-customer-tag"},tagForm(){return this.tagState.tagForm},isReady(){return this.isEditingProductTag||this.isCreatingProductTag?this.tagProductsReady:this.tagCustomersReady},isSubmitting(){return this.changeHistoryState.actionButtons.length==0?!1:this.changeHistoryState.actionButtons[1].loading},isDeletingTag(){return this.tagState.isDeletingTag}},methods:{goBack(){this.navigateToTags()},async setup(){this.tagForm==null&&this.tagState.setTagForm(null),this.isEditing&&this.store&&await this.showTag()},async navigateToTags(){await this.$router.replace({name:this.isEditingProductTag||this.isCreatingProductTag?"show-product-tags":"show-customer-tags",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},async onView(s){await this.$router.push({name:this.isCreatingProductTag?"edit-product-tag":"edit-customer-tag",params:{tag_id:s.id},query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})},async showTag(){var s,e;try{this.tagState.isLoadingTag=!0;let i={params:{store_id:this.store.id,_relationships:[this.isEditingProductTag||this.isCreatingProductTag?"products.photo":"customers"].join(",")}};const t=(await axios.get(`/api/tags/${this.tagId}`,i)).data;this.tagState.setTag(t),this.tagState.setTagForm(t)}catch(i){const o=((e=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:e.message)||(i==null?void 0:i.message)||"Something went wrong while fetching tag";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(i),console.error("Failed to fetch tag:",i),i.status==404&&await this.$router.replace({name:"show-tags",query:{store_id:this.store.id,searchTerm:this.$route.query.searchTerm,filterExpressions:this.$route.query.filterExpressions,sortingExpressions:this.$route.query.sortingExpressions}})}finally{this.tagState.isLoadingTag=!1}},async createTag(){var s,e;try{if(this.tagState.isCreatingTag||(this.formState.hideFormErrors(),(this.tagForm.name==null||this.tagForm.name.trim()==="")&&this.formState.setFormError("name","The name is required"),this.formState.hasErrors))return;this.tagState.isCreatingTag=!0,this.changeHistoryState.actionButtons[1].loading=!0;const i={...this.getPayload(),store_id:this.store.id},t=(await axios.post("/api/tags",i)).data.tag;this.tagForm.id=t.id,this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Tag created"),this.tagState.saveOriginalState("Original tag"),await this.onView(t)}catch(i){const o=((e=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:e.message)||(i==null?void 0:i.message)||"Something went wrong while creating tag";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(i),console.error("Failed to create tag:",i)}finally{this.tagState.isCreatingTag=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async updateTag(){var s,e;try{if(this.tagState.isUpdatingTag||(this.formState.hideFormErrors(),(this.tagForm.name==null||this.tagForm.name.trim()==="")&&this.formState.setFormError("name","The name is required"),this.formState.hasErrors))return;this.tagState.isUpdatingTag=!0,this.changeHistoryState.actionButtons[1].loading=!0;const i={...this.getPayload(),store_id:this.store.id},t=(await axios.put(`/api/tags/${this.tagForm.id}`,i)).data.tag;this.tagState.setTag(t),this.tagState.setTagForm(t),this.storeState.silentUpdate(),this.notificationState.showSuccessNotification("Tag updated"),this.tagState.saveOriginalState("Original tag")}catch(i){const o=((e=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:e.message)||(i==null?void 0:i.message)||"Something went wrong while updating tag";this.notificationState.showWarningNotification(o),this.formState.setServerFormErrors(i),console.error("Failed to update tag:",i)}finally{this.tagState.isUpdatingTag=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async deleteTag(s){var e,i;try{if(this.tagState.isDeletingTag)return;this.tagState.isDeletingTag=!0;const o={data:{store_id:this.store.id}};await axios.delete(`/api/tags/${this.tag.id}`,o),this.storeState.silentUpdate(),s(),await new Promise(t=>setTimeout(t,1e3)),this.notificationState.showSuccessNotification("Tag deleted"),await this.navigateToTags()}catch(o){const t=((i=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:i.message)||(o==null?void 0:o.message)||"Something went wrong while deleting tag";this.notificationState.showWarningNotification(t),this.formState.setServerFormErrors(o),console.error("Failed to delete tag:",o)}finally{this.tagState.isDeletingTag=!1,s()}},getPayload(){let s=N(this.tagForm);return this.isCreatingProductTag?s.product_ids=s.products_to_add.map(e=>e.id):this.isEditingProductTag?(s.product_ids_to_add=s.products_to_add.map(e=>e.id),s.product_ids_to_remove=s.products_to_remove.map(e=>e.id)):this.isCreatingCustomerTag?s.customer_ids=s.customers_to_add.map(e=>e.id):this.isEditingCustomerTag&&(s.customer_ids_to_add=s.customers_to_add.map(e=>e.id),s.customer_ids_to_remove=s.customers_to_remove.map(e=>e.id)),delete s.products_to_add,delete s.products_to_remove,delete s.customers_to_add,delete s.customers_to_remove,s},setActionButtons(){(this.isCreating||this.isEditing)&&(this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(this.onDiscard),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Create Tag",this.isEditing?this.updateTag:this.createTag,"primary",null))},setTagForm(s){this.tagState.tagForm=s}},beforeRouteLeave(s,e,i){if(this.changeHistoryState.hasChangeHistory&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return i(!1);i()},unmounted(){this.tagState.reset(),this.changeHistoryState.reset()},created(){this.setup(),this.setActionButtons();const s=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let e=0;e<s.length;e++){let i=s[e];this.changeHistoryState.listeners[i]=this.setTagForm}}},xt={class:"pt-24 px-4"},bt={class:"grid grid-cols-12 gap-4 mb-4"},Lt={class:"col-span-8 col-start-3"},kt={class:"select-none bg-white rounded-lg p-4 mb-4"},Et={class:"flex items-center space-x-4"},Ft={key:0,class:"flex items-center space-x-2"},Rt={key:1,class:"flex items-center space-x-1"},Bt={class:"text-lg text-gray-700 font-semibold"},It={class:"relative mb-8"},qt={class:"bg-white rounded-lg space-y-4 p-4"},jt={class:"relative mb-8"},At={class:"space-y-2"},Nt={class:"font-bold text-black"},Dt={class:"flex justify-end"},Ht={class:"mb-8"},Ot={class:"font-bold text-black"};function Ut(s,e,i,o,t,a){const _=c("Button"),p=c("Skeleton"),m=c("Popover"),y=c("BackdropLoader"),w=c("Input"),v=c("TagProducts"),d=c("TagCustomers"),C=c("Modal");return n(),g("div",xt,[r("div",bt,[r("div",Lt,[r("div",kt,[r("div",Et,[u(_,{size:"xs",type:"light",action:a.goBack,leftIcon:t.MoveLeft},{default:f(()=>e[4]||(e[4]=[r("span",null,"Back",-1)])),_:1,__:[4]},8,["action","leftIcon"]),a.isLoadingStore||a.isLoadingTag||a.isEditing&&!a.hasTag?(n(),g("div",Ft,[u(p,{width:"w-40"}),u(p,{width:"w-4"})])):(n(),g("div",Rt,[r("h1",Bt,l(a.isCreating?"Add Tag":a.tagForm.name||"..."),1),u(m,{placement:"top",content:a.isEditingProductTag||a.isCreatingProductTag?"Tags are labels you add to products to highlight features, making it easier for customers to find related items e.g. organic, new arrival, or best seller.":"Tags are labels you add to customers to group them by traits or behavior, making it easier to organize and personalize interactions e.g vip, frequent buyer or needs follow-up"},null,8,["content"])]))])]),r("div",It,[a.isLoadingTag||a.isSubmitting?(n(),T(y,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):h("",!0),r("div",qt,[u(w,{type:"text",label:"Name",modelValue:a.tagForm.name,"onUpdate:modelValue":e[0]||(e[0]=P=>a.tagForm.name=P),errorText:a.formState.getFormError("name"),onInput:e[1]||(e[1]=P=>a.tagState.saveStateDebounced("Name changed")),placeholder:a.isEditingProductTag||a.isCreatingProductTag?"main dish":"vip",disabled:a.isEditingProductTag||a.isCreatingProductTag?!t.tagProductsReady:!t.tagCustomersReady,tooltipContent:`The name of your tag e.g ${a.isEditingProductTag||a.isCreatingProductTag?"main dish":"vip"}`},null,8,["modelValue","errorText","placeholder","disabled","tooltipContent"])])]),r("div",jt,[a.isLoadingTag||a.isSubmitting?(n(),T(y,{key:0,showSpinningLoader:!1,class:"rounded-lg"})):h("",!0),a.isEditingProductTag||a.isCreatingProductTag?(n(),T(v,{key:1,onTagProductsReady:e[2]||(e[2]=P=>t.tagProductsReady=!0)})):(n(),T(d,{key:2,onTagCustomersReady:e[3]||(e[3]=P=>t.tagCustomersReady=!0)}))]),a.tag?(n(),g("div",{key:0,class:O(["flex items-center justify-between space-x-4 overflow-hidden rounded-lg p-4 border mb-20",a.isLoadingTag?"border-gray-300 bg-gray-50":"border-red-300 bg-red-50"])},[r("div",At,[r("p",null,[e[5]||(e[5]=S("Delete ")),r("span",Nt,l(a.tagForm.name),1),e[6]||(e[6]=S("?"))]),e[7]||(e[7]=r("p",{class:"text-sm"},"Once this tag is deleted you will not be able to recover it.",-1))]),r("div",Dt,[u(C,{triggerType:"danger",approveType:"danger",approveLeftIcon:t.Trash2,triggerText:"Delete Tag",approveText:"Delete Tag",approveAction:a.deleteTag,triggerLoading:a.isDeletingTag,approveLoading:a.isDeletingTag},{content:f(()=>[e[10]||(e[10]=r("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),r("p",Ht,[e[8]||(e[8]=S("Are you sure you want to permanently delete ")),r("span",Ot,l(a.tagForm.name),1),e[9]||(e[9]=S("?"))])]),_:1},8,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])],2)):h("",!0)])])])}const re=E(Pt,[["render",Ut]]);export{re as default};
