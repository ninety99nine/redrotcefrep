import{P as T}from"./Pill-DpqrMa0r.js";import{I as B}from"./Input-BtMsYEQC.js";import{L as V}from"./Loader-Cx-EKtVY.js";import{B as M}from"./Button-DQZsVgv2.js";import{S as N}from"./Skeleton-CrFOPy1K.js";import{a as j}from"./stringUtils-Bvzw0-oW.js";import{M as F}from"./Menu-Bkvb9EWc.js";import{M as z}from"./DesignCardManager-Dmuk3f8x.js";import{c as o,a as p,b as a,r as c,g as f,F as _,d as y,e as g,f as x,o as i,k as q,v as E,t as d,i as v,w as Q,j as U}from"./app-NqhLBX5U.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as D}from"./image-Ch1RFnVq.js";import"./Popover-B8o2G8jc.js";import"./x-BAZkSzS9.js";import"./createLucideIcon-DnmJ9UE3.js";import"./Copy-Balf8fLz.js";import"./ShineEffect-D1afC5Ah.js";import"./refresh-ccw-D0BER8Gi.js";import"./circle-check-CR2oW9jw.js";import"./circle-alert-CK7NUARt.js";import"./parsePhoneNumber-DR0S47Bc.js";import"./house-jm0q6dkb.js";import"./shopping-cart-DHN55GmJ.js";import"./Drawer-DlToXcmB.js";import"./menu-BwvCVe4S.js";import"./user-C7TBsV7g.js";import"./store-BCc8tTza.js";import"./AddressInput-vR4gTyJM.js";import"./isEqual-U_1WSR2O.js";import"./Modal-kjURmp1k.js";import"./GoogleMaps-BY4jB9EI.js";import"./SelectCountry-D_3x_nUW.js";import"./Select-D6ibtGLL.js";import"./move-left-uceyjw08.js";import"./trash-2-C8lxGBuv.js";import"./plus-BrZICUoI.js";import"./StoreLogo-CbJbNI00.js";import"./link-B9loYvjH.js";import"./video-pvdTEtkA.js";import"./at-sign-Br9pNQ1G.js";import"./Countdown-D5XBvp5N.js";import"./chevron-up-BAr0JeXW.js";import"./Datepicker-RvaP_gpp.js";import"./arrow-right-6jfvwB_R.js";import"./arrow-left-vvB19v8N.js";import"./Alert-C6_-FM9c.js";import"./info-t6hvO3zt.js";import"./Switch-DQQV--PT.js";import"./DeliveryTimePicker-CtNahkmi.js";import"./debounce-ARpWDjza.js";import"./circle-check-big-tL7feu8T.js";const W={inject:["formState","orderState","storeState","notificationState"],components:{Pill:T,Image:D,Input:B,Loader:V,Button:M,Skeleton:N,Menu:F,MyCartButton:z},data(){return{products:[],categories:[],searchTerm:null,lastSearchTerm:null,checkedCategories:[],isLoadingProducts:!1,isLoadingCategories:!1,hasLoadedInitialProducts:!1}},watch:{store(r,s){!s&&r&&this.setup()},searchTerm(){this.showProducts()},categoryIds(){this.showProducts()}},computed:{store(){return this.storeState.store},shoppingCart(){return this.orderState.shoppingCart},isLoadingStore(){return this.storeState.isLoadingStore},hasSearchTerm(){return this.isNotEmpty(this.searchTerm)},hasProducts(){return this.products.length>0},hasCategories(){return this.categories.length>0},categoryIds(){return this.checkedCategories.map((r,s)=>{var e;return r?(e=this.categories[s])==null?void 0:e.id:null}).filter(r=>r!==null)}},methods:{isNotEmpty:j,setup(){this.store&&(this.hasCategories||this.showCategories(),this.hasLoadedInitialProducts||this.showProducts())},async onView(r){await this.$router.push({name:"show-shop-product",params:{alias:this.store.alias,product_id:r.id}})},clearFilters(){this.checkedCategories=this.checkedCategories.map(()=>!1)},getSelectedQuantity(r){if(this.shoppingCart&&r){const s=this.shoppingCart.order_products.find(e=>e.product_id==r.id);if(s)return s.quantity}return null},async showProducts(){var r,s;try{this.isLoadingProducts=!0;let e={params:{store_id:this.store.id,association:"team member",category_ids:this.categoryIds,_relationships:"photo,variants"}};this.hasSearchTerm&&(e.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const h=await axios.get("/api/products",e);if(this.searchTerm===this.lastSearchTerm){const n=h.data;this.products=n.data,this.isLoadingProducts=!1,this.hasLoadedInitialProducts=!0}}catch(e){const h=((s=(r=e==null?void 0:e.response)==null?void 0:r.data)==null?void 0:s.message)||(e==null?void 0:e.message)||"Something went wrong while fetching products";this.notificationState.showWarningNotification(h),this.formState.setServerFormErrors(e),console.error("Failed to fetch products:",e)}finally{this.isLoadingProducts=!1}},async showCategories(){var r,s;try{this.isLoadingCategories=!0;let e={params:{per_page:100,store_id:this.store.id,_countable_relationships:["products"].join(",")}};const n=(await axios.get("/api/categories",e)).data;this.categories=n.data,this.checkedCategories=Array(this.categories.length).fill(!1)}catch(e){const h=((s=(r=e==null?void 0:e.response)==null?void 0:r.data)==null?void 0:s.message)||(e==null?void 0:e.message)||"Something went wrong while fetching categories";this.notificationState.showWarningNotification(h),this.formState.setServerFormErrors(e),console.error("Failed to fetch categories:",e)}finally{this.isLoadingCategories=!1}}},created(){this.setup()}},G={class:"max-w-4xl mx-auto pt-8 pb-40"},H={key:0,class:"pt-8 flex items-center justify-center"},J={class:"select-none grid grid-cols-1 md:grid-cols-4 md:gap-8"},K={class:"col-span-1 space-y-4"},O={key:0,class:"w-full bg-gray-50 p-4 border border-gray-300 rounded-lg relative"},R=["for"],X={class:"flex items-center space-x-2 hover:scale-105 transition-all duration-300"},Y=["id","onUpdate:modelValue","onChange"],Z={class:"space-x-2"},$={class:"text-sm text-gray-900"},tt={class:"text-sm text-gray-400"},et={key:0,class:"border-t border-gray-300 pt-4 mt-4"},st={class:"col-span-3"},it={key:0,class:"flex justify-center items-center space-x-4"},ot={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},at={class:"w-full max-h-60 aspect-square relative flex items-center justify-center bg-gray-100 rounded-lg overflow-hidden"},rt={class:"flex items-center space-x-2 flex-wrap gap-2"},nt={key:2,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},lt=["onClick"],ct={key:0,class:"absolute top-1 right-1 z-10 flex items-center justify-center min-w-6 w-fit h-6 p-1 bg-red-500 text-xs font-bold text-white rounded-full"},dt={class:"w-full max-h-60 aspect-square relative flex items-center justify-center bg-gray-100 rounded-lg overflow-hidden"},ht=["alt","src"],mt={class:"text-gray-900 text-sm font-medium truncate"},pt={class:"flex items-center space-x-2 flex-wrap gap-2"},gt={key:0,class:"text-gray-900 text-sm font-semibold"},ut={key:3,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function _t(r,s,e,h,n,l){const S=c("Menu"),b=c("Loader"),L=c("Button"),P=c("Input"),k=c("Image"),w=c("Skeleton"),C=c("Pill"),I=c("MyCartButton");return i(),o("div",null,[p(S,{menuClass:"max-w-4xl mx-auto"}),a("div",G,[l.isLoadingStore?(i(),o("div",H,[p(b,null,{default:f(()=>s[2]||(s[2]=[a("span",{class:"text-sm ml-2"},"Loading store",-1)])),_:1,__:[2]})])):(i(),o(_,{key:1},[a("div",J,[a("div",K,[l.hasCategories?(i(),o("div",O,[s[3]||(s[3]=a("h1",{class:"text-gray-900 font-medium mb-4"},"Categories",-1)),(i(!0),o(_,null,x(n.categories,(t,m)=>(i(),o("label",{key:m,for:t.id,class:"cursor-pointer"},[a("div",X,[q(a("input",{type:"checkbox",id:t.id,class:"cursor-pointer","onUpdate:modelValue":u=>n.checkedCategories[m]=u,onChange:u=>n.checkedCategories[m]=u.target.checked},null,40,Y),[[E,n.checkedCategories[m]]]),a("div",Z,[a("span",$,d(t.name),1),a("span",tt,"("+d(t.products_count)+")",1)])])],8,R))),128)),l.categoryIds.length?(i(),o("div",et,[p(L,{size:"xs",type:"light",buttonClass:"w-full",action:l.clearFilters},{default:f(()=>[v(" Clear filters ("+d(l.categoryIds.length)+") ",1)]),_:1},8,["action"])])):g("",!0)])):g("",!0)]),a("div",st,[n.hasLoadedInitialProducts?(i(),o("div",it,[p(P,{type:"search",debounced:!0,class:"w-full mb-4",modelValue:n.searchTerm,"onUpdate:modelValue":s[0]||(s[0]=t=>n.searchTerm=t),skeleton:l.isLoadingStore,placeholder:"Search products",onInput:s[1]||(s[1]=t=>n.isLoadingProducts=!0)},null,8,["modelValue","skeleton"])])):g("",!0),n.isLoadingProducts?(i(),o("div",ot,[(i(!0),o(_,null,x([...Array(8).keys()].map(t=>t+1),t=>(i(),o("div",{key:t.id,class:"relative flex flex-col space-y-2 p-2 cursor-pointer rounded-lg hover:scale-105 transition-all duration-300"},[a("div",at,[p(k,{size:"40",class:"text-gray-300"})]),p(w,{width:"w-4/5",shine:!0}),a("div",rt,[p(w,{width:"w-3/5",height:"h-2",shine:!0})])]))),128))])):l.hasProducts?(i(),o("div",nt,[(i(!0),o(_,null,x(n.products,t=>{var m,u;return i(),o("div",{key:t.id,onClick:Q(()=>l.onView(t),["stop"]),class:"relative flex flex-col space-y-2 p-2 cursor-pointer rounded-lg hover:scale-105 transition-all duration-300"},[l.getSelectedQuantity(t)?(i(),o("div",ct,[a("span",null,d(l.getSelectedQuantity(t)),1)])):g("",!0),a("div",dt,[(m=(t??t.variant).photo)!=null&&m.path?(i(),o("img",{key:0,alt:(t??t.variant).name,class:"absolute w-full h-full object-cover",src:(u=(t??t.variant).photo)==null?void 0:u.path},null,8,ht)):(i(),y(k,{key:1,size:"40",class:"text-gray-300"}))]),a("h4",mt,d(t.name),1),a("div",pt,[(t.variant??t).is_free?(i(),y(C,{key:0,type:"success",size:"xs"},{default:f(()=>s[4]||(s[4]=[v("free")])),_:1,__:[4]})):(i(),o(_,{key:1},[(t.variant??t).on_sale?(i(),o("span",gt,d((t.variant??t).unit_sale_price.amount_with_currency),1)):g("",!0),a("span",{class:U(["text-sm",{"text-gray-400 line-through":(t.variant??t).on_sale,"text-gray-900 font-semibold":!(t.variant??t).on_sale}])},d((t.variant??t).unit_regular_price.amount_with_currency),3)],64)),(t.variant??t).stock_quantity_type=="limited"&&((t.variant??t).has_stock&&(t.variant??t).stock_quantity<=5||!(t.variant??t).has_stock)?(i(),y(C,{key:2,type:(t.variant??t).has_stock?"success":"warning",size:"xs"},{default:f(()=>[v(d((t.variant??t).has_stock?`${(t.variant??t).stock_quantity} left`:"no stock"),1)]),_:2},1032,["type"])):g("",!0)])],8,lt)}),128))])):(i(),o("p",ut," No products found "))])]),l.shoppingCart?(i(),y(I,{key:0})):g("",!0)],64))])])}const pe=A(W,[["render",_t]]);export{pe as default};
