import{B as T}from"./Button-H5-4pReg.js";import{c as i,b as n,e as l,a as _,r as y,F as b,f as w,o,n as V,d as m,t as h,g as f,k as j,w as C,x as D,i as B}from"./app-C3gvvzwr.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as z}from"./chevron-right-DjWnjfU9.js";import{C as Q}from"./chevron-left-CmjVL2uT.js";import{I as A}from"./image-DrPuhYWN.js";import{P as M}from"./Pill-CKWNekmo.js";import{I as E,c as R}from"./Input-Ky0M0gBr.js";import{D as N}from"./Dropdown-CqG75M6r.js";import{D as G}from"./Datepicker-ZV66TTkQ.js";import{L as W}from"./link-B9zuN44s.js";import{M as U}from"./move-left-B7kKQMR8.js";import{c as H}from"./createLucideIcon-DcEzUACP.js";import"./Loader-CenJqq8u.js";import"./ShineEffect-Bjy7l8nq.js";import"./Popover-CueE8CKU.js";import"./x-DysaB_8N.js";import"./Copy-2MtTss3I.js";import"./Skeleton-BmfWv9Ad.js";import"./refresh-ccw-CCOkutNK.js";import"./circle-check-Bpb6vmpJ.js";import"./circle-alert-jW_RoXi8.js";import"./parsePhoneNumber-DR0S47Bc.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=H("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),K={inject:["productState"],components:{Image:A,ChevronLeft:Q,ChevronRight:z},data(){return{currentIndex:0}},watch:{selectedVariantId(s){s&&this.updateCurrentImageForVariant(s)}},computed:{product(){return this.productState.product},selectedVariantId(){return this.productState.selectedVariantId},images(){var e,u,d;let s=[...((e=this.product)==null?void 0:e.photos)||[]];return((d=(u=this.product)==null?void 0:u.variants)==null?void 0:d.length)>0&&this.product.variants.forEach(a=>{var t;((t=a.photos)==null?void 0:t.length)>0&&(s=[...s,...a.photos])}),s},currentImage(){return this.images[this.currentIndex]||{}}},methods:{next(){this.currentIndex=(this.currentIndex+1)%this.images.length},prev(){this.currentIndex=(this.currentIndex-1+this.images.length)%this.images.length},selectImage(s){this.currentIndex=s},updateCurrentImageForVariant(s){const e=this.product.variants.find(u=>u.id===s);e.photos.length>0?this.currentIndex=this.images.findIndex(u=>u.path===e.photos[0].path):this.currentIndex=0}}},J={key:0,class:"relative"},O={class:"h-96 relative flex justify-center items-center bg-gray-100 rounded-lg overflow-hidden"},Y=["src"],Z={key:0,class:"flex justify-center mt-4 space-x-2"},F=["onClick"],$=["src"],tt={key:1,class:"h-96 relative flex justify-center items-center bg-gray-100 rounded-lg overflow-hidden"};function et(s,e,u,d,a,t){const x=y("ChevronLeft"),v=y("ChevronRight"),I=y("Image");return t.images.length>0?(o(),i("div",J,[n("div",O,[n("img",{src:t.currentImage.path,alt:"Selected product image",class:"w-full h-full object-contain"},null,8,Y),t.images.length>1?(o(),i("button",{key:0,onClick:e[0]||(e[0]=(...k)=>t.prev&&t.prev(...k)),class:"absolute left-8 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-50 text-gray-800 border border-gray-200 flex items-center justify-center w-8 h-8 rounded-full shadow-md cursor-pointer hover:scale-105 active:scale-100"},[_(x,{size:"20"})])):l("",!0),t.images.length>1?(o(),i("button",{key:1,onClick:e[1]||(e[1]=(...k)=>t.next&&t.next(...k)),class:"absolute right-8 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-50 text-gray-800 border border-gray-200 flex items-center justify-center w-8 h-8 rounded-full shadow-md cursor-pointer hover:scale-105 active:scale-100"},[_(v,{size:"20"})])):l("",!0)]),t.images.length>1?(o(),i("div",Z,[(o(!0),i(b,null,w(t.images,(k,g)=>(o(),i("div",{key:k.id,onClick:q=>t.selectImage(g),class:"cursor-pointer"},[n("img",{src:k.path,alt:"Thumbnail",class:V(["w-16 h-16 object-cover rounded-md border-2",{"border-blue-500":g===a.currentIndex,"border-transparent":g!==a.currentIndex}])},null,10,$)],8,F))),128))])):l("",!0)])):(o(),i("div",tt,[_(I,{size:"40",class:"text-gray-300"})]))}const rt=P(K,[["render",et]]),st={inject:["formState","orderState","productState","storeState","notificationState"],components:{Link:W,Pill:M,Input:E,Button:T,Dropdown:N,Datepicker:G},data(){return{Share2:X,MoveLeft:U,quantity:"1",responses:[],shouldGoBack:!1,options:[{label:"Whatsapp",icon:"whatsapp",action:this.shareViaWhatsapp},{label:"Facebook",icon:"facebook",action:this.shareViaFacebook},{label:"LinkedIn",icon:"linkedin",action:this.shareViaLinkedIn},{label:"X",icon:"x",action:this.shareViaX},{label:"Copy Link",action:this.copyLink}]}},watch:{product(s,e){!e&&s&&(this.setInitialQuantity(),this.product.variants.length&&(this.productState.selectedVariantId=this.product.variants[0].id),this.responses=this.dataCollectionFields.map(u=>u.type=="date"?null:u.type=="checkbox"?new Array(u.options.length).fill(!1):u.type=="media"?[]:""))},quantity(){this.orderProduct&&this.addToCart(!1)},isInspectingShoppingCart(s,e){e&&!s&&this.shouldGoBack&&this.goBack()}},computed:{store(){return this.storeState.store},isLoadingStore(){return this.storeState.isLoadingStore},isLoadingProduct(){return this.productState.isLoadingProduct},isInspectingShoppingCart(){return this.orderState.isInspectingShoppingCart},product(){return this.productState.product},orderProduct(){return this.shoppingCart&&this.product?this.shoppingCart.order_products.find(s=>s.product_id==this.product.id):null},estimatedPrice(){return this.isLoadingStore||this.isLoadingProduct?null:R(this.product.unit_price.amount*this.quantity,this.store.currency)},shoppingCart(){return this.orderState.shoppingCart},selectedVariantId(){return this.productState.selectedVariantId},selectedVariant(){return this.product.variants.find(s=>s.id==this.selectedVariantId)},dataCollectionFields(){return this.product.data_collection_fields},hasDataCollectionFields(){return this.dataCollectionFields.length>0},productLink(){if(!this.store||!this.product)return null;const s=this.$router.resolve({name:"show-shop-product",params:{alias:this.store.alias,product_id:this.product.id}});return`${window.location.origin}${s.href}`}},methods:{goBack(){this.$router.back()},setInitialQuantity(){this.orderProduct&&(this.quantity=this.orderProduct.quantity)},shareViaWhatsapp(){if(!this.productLink)return;const e=`https://wa.me/?text=${encodeURIComponent(`Check out ${this.product.name} at ${this.store.name}:

${this.productLink}`)}`;window.open(e,"_blank")},shareViaFacebook(){if(!this.productLink)return;const s=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(this.productLink)}`;window.open(s,"_blank")},shareViaLinkedIn(){if(!this.productLink)return;const s=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(this.productLink)}`;window.open(s,"_blank")},shareViaX(){if(!this.productLink)return;const e=`https://x.com/intent/post?text=${encodeURIComponent(`Check out ${this.product.name} at ${this.store.name}: ${this.productLink}`)}`;window.open(e,"_blank")},addToCart(s=!0){this.selectedVariant?this.orderState.addCartProductUsingProduct(this.selectedVariant,this.product,this.quantity,!1):this.orderState.addCartProductUsingProduct(this.product,null,this.quantity,!1),this.shouldGoBack=s},removeFromCart(s=!0){const e=this.shoppingCart.order_products.findIndex(u=>u.product_id==this.product.id);this.orderState.removeCartProduct(e,!1),this.shouldGoBack=s},async copyLink(){try{this.productLink?(await navigator.clipboard.writeText(this.productLink),this.notificationState.showSuccessNotification("Link copied")):this.notificationState.showWarningNotification("Link not ready")}catch(s){console.error("Failed to copy:",s)}},increaseQuantity(){const s=parseInt(this.quantity)||0,e=parseInt(this.product.stock_quantity)||1/0;s<e&&(this.quantity=(s+1).toString())},decreaseQuantity(){const s=parseInt(this.quantity)||1;s>1&&(this.quantity=(s-1).toString())},onBlurQuantityInput(){const s=parseInt(this.quantity)||1,e=parseInt(this.product.stock_quantity)||1/0;s<1?this.quantity="1":s>e?this.quantity=e.toString():this.quantity=s.toString()}}},ot={key:0},nt={class:"flex items-center justify-between"},it={class:"text-lg text-gray-700 font-semibold"},at={class:"max-h-60 overflow-auto"},ct=["onClick"],lt={class:"flex items-center space-x-2"},ut=["src","alt"],dt={class:"truncate"},pt={key:0,class:"text-sm text-gray-500 text-justify mt-4"},ht={key:1,class:"text-sm text-gray-500 mt-2"},mt={key:2,class:"space-y-2 mt-4"},yt=["onClick"],gt={class:"flex items-center justify-center w-5 h-5 bg-blue-100 rounded-full"},ft={class:"w-full flex items-center justify-between space-x-2"},_t={key:0,class:"max-w-12 max-h-12 aspect-square relative flex items-center justify-center bg-gray-100 rounded-lg overflow-hidden"},xt=["alt","src"],kt={class:"w-full flex items-center justify-between space-x-4"},bt={class:"text-sm text-gray-900 truncate"},wt={key:1},vt={key:0,class:"text-right text-sm font-semibold text-gray-900"},It={key:3,class:"flex items-center justify-between mt-4"},St={key:1,class:"space-x-2"},Vt={key:0,class:"text-right text-sm font-semibold text-gray-900"},Lt={class:"flex items-center justify-between space-x-4 border-t border-gray-300 pt-4 mt-4"},Ct={class:"w-fit text-sm flex items-center border border-gray-300 rounded-full overflow-hidden"},Pt={key:4,class:"flex justify-center border-b border-gray-300 pb-4 mt-4"},qt={class:"text-lg font-semibold text-gray-900"},Bt={key:5,class:"border-t border-gray-300 space-y-4 pt-4 mt-4"},Tt={class:"flex items-center text-sm leading-6 font-medium text-gray-900 space-x-1 mb-2"},Ut={key:0,class:"text-red-500"},jt={key:1,class:"font-normal text-gray-400 ml-1"},Dt={class:"space-y-2"},zt={class:"flex items-center text-sm leading-6 font-medium text-gray-900 space-x-1 mb-2"},Qt={key:0,class:"text-red-500"},At={key:1,class:"font-normal text-gray-400 ml-1"},Mt={class:"space-y-2"},Et={key:6,class:"flex space-x-2"},Rt={key:0};function Nt(s,e,u,d,a,t){const x=y("Button"),v=y("Link"),I=y("Dropdown"),k=y("Pill"),g=y("Input"),q=y("Datepicker");return t.product?(o(),i("div",ot,[n("div",nt,[n("h1",it,h(t.product.name),1),_(I,{position:"left",options:a.options,dropdownClasses:"w-40"},{trigger:f(r=>[_(x,{size:"xs",type:"light",leftIconSize:"16",leftIcon:a.Share2,action:r.toggleDropdown},{default:f(()=>e[4]||(e[4]=[n("span",{class:"ml-1"},"Share",-1)])),_:2,__:[4]},1032,["leftIcon","action"])]),content:f(r=>[n("ul",at,[(o(!0),i(b,null,w(r.options,(c,p)=>(o(),i("li",{key:p,onClick:()=>r.handleItemClick(c),class:V(["flex items-center space-x-2 px-4 py-1.5 text-sm cursor-pointer",c.label=="Copy Link"?"hover:bg-blue-100 bg-blue-50":"hover:bg-gray-100 text-gray-700"])},[n("div",lt,[c.label=="Copy Link"?(o(),m(v,{key:0,size:"14"})):c.icon?(o(),i("img",{key:1,src:`/images/social-media-icons/${c.icon}.png`,alt:`${c.icon} Logo`,class:"w-4 h-4"},null,8,ut)):l("",!0),n("span",dt,h(c.label),1)])],10,ct))),128))])]),_:1},8,["options"])]),t.product.show_description&&t.product.description?(o(),i("p",pt,h(t.product.description),1)):l("",!0),t.product.sku?(o(),i("p",ht," SKU: "+h(t.product.sku),1)):l("",!0),t.product.variants.length?(o(),i("div",mt,[(o(!0),i(b,null,w(t.product.variants,r=>(o(),i("div",{key:r.id,onClick:C(c=>t.productState.selectedVariantId=r.id,["stop"]),class:"flex items-center space-x-4 p-2 hover:bg-gray-50 cursor-pointer rounded-lg"},[n("div",gt,[n("div",{class:V(["w-3 h-3 bg-blue-500 rounded-full transition-all",r.id==t.selectedVariantId?"opacity-100":"opacity-0"])},null,2)]),n("div",ft,[r.photos.length?(o(),i("div",_t,[n("img",{alt:r.name,src:r.photos[0].path,class:"w-full h-full object-cover"},null,8,xt)])):l("",!0),n("div",kt,[n("h4",bt,h(t.product.name),1),r.is_free?(o(),m(k,{key:0,type:"success",size:"xs"},{default:f(()=>e[5]||(e[5]=[B("free")])),_:1,__:[5]})):(o(),i("div",wt,[r.on_sale?(o(),i("p",vt,h(r.unit_sale_price.amount_with_currency),1)):l("",!0),n("p",{class:V(["text-right",{"line-through text-xs text-gray-400":r.on_sale,"text-sm text-gray-900 font-semibold":!r.on_sale}])},h(r.unit_regular_price.amount_with_currency),3)]))])])],8,yt))),128))])):(o(),i("div",It,[e[7]||(e[7]=n("span",{class:"text-sm font-bold"},"Price",-1)),t.product.is_free?(o(),m(k,{key:0,type:"success",size:"xs"},{default:f(()=>e[6]||(e[6]=[B("free")])),_:1,__:[6]})):(o(),i("div",St,[t.product.on_sale?(o(),i("span",Vt,h(t.product.unit_sale_price.amount_with_currency),1)):l("",!0),n("span",{class:V(["text-right",{"line-through text-xs text-gray-400":t.product.on_sale,"text-sm text-gray-900 font-semibold":!t.product.on_sale}])},h(t.product.unit_regular_price.amount_with_currency),3)]))])),n("div",Lt,[e[8]||(e[8]=n("span",{class:"text-sm font-bold"},"Quantity",-1)),n("div",Ct,[n("button",{onClick:e[0]||(e[0]=C((...r)=>t.decreaseQuantity&&t.decreaseQuantity(...r),["stop"])),class:"px-3 py-1 bg-gray-200 text-gray-700 hover:bg-gray-300 cursor-pointer"}," - "),j(n("input",{min:"0",value:"2","onUpdate:modelValue":e[1]||(e[1]=r=>a.quantity=r),onBlur:e[2]||(e[2]=(...r)=>s.onBlurQuntityInput&&s.onBlurQuntityInput(...r)),class:"w-16 text-center border-0 focus:outline-none"},null,544),[[D,a.quantity]]),n("button",{onClick:e[3]||(e[3]=C((...r)=>t.increaseQuantity&&t.increaseQuantity(...r),["stop"])),class:"px-3 py-1 bg-gray-200 text-gray-700 hover:bg-gray-300 cursor-pointer"}," + ")])]),t.orderProduct&&(t.isInspectingShoppingCart||!a.shouldGoBack)?(o(),i("div",Pt,[n("span",qt,h(t.estimatedPrice),1)])):l("",!0),t.hasDataCollectionFields?(o(),i("div",Bt,[(o(!0),i(b,null,w(t.dataCollectionFields,(r,c)=>(o(),i("div",{key:c},[r.type=="short answer"?(o(),m(g,{key:0,type:"text",modelValue:a.responses[c],"onUpdate:modelValue":p=>a.responses[c]=p,label:r.name,showAsterisk:r.required,secondaryLabel:r.required?null:"(optional)",errorText:t.formState.getFormError(`data_collection_fields.${c}`)},null,8,["modelValue","onUpdate:modelValue","label","showAsterisk","secondaryLabel","errorText"])):l("",!0),r.type=="long answer"?(o(),m(g,{key:1,type:"textarea",modelValue:a.responses[c],"onUpdate:modelValue":p=>a.responses[c]=p,label:r.name,showAsterisk:r.required,secondaryLabel:r.required?null:"(optional)",errorText:t.formState.getFormError(`data_collection_fields.${c}`)},null,8,["modelValue","onUpdate:modelValue","label","showAsterisk","secondaryLabel","errorText"])):l("",!0),r.type=="number"?(o(),m(g,{key:2,type:"number",modelValue:a.responses[c],"onUpdate:modelValue":p=>a.responses[c]=p,label:r.name,showAsterisk:r.required,secondaryLabel:r.required?null:"(optional)",errorText:t.formState.getFormError(`data_collection_fields.${c}`)},null,8,["modelValue","onUpdate:modelValue","label","showAsterisk","secondaryLabel","errorText"])):l("",!0),r.type=="date"?(o(),m(q,{key:3,enableTimePicker:!0,modelValue:a.responses[c],"onUpdate:modelValue":p=>a.responses[c]=p,format:"dd MMM yyyy HH:mm",placeholder:"Select a date",modelType:"yyyy-MM-dd HH:mm",label:r.name,showAsterisk:r.required,secondaryLabel:r.required?null:"(optional)",errorText:t.formState.getFormError(`data_collection_fields.${c}`)},null,8,["modelValue","onUpdate:modelValue","label","showAsterisk","secondaryLabel","errorText"])):l("",!0),r.type=="checkbox"?(o(),i(b,{key:4},[n("div",Tt,[n("span",null,h(r.name),1),r.required?(o(),i("span",Ut," * ")):(o(),i("span",jt,"(optional)"))]),n("div",Dt,[(o(!0),i(b,null,w(r.options,(p,S)=>(o(),m(g,{type:"checkbox",key:S,inputLabel:p.name,radioValue:p.name,modelValue:a.responses[c][S],"onUpdate:modelValue":L=>a.responses[c][S]=L,errorText:t.formState.getFormError(`data_collection_fields.${c}`)},null,8,["inputLabel","radioValue","modelValue","onUpdate:modelValue","errorText"]))),128))])],64)):l("",!0),r.type=="selection"?(o(),i(b,{key:5},[n("div",zt,[n("span",null,h(r.name),1),r.required?(o(),i("span",Qt," * ")):(o(),i("span",At,"(optional)"))]),n("div",Mt,[(o(!0),i(b,null,w(r.options,(p,S)=>(o(),m(g,{type:"radio",key:S,inputLabel:p.name,radioValue:p.name,modelValue:a.responses[c],"onUpdate:modelValue":L=>a.responses[c]=L,name:`selection-${r.temporary_id}`,errorText:t.formState.getFormError(`data_collection_fields.${c}`)},null,8,["inputLabel","radioValue","modelValue","onUpdate:modelValue","name","errorText"]))),128))]),r.required?l("",!0):(o(),m(x,{key:0,size:"xs",type:"light",class:"mt-4",action:()=>a.responses[c]=null},{default:f(()=>e[9]||(e[9]=[n("span",null,"Clear selection",-1)])),_:2,__:[9]},1032,["action"]))],64)):l("",!0),r.type=="media"?(o(),m(g,{key:6,type:"file",mimeTypes:["image/*"],modelValue:a.responses[c],"onUpdate:modelValue":p=>a.responses[c]=p,showAsterisk:r.required,maxFiles:parseInt(r.max),errorText:t.formState.getFormError(`data_collection_fields.${c}`)},null,8,["modelValue","onUpdate:modelValue","showAsterisk","maxFiles","errorText"])):l("",!0)]))),128))])):l("",!0),t.orderProduct&&(t.isInspectingShoppingCart||!a.shouldGoBack)?(o(),i("div",Et,[_(x,{size:"md",class:"mt-8",type:"light",action:t.goBack,leftIcon:a.MoveLeft,buttonClass:"w-full",disabled:t.isInspectingShoppingCart},{default:f(()=>e[10]||(e[10]=[n("span",null,"Shop",-1)])),_:1,__:[10]},8,["action","leftIcon","disabled"]),_(x,{size:"md",class:"mt-8",type:"danger",buttonClass:"w-full",action:t.removeFromCart,disabled:t.isInspectingShoppingCart},{default:f(()=>e[11]||(e[11]=[n("span",null,"Remove Item",-1)])),_:1,__:[11]},8,["action","disabled"])])):t.orderProduct?l("",!0):(o(),m(x,{key:7,size:"lg",class:"mt-8",type:"primary",action:t.addToCart,buttonClass:"w-full",disabled:t.isInspectingShoppingCart},{default:f(()=>[e[12]||(e[12]=n("span",null,"Add",-1)),t.estimatedPrice?(o(),i("span",Rt,h(t.estimatedPrice),1)):l("",!0)]),_:1,__:[12]},8,["action","disabled"]))])):l("",!0)}const Gt=P(st,[["render",Nt]]),Wt={inject:["formState","productState","storeState","notificationState"],components:{Button:T,ImageCarousel:rt,ProductDetails:Gt},data(){return{MoveLeft:U}},watch:{store(s,e){!e&&s&&this.showProduct()}},computed:{store(){return this.storeState.store},product(){return this.productState.product},productId(){return this.$route.params.product_id}},methods:{goBack(){this.$router.back()},async showProduct(){var s,e,u;try{this.productState.isLoadingProduct=!0;let d={params:{store_id:this.store.id,_relationships:["photos","categories","variants.photos"].join(",")}};const t=(await axios.get(`/api/products/${this.productId}`,d)).data;this.productState.setProduct(t)}catch(d){const a=((e=(s=d==null?void 0:d.response)==null?void 0:s.data)==null?void 0:e.message)||(d==null?void 0:d.message)||"Something went wrong while fetching product";this.notificationState.showWarningNotification(a),this.formState.setServerFormErrors(d),console.error("Failed to fetch product:",d),((u=d.response)==null?void 0:u.status)===404&&await this.$router.replace({name:"show-storefront",params:{alias:this.store.alias}})}finally{this.productState.isLoadingProduct=!1}}},unmounted(){this.productState.reset()},created(){this.store&&this.showProduct()}},Ht={class:"lg:max-w-6xl max-w-xl mx-auto grid grid-cols-1 lg:grid-cols-2 lg:divide-x lg:divide-gray-300"},Xt={class:"lg:p-8 px-4 pt-8"},Kt={class:"lg:p-8 px-4 pb-8"};function Jt(s,e,u,d,a,t){const x=y("Button"),v=y("ImageCarousel"),I=y("ProductDetails");return o(),i("div",Ht,[n("div",Xt,[_(x,{size:"xs",class:"mb-4",type:"light",action:t.goBack,leftIcon:a.MoveLeft},{default:f(()=>e[0]||(e[0]=[n("span",null,"Shop",-1)])),_:1,__:[0]},8,["action","leftIcon"]),_(v)]),n("div",Kt,[_(I)])])}const _e=P(Wt,[["render",Jt]]);export{_e as default};
