import{c as p,b as o,a,w as x,e as y,t as m,g as u,h as b,r as n,o as c,i as S}from"./app-BdtgzR1l.js";import{L as E}from"./Logo-B6TeVoLF.js";import{I as P}from"./Input-BDUYKZ_s.js";import{B as _}from"./Button-HzXB0hWC.js";import{i as k}from"./stringUtils-Bvzw0-oW.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Copy-DcyQ5giz.js";import"./ShineEffect-Dr0WlC0V.js";import"./createLucideIcon-BOaOvfG7.js";import"./Popover-CtdAzqVX.js";import"./Tooltip-NkqcAVam.js";import"./Skeleton-BWgMm33A.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-CCUHqYUk.js";import"./circle-check-D6VZimzV.js";import"./circle-alert-BWam5-Oa.js";import"./x-H5s2sCz3.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-DFjvkDgo.js";const v={name:"ResetPassword",components:{Logo:E,Input:P,Button:_},inject:["formState","notificationState"],data(){return{form:{email:"",token:"",password:"",confirmPassword:""},loading:!1,currentYear:new Date().getFullYear(),appName:"Perfect Order"}},methods:{isEmpty:k,async submit(){var l,t;if(!this.loading&&(this.formState.hideFormErrors(),this.isEmpty(this.form.email)&&this.formState.setFormError("email","Email is required"),this.isEmpty(this.form.password)&&this.formState.setFormError("password","New Password is required"),this.isEmpty(this.form.confirmPassword)&&this.formState.setFormError("confirmPassword","Confirm New Password is required"),this.form.password!==this.form.confirmPassword&&this.formState.setFormError("confirmPassword","Passwords do not match"),!this.formState.hasErrors)){this.loading=!0;try{await b.post("/api/auth/reset-password",this.form),this.notificationState.showSuccessNotification("Password reset successfully. Please log in with your new password."),this.$router.push({name:"login"})}catch(r){const f=((t=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Something went wrong while resetting your password";this.notificationState.showWarningNotification(f),this.formState.setServerFormErrors(r),console.error("Failed to reset password:",r)}finally{this.loading=!1}}}},mounted(){this.form.email=this.$route.query.email||"",this.form.token=this.$route.query.token||"",this.form.email?this.form.token||(this.formState.setFormError("general","Missing token."),this.notificationState.showWarningNotification("Missing token.")):(this.formState.setFormError("general","Missing email."),this.notificationState.showWarningNotification("Missing email."))}},F={class:"min-h-screen grid grid-cols-1 lg:grid-cols-2 transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0"},V={class:"flex items-center justify-center p-6 bg-linear-to-b from-blue-100 to-white-100"},T={class:"w-full max-w-md"},B={class:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6"},C={key:0,class:"text-red-500 text-sm mb-3"},L={class:"ml-1"},j={class:"flex justify-center mt-4"},q={class:"text-sm text-center text-gray-500"};function M(l,t,r,f,e,s){const w=n("Logo"),d=n("Input"),g=n("Button"),h=n("router-link");return c(),p("div",F,[o("div",V,[o("div",T,[a(w,{height:"h-20 mx-auto mb-4"}),o("div",B,[t[5]||(t[5]=o("h1",{class:"text-2xl font-semibold leading-none tracking-tight mb-4"},"Reset Password",-1)),t[6]||(t[6]=o("h1",{class:"text-sm text-gray-500 mb-4"},"Enter a new password for your account.",-1)),o("form",{onSubmit:t[3]||(t[3]=x((...i)=>s.submit&&s.submit(...i),["prevent"])),class:"space-y-4"},[a(d,{disabled:"",type:"email",label:"Email",modelValue:e.form.email,"onUpdate:modelValue":t[0]||(t[0]=i=>e.form.email=i),errorText:s.formState.getFormError("email")},null,8,["modelValue","errorText"]),a(d,{type:"password",label:"New Password",modelValue:e.form.password,"onUpdate:modelValue":t[1]||(t[1]=i=>e.form.password=i),errorText:s.formState.getFormError("password")},null,8,["modelValue","errorText"]),a(d,{type:"password",label:"Confirm New Password",modelValue:e.form.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=i=>e.form.confirmPassword=i),errorText:s.formState.getFormError("confirmPassword")},null,8,["modelValue","errorText"]),s.formState.generalErrorText?(c(),p("div",C,m(s.formState.generalErrorText),1)):y("",!0),a(g,{size:"md",type:"primary",action:s.submit,disabled:e.loading,buttonClass:"w-full"},{default:u(()=>[o("span",L,m(e.loading?"Resetting...":"Reset Password"),1)]),_:1},8,["action","disabled"]),o("div",j,[a(h,{to:{name:"login"},class:"text-sm text-blue-600 hover:underline"},{default:u(()=>[...t[4]||(t[4]=[S("Back to Login",-1)])]),_:1})])],32)]),o("p",q,"Â© "+m(e.currentYear)+" "+m(e.appName)+". All rights reserved.",1)])]),t[7]||(t[7]=o("div",{class:"hidden lg:block"},[o("img",{src:"/images/lady-with-laptop.jpg",class:"w-full h-full object-cover",alt:"Lady holding boxes"})],-1))])}const et=N(v,[["render",M]]);export{et as default};
