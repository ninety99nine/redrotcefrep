import{I as y}from"./Input-BDUYKZ_s.js";import{B as _}from"./Button-HzXB0hWC.js";import{S as x}from"./StoreLogo-CBj6UzC0.js";import{W as w}from"./WhatsappIcon-C1Z43tYr.js";import{S as C}from"./SelectCountry-N0bZktMC.js";import{a as E,i as V}from"./stringUtils-Bvzw0-oW.js";import{S as T}from"./SelectCurrency-iQIfxcQm.js";import{c as v,b as r,d as B,e as k,a as l,g as p,r as n,o as f}from"./app-BdtgzR1l.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as W}from"./earth-BDrhhFJN.js";import{M as I}from"./move-left-B36B48Qb.js";import"./Copy-DcyQ5giz.js";import"./ShineEffect-Dr0WlC0V.js";import"./createLucideIcon-BOaOvfG7.js";import"./Popover-CtdAzqVX.js";import"./Tooltip-NkqcAVam.js";import"./Skeleton-BWgMm33A.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-CCUHqYUk.js";import"./circle-check-D6VZimzV.js";import"./circle-alert-BWam5-Oa.js";import"./x-H5s2sCz3.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-DFjvkDgo.js";import"./plus-YSNtgxvu.js";import"./trash-2-BsHN7UDw.js";import"./Select-DSAUUq8e.js";const N={inject:["authState","storeState","formState","notificationState"],components:{Earth:W,Input:y,Button:_,StoreLogo:x,WhatsappIcon:w,SelectCountry:C,SelectCurrency:T},data(){return{MoveLeft:I,form:{name:"",alias:"",country:"BW",currency:"BWP",whatsapp_mobile_number:""},logo:null,aliasModified:!1,isCreatingStore:!1}},computed:{canGoBackToDashboard(){var s;return((s=this.$route.query)==null?void 0:s.can_go_back)==1}},methods:{isEmpty:V,isNotEmpty:E,syncWithAlias(){this.aliasModified==!1&&(this.form.alias=this.form.name,this.formatAlias())},formatAlias(s=!1){this.form.alias.length?(this.form.alias=this.form.alias.replace(/[^a-zA-Z0-9\s-]/g,"").replace(/\s+/g,"-").trim().toLowerCase(),this.aliasModified=s):this.aliasModified=!1},handleSelectedFile(s){this.logo=s},navigateToShowStores(){this.$router.push({name:"show-stores"})},async createStore(){var s,e;try{if(this.isCreatingStore||(this.formState.hideFormErrors(),this.isEmpty(this.form.name)&&this.formState.setFormError("name","Enter store name"),this.formState.hasErrors))return;this.isCreatingStore=!0;let o=new FormData;o.append("return",1),o.append("name",this.form.name),o.append("country",this.form.country),o.append("currency",this.form.currency),this.isNotEmpty(this.form.alias)&&o.append("alias",this.form.alias.trim()),this.isNotEmpty(this.form.whatsapp_mobile_number)&&o.append("whatsapp_mobile_number",this.form.whatsapp_mobile_number.trim()),this.logo&&o.append("logo",this.logo);const m={headers:{"Content-Type":"multipart/form-data"}},t=await axios.post("/api/stores",o,m);this.notificationState.showSuccessNotification("Store created!"),console.log({name:"add-products",params:{store_id:t.data.store.id}}),this.$router.push({name:"add-products",params:{store_id:t.data.store.id}})}catch(o){const m=((e=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:e.message)||(o==null?void 0:o.message)||"Something went wrong while creating store";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(o),console.error("Failed to create store:",o)}finally{this.isCreatingStore=!1}}},created(){this.storeState.setStore(null),this.authState.user.mobile_number&&(this.form.whatsapp_mobile_number=this.authState.user.mobile_number.international)}},A={class:"flex flex-col items-center justify-center pb-40"},D={class:"w-full max-w-lg"},L={class:"bg-white p-8 rounded-2xl shadow-lg"},M={class:"space-y-4 mb-4"},z={class:"flex items-center space-x-1 pl-2 rounded-l-md bg-gray-50 text-gray-500 whitespace-nowrap"};function P(s,e,o,m,t,a){const d=n("StoreLogo"),u=n("Input"),h=n("WhatsappIcon"),g=n("Earth"),S=n("SelectCountry"),b=n("SelectCurrency"),c=n("Button");return f(),v("div",A,[e[10]||(e[10]=r("div",{class:"w-full max-w-lg"},[r("h2",{class:"text-2xl font-semibold text-center"},"Start Your Store"),r("p",{class:"text-gray-500 text-center mb-6"},"Tell us a little about your store to get started")],-1)),r("div",D,[r("div",L,[l(d,{onSelectedFile:a.handleSelectedFile,uploading:t.logo&&t.isCreatingStore,class:"flex justify-center mb-4"},null,8,["onSelectedFile","uploading"]),r("div",M,[l(u,{type:"text",label:"Name",modelValue:t.form.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.form.name=i),showAsterisk:!0,onKeyup:a.syncWithAlias,placeholder:"Baby Cakes ðŸ§",autocomplete:"organization",errorText:a.formState.getFormError("name")},null,8,["modelValue","onKeyup","errorText"]),l(u,{type:"text",label:"WhatsApp Number",placeholder:"+26772000001",modelValue:t.form.whatsapp_mobile_number,"onUpdate:modelValue":e[1]||(e[1]=i=>t.form.whatsapp_mobile_number=i),errorText:a.formState.getFormError("whatsapp_mobile_number"),description:"Customers can send orders to this number after shopping"},{prefix:p(()=>[l(h,{class:"mx-2"})]),_:1},8,["modelValue","errorText"]),l(u,{type:"text",label:"Store Link",modelValue:t.form.alias,"onUpdate:modelValue":e[2]||(e[2]=i=>t.form.alias=i),placeholder:"baby-cakes",onKeyup:e[3]||(e[3]=()=>a.formatAlias(!0)),errorText:a.formState.getFormError("alias"),description:"Your storeâ€™s shopping link. Custom domains can be set later."},{prefix:p(()=>[r("div",z,[l(g,{size:"18",class:"mt-0.5"}),e[6]||(e[6]=r("span",{class:"text-sm"},"perfectorder.shop",-1)),e[7]||(e[7]=r("span",{class:"text-gray-400 text-sm"},"/",-1))])]),_:1},8,["modelValue","errorText"]),l(S,{class:"w-full",label:"Country",modelValue:t.form.country,"onUpdate:modelValue":e[4]||(e[4]=i=>t.form.country=i),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your storeâ€™s country of operation"},null,8,["modelValue"]),l(b,{class:"w-full",label:"Currency",modelValue:t.form.currency,"onUpdate:modelValue":e[5]||(e[5]=i=>t.form.currency=i),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your storeâ€™s currency"},null,8,["modelValue"])]),l(c,{size:"lg",type:"primary",buttonClass:"w-full",action:a.createStore,loading:t.isCreatingStore,disabled:t.isCreatingStore},{default:p(()=>[...e[8]||(e[8]=[r("span",null,"Create Store",-1)])]),_:1},8,["action","loading","disabled"])]),a.canGoBackToDashboard?(f(),B(c,{key:0,size:"lg",class:"mt-4",type:"light",leftIcon:t.MoveLeft,buttonClass:"w-full",disabled:t.isCreatingStore,action:a.navigateToShowStores},{default:p(()=>[...e[9]||(e[9]=[r("span",{class:"ml-1"},"Back To Dashboard",-1)])]),_:1},8,["leftIcon","disabled","action"])):k("",!0)])])}const fe=F(N,[["render",P]]);export{fe as default};
