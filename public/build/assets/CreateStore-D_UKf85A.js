import{I as b}from"./Input-5etQ1obE.js";import{B as y}from"./Button-C-mSVtjr.js";import{S as _}from"./StoreLogo-CNCxn3hW.js";import{W as x}from"./WhatsappIcon-DJrQkeSD.js";import{S as w}from"./SelectCountry-C_Upu5vt.js";import{a as C,i as E}from"./stringUtils-Bvzw0-oW.js";import{S as V}from"./SelectCurrency-c9b_Ayom.js";import{c as v,b as r,a,g as p,r as n,o as T}from"./app-CfcRgAtV.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as F}from"./earth-B9M_GWEI.js";import{M as W}from"./move-left-Dt2sjdDQ.js";import"./Copy-DthcHkWW.js";import"./ShineEffect-DuM8M3bS.js";import"./createLucideIcon-6Wi-O4Lc.js";import"./Popover-CErryWiK.js";import"./Tooltip-DXGv3bv0.js";import"./Skeleton-dcrsQT38.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-BfzP-qh6.js";import"./circle-check-DJt4jgY5.js";import"./circle-alert-DtAPlORr.js";import"./x-0E_1Yt9j.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-DC71jh3F.js";import"./plus-4iq4yqcZ.js";import"./Select-mk4gS599.js";const I={inject:["authState","storeState","formState","notificationState"],components:{Earth:F,Input:b,Button:y,StoreLogo:_,WhatsappIcon:x,SelectCountry:w,SelectCurrency:V},data(){return{MoveLeft:W,form:{name:"",alias:"",country:"BW",currency:"BWP",whatsapp_mobile_number:""},logo:null,aliasModified:!1,isCreatingStore:!1}},computed:{canGoBack(){var s;return((s=this.$route.query)==null?void 0:s.can_go_back)==1}},methods:{isEmpty:E,isNotEmpty:C,syncWithAlias(){this.aliasModified==!1&&(this.form.alias=this.form.name,this.formatAlias())},formatAlias(s=!1){this.form.alias.length?(this.form.alias=this.form.alias.replace(/[^a-zA-Z0-9\s-]/g,"").replace(/\s+/g,"-").trim().toLowerCase(),this.aliasModified=s):this.aliasModified=!1},handleSelectedFile(s){this.logo=s},navigateToShowStores(){this.$router.push({name:"show-stores"})},async createStore(){var s,e;try{if(this.isCreatingStore||(this.formState.hideFormErrors(),this.isEmpty(this.form.name)&&this.formState.setFormError("name","Enter store name"),this.formState.hasErrors))return;this.isCreatingStore=!0;let t=new FormData;t.append("return",1),t.append("name",this.form.name),t.append("country",this.form.country),t.append("currency",this.form.currency),this.isNotEmpty(this.form.alias)&&t.append("alias",this.form.alias.trim()),this.isNotEmpty(this.form.whatsapp_mobile_number)&&t.append("whatsapp_mobile_number",this.form.whatsapp_mobile_number.trim()),this.logo&&t.append("logo",this.logo);const m={headers:{"Content-Type":"multipart/form-data"}},o=await axios.post("/api/stores",t,m);this.notificationState.showSuccessNotification("Store created!"),this.$router.push({name:"add-products",params:{store_id:o.data.store.id}})}catch(t){const m=((e=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:e.message)||(t==null?void 0:t.message)||"Something went wrong while creating store";this.notificationState.showWarningNotification(m),this.formState.setServerFormErrors(t),console.error("Failed to create store:",t)}finally{this.isCreatingStore=!1}}},created(){this.storeState.setStore(null),this.authState.user.mobile_number&&(this.form.whatsapp_mobile_number=this.authState.user.mobile_number.international)}},k={class:"flex flex-col items-center justify-center pb-40"},N={class:"w-full max-w-lg"},A={class:"bg-white p-8 rounded-2xl shadow-lg"},L={class:"space-y-4 mb-4"},M={class:"flex items-center space-x-1 pl-2 rounded-l-md bg-gray-50 text-gray-500 whitespace-nowrap"};function z(s,e,t,m,o,l){const f=n("StoreLogo"),u=n("Input"),d=n("WhatsappIcon"),h=n("Earth"),S=n("SelectCountry"),g=n("SelectCurrency"),c=n("Button");return T(),v("div",k,[e[10]||(e[10]=r("div",{class:"w-full max-w-lg"},[r("h2",{class:"text-2xl font-semibold text-center"},"Start Your Store"),r("p",{class:"text-gray-500 text-center mb-6"},"Tell us a little about your store to get started")],-1)),r("div",N,[r("div",A,[a(f,{onSelectedFile:l.handleSelectedFile,uploading:o.logo&&o.isCreatingStore,class:"flex justify-center mb-4"},null,8,["onSelectedFile","uploading"]),r("div",L,[a(u,{type:"text",label:"Name",modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=i=>o.form.name=i),showAsterisk:!0,onKeyup:l.syncWithAlias,placeholder:"Baby Cakes 🧁",autocomplete:"organization",errorText:l.formState.getFormError("name")},null,8,["modelValue","onKeyup","errorText"]),a(u,{type:"text",label:"WhatsApp Number",placeholder:"+26772000001",modelValue:o.form.whatsapp_mobile_number,"onUpdate:modelValue":e[1]||(e[1]=i=>o.form.whatsapp_mobile_number=i),errorText:l.formState.getFormError("whatsapp_mobile_number"),description:"Customers can send orders to this number after shopping"},{prefix:p(()=>[a(d,{class:"mx-2"})]),_:1},8,["modelValue","errorText"]),a(u,{type:"text",label:"Store Link",modelValue:o.form.alias,"onUpdate:modelValue":e[2]||(e[2]=i=>o.form.alias=i),placeholder:"baby-cakes",onKeyup:e[3]||(e[3]=()=>l.formatAlias(!0)),errorText:l.formState.getFormError("alias"),description:"Your store’s shopping link. Custom domains can be set later."},{prefix:p(()=>[r("div",M,[a(h,{size:"18",class:"mt-0.5"}),e[6]||(e[6]=r("span",{class:"text-sm"},"perfectorder.shop",-1)),e[7]||(e[7]=r("span",{class:"text-gray-400 text-sm"},"/",-1))])]),_:1},8,["modelValue","errorText"]),a(S,{class:"w-full",label:"Country",modelValue:o.form.country,"onUpdate:modelValue":e[4]||(e[4]=i=>o.form.country=i),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your store’s country of operation"},null,8,["modelValue"]),a(g,{class:"w-full",label:"Currency",modelValue:o.form.currency,"onUpdate:modelValue":e[5]||(e[5]=i=>o.form.currency=i),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Your store’s currency"},null,8,["modelValue"])]),a(c,{size:"lg",type:"primary",buttonClass:"w-full",action:l.createStore,loading:o.isCreatingStore,disabled:o.isCreatingStore},{default:p(()=>[...e[8]||(e[8]=[r("span",null,"Create Store",-1)])]),_:1},8,["action","loading","disabled"])]),a(c,{size:"lg",class:"mt-4",type:"light",leftIcon:o.MoveLeft,buttonClass:"w-full",disabled:o.isCreatingStore,action:l.navigateToShowStores},{default:p(()=>[...e[9]||(e[9]=[r("span",{class:"ml-1"},"Back To Dashboard",-1)])]),_:1},8,["leftIcon","disabled","action"])])])}const pe=B(I,[["render",z]]);export{pe as default};
