import{T as E}from"./Tabs-DCcIJlN0.js";import{P as I}from"./Pill-aGbs_XL2.js";import{A}from"./Alert-CoP-lZmZ.js";import{M as B}from"./Modal-X3iEO6Sa.js";import{I as V}from"./Input-Ch5FVRoG.js";import{B as H}from"./Button-0Fhg4Aii.js";import{S as U}from"./Skeleton-DGkj9lRL.js";import{a as P,i as W}from"./stringUtils-Bvzw0-oW.js";import{c as d,a as p,b as a,e as f,g as S,d as l,i as h,t as m,j,k as z,r as g,o as r}from"./app-811fDb4C.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as M}from"./external-link-Dvd2ainH.js";import{C as G}from"./circle-check-big-CC1FR4MG.js";import{T as w}from"./trash-2-COAOku7K.js";import{M as v}from"./move-left-C1am2jSW.js";import{G as x}from"./globe-DViHD95H.js";import{U as q}from"./user-CNOykAp6.js";import{R}from"./refresh-ccw-fYK0zSuq.js";import{P as Y}from"./plus-BU4OPlaU.js";import"./Popover-DfwFh9bM.js";import"./Tooltip-5EEAR2_1.js";import"./createLucideIcon-JVTSwxMK.js";import"./circle-check-Ci8AvIUe.js";import"./info-BoI19BZ7.js";import"./x-WVuudoOP.js";import"./Copy-XiSIbjW8.js";import"./ShineEffect-BW3gyXUb.js";import"./capitalize-ChUSrr1V.js";import"./circle-alert-DdTgr82K.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./Loader-DjUD9LDC.js";const J={inject:["formState","storeState","domainState","changeHistoryState","notificationState"],components:{Tabs:E,Pill:I,Alert:A,Modal:B,Input:V,Button:H,Skeleton:U,User:q,Globe:x,MoveLeft:v,Trash2:w,CheckCircle:G,ExternalLink:M},data(){return{Plus:Y,Globe:x,Trash2:w,MoveLeft:v,RefreshCcw:R,serverIp:null,connected:!1,domainContacts:null,existingDomainNames:[],isLoadingDomains:!1,isLoadingServerIp:!1,originalDomainName:null,originalDomainStatus:null,tab:"registrant",tabs:[{label:"Domain Owner",value:"registrant",description:"The individual or entity that owns the domain. This information is used to register the domain and is publicly visible in WHOIS records unless privacy protection is enabled."},{label:"Technical Contact",value:"tech",description:"The person or team responsible for managing the domainâ€™s technical setup, such as DNS configurations. They handle technical issues related to the domain."},{label:"Administrative Contact",value:"admin",description:"The contact responsible for administrative tasks, such as managing domain renewals and updates. They may also handle billing and policy-related matters."},{label:"Billing Contact",value:"aux_billing",description:"The contact responsible for payment and billing details for the domain. This information is used for invoices and renewal notifications."}]}},watch:{store(o,t){!t&&o&&this.setup()},domainForm:{handler(o){o.name==this.originalDomainName&&this.originalDomainStatus=="connected"?this.connected=!0:this.connected=!1},deep:!0}},computed:{store(){return this.storeState.store},isCreating(){return this.domainId==null},isEditing(){return this.domainId!=null},isLoadingStore(){return this.storeState.isLoadingStore},domainId(){return this.$route.params.domain_id},domain(){return this.domainState.domain},domainForm(){return this.domainState.domainForm},isLoadingDomain(){return this.domainState.isLoadingDomain},isCreatingDomain(){return this.domainState.isCreatingDomain},isUpdatingDomain(){return this.domainState.isUpdatingDomain},isDeletingDomain(){return this.domainState.isDeletingDomain},isVerifyingDomain(){return this.domainState.isVerifyingDomain},isLoadingDomainContacts(){return this.domainState.isLoadingDomainContacts},domainStatus(){return this.connected===!0?{label:"connected",type:"success"}:{label:"pending",type:"warning"}},selectedTabIndex(){return this.tabs.findIndex(o=>o.value==this.tab)}},methods:{isEmpty:W,isNotEmpty:P,setup(){this.domainState.setDomainForm(null,!0),this.store&&this.showDomains(),this.store&&this.domainId&&this.showDomain(),this.store&&!this.serverIp&&this.showServerIp()},setActionButtons(){this.changeHistoryState.removeButtons(),this.changeHistoryState.addDiscardButton(),this.changeHistoryState.addActionButton(this.isEditing?"Save Changes":"Add Domain",this.isEditing?this.updateDomain:this.createDomain,"primary",null)},async navigateToShowDomains(){await this.$router.push({name:"show-domains",query:{store_id:this.store.id}})},async navigateToEditDomain(){await this.$router.push({name:"edit-domain",query:{store_id:this.store.id},params:{domain_id:this.domain.id}})},async showServerIp(){var o,t;try{this.isLoadingServerIp=!0;let i={params:{store_id:this.store.id}};const n=await axios.get("/api/domains/server-ip",i);this.serverIp=n.data.server_ip}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching server IP";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch server IP:",i)}finally{this.isLoadingServerIp=!1}},async showDomains(){var o,t;try{this.isLoadingDomains=!0;let i={params:{per_page:100,store_id:this.store.id}};const e=(await axios.get("/api/domains",i)).data;this.existingDomainNames=e.data.map(s=>s.name)}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching domains";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch domains:",i)}finally{this.isLoadingDomains=!1}},async showDomain(){var o,t;try{this.domainState.isLoadingDomain=!0;let i={params:{store_id:this.store.id}};const e=(await axios.get(`/api/domains/${this.domainId}`,i)).data;this.domainState.setDomain(e),this.domainState.setDomainForm(e,!0),this.domain.type=="purchased"&&this.showDomainContacts(),this.$nextTick(()=>{this.connected=e.status==="connected",this.originalDomainStatus=this.domain.status,this.originalDomainName=this.domain.name})}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching domain";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch domain:",i)}finally{this.domainState.isLoadingDomain=!1}},async showDomainContacts(){var o,t;try{this.domainState.isLoadingDomainContacts=!0;let i={params:{store_id:this.store.id}};const n=await axios.get(`/api/domains/${this.domainId}/contacts`,i);this.domainContacts=n.data}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while fetching domain contacts";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to fetch domain contacts:",i)}finally{this.domainState.isLoadingDomainContacts=!1}},async createDomain(){var o,t;try{if(this.domainState.isCreatingDomain||(this.formState.hideFormErrors(),this.isEmpty(this.domainForm.name)?this.formState.setFormError("name","The domain name is required"):this.existingDomainNames.includes(this.domainForm.name)&&this.formState.setFormError("name","The domain name already exists"),this.formState.hasErrors))return;this.domainState.isCreatingDomain=!0,this.changeHistoryState.actionButtons[1].loading=!0;const i={name:this.domainForm.name,active:this.domainForm.active,store_id:this.store.id},e=(await axios.post("/api/domains",i)).data.domain;this.domainState.setDomain(e),this.domainState.setDomainForm(e,!0),this.connected=e.status==="connected",this.originalDomainName=e.name,this.originalDomainStatus=e.status,this.notificationState.showSuccessNotification("Domain created"),this.domainState.saveOriginalState("Original domain"),this.navigateToEditDomain()}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while creating domain";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to create domain:",i)}finally{this.domainState.isCreatingDomain=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async updateDomain(){var o,t;try{if(this.domainState.isUpdatingDomain||(this.formState.hideFormErrors(),this.isEmpty(this.domainForm.name)?this.formState.setFormError("name","The domain name is required"):this.domain.name!=this.domainForm.name&&this.existingDomainNames.includes(this.domainForm.name)&&this.formState.setFormError("name","The domain name already exists"),this.formState.hasErrors))return;this.domainState.isUpdatingDomain=!0,this.changeHistoryState.actionButtons[1].loading=!0;const i={name:this.domainForm.name,active:this.domainForm.active,store_id:this.store.id},e=(await axios.put(`/api/domains/${this.domainId}`,i)).data.domain;this.domainState.setDomain(e),this.domainState.setDomainForm(e,!0),this.connected=e.status==="connected",this.originalDomainName=e.name,this.originalDomainStatus=e.status,this.notificationState.showSuccessNotification("Domain updated"),this.domainState.saveOriginalState("Original domain")}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while updating domain";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to update domain:",i)}finally{this.domainState.isUpdatingDomain=!1,this.changeHistoryState.actionButtons[1].loading=!1}},async deleteDomain(o){var t,i;try{if(this.domainState.isDeletingDomain)return;this.domainState.isDeletingDomain=!0;const n={data:{store_id:this.store.id}};await axios.delete(`/api/domains/${this.domainId}`,n),o(),await new Promise(e=>setTimeout(e,500)),this.notificationState.showSuccessNotification("Domain deleted"),await this.navigateToShowDomains()}catch(n){const e=((i=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:i.message)||(n==null?void 0:n.message)||"Something went wrong while deleting domain";this.notificationState.showWarningNotification(e),this.formState.setServerFormErrors(n),console.error("Failed to delete domain:",n),o()}finally{this.domainState.isDeletingDomain=!1}},async verifyDomainConnection(){var o,t;try{if(this.domainState.isVerifyingDomain||(this.formState.hideFormErrors(),(this.isCreating||this.isEditing&&this.domain.name!=this.domainForm.name)&&this.existingDomainNames.includes(this.domainForm.name)&&this.formState.setFormError("name","The domain name already exists"),this.formState.hasErrors))return;this.domainState.isVerifyingDomain=!0;const i={store_id:this.store.id,name:this.domainForm.name},n=await axios.post("/api/domains/verify-connection",i);this.connected=n.data.connected,this.connected?this.isCreating?this.createDomain():this.updateDomain():this.notificationState.showWarningNotification(`${this.domainForm.name} is not connected`)}catch(i){const n=((t=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:t.message)||(i==null?void 0:i.message)||"Something went wrong while verifying domain connection";this.notificationState.showWarningNotification(n),this.formState.setServerFormErrors(i),console.error("Failed to verify domain connection:",i)}finally{this.domainState.isVerifyingDomain=!1}},setDomainForm(o){this.domainState.domainForm=o}},beforeUnmount(){this.domainState.reset()},created(){this.setup(),this.setActionButtons();const o=["undo","redo","jumpToHistory","resetHistoryToCurrent","resetHistoryToOriginal"];for(let t=0;t<o.length;t++){let i=o[t];this.changeHistoryState.listeners[i]=this.setDomainForm}}},K={class:"max-w-2xl mx-auto pt-24 pb-40"},Q={class:"bg-gray-50 border border-gray-300 rounded-lg p-4 mb-4"},X={key:0,class:"flex justify-end"},Z={key:0,class:"bg-gray-50 border border-gray-300 rounded-lg p-4 space-y-4 mb-4"},$={class:"flex items-center space-x-2 mb-4"},tt={class:"text-sm text-gray-600"},it={class:"font-bold"},et={class:"bg-white border border-gray-200 rounded-lg p-4"},st={class:"flex items-center space-x-4"},at={class:"w-1/3"},ot={class:"text-sm"},nt={class:"flex justify-center mt-4"},rt={key:1,class:"bg-gray-50 border border-gray-300 rounded-lg p-4 space-y-4 mb-4"},mt={class:"flex items-center space-x-2 mb-4"},dt={class:"bg-blue-50 border border-blue-100 rounded-lg text-sm p-2"},lt={class:"bg-white border border-gray-200 rounded-lg p-4"},ct={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ht={key:1,class:"text-sm"},gt={key:1,class:"text-sm"},pt={key:1,class:"text-sm"},ft={key:1,class:"text-sm"},ut={key:1,class:"text-sm"},St={key:1,class:"text-sm"},yt={key:1,class:"text-sm"},bt={key:1,class:"text-sm"},Dt={key:1,class:"text-sm"},wt={class:"text-sm"},vt={href:"https://www.namecheap.com",target:"_blank",class:"underline inline-flex items-center"},xt={class:"space-y-2"},Ct={class:"font-bold text-black"},_t={class:"flex justify-end"},Ft={class:"mb-8"},Lt={class:"font-bold text-black"};function Nt(o,t,i,n,e,s){var b,D;const y=g("Button"),C=g("Pill"),_=g("Input"),F=g("Globe"),L=g("User"),N=g("Tabs"),c=g("Skeleton"),k=g("ExternalLink"),T=g("Modal");return r(),d("div",K,[p(y,{size:"xs",type:"light",class:"mb-4",leftIcon:e.MoveLeft,action:s.navigateToShowDomains},{default:S(()=>[...t[3]||(t[3]=[a("span",null,"Back",-1)])]),_:1},8,["leftIcon","action"]),a("div",Q,[!s.isLoadingStore&&!s.isLoadingDomain&&s.isNotEmpty(s.domainForm.name)?(r(),d("div",X,[s.domainStatus?(r(),l(C,{key:0,type:s.domainStatus.type,size:"xs"},{default:S(()=>[h(m(s.domainStatus.label),1)]),_:1},8,["type"])):f("",!0)])):f("",!0),p(_,{type:"text",label:"Domain Name",placeholder:"example.com",modelValue:s.domainForm.name,"onUpdate:modelValue":t[0]||(t[0]=u=>s.domainForm.name=u),disabled:((b=s.domain)==null?void 0:b.type)=="purchased",errorText:s.formState.getFormError("name"),skeleton:s.isLoadingStore||s.isLoadingDomain,onInput:t[1]||(t[1]=u=>s.domainState.saveStateDebounced("Domain name changed")),tooltipContent:"The domain name for your store (e.g., example.com)",description:((D=s.domain)==null?void 0:D.type)=="purchased"?"This domain cannot be changed because its a purchased domain":null},null,8,["modelValue","disabled","errorText","skeleton","description"])]),!s.isLoadingStore&&!s.isLoadingDomain&&s.isNotEmpty(s.domainForm.name)&&!e.connected?(r(),d("div",Z,[a("div",$,[p(F,{size:"20"}),t[4]||(t[4]=a("h1",{class:"font-bold"},"Complete Connection",-1))]),a("p",tt,[t[5]||(t[5]=h(" To connect ",-1)),a("span",it,m(s.domainForm.name),1),t[6]||(t[6]=h(", update the DNS settings at your domain provider (e.g., Namecheap, GoDaddy, etc.) with the following ",-1)),t[7]||(t[7]=a("span",{class:"font-bold"},"A record",-1)),t[8]||(t[8]=h(" to prove ownership ",-1))]),a("div",et,[a("div",st,[t[10]||(t[10]=j('<div class="w-1/3"><p class="text-sm font-semibold mb-2">Type</p><p class="text-sm">A</p></div><div class="w-1/3"><p class="text-sm font-semibold mb-2">Host</p><p class="text-sm">@</p></div>',2)),a("div",at,[t[9]||(t[9]=a("p",{class:"text-sm font-semibold mb-2"},"Value",-1)),a("p",ot,m(e.serverIp),1)])])]),a("div",nt,[p(y,{size:"md",type:"success",class:"w-full",buttonClass:"w-full",leftIcon:e.RefreshCcw,loading:s.isVerifyingDomain,action:s.verifyDomainConnection},{default:S(()=>[...t[11]||(t[11]=[a("span",{class:"ml-1"},"Check Connection",-1)])]),_:1},8,["leftIcon","loading","action"])])])):f("",!0),!s.isLoadingStore&&!s.isLoadingDomain&&(s.isLoadingDomainContacts||e.domainContacts)?(r(),d("div",rt,[a("div",mt,[p(L,{size:"20"}),t[12]||(t[12]=a("h1",{class:"font-bold"},"Domain Contacts",-1))]),p(N,{tabs:e.tabs,modelValue:e.tab,"onUpdate:modelValue":t[2]||(t[2]=u=>e.tab=u)},null,8,["tabs","modelValue"]),a("p",dt,m(e.tabs[s.selectedTabIndex].description),1),a("div",lt,[a("div",ct,[a("div",null,[t[13]||(t[13]=a("p",{class:"text-sm font-semibold mb-1"},"First Name",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",ht,m(e.domainContacts[e.tab].first_name||"N/A"),1))]),a("div",null,[t[14]||(t[14]=a("p",{class:"text-sm font-semibold mb-1"},"Last Name",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",gt,m(e.domainContacts[e.tab].last_name||"N/A"),1))]),a("div",null,[t[15]||(t[15]=a("p",{class:"text-sm font-semibold mb-1"},"Email",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",pt,m(e.domainContacts[e.tab].email||"N/A"),1))]),a("div",null,[t[16]||(t[16]=a("p",{class:"text-sm font-semibold mb-1"},"Phone",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",ft,m(e.domainContacts[e.tab].phone||"N/A"),1))]),a("div",null,[t[17]||(t[17]=a("p",{class:"text-sm font-semibold mb-1"},"Address",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",ut,m(e.domainContacts[e.tab].address1||"N/A"),1))]),a("div",null,[t[18]||(t[18]=a("p",{class:"text-sm font-semibold mb-1"},"City",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",St,m(e.domainContacts[e.tab].city||"N/A"),1))]),a("div",null,[t[19]||(t[19]=a("p",{class:"text-sm font-semibold mb-1"},"State",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",yt,m(e.domainContacts[e.tab].state||"N/A"),1))]),a("div",null,[t[20]||(t[20]=a("p",{class:"text-sm font-semibold mb-1"},"Postal Code",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",bt,m(e.domainContacts[e.tab].postal_code||"N/A"),1))]),a("div",null,[t[21]||(t[21]=a("p",{class:"text-sm font-semibold mb-1"},"Country",-1)),s.isLoadingDomainContacts?(r(),l(c,{key:0,width:"w-40",class:"mt-2"})):(r(),d("p",Dt,m(e.domainContacts[e.tab].country||"N/A"),1))])])]),a("p",wt,[t[23]||(t[23]=h(" Your domain is provided by ",-1)),a("a",vt,[t[22]||(t[22]=a("span",null,"Namecheap.com",-1)),p(k,{size:"14",class:"ml-1"})])])])):f("",!0),s.domain&&!s.isLoadingStore&&!s.isLoadingDomain&&s.isEditing?(r(),d("div",{key:2,class:z(["flex items-center justify-between space-x-4 overflow-hidden rounded-lg p-4 border mt-4",s.isLoadingStore||s.isLoadingDomain?"border-gray-300 bg-gray-50":"border-red-300 bg-red-50"])},[a("div",xt,[a("p",null,[t[24]||(t[24]=h("Delete ",-1)),a("span",Ct,m(s.domain.name),1),t[25]||(t[25]=h("?",-1))])]),a("div",_t,[p(T,{triggerType:"danger",approveType:"danger",approveLeftIcon:e.Trash2,triggerText:"Delete Domain",approveText:"Delete Domain",approveAction:s.deleteDomain,triggerLoading:s.isDeletingDomain,approveLoading:s.isDeletingDomain},{content:S(()=>[t[28]||(t[28]=a("p",{class:"text-lg font-bold border-b border-gray-300 border-dashed pb-4 mb-4"},"Confirm Delete",-1)),a("p",Ft,[t[26]||(t[26]=h("Are you sure you want to delete ",-1)),a("span",Lt,m(s.domain.name),1),t[27]||(t[27]=h("?",-1))])]),_:1},8,["approveLeftIcon","approveAction","triggerLoading","approveLoading"])])],2)):f("",!0)])}const oi=O(J,[["render",Nt]]);export{oi as default};
