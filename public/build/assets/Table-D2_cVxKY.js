import{P as z}from"./Pill-CKWNekmo.js";import{I as j}from"./Input-Ky0M0gBr.js";import{S as W}from"./Select-DpnAowrL.js";import{B}from"./Button-H5-4pReg.js";import{L as Y}from"./Loader-CenJqq8u.js";import{a as ee}from"./stringUtils-Bvzw0-oW.js";import{D as P,A as C,c as i,a as u,r as c,g as F,o as l,b as n,e as p,F as A,f as I,t as U,d as v,i as O,w as S,P as te,E as M,T as se}from"./app-C3gvvzwr.js";import{P as oe}from"./Paginator-hfCsGu05.js";import{i as G}from"./isEqual-CPAhFYmu.js";import{D as $}from"./Drawer-T4tOETy4.js";import{S as le}from"./SelectCountry-CPsfeWcZ.js";import{D as re}from"./Datepicker-ZV66TTkQ.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as ie,a as ne}from"./chevron-up-DsZXZbFF.js";import{c as T}from"./createLucideIcon-DcEzUACP.js";import{S as ae}from"./Switch-BaQ7x_ir.js";import{V as J}from"./vue-draggable-next.esm-bundler-Cq980K70.js";import{M as K}from"./move-a5V9QytS.js";import{R as ue}from"./rotate-ccw-D4b3__ZP.js";/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=T("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=T("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=T("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=T("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=T("logs",[["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M3 18h1",key:"1eiwyy"}],["path",{d:"M3 6h1",key:"rgxa97"}],["path",{d:"M8 12h1",key:"1con00"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M8 6h1",key:"tn6mkg"}]]),ce={inject:["notificationState"],components:{Pill:z,Input:j,Button:B,Drawer:$,Datepicker:re,Loader:Y,Select:W,SelectCountry:le,Funnel:R,ChevronUp:ne,ChevronDown:ie},props:{filterExpressions:{type:Array,default:()=>[]},resource:{type:String}},emits:["updatedFilters"],data(){return{Funnel:R,ArrowUp:X,ArrowDown:Q,showMore:!1,localFilters:null,filterDrawer:null,originalFilters:null,isLoadingFilters:!1,lastEmittedFilters:null}},watch:{localFilters:{handler(t){this.createFilterExpressions()},deep:!0}},computed:{hasFilterExpressions(){return this.filterExpressions.length>0},totalActiveFilters(){return this.localFilters==null?0:this.localFilters.filter(t=>t.options.some(e=>e.active)).length},hasPriorityFilters(){return this.localFilters==null?!1:this.localFilters.filter(t=>t.priority).length>0},hasNonPriorityFilters(){return this.localFilters==null?!1:this.localFilters.filter(t=>!t.priority).length>0}},methods:{countActiveOptions(t){return t.options.filter(e=>e.active).length},createFilterExpressions(){let t=[];for(let e=0;e<this.localFilters.length;e++){const s=this.localFilters[e];if(s.options.some(o=>o.active))if(s.type==="checkboxes"){const r=s.options.filter(w=>w.active).map(w=>w.value),d=`${s.label} = ${r.join(", ")}`,h=`${s.target}:in:${r.join(",")}`;t.push({label:d,expression:h,filterIndex:e})}else for(let o=0;o<s.options.length;o++){const r=s.options[o];if(r.active){let h=null,w=null,V=r.value,D=r.value2,f=r.operator;if(["bt","bt_ex"].includes(f)){if(!V||!D)continue;h=`${s.label} between ${r.value} - ${r.value2} ${f=="bt"?"(including)":"(excluding)"}`,w=`${s.target}:${f}:${V}:${D}`}else if(["in","not_in"].includes(f)){if(!V&&!D)continue;const k=(D?D.split(",").map(x=>x.trim()):[V]).join(",");h=`${s.label} ${f==="in"?"in":"not in"} ${k}`,w=`${s.target}:${f}:${k}`}else h=`${s.label} ${f??"="} ${r.value}`,w=`${s.target}:${f??"="}:${V}`;t.push({label:h,expression:w,filterIndex:e,optionIndex:o})}}}this.filtersHaveChanged(t,this.lastEmittedFilters)&&(this.$emit("updatedFilters",t),this.lastEmittedFilters=C(t))},applyFilterExpressions(){this.filterExpressions.forEach(t=>{const e=t.split(":"),s=e[0],g=e[1],o=e[2],r=e[3]??null,d=this.localFilters.find(h=>h.target===s);d&&d.options.forEach(h=>{h.value===g&&(h.active=!0,d.type==="date"&&o&&P(o).isValid()?(h.value=P(o).format("DD MMM YYYY"),r&&P(r).isValid()&&(h.value2=P(r).format("DD MMM YYYY"))):["in","not_in"].includes(g)?(h.value=o.split(",")[0],h.value2=o):(h.value=o,h.value2=r))})})},filtersHaveChanged(t,e){var s=C(t),g=C(e);return!G(s,g)},openFilterDrawer(){this.localFilters==null&&this.getFilters(),this.filterDrawer.showDrawer()},closeFilterDrawer(){this.filterDrawer.hideDrawer()},toggleFilterVisibility(t){this.localFilters[t].active||this.localFilters.forEach((e,s)=>{this.localFilters[s].active=!1}),this.localFilters[t].active=!this.localFilters[t].active},showMoreOrLess(){this.showMore=!this.showMore},removeAppliedFilter(t){t.hasOwnProperty("filterIndex")&&t.hasOwnProperty("optionIndex")?this.localFilters[t.filterIndex].options[t.optionIndex].active=!1:this.localFilters[t.filterIndex].options.forEach(e=>{e.active=!1})},clearFilters(){this.localFilters=C(this.originalFilters)},async getFilters(){var t,e;try{if(this.isLoadingFilters)return;this.isLoadingFilters=!0;const s={params:{type:this.resource}},g=await axios.get("/api/filters",s);this.localFilters=g.data.map(o=>({...o,active:!1,options:o.options.map(r=>{let d={...r,active:!1};return o.type==="money"?(d.value="0.00",d.value2="0.00"):o.type==="date"?(d.value=P().subtract(7,"day").format("YYYY-MM-DD"),d.value2=P().add(7,"day").format("YYYY-MM-DD")):(["text","number","uuid"].includes(o.type)||o.target==="country"||o.type==="select")&&(d.value="",d.value2=""),d})})),this.originalFilters=C(this.localFilters),this.applyFilterExpressions()}catch(s){const g=((e=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while fetching the filter options";this.notificationState.showWarningNotification(g),console.error("Failed to fetch filter options:",s)}finally{this.isLoadingFilters=!1}}},mounted(){this.filterDrawer=this.$refs.filterDrawer,this.hasFilterExpressions&&this.getFilters()}},de={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},pe={key:0,class:"flex justify-center my-8"},he={key:1,class:"divide-y mb-4"},me={key:0},ge=["onClick"],fe={class:"flex items-center space-x-2"},ye={key:0,class:"text-sm p-4"},ve={key:0,class:"my-4"},we={key:0,class:"space-y-4"},be={key:1,class:"space-y-4"},xe={key:2,class:"space-y-4"},_e={key:3,class:"space-y-4"},Se={key:4,class:"space-y-4"},ke={key:5,class:"space-y-4"},Fe={key:6,class:"space-y-4"},Ve={key:2,class:"flex flex-col items-center px-4 space-y-8 mb-60"};function De(t,e,s,g,o,r){const d=c("Button"),h=c("Funnel"),w=c("Loader"),V=c("Pill"),D=c("ChevronUp"),f=c("ChevronDown"),b=c("Input"),k=c("Datepicker"),x=c("SelectCountry"),_=c("Select"),E=c("Drawer");return l(),i("div",null,[u(d,{size:"xs",type:"bare",leftIcon:o.Funnel,action:r.openFilterDrawer},null,8,["leftIcon","action"]),u(E,{position:"right",ref:"filterDrawer",showFooter:!1,scrollOnContent:!1},{content:F(()=>[n("div",de,[u(h,{size:"20"}),e[14]||(e[14]=n("h2",null,"Filters",-1))]),e[16]||(e[16]=n("p",{class:"p-4 text-sm bg-indigo-100"}," Find exactly what you need by applying filters to your data ",-1)),o.isLoadingFilters?(l(),i("div",pe,[u(w)])):(l(),i("div",he,[(l(!0),i(A,null,I(o.localFilters,(y,L)=>(l(),i(A,{key:L},[o.showMore||y.priority?(l(),i("div",me,[n("div",{onClick:a=>r.toggleFilterVisibility(L),class:"text-sm p-4 bg-gray-50 hover:bg-gray-100 cursor-pointer flex items-center justify-between"},[n("span",null,U(y.label),1),n("div",fe,[r.countActiveOptions(y)?(l(),v(V,{key:0,type:"primary",size:"xs",class:"flex-shrink-0"},{default:F(()=>[O(U(r.countActiveOptions(y)),1)]),_:2},1024)):p("",!0),y.active?(l(),v(D,{key:1,size:"16"})):(l(),v(f,{key:2,size:"16"}))])],8,ge),y.active?(l(),i("div",ye,[(l(!0),i(A,null,I(y.options,(a,Z)=>(l(),i("div",{key:Z},[u(b,{onClick:e[0]||(e[0]=S(()=>{},["stop"])),type:"checkbox",modelValue:a.active,"onUpdate:modelValue":m=>a.active=m,inputLabel:a.label},null,8,["modelValue","onUpdate:modelValue","inputLabel"]),a.active?(l(),i("div",ve,[y.type==="date"?(l(),i("div",we,[u(k,{onClick:e[1]||(e[1]=S(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":m=>a.value=m},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(a.operator)?(l(),v(k,{key:0,onClick:e[2]||(e[2]=S(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":m=>a.value2=m},null,8,["modelValue","onUpdate:modelValue"])):p("",!0)])):y.type==="money"?(l(),i("div",be,[u(b,{type:"money",onClick:e[3]||(e[3]=S(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":m=>a.value=m},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(a.operator)?(l(),v(b,{key:0,type:"money",onClick:e[4]||(e[4]=S(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":m=>a.value2=m},null,8,["modelValue","onUpdate:modelValue"])):p("",!0)])):y.target==="country"?(l(),i("div",xe,[u(x,{onClick:e[5]||(e[5]=S(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,placeholder:"Select country"},null,8,["modelValue","onUpdate:modelValue"]),["in","not_in"].includes(a.operator)?(l(),v(b,{key:0,type:"text",onClick:e[6]||(e[6]=S(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":m=>a.value2=m,placeholder:"Enter comma-separated country codes"},null,8,["modelValue","onUpdate:modelValue"])):p("",!0)])):y.type==="text"?(l(),i("div",_e,[u(b,{type:"text",onClick:e[7]||(e[7]=S(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,placeholder:"Enter value"},null,8,["modelValue","onUpdate:modelValue"])])):y.type==="number"?(l(),i("div",Se,[u(b,{type:"number",onClick:e[8]||(e[8]=S(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,placeholder:"Enter number"},null,8,["modelValue","onUpdate:modelValue"]),["bt","bt_ex"].includes(a.operator)?(l(),v(b,{key:0,type:"number",onClick:e[9]||(e[9]=S(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":m=>a.value2=m,placeholder:"Enter number"},null,8,["modelValue","onUpdate:modelValue"])):p("",!0)])):y.type==="uuid"?(l(),i("div",ke,[u(b,{type:"text",onClick:e[10]||(e[10]=S(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,placeholder:"Enter UUID"},null,8,["modelValue","onUpdate:modelValue"]),["in","not_in"].includes(a.operator)?(l(),v(b,{key:0,type:"text",onClick:e[11]||(e[11]=S(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":m=>a.value2=m,placeholder:"Enter comma-separated UUIDs"},null,8,["modelValue","onUpdate:modelValue"])):p("",!0)])):y.type==="select"?(l(),i("div",Fe,[u(_,{onClick:e[12]||(e[12]=S(()=>{},["stop"])),modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,options:y.options,placeholder:"Select value"},null,8,["modelValue","onUpdate:modelValue","options"]),["in","not_in"].includes(a.operator)?(l(),v(b,{key:0,type:"text",onClick:e[13]||(e[13]=S(()=>{},["stop"])),modelValue:a.value2,"onUpdate:modelValue":m=>a.value2=m,placeholder:"Enter comma-separated values"},null,8,["modelValue","onUpdate:modelValue"])):p("",!0)])):p("",!0)])):p("",!0)]))),128))])):p("",!0)])):p("",!0)],64))),128))])),o.isLoadingFilters?p("",!0):(l(),i("div",Ve,[r.hasPriorityFilters&&r.hasNonPriorityFilters?(l(),v(d,{key:0,size:"xs",type:"outline",action:r.showMoreOrLess,leftIcon:o.showMore?o.ArrowUp:o.ArrowDown},{default:F(()=>[n("span",null,U(o.showMore?"show less options":"show more options"),1)]),_:1},8,["action","leftIcon"])):p("",!0),r.totalActiveFilters?(l(),v(d,{key:1,size:"sm",type:"light",buttonClass:"w-full",action:r.clearFilters},{default:F(()=>e[15]||(e[15]=[n("span",null,"Clear Filters",-1)])),_:1,__:[15]},8,["action"])):p("",!0)]))]),_:1},512)])}const Ce=N(ce,[["render",De]]),Ee={inject:["formState"],components:{Move:K,Logs:q,draggable:J,Input:j,Pill:z,Button:B,Drawer:$,Switch:ae},props:{columns:{type:Array,default:()=>[]}},emits:["updatedColumns"],data(){return{Logs:q,showMore:!1,columnsDrawer:null,showEverything:!1,localColumns:C(this.columns),originalColumns:C(this.columns)}},watch:{localColumns:{handler(t){this.showEverything!=this.isShowingEverything&&(this.showEverything=this.isShowingEverything),this.$emit("updatedColumns",t)},deep:!0},showEverything(t){t?this.localColumns.map(e=>e.active=!0):this.isShowingEverything&&this.localColumns.map(e=>e.active=e.priority)}},computed:{isShowingEverything(){return this.localColumns.filter(t=>t.active==!0).length==this.localColumns.length}},methods:{openColumnsDrawer(){this.columnsDrawer.showDrawer()},closeColumnsDrawer(){this.columnsDrawer.hideDrawer()},resetColumns(){this.localColumns=C(this.originalColumns)}},mounted(){this.columnsDrawer=this.$refs.columnsDrawer}},Ue={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},Ae={class:"p-4 border-b shadow-sm"},Ie={class:"divide-y mb-4"},Me={class:"px-4 mb-60"};function Le(t,e,s,g,o,r){const d=c("Button"),h=c("Logs"),w=c("Switch"),V=c("Input"),D=c("Move"),f=c("draggable"),b=c("Drawer");return l(),i("div",null,[u(d,{size:"xs",type:"bare",leftIcon:o.Logs,action:r.openColumnsDrawer},null,8,["leftIcon","action"]),u(b,{position:"right",ref:"columnsDrawer",showFooter:!1,scrollOnContent:!1},{content:F(()=>[n("div",Ue,[u(h,{size:"20"}),e[4]||(e[4]=n("h2",null,"Columns",-1))]),e[6]||(e[6]=n("p",{class:"p-4 text-sm bg-indigo-100"}," Show, hide and move your data they way you want to see it ",-1)),n("div",Ae,[u(w,{size:"sm",modelValue:o.showEverything,"onUpdate:modelValue":e[0]||(e[0]=k=>o.showEverything=k),suffixText:"Show Everything"},null,8,["modelValue"])]),n("div",Ie,[u(f,{class:"divide-y mb-4",modelValue:o.localColumns,"onUpdate:modelValue":e[3]||(e[3]=k=>o.localColumns=k),handle:".draggable-handle","ghost-class":"bg-yellow-50"},{default:F(()=>[(l(!0),i(A,null,I(o.localColumns,(k,x)=>(l(),i("div",{key:x,class:"flex items-center justify-between p-4"},[u(V,{onClick:e[1]||(e[1]=S(()=>{},["stop"])),type:"checkbox",modelValue:k.active,"onUpdate:modelValue":_=>k.active=_,inputLabel:k.name},null,8,["modelValue","onUpdate:modelValue","inputLabel"]),u(D,{onClick:e[2]||(e[2]=S(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})]))),128))]),_:1},8,["modelValue"])]),n("div",Me,[u(d,{size:"sm",type:"light",buttonClass:"w-full",action:r.resetColumns},{default:F(()=>e[5]||(e[5]=[n("span",null,"Reset Columns",-1)])),_:1,__:[5]},8,["action"])])]),_:1},512)])}const Pe=N(Ee,[["render",Le]]),Oe={inject:["notificationState"],components:{Move:K,draggable:J,Pill:z,Input:j,Button:B,Drawer:$,Loader:Y,ArrowDownWideNarrow:H},props:{sortingExpressions:{type:Array,default:()=>[]},resource:{type:String}},emits:["updatedSorting"],data(){return{ArrowUp:X,ArrowDown:Q,showMore:!1,sortDrawer:null,localSorting:null,ArrowDownWideNarrow:H,originalSorting:null,isLoadingSorting:!1,lastEmittedSorting:null}},watch:{localSorting:{handler(t){this.createSortingExpressions()},deep:!0}},computed:{hasSortingExpressions(){return this.sortingExpressions.length>0},totalActiveSortOptions(){return this.localSorting==null?0:this.localSorting.filter(t=>t.options.some(e=>e.active)).length},hasPrioritySortOptions(){return this.localSorting==null?!1:this.localSorting.filter(t=>t.priority).length>0},hasNonPrioritySortOptions(){return this.localSorting==null?!1:this.localSorting.filter(t=>!t.priority).length>0}},methods:{toggleSortOption(t,e){this.localSorting[t].options.forEach((s,g)=>{g!==e&&(s.active=!1)})},countActiveOptions(t){return t.options.filter(e=>e.active).length},createSortingExpressions(){let t=[];for(let e=0;e<this.localSorting.length;e++){const s=this.localSorting[e];if(s.options.some(o=>o.active)){const r=s.options.filter(w=>w.active)[0],d=`${s.label} (${r.label})`,h=`${s.target}:${r.value}`;t.push({label:d,sortIndex:e,expression:h})}}this.sortingHasChanged(t,this.lastEmittedSorting)&&(this.$emit("updatedSorting",t),this.lastEmittedSorting=C(t))},applySortingExpressions(){this.sortingExpressions.forEach(t=>{const e=t.split(":"),s=e[0],g=e[1],o=this.localSorting.find(r=>r.target===s);o&&o.options.forEach(r=>{r.value==g&&(r.active=!0)})})},sortingHasChanged(t,e){var s=C(t),g=C(e);return!G(s,g)},openSortDrawer(){this.localSorting==null&&this.getSorting(),this.sortDrawer.showDrawer()},closeSortDrawer(){this.sortDrawer.hideDrawer()},toggleSortingVisibility(t){this.localSorting[t].active||this.localSorting.forEach((e,s)=>{this.localSorting[s].active=!1}),this.localSorting[t].active=!this.localSorting[t].active},showMoreOrLess(){this.showMore=!this.showMore},removeAppliedSort(t){this.localSorting[t.sortIndex].options.forEach(e=>{e.active=!1})},clearSorting(){this.localSorting=C(this.originalSorting)},async getSorting(){var t,e;try{if(this.isLoadingSorting)return;this.isLoadingSorting=!0;const s={params:{type:this.resource}},g=await axios.get("/api/sorting",s);this.localSorting=g.data.map(o=>({...o,active:!1,options:o.options.map(r=>({...r,active:!1}))})),this.originalSorting=C(this.localSorting),this.applySortingExpressions()}catch(s){const g=((e=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"Something went wrong while fetching the sorting options";this.notificationState.showWarningNotification(g),console.error("Failed to fetch sorting options:",s)}finally{this.isLoadingSorting=!1}}},mounted(){this.sortDrawer=this.$refs.sortDrawer,this.hasSortingExpressions&&this.getSorting()}},Te={class:"flex items-center space-x-2 bg-gray-100 border-b border-gray-300 shadow-sm p-4"},ze={key:0,class:"flex justify-center my-8"},je={key:0},Be=["onClick"],Ne={class:"flex items-center space-x-2"},Ye={key:2,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},$e={key:3,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},He={key:0,class:"text-sm p-4"},Re={key:2,class:"flex flex-col items-center px-4 space-y-8 mb-60"};function qe(t,e,s,g,o,r){const d=c("Button"),h=c("ArrowDownWideNarrow"),w=c("Loader"),V=c("Pill"),D=c("Move"),f=c("Input"),b=c("draggable"),k=c("Drawer");return l(),i("div",null,[u(d,{size:"xs",type:"bare",action:r.openSortDrawer,leftIcon:o.ArrowDownWideNarrow},null,8,["action","leftIcon"]),u(k,{ref:"sortDrawer",position:"right",showFooter:!1,scrollOnContent:!1},{content:F(()=>[n("div",Te,[u(h,{size:"20"}),e[2]||(e[2]=n("h2",null,"Sorting",-1))]),e[6]||(e[6]=n("p",{class:"p-4 text-sm bg-indigo-100"}," When using two or more sorting options, you can rearrange their order to prioritize which criteria are applied first. ",-1)),o.isLoadingSorting?(l(),i("div",ze,[u(w)])):(l(),v(b,{key:1,modelValue:o.localSorting,"onUpdate:modelValue":e[1]||(e[1]=x=>o.localSorting=x),class:"divide-y mb-4",handle:".draggable-handle","ghost-class":"bg-yellow-50"},{default:F(()=>[(l(!0),i(A,null,I(o.localSorting,(x,_)=>(l(),i(A,{key:_},[o.showMore||x.priority?(l(),i("div",je,[n("div",{onClick:E=>r.toggleSortingVisibility(_),class:"text-sm p-4 bg-gray-50 hover:bg-gray-100 cursor-pointer flex items-center justify-between"},[n("span",null,U(x.label),1),n("div",Ne,[r.countActiveOptions(x)?(l(),v(V,{key:0,type:"primary",size:"xs",class:"flex-shrink-0"},{default:F(()=>[O(U(r.countActiveOptions(x)),1)]),_:2},1024)):p("",!0),r.countActiveOptions(x)?(l(),v(D,{key:1,onClick:e[0]||(e[0]=S(()=>{},["stop"])),size:"16",class:"draggable-handle cursor-grab active:cursor-grabbing text-gray-500 hover:text-yellow-500"})):p("",!0),x.active?(l(),i("svg",Ye,e[3]||(e[3]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"},null,-1)]))):(l(),i("svg",$e,e[4]||(e[4]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"},null,-1)])))])],8,Be),x.active?(l(),i("div",He,[(l(!0),i(A,null,I(x.options,(E,y)=>(l(),i("div",{key:y},[u(f,{type:"checkbox",modelValue:E.active,"onUpdate:modelValue":L=>E.active=L,inputLabel:E.label,onClick:S(()=>r.toggleSortOption(_,y),["stop"])},null,8,["modelValue","onUpdate:modelValue","inputLabel","onClick"])]))),128))])):p("",!0)])):p("",!0)],64))),128))]),_:1},8,["modelValue"])),o.isLoadingSorting?p("",!0):(l(),i("div",Re,[r.hasPrioritySortOptions&&r.hasNonPrioritySortOptions?(l(),v(d,{key:0,size:"xs",type:"outline",action:r.showMoreOrLess,leftIcon:o.showMore?o.ArrowUp:o.ArrowDown},{default:F(()=>[n("span",null,U(o.showMore?"show less options":"show more options"),1)]),_:1},8,["action","leftIcon"])):p("",!0),r.totalActiveSortOptions?(l(),v(d,{key:1,size:"sm",type:"light",buttonClass:"w-full",action:r.clearSorting},{default:F(()=>e[5]||(e[5]=[n("span",null,"Clear Sorting",-1)])),_:1,__:[5]},8,["action"])):p("",!0)]))]),_:1},512)])}const We=N(Oe,[["render",qe]]),Ge={components:{Pill:z,Button:B,Input:j,Select:W,Paginator:oe,Loader:Y,FilterDrawer:Ce,ColumnsDrawer:Pe,SortingDrawer:We},props:{isLoading:{type:Boolean,default:!1},searchTerm:{type:String,default:null},searchPlaceholder:{type:String,default:null},pagination:{type:Object},perPage:{type:String,default:"15"},resource:{type:String},columns:{type:Array,default:()=>[]},filterExpressions:{type:Array,default:()=>[]},sortingExpressions:{type:Array,default:()=>[]}},emits:["search","refresh","paginate","updatedColumns","updatedFilters","updatedSorting","updatedPerPage"],data(){return{RotateCcw:ue,modal:null,filters:[],sorting:[],filterDrawer:null,isSearching:!1,sortingDrawer:null,totalTableHeaders:0,localPerPage:this.perPage,localIsLoading:this.isLoading,localSearchTerm:this.searchTerm,uniqueModalId:te("modal")}},watch:{isLoading(t){this.localIsLoading=t,this.isSearching=t&&this.hasSearchTerm},localSearchTerm(t){this.$emit("search",t)},localPerPage(t){this.$emit("updatedPerPage",t)},pagination(t){t&&this.$nextTick(()=>{this.filterDrawer=this.$refs.filterDrawer,this.sortingDrawer=this.$refs.sortingDrawer})},columns:{handler(){this.$nextTick(()=>{this.totalTableHeaders=this.$refs.tablehead.querySelectorAll("th").length})},deep:!0}},computed:{hasSearchTerm(){return this.isNotEmpty(this.localSearchTerm)},hasFilters(){return this.filters.length>0},hasSorting(){return this.sorting.length>0},hasFilterExpressions(){return this.filterExpressions.length>0},hasSortingExpressions(){return this.sortingExpressions.length>0},perPageOptions(){return["15","50","100","200"].map(t=>({label:`${t} per page`,value:t}))}},methods:{isNotEmpty:ee,refresh(){this.localIsLoading||this.$emit("refresh")},paginate(t){this.$emit("paginate",t)},updatedColumns(t){this.$emit("updatedColumns",t)},updatedFilters(t){this.filters=t,this.$emit("updatedFilters",t)},updatedSorting(t){this.sorting=t,this.$emit("updatedSorting",t)},removeAppliedFilter(t){this.filterDrawer.removeAppliedFilter(t)},removeAppliedSort(t){this.sortingDrawer.removeAppliedSort(t)},onInputSearchTerm(t){t.target.value.length?this.isSearching=!0:this.isSearching=!1,this.localIsLoading=!0}},mounted(){this.totalTableHeaders=this.$refs.tablehead.querySelectorAll("th").length}},Je={class:"flex justify-between items-center space-x-4 mb-4"},Ke={key:0,class:"flex justify-center items-center space-x-4"},Qe={key:0},Xe={key:1},Ze={key:0,class:"flex flex-col items-center mb-4"},et={class:"flex items-center space-x-2"},tt={key:1,class:"flex flex-col items-center mb-4"},st={class:"flex items-center space-x-2"},ot={key:2,class:"flex flex-wrap gap-2 mb-4"},lt={class:"relative w-full overflow-x-auto border border-blue-200 rounded-lg"},rt={key:0,class:"absolute top-0 bottom-0 left-0 right-0 bg-white/50 flex justify-center items-center"},it={class:"w-full text-left rtl:text-right"},nt={class:"text-sm bg-blue-50",ref:"tablehead"},at={key:0},ut={key:2},ct={key:2,class:"text-sm text-gray-700 text-center py-16 bg-blue-50 border-t border-blue-200"},dt={key:0,class:"flex items-center justify-center space-x-2"},pt={class:"text-sm text-gray-500"},ht={key:1},mt={key:0,class:"flex justify-between items-center mt-4"},gt={class:"text-sm font-normal text-gray-500 dark:text-gray-400"},ft={class:"font-semibold text-gray-900 dark:text-white"},yt={class:"font-semibold text-gray-900 dark:text-white"},vt={class:"flex items-center space-x-4"};function wt(t,e,s,g,o,r){const d=c("Input"),h=c("FilterDrawer"),w=c("SortingDrawer"),V=c("ColumnsDrawer"),D=c("Button"),f=c("Loader"),b=c("Pill"),k=c("Select"),x=c("Paginator");return l(),i("div",null,[M(t.$slots,"header"),n("div",Je,[u(d,{type:"search",class:"w-full",debounced:!0,modelValue:o.localSearchTerm,"onUpdate:modelValue":e[0]||(e[0]=_=>o.localSearchTerm=_),onInput:r.onInputSearchTerm,placeholder:s.searchPlaceholder},null,8,["modelValue","onInput","placeholder"]),s.pagination?(l(),i("div",Ke,[u(h,{ref:"filterDrawer",resource:s.resource,filterExpressions:s.filterExpressions,onUpdatedFilters:r.updatedFilters},null,8,["resource","filterExpressions","onUpdatedFilters"]),u(w,{ref:"sortingDrawer",resource:s.resource,sortingExpressions:s.sortingExpressions,onUpdatedSorting:r.updatedSorting},null,8,["resource","sortingExpressions","onUpdatedSorting"]),u(V,{ref:"columnsDrawer",columns:s.columns,onUpdatedColumns:r.updatedColumns},null,8,["columns","onUpdatedColumns"]),t.$slots.beforeRefreshButton?(l(),i("div",Qe,[M(t.$slots,"beforeRefreshButton")])):p("",!0),u(D,{action:r.refresh,type:"bare",size:"xs",leftIcon:o.RotateCcw},null,8,["action","leftIcon"]),t.$slots.afterRefreshButton?(l(),i("div",Xe,[M(t.$slots,"afterRefreshButton")])):p("",!0)])):p("",!0)]),u(se,{name:"fade-1",mode:"out-in"},{default:F(()=>[r.hasFilterExpressions&&!r.hasFilters?(l(),i("div",Ze,[n("div",et,[u(f),e[2]||(e[2]=n("span",{class:"text-sm text-gray-500"},"Preparing filters",-1))])])):r.hasSortingExpressions&&!r.hasSorting?(l(),i("div",tt,[n("div",st,[u(f),e[3]||(e[3]=n("span",{class:"text-sm text-gray-500"},"Preparing sorting",-1))])])):r.hasFilters||r.hasSorting?(l(),i("div",ot,[(l(!0),i(A,null,I(o.filters,(_,E)=>(l(),v(b,{key:E,type:"primary",size:"xs",closableAction:()=>r.removeAppliedFilter(_)},{default:F(()=>[O(U(_.label),1)]),_:2},1032,["closableAction"]))),128)),(l(!0),i(A,null,I(o.sorting,(_,E)=>(l(),v(b,{key:E,type:"success",size:"xs",closableAction:()=>r.removeAppliedSort(_)},{default:F(()=>[O(U(_.label),1)]),_:2},1032,["closableAction"]))),128))])):p("",!0)]),_:1}),M(t.$slots,"belowToolbar"),n("div",lt,[s.pagination&&s.pagination.meta.total>0&&(o.localIsLoading||o.isSearching)?(l(),i("div",rt,[u(f)])):p("",!0),n("table",it,[n("thead",nt,[M(t.$slots,"head")],512),!s.pagination&&o.localIsLoading&&o.totalTableHeaders>0?(l(),i("tbody",at,[(l(),i(A,null,I([1,2,3],(_,E)=>n("tr",{key:E,class:"animate-pulse"},[(l(!0),i(A,null,I(o.totalTableHeaders,(y,L)=>(l(),i("td",{key:L},e[4]||(e[4]=[n("div",{class:"h-2 bg-blue-200 rounded-full mx-4 my-4"},null,-1)])))),128))])),64))])):t.$slots.tbody?M(t.$slots,"tbody",{key:1}):(l(),i("tbody",ut,[M(t.$slots,"body")]))]),t.$slots.noResults&&!o.localIsLoading&&s.pagination&&s.pagination.meta.total==0&&!r.hasSearchTerm?M(t.$slots,"noResults",{key:1}):s.pagination&&s.pagination.meta.total==0?(l(),i("div",ct,[o.localIsLoading||o.isSearching?(l(),i("div",dt,[u(f),n("span",pt,U(o.isSearching?"Searching":"Loading"),1)])):(l(),i("span",ht,"No results found"))])):p("",!0)]),s.pagination&&s.pagination.meta.total>0?(l(),i("div",mt,[n("span",gt,[e[5]||(e[5]=O("Showing ")),n("span",ft,U(s.pagination.meta.from)+"-"+U(s.pagination.meta.to),1),e[6]||(e[6]=O(" of ")),n("span",yt,U(s.pagination.meta.total),1)]),n("div",vt,[u(k,{class:"w-40",search:!1,modelValue:o.localPerPage,"onUpdate:modelValue":e[1]||(e[1]=_=>o.localPerPage=_),options:r.perPageOptions},null,8,["modelValue","options"]),s.pagination?(l(),v(x,{key:0,pagination:s.pagination,onPaginate:r.paginate},null,8,["pagination","onPaginate"])):p("",!0)])])):p("",!0)])}const jt=N(Ge,[["render",wt]]);export{jt as T};
