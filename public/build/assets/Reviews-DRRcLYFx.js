import{P as k}from"./Pill-_ubzDuHk.js";import{I as L}from"./Input-QwDj8T87.js";import{L as T}from"./Loader-j3Xd9R0O.js";import{B as I}from"./Button-Dy6BYOYD.js";import{S as B}from"./Skeleton-BfdDUyfM.js";import{a as _}from"./stringUtils-Bvzw0-oW.js";import{M as N}from"./Menu-DKCIvAgi.js";import{m as V,c as i,a as n,b as e,g as w,t as d,F as g,f,r as l,o as r,e as C}from"./app-CAsQYp3T.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as v}from"./star-D2qLTOf1.js";import"./Popover-DUH2qEVS.js";import"./Tooltip-Gwe3QXsJ.js";import"./Copy-B_MLEMQD.js";import"./ShineEffect-DjmscYxr.js";import"./createLucideIcon-Dd5tvPb0.js";import"./capitalize-ChUSrr1V.js";import"./refresh-ccw-D7oBzLST.js";import"./circle-check-Coc-yKcS.js";import"./circle-alert-BwdAp8OB.js";import"./x-ICmzimgK.js";import"./parsePhoneNumber-xMTQFMCS.js";import"./house-BngMDmkI.js";import"./video-B6MeQF7n.js";import"./Drawer-uTQfQwAQ.js";import"./DesignCardManager-ChtXPBMq.js";import"./store-BlZHVnvd.js";import"./image-BbT_gSv5.js";import"./AddressInput-DPH8kHp3.js";import"./index-BlT6DaHK.js";import"./Modal-UBL0nJJO.js";import"./GoogleMaps-BjYZrpPF.js";import"./SelectCountry-CIkMQYkK.js";import"./Select-DopDm6jM.js";import"./move-left-Cp2UyO56.js";import"./trash-2-Cze44q0v.js";import"./plus-BwaaZFcM.js";import"./StoreLogo-DJAU6e07.js";import"./link-BtieYfQr.js";import"./at-sign-wvGmnihc.js";import"./chevron-up-GoZo737D.js";import"./Datepicker-Dt1y4pwS.js";import"./arrow-right-DO5RsmNG.js";import"./arrow-left-Cy1iBNmi.js";import"./Alert-jIC638EV.js";import"./info-BxOCgZi_.js";import"./Switch-TKSotGnN.js";import"./DeliveryTimePicker-Bk8RUx36.js";import"./circle-check-big-DkMj8lOq.js";import"./menu-Ck_b6Dxp.js";import"./user-CrNwCO6K.js";const A={inject:["formState","storeState","notificationState"],components:{Pill:k,Input:L,Loader:T,Button:I,Skeleton:B,Menu:N,Star:v},data(){return{Star:v,reviews:[],searchTerm:null,lastSearchTerm:null,isLoadingReviews:!1,hasLoadedInitialReviews:!1}},watch:{store(c,t){!t&&c&&this.setup()},searchTerm(){this.showReviews()}},computed:{store(){return this.storeState.store},isLoadingStore(){return this.storeState.isLoadingStore},hasSearchTerm(){return _(this.searchTerm)},hasReviews(){return this.reviews.length>0}},methods:{isNotEmpty:_,formattedRelativeDate:V,async setup(){this.store&&(this.hasLoadedInitialReviews||await this.showReviews())},onAddReview(){this.$router.push({name:"create-shop-review",query:{alias:this.store.alias}})},async showReviews(){var c,t;try{this.isLoadingReviews=!0;let o={params:{store_id:this.store.id}};this.hasSearchTerm&&(o.params.search=this.searchTerm),this.lastSearchTerm=this.searchTerm;const p=await axios.get("/api/reviews",o);if(this.searchTerm===this.lastSearchTerm){const a=p.data;this.reviews=a.data,this.hasLoadedInitialReviews=!0}}catch(o){const p=((t=(c=o==null?void 0:o.response)==null?void 0:c.data)==null?void 0:t.message)||(o==null?void 0:o.message)||"Something went wrong while fetching reviews";this.notificationState.showWarningNotification(p),this.formState.setServerFormErrors(o),console.error("Failed to fetch reviews:",o)}finally{this.isLoadingReviews=!1}}},created(){this.setup()}},F={class:"max-w-4xl mx-auto pt-8 pb-40"},M={key:0,class:"pt-8 flex items-center justify-center"},D={key:1,class:"select-none"},E={class:"flex justify-between items-end mb-4"},z={class:"space-y-2"},P={class:"text-lg font-semibold"},W={class:"flex justify-center items-center space-x-4 mb-4"},q={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},U={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G={class:"flex items-center space-x-2 mb-2"},H={class:"flex space-x-1"},J={class:"text-sm font-medium text-gray-900"},K={key:0,class:"text-sm text-gray-900 mb-2"},O={class:"flex items-center space-x-2"},Q={class:"text-sm text-gray-600"},X={class:"text-xs text-gray-600"},Y={key:2,class:"text-sm text-center p-4 rounded-lg bg-gray-50 mb-4"};function Z(c,t,o,p,a,m){const x=l("Menu"),y=l("Loader"),S=l("Button"),R=l("Input"),h=l("Skeleton"),b=l("Star");return r(),i("div",null,[n(x,{menuClass:"max-w-4xl mx-auto"}),e("div",F,[m.isLoadingStore?(r(),i("div",M,[n(y,null,{default:w(()=>[...t[2]||(t[2]=[e("span",{class:"text-sm ml-2"},"Loading store",-1)])]),_:1})])):(r(),i("div",D,[e("div",E,[e("div",z,[e("h1",P,d(m.store.name),1),t[3]||(t[3]=e("h1",{class:"text-lg font-semibold"},"Customer Reviews",-1))]),n(S,{size:"sm",type:"primary",leftIcon:a.Star,action:m.onAddReview},{default:w(()=>[...t[4]||(t[4]=[e("span",{class:"ml-1"},"Write A Review",-1)])]),_:1},8,["leftIcon","action"])]),e("div",W,[n(R,{type:"search",debounced:!0,class:"w-full",modelValue:a.searchTerm,"onUpdate:modelValue":t[0]||(t[0]=s=>a.searchTerm=s),skeleton:m.isLoadingStore,placeholder:"Search by name, comment or rating e.g 3",onInput:t[1]||(t[1]=s=>a.isLoadingReviews=!0)},null,8,["modelValue","skeleton"])]),a.isLoadingReviews?(r(),i("div",q,[(r(),i(g,null,f(4,s=>e("div",{key:s,class:"p-4 bg-gray-100 rounded-lg"},[n(h,{width:"w-1/2",shine:!0,class:"mb-2"}),n(h,{width:"w-3/4",shine:!0,class:"mb-2"}),n(h,{width:"w-full",height:"h-4",shine:!0})])),64))])):m.hasReviews?(r(),i("div",U,[(r(!0),i(g,null,f(a.reviews,s=>(r(),i("div",{key:s.id,class:"p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-300"},[e("div",G,[e("div",H,[(r(),i(g,null,f(5,u=>n(b,{size:16,key:u,fill:u<=s.rating?"gold":"none",stroke:u<=s.rating?"gold":"gray"},null,8,["fill","stroke"])),64))]),e("span",J,d(s.rating)+"/5",1)]),s.comment?(r(),i("p",K,d(s.comment),1)):C("",!0),e("div",O,[e("span",Q,d(s.name||"Anonymous"),1),t[5]||(t[5]=e("span",{class:"text-xs text-gray-400"},"â€¢",-1)),e("span",X,d(m.formattedRelativeDate(s.created_at)),1)])]))),128))])):(r(),i("p",Y," No reviews found. Be the first to share your experience! "))]))])])}const Qt=j(A,[["render",Z]]);export{Qt as default};
